<html>
<head>
<title>How to Publish an Angular Library to NPM</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何向NPM发布角库</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-publish-an-angular-library-to-npm-ec3a50244434?source=collection_archive---------6-----------------------#2022-08-29">https://javascript.plainenglish.io/how-to-publish-an-angular-library-to-npm-ec3a50244434?source=collection_archive---------6-----------------------#2022-08-29</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="48f4" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">使用Angular 6+，在npm中生成和发布包非常容易。在本例中，我们将创建并发布一个星级评定组件。</p><p id="4d82" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">你可以在这里找到git库和源代码<a class="ae ki" href="https://github.com/armenstepanyan/ng-rating-bar" rel="noopener ugc nofollow" target="_blank">，在这里</a>找到发布的npm包<a class="ae ki" href="https://www.npmjs.com/package/ng-rating-bar" rel="noopener ugc nofollow" target="_blank"/></p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/733bfc1072ef060b6b5c0cdad069aeca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VoxZPNxLdIamF5Bmd2EMnQ.png"/></div></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk">Publishing angular library onto npm</figcaption></figure><h1 id="c3c1" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">设置</h1><p id="4c6e" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">首先，让我们创建一个新的Angular项目:</p><pre class="kk kl km kn gt mc md me mf aw mg bi"><span id="bfda" class="mh la in md b gy mi mj l mk ml">ng new rating</span></pre><p id="1e4e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">那么让我们添加一个新的角度库。Angular CLI提供了一种使用以下命令在新工作空间中生成新库框架的方法。</p><pre class="kk kl km kn gt mc md me mf aw mg bi"><span id="acae" class="mh la in md b gy mi mj l mk ml">ng g library ng-rating-bar</span></pre><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi mm"><img src="../Images/6e67d44f9da52441dcc010edfd0cd610.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ih_mcgrV3SlJbOqTD89rzg.png"/></div></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk">Create new library</figcaption></figure><p id="32f5" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">正如我们在这里看到的，一个新的<strong class="jm io"> ng-rating-bar </strong>文件夹被创建在项目文件夹中，3个文件被更新。让我们逐一看看:</p><ul class=""><li id="277d" class="mn mo in jm b jn jo jr js jv mp jz mq kd mr kh ms mt mu mv bi translated"><strong class="jm io"> angular.json - </strong>新增<em class="mw"> ng-rating-bar </em>项目(项目类型为库)</li></ul><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi mx"><img src="../Images/70e5f19a27789ba32273c36045f058e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sYWc5KYJZCtSdhUTgAWLxw.png"/></div></div></figure><ul class=""><li id="ae5e" class="mn mo in jm b jn jo jr js jv mp jz mq kd mr kh ms mt mu mv bi translated"><strong class="jm io"> packages.json - </strong>增加了<strong class="jm io">ng-packager</strong>依赖项，用于从您编译的代码创建可以发布到npm的包。</li></ul><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi my"><img src="../Images/1c49e9ae1cbf62ed8e30f9364926b5fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1074/format:webp/1*OTVwP-X1plkH4_-ad6NZxg.png"/></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk">ng-packagr will be added in packages.json</figcaption></figure><p id="8152" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">注意:对于普通的angular应用程序，使用<strong class="jm io">@ angular-devkit/build-angular:browser</strong>来构建应用程序(您可以在angular.json文件中找到它),对于库angular使用<strong class="jm io">ng-packar</strong></p><ul class=""><li id="30fd" class="mn mo in jm b jn jo jr js jv mp jz mq kd mr kh ms mt mu mv bi translated"><strong class="jm io"> tsconfig.json - </strong>添加了一个新路径，稍后将使用该路径将库导入到我们的应用程序中</li></ul><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi mz"><img src="../Images/3bc8cbd82208c2bb9dfd6a260c32e101.png" data-original-src="https://miro.medium.com/v2/resize:fit:1106/format:webp/1*39h45s2qxNcakmfwUMYrqA.png"/></div></figure><h1 id="0125" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">文件结构</h1><p id="69ce" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">新生成的库包含public-api.ts文件和lib文件夹。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi na"><img src="../Images/d62bccd83b2bd4009ade17b776049dc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:906/format:webp/1*i9f3o_HWaDeD3QtICF9cHA.png"/></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk">Library file structure</figcaption></figure><p id="bfc1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">默认情况下，lib文件夹包含可以在我们的库中使用的模块、组件和服务文件。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/c5299153ca2c9f32a732a6649f673541.png" data-original-src="https://miro.medium.com/v2/resize:fit:1376/format:webp/1*3iVy3hChuPceQwePW09vwA.png"/></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk">Lib folder structure</figcaption></figure><p id="0f0b" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">对于我们的例子，我们不需要使用服务，所以我们可以从lib文件夹和<em class="mw"> src/public.api </em>文件中删除它。</p><p id="4163" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">projects/ng-rating-bar/src/public . API</strong></p><pre class="kk kl km kn gt mc md me mf aw mg bi"><span id="1a7c" class="mh la in md b gy mi mj l mk ml">/*<br/> * Public API Surface of ng-bar<br/> */</span><span id="45f9" class="mh la in md b gy nc mj l mk ml">// export * from './lib/ng-bar.service'; // remove this<br/>export * from './lib/ng-bar.component';<br/>export * from './lib/ng-bar.module';</span></pre><p id="499f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们的库将按给定的配置显示评级。我不会在这里包含全部代码，你可以在<a class="ae ki" href="https://github.com/armenstepanyan/ng-rating-bar" rel="noopener ugc nofollow" target="_blank"> Github库</a>上找到。</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="nd ne l"/></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk">Part of ng-rating-bar component</figcaption></figure><p id="5549" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在我们需要导出组件:</p><pre class="kk kl km kn gt mc md me mf aw mg bi"><span id="0461" class="mh la in md b gy mi mj l mk ml">import { NgModule } from '<a class="ae ki" href="http://twitter.com/angular/core" rel="noopener ugc nofollow" target="_blank">@angular/core</a>';<br/>import { NgRatingBarComponent } from './ng-rating-bar.component';<br/>import { CommonModule } from '<a class="ae ki" href="http://twitter.com/angular/common" rel="noopener ugc nofollow" target="_blank">@angular/common</a>';</span><span id="ba61" class="mh la in md b gy nc mj l mk ml"><a class="ae ki" href="http://twitter.com/NgModule" rel="noopener ugc nofollow" target="_blank">@NgModule</a>({<br/>  declarations: [<br/>    NgRatingBarComponent<br/>  ],<br/>  imports: [CommonModule],<br/>  exports: [<br/>    NgRatingBarComponent<br/>  ]<br/>})<br/>export class NgRatingBarModule { }</span></pre><p id="01c9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">我们组件的简单用法:</p><pre class="kk kl km kn gt mc md me mf aw mg bi"><span id="cd62" class="mh la in md b gy mi mj l mk ml">&lt;ng-rating-bar<br/>  [(value)]="value"<br/>  [ratingCount]="ratingCount"<br/>  colorActive="red"<br/>  colorDefault="gray"<br/>&gt;&lt;/ng-rating-bar&gt;</span></pre><h1 id="6917" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">将库导入应用程序</h1><p id="0722" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">现在库已经准备好了，我们需要在我们的应用程序中导入并测试它。有两种方法:</p><p id="d3d6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">第一种方式:</strong>我们可以直接从<em class="mw">项目/ng-rating-bar </em>文件夹中导入模块:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/2cf0f8222d216361f5f199896ab4f957.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/format:webp/1*CD2bzYgWsdb6et9KivGFZA.png"/></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk">Import library from projects folder</figcaption></figure><p id="8a5e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">第二种方式:</strong>我们可以构建自己的库，从<em class="mw">ng-rating-bar</em><strong class="jm io"/>导入(因为tsconfig.js中增加了新的路径):</p><pre class="kk kl km kn gt mc md me mf aw mg bi"><span id="ef7b" class="mh la in md b gy mi mj l mk ml">ng build ng-rating-bar</span></pre><p id="efa9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">这将在<em class="mw"> dist/ng-rating-bar </em>文件夹中创建库的构建版本:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/b452e0a4318ace5883399aea006f6692.png" data-original-src="https://miro.medium.com/v2/resize:fit:1158/format:webp/1*lFK7iqWkHxrLQ1KkRVO4dw.png"/></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk">Import module from ng-rating-bar</figcaption></figure><blockquote class="nh ni nj"><p id="4e56" class="jk jl mw jm b jn jo jp jq jr js jt ju nk jw jx jy nl ka kb kc nm ke kf kg kh ig bi translated">当您从Angular应用程序的库中导入内容时，Angular会在库名和磁盘位置之间寻找映射。当您安装一个库包时，映射在<code class="fe nn no np md b">node_modules</code>文件夹中。当您构建自己的库时，它必须在您的<code class="fe nn no np md b">tsconfig</code>路径中找到映射。</p><p id="4acf" class="jk jl mw jm b jn jo jp jq jr js jt ju nk jw jx jy nl ka kb kc nm ke kf kg kh ig bi translated">用Angular CLI生成库时，会自动将其路径添加到<code class="fe nn no np md b">tsconfig</code>文件中。Angular CLI使用<code class="fe nn no np md b">tsconfig</code>路径来告诉构建系统在哪里可以找到这个库。</p></blockquote><h1 id="7668" class="kz la in bd lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw bi translated">出版图书馆</h1><p id="31f8" class="pw-post-body-paragraph jk jl in jm b jn lx jp jq jr ly jt ju jv lz jx jy jz ma kb kc kd mb kf kg kh ig bi translated">现在一切都准备好了，我们可以在npm中发布这个包了。但在此之前，我们先在<strong class="jm io"> Readme.md <em class="mw"> </em> </strong>文件中添加一些信息，在<strong class="jm io"> package.json </strong>文件中添加作者、关键字和描述。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi mx"><img src="../Images/55b02ba34206b5126be24b85d4688e96.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8HShBQ1IkBwrTJKHORIAOA.png"/></div></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk">ng-rating-bar library</figcaption></figure><p id="8267" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">打开packages.json并添加元数据:</p><pre class="kk kl km kn gt mc md me mf aw mg bi"><span id="635f" class="mh la in md b gy mi mj l mk ml">{<br/>  "name": "ng-rating-bar",<br/>  "version": "1.2.2",<br/>  "author": {<br/>    "name": "Armen Stepanyan"<br/>  },<br/>  "keywords": [<br/>    "angular",<br/>    "rating",<br/>    "javascript",<br/>    "angular-rating",<br/>    "ng-rating-bar"<br/>  ],<br/>  "repository": {<br/>    "type": "git",<br/>    "url": "<a class="ae ki" href="https://github.com/armenstepanyan/ng-rating-bar.git" rel="noopener ugc nofollow" target="_blank">https://github.com/armenstepanyan/ng-rating-bar.git</a>"<br/>  },<br/>  "description": "Star rating component for angular",<br/>  "peerDependencies": {<br/>    "<a class="ae ki" href="http://twitter.com/angular/common" rel="noopener ugc nofollow" target="_blank">@angular/common</a>": "^14.1.0",<br/>    "<a class="ae ki" href="http://twitter.com/angular/core" rel="noopener ugc nofollow" target="_blank">@angular/core</a>": "^14.1.0"<br/>  },<br/>  "dependencies": {<br/>    "tslib": "^2.3.0"<br/>  }<br/>}</span></pre><p id="89e8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在，我们可以构建并发布我们的库:</p><pre class="kk kl km kn gt mc md me mf aw mg bi"><span id="4f5a" class="mh la in md b gy mi mj l mk ml">ng build ng-rating-bar</span></pre><p id="7154" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">现在从<em class="mw"> dist/ng-rating-bar </em>文件夹中，运行<em class="mw"> publish </em>命令:</p><pre class="kk kl km kn gt mc md me mf aw mg bi"><span id="a47a" class="mh la in md b gy mi mj l mk ml">npm publish</span></pre><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi nq"><img src="../Images/b0e981bf0d6315f419ef3b14cf0ca5cc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6jjut_wKgFg13qKPw146LA.png"/></div></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk">Publish package in npm</figcaption></figure><p id="79d7" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">注意</strong>:如果没有登录npm，需要运行<code class="fe nn no np md b"><strong class="jm io">npm login</strong></code> <em class="mw">。</em></p><p id="e838" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io">发布包:</strong></p><div class="nr ns gp gr nt nu"><a href="https://www.npmjs.com/package/ng-rating-bar" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd io gy z fp nz fr fs oa fu fw im bi translated">ng-评级-栏</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">角度的星级评定组件。最新版本:1.2.5，最后发布时间:3天前。开始使用ng-rating-bar在您的…</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">www.npmjs.com</p></div></div><div class="od l"><div class="oe l of og oh od oi kt nu"/></div></div></a></div><p id="0fb9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><strong class="jm io"> Github库:</strong></p><div class="nr ns gp gr nt nu"><a href="https://github.com/armenstepanyan/ng-rating-bar" rel="noopener  ugc nofollow" target="_blank"><div class="nv ab fo"><div class="nw ab nx cl cj ny"><h2 class="bd io gy z fp nz fr fs oa fu fw im bi translated">GitHub-armenstepanyan/ng-rating-bar</h2><div class="ob l"><h3 class="bd b gy z fp nz fr fs oa fu fw dk translated">在GitHub上创建一个帐户，为armenstepanyan/ng-rating-bar的发展做出贡献。</h3></div><div class="oc l"><p class="bd b dl z fp nz fr fs oa fu fw dk translated">github.com</p></div></div><div class="od l"><div class="oj l of og oh od oi kt nu"/></div></div></a></div></div><div class="ab cl ok ol hr om" role="separator"><span class="on bw bk oo op oq"/><span class="on bw bk oo op oq"/><span class="on bw bk oo op"/></div><div class="ig ih ii ij ik"><p id="c6c1" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="mw">更多内容看</em> <a class="ae ki" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io"> <em class="mw">说白了就是</em> </strong> </a> <em class="mw">。报名参加我们的</em> <a class="ae ki" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io"> <em class="mw">免费每周简讯</em> </strong> </a> <em class="mw">。关注我们</em> <a class="ae ki" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io"> <em class="mw">推特</em> </strong> </a>，<a class="ae ki" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="jm io"><em class="mw">LinkedIn</em></strong></a><em class="mw">，</em><a class="ae ki" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"><strong class="jm io"><em class="mw">YouTube</em></strong></a><em class="mw">，</em> <a class="ae ki" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io"> <em class="mw">不和</em> </strong> </a> <em class="mw">。</em></p></div></div>    
</body>
</html>