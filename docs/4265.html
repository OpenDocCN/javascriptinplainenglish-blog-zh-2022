<html>
<head>
<title>How to Populate HTML Dynamically with Data from An API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用来自API的数据动态填充HTML</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-populate-html-dynamically-with-data-from-an-api-1a99be8a97c7?source=collection_archive---------6-----------------------#2022-11-15">https://javascript.plainenglish.io/how-to-populate-html-dynamically-with-data-from-an-api-1a99be8a97c7?source=collection_archive---------6-----------------------#2022-11-15</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="3416" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">我如何使用一个简单的API为哈利波特人物创建卡片</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/375e24b121ee7c639141625ac28e8b37.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ta7HFQJkK9mKhjg83zrnTQ.png"/></div></div></figure><p id="739b" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi lk translated">作为一名web开发人员(通常也是一名软件开发人员)，学习如何使用应用程序编程接口(API)是非常重要的。简单解释一下，API是一个数据集合，您可以通过使用JavaScript中的<code class="fe lt lu lv lw b">fetch()</code>方法来访问它。不是所有的数据都存储在本地，而是存储在另一台服务器上的某个地方&amp;你可以在需要时访问全部或部分数据。您需要在特定时间在网站或应用程序的特定部分显示这些数据&amp;。</p><p id="248b" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在我在这里写的例子中，我将向你展示我是如何从一个包含哈利波特角色信息的API中获取数据，以及如何在页面上显示这些数据的。我不知道的是，检索API数据并显示它实际上是项目中最容易的部分之一，但是如果我想写这个的话，那就另当别论了。废话少说，我们开始吧。</p></div><div class="ab cl lx ly hr lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ig ih ii ij ik"><h1 id="904c" class="me mf in bd mg mh mi mj mk ml mm mn mo jt mp ju mq jw mr jx ms jz mt ka mu mv bi translated">获取API数据</h1><p id="7c3a" class="pw-post-body-paragraph ko kp in kq b kr mw jo kt ku mx jr kw kx my kz la lb mz ld le lf na lh li lj ig bi translated">首先，让我们将HTML文档的一部分(<code class="fe lt lu lv lw b">chars-container</code>)分配给一个变量，这个变量最终将由我们从API获取的字符信息填充:</p><pre class="kd ke kf kg gt nb lw nc bn nd ne bi"><span id="6e97" class="nf mf in lw b be ng nh l ni nj">const charsSection = document.getElementById('chars-container');</span></pre><p id="f72f" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">然后，让我们将API的URL赋给一个变量(当我们获取API数据时，使代码更加整洁)&amp;创建一个异步函数，因为我们需要等待从API中检索数据):</p><pre class="kd ke kf kg gt nb lw nc bn nd ne bi"><span id="9241" class="nf mf in lw b be ng nh l ni nj">// Assign API URL to variable:<br/>const charsURL = 'https://hp-api.herokuapp.com/api/characters';<br/><br/>// Function to return array of filtered character data objects from API:<br/>async function getChars() {<br/>    // Fetch API data:<br/>    const response = await fetch(charsURL);<br/><br/>    // Convert API data to JSON:<br/>    const allCharsArr = await response.json();<br/>    <br/>    // Push into iterable array, newCharsArr, all characters that are human &amp; contain an image URL:<br/>    let newCharsArr = [];<br/>    for (let i = 0; i &lt; allCharsArr.length; i++) {<br/>        if (allCharsArr[i].species === 'human' &amp;&amp; allCharsArr[i].image.length &gt; 0) {<br/>            newCharsArr.push(allCharsArr[i]);<br/>        }<br/>    }<br/>    return newCharsArr;<br/>}</span></pre><p id="d308" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">只要对象的<code class="fe lt lu lv lw b">.image</code>属性长度大于0(API中所有非空的<code class="fe lt lu lv lw b">.image</code>属性都包含一个有效的图像URL) &amp;，这个函数<code class="fe lt lu lv lw b">getChars() </code>获取API数据，将数据转换为JavaScript对象符号(JSON)，然后将每个数据对象推入一个新的可迭代数组<code class="fe lt lu lv lw b">newCharsArr</code>。</p><p id="0d08" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">您可能出于几个原因想要过滤API数据，其中一个原因可能是API不完整，就像这里的情况一样。如果您知道如何用循环、条件语句等操作JS对象中的数据，通常就可以解决这个问题。，只要它满足您的项目需求，或者直到API完成。在这种情况下，并不是API中的每个字符数据对象都包含图像，这对项目来说是必要的，所以我过滤掉了不包含图像的数据对象。</p><p id="693f" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">因此，上面的<code class="fe lt lu lv lw b">getChars()</code>函数从API返回一个包含数据对象的iterable数组，该数据对象的<code class="fe lt lu lv lw b">.species</code>属性是‘human’&amp;，其<code class="fe lt lu lv lw b">.image</code>属性长度大于0。</p><h1 id="1877" class="me mf in bd mg mh nk mj mk ml nl mn mo jt nm ju mq jw nn jx ms jz no ka mu mv bi translated">用检索到的API数据填充页面</h1><pre class="kd ke kf kg gt nb lw nc bn nd ne bi"><span id="f10c" class="nf mf in lw b be ng nh l ni nj">async function buildPage() {<br/>    const newCharsArr = await getChars();<br/>    // Populate character cards' HTML:<br/>    for (let i = 0; i &lt; newCharsArr.length; i++) {<br/>        // Populate homepage (make cards visible by default)<br/>        charsSection.innerHTML += <br/>            "&lt;div class='char-card' data-name='" + newCharsArr[i].name.toLowerCase().replace(/\s/g, '-') + "' data-house='"<br/>            + newCharsArr[i].house.toLowerCase().replace(/\s/g, '-') + "'&gt;" <br/>                + "&lt;div class='char-img-container'&gt;"<br/>                + "&lt;button class='favs-btn' title='Add to Favorites'&gt;&lt;i class='far fa-heart'&gt;&lt;/i&gt;&lt;/button&gt;"<br/>                + "&lt;img src='" + newCharsArr[i].image + "'&gt;"<br/>                + "&lt;/div&gt;"<br/>                + "&lt;header class='char-header'&gt;" + newCharsArr[i].name + "&lt;/header&gt;"<br/>                + "&lt;p&gt;&lt;span&gt;Ancestry: &lt;/span&gt;" + newCharsArr[i].ancestry + "&lt;/p&gt;"<br/>                + "&lt;p id='house-homepage'&gt;&lt;span&gt;House: &lt;/span&gt;" + newCharsArr[i].house + "&lt;/p&gt;"<br/>                + "&lt;p&gt;&lt;span&gt;Actor/Actress: &lt;/span&gt;" + newCharsArr[i].actor + "&lt;/p&gt;"<br/>            + "&lt;/div&gt;"<br/>    }<br/>}</span></pre><p id="4d19" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">还记得我们一开始声明的<code class="fe lt lu lv lw b">charsSection</code>变量吗？上面的函数<code class="fe lt lu lv lw b">buildPage()</code>，用我们用<code class="fe lt lu lv lw b">getChars()</code>函数检索的过滤后的数据对象填充它。由于<code class="fe lt lu lv lw b">getChars()</code>是异步的&amp;必须等待从API中检索数据，<code class="fe lt lu lv lw b">buildPage()</code>也必须是异步的&amp;等待<code class="fe lt lu lv lw b">getChars()</code>的调用，然后才能填充<code class="fe lt lu lv lw b">charsSection</code>的innerHTML。</p><p id="8c1c" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在上面的<code class="fe lt lu lv lw b">buildPage()</code>中，我将过滤后的数据对象的可迭代数组赋给了<code class="fe lt lu lv lw b">newCharsArr</code>。对于<code class="fe lt lu lv lw b">newCharsArr</code>中的每一个物品，我们都会动态地创建一张卡片，包含关于该物品所代表的角色的选择信息(角色的形象、名字、血统、霍格沃茨魔法学校、&amp;男演员/女演员)。</p></div><div class="ab cl lx ly hr lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ig ih ii ij ik"><p id="14db" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">这是在提取、过滤了角色的信息，并用它填充了页面后，该页面的摘录。我没有包括任何关于样式的信息，但是如果你想看我的整个项目的代码，可以在文章末尾看到它的GitHub库的链接。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi np"><img src="../Images/678fcdb040472385be8cbd40207e8229.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G-xZ6k9T7fSXUXHBjzg5vQ.png"/></div></div></figure></div><div class="ab cl lx ly hr lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ig ih ii ij ik"><p id="af05" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">这就是如何用从API获取的信息动态填充网页的简单例子。如果你有任何意见或问题，我很乐意回答。如果你觉得这篇文章有帮助，我会很感激一个好的评论或一两个掌声，这样我就可以知道我的读者喜欢什么内容。如果你认为其他人会发现这很有用，请与他们分享。</p><p id="ad99" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">感谢阅读！</p></div><div class="ab cl lx ly hr lz" role="separator"><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc md"/><span class="ma bw bk mb mc"/></div><div class="ig ih ii ij ik"><h2 id="d274" class="nq mf in bd mg nr ns dn mk nt nu dp mo kx nv nw mq lb nx ny ms lf nz oa mu ob bi translated">有用的链接</h2><p id="c1fe" class="pw-post-body-paragraph ko kp in kq b kr mw jo kt ku mx jr kw kx my kz la lb mz ld le lf na lh li lj ig bi translated">该项目的GitHub库:<a class="ae oc" href="https://github.com/EGROENE/api-project" rel="noopener ugc nofollow" target="_blank">https://github.com/EGROENE/api-project</a></p><p id="d8fe" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">MDN Web Docs简介':<a class="ae oc" href="https://developer.mozilla.org/en-US/docs/Learn/JavaScript/Client-side_web_APIs/Introduction" rel="noopener ugc nofollow" target="_blank">https://developer . Mozilla . org/en-US/Docs/Learn/JavaScript/Client-side _ Web _ API/简介</a></p><p id="ed38" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><em class="od">更多内容请看</em><a class="ae oc" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kq io"><em class="od">plain English . io</em></strong></a><em class="od">。报名参加我们的</em> <a class="ae oc" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io"> <em class="od">免费周报</em> </strong> </a> <em class="od">。关注我们关于</em><a class="ae oc" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="kq io"><em class="od">Twitter</em></strong></a><a class="ae oc" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kq io"><em class="od">LinkedIn</em></strong></a><em class="od"/><a class="ae oc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"><strong class="kq io"><em class="od">YouTube</em></strong></a><em class="od"/><a class="ae oc" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"><strong class="kq io"><em class="od">不和</em> </strong> </a> <em class="od">。对增长黑客感兴趣？检查</em> <a class="ae oc" href="https://circuit.ooo/" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io"> <em class="od">电路</em> </strong> </a> <em class="od">。</em></p></div></div>    
</body>
</html>