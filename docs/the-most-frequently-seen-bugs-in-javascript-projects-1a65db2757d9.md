# JavaScript 项目中最常见的错误

> 原文：<https://javascript.plainenglish.io/the-most-frequently-seen-bugs-in-javascript-projects-1a65db2757d9?source=collection_archive---------6----------------------->

## 我有机会观察到。

![](img/0f0f6986d668feb987750d819179c63d.png)

Photo by [Elisa Ventur](https://unsplash.com/@elisa_ventur?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral)

我想今天我会分享我有机会观察到的 JS 项目中最常见的 5 个高度主观的错误。我通常在前端看到这些，但我也在 JS 后端看到这些。无论如何，这些技巧，经过适当的修改，将适用于许多其他编程语言。

让我们开始吧。

# **1。将秘密扔进仓库**

我看到的最常见的错误之一是将所有非公开信息上传到 Git 存储库中。存储不公开不是坏事，公开了就是自讨苦吃。

## 为什么？

API 访问令牌之类的东西应该与密码同等对待。相反，我们不希望任何未经授权的人代表我们在 API 上做事情，特别是如果它是我们 Firebase 应用程序的基础。

此外，一些令牌可能会赋予太多权力，例如，在 AWS 上，我们可以生成一个收据，让管理员访问我们云中的所有服务。不用说，如果它落入坏人之手，可能会引起麻烦。

## 如何预防？

最简单的方法是使用环境变量。我们定义一个 Dotenv 文件，在其中保存秘密值，将它们添加到。gitignore，然后通过 process . env .[变量名]引用该值。

要从文件中读取环境变量，我们可以:

*   在前端，使用 Webpack 中的 DotenvPlugin，它将从。env 文件添加到 process.env 对象
*   在后端，使用 dotenv 库，它读取。调用 dotenv.config()后将 env 文件放入 process.env
*   如果项目是从任何项目生成器(例如，Create React App，Nx)创建的，它们通常具有对。环境文件。例如，唯一值得注意的是。env 文件被提交到 CRA 的存储库中，未提交的文件被命名为. env.local。另外，在 CRA 的例子中，我们有一个强制变量命名方案。

# **2。在生产构建中使用 npm / yarn 安装**

还记得开发人员发布了一个损坏的库版本的 colors.js 丑闻吗？还是在 NPM 发现恶意软件的无数丑闻？这个问题可能会影响到我们，但是我们可以把风险降到最低。

首先，我们可以在 package.json 中设置不带通配符的包的特定版本，但即使这样也不能 100%保护我们，因为外部依赖项通常已经有了这些通配符。

**那么我们还能做些什么呢？**

依赖包锁。NPM 和 Yarn 都生成了一个锁文件，其中包含了将包添加到项目中时所下载的库的版本信息。

由于这一点，我们应该确保我们始终安装一个经过验证的库版本。但是，有一个问题 npm 安装和 yarn 安装都不遵守这一点。那么怎么逼呢？

非常简单:

*   在 NPM:高于海平面
*   纱线中:纱线安装—冻结锁文件

这就是我们在生产构建中应该使用它的方式

# **3。JS 应用程序 Dockerfile 中的操作顺序错误**

这有点像 DevOps 的主题，但是值得一提，因为它涉及到 JS 项目。如果你在项目中使用 Docker(这在招聘时总是一大优势)，你应该知道如何避免 Dockerfile 错误。为什么？嗯，这样，不考虑变化:

*   我们总是会用 NPM 重新加载包，这通常很长——Docker 有一个缓存，可以让我们跳过这一步。
*   容器由层组成(Dockerfile 中的每一行，除了少数例外，都是一个新层)。如果具有不同标签的几个容器具有相同的层，则它们不会在集线器上复制，而是被重用。得益于此，我们节省了空间。
*   继续上面的观点-如果我们已经在磁盘上有一个层，它不会被再次下载，所以 docker pull 花费的时间更少。

# **4。不使用 ESLint / Prettiera / editorconfig 等。**

在检查招聘代码时，让我远离存储库的一个原因是存储库的格式一致性没有反应。附加我在标题中提到的任何工具都需要一段时间，感谢它们，我们将保持代码风格的一致性。

关于他们的更多信息:

*   Editorconfig 提供了最基本的功能，如间距大小和行尾类型。另外，你可以将它应用于任何文件格式，所以它是一个通用的工具。与代码编辑器集成，以便在创建代码时自动应用准则。
*   ESLint 是一个工具，它检查我们的代码是否按照我们的规则编写。在将 JS / TS 代码推送到存储库之前，用它检查一下是值得的。
*   另一方面，更漂亮地允许代码被自动格式化成预定的模式。通常，对于室内项目来说，越漂亮越好。你只需要记得运行它。
*   Stylelint 是样式的 ESLint 等价物。它支持许多不同的风格语言(CSS，SCSS，等等)，但它也可以用于，例如，样式组件。
*   hadolint——严格来说它已经不是 JS 了，但是如果你使用 Docker，你应该了解这个工具。它允许您在编写 Dockerfile 文件时发现许多常见错误。

# **5。没有架构约定(或后果)**

这一点尤其适用于用 Express 写的 React 和 backends，但如果有人有能力，在 Angular 和 Nest.js 中也能收支平衡。

在创建任何一个编程项目的时候，你都应该把重点放在把代码分割成更小的部分，并把这些更小的部分合理地安排在项目中。

关于如何最好地在你的框架中共享代码并遵守约定，这是值得一读的。以下是一些极端的错误示例:

*   把所有东西都放在一个文件里。我们有从那里开始的构建过程，把我们都带入一个 JS。
*   将多个组件保存在一个文件中。这对于 Angular 和 Vue 爱好者来说相当熟悉，但是在 React 中，您经常会发现多个组件的文件和容器。
*   保持应用程序的全局状态。我们可以在每个框架中定义一个组件呈现状态是有原因的。从整个应用程序的角度来看，诸如输入的当前值或元素的可见性之类的东西并不重要。我们应该只对许多不同的、独立的组件共享的东西使用全局状态，例如，它可能是来自应用程序工作的 API 的数据。
*   没有架构一致性。如果您正在提取组件的文件夹，请将组件保存在那里。如果你有一个文件夹在州立商店，不要把它放在其他地方。如果你使用样式组件，不要无缘无故地用纯 CSS 编写部分样式。

首先，值得一读的是其他人如何处理项目中的架构问题(React，Express)或者框架强加了什么架构(Angular，Nest.js)。

另一方面，如果你没有发现任何令人满意的东西，那么就去看看它的来源——例如，学习清洁建筑，或者阅读罗伯特·马丁。他写的是一般的代码架构，而不是专注于特定的技术。

我希望上面的列表能帮助你创建更好的项目，避免一些简单的错误。这个清单可能会更长，但这些通常最吸引我的注意力，也可能吸引其他人的注意力。

*更多内容请看*[***plain English . io***](https://plainenglish.io/)*。报名参加我们的* [***免费周报***](http://newsletter.plainenglish.io/) *。关注我们关于*[***Twitter***](https://twitter.com/inPlainEngHQ)[***LinkedIn***](https://www.linkedin.com/company/inplainenglish/)*[***YouTube***](https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw)*[***不和***](https://discord.gg/GtDtUAvyhW) *。***