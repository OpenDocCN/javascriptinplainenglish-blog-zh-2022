<html>
<head>
<title>Why You Shouldnâ€™t Use forEach() with async/await!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä¸ºä»€ä¹ˆä¸åº”è¯¥å°†forEach()ä¸async/awaitä¸€èµ·ä½¿ç”¨ï¼</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://javascript.plainenglish.io/why-you-shouldnt-use-foreach-with-async-await-bece7bdc44b7?source=collection_archive---------8-----------------------#2022-05-18">https://javascript.plainenglish.io/why-you-shouldnt-use-foreach-with-async-await-bece7bdc44b7?source=collection_archive---------8-----------------------#2022-05-18</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="b32e" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">Array.prototype.forEach()å‡½æ•°æ˜¯å¦åªéœ€è¦ä¸€ä¸ªåŒæ­¥å‡½æ•°ï¼Ÿ</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/4031c8c03fe4c1fe419502278549a340.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ko2dH7mit2Iri7414vPWZA.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">The code snippet that triggered the observation!</figcaption></figure><p id="9b7a" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">æŸ¥çœ‹ä¸‹é¢çš„ä»£ç :</p><pre class="kd ke kf kg gt lo lp lq lr aw ls bi"><span id="8ec4" class="lt lu in lp b gy lv lw l lx ly">async function displayScores() {<br/>  const scores = [1, 2, 3, 4, 5];</span><span id="a1eb" class="lt lu in lp b gy lz lw l lx ly">  console.log("Starting to display scores");</span><span id="f9b5" class="lt lu in lp b gy lz lw l lx ly">  scores.forEach((score) =&gt; {<br/>    console.log('The current score is ', score);<br/>  });</span><span id="728e" class="lt lu in lp b gy lz lw l lx ly">  console.log("Finished displaying scores. This should execute last!");<br/>}</span><span id="75c9" class="lt lu in lp b gy lz lw l lx ly">displayScores();</span></pre><p id="3f55" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">è¯¥ä»£ç å°†ç»™å‡ºä»¥ä¸‹è¾“å‡º:</p><pre class="kd ke kf kg gt lo lp lq lr aw ls bi"><span id="e550" class="lt lu in lp b gy lv lw l lx ly">Starting to display scores<br/>The current score is 1<br/>The current score is 2<br/>The current score is 3<br/>The current score is 4<br/>The current score is 5<br/>Finished displaying scores. This should execute last!</span></pre><p id="bf5c" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">ç„¶è€Œï¼Œé€šè¿‡ä½¿ç”¨ä¸€äº›å¼‚æ­¥å‡½æ•°æ¥ä¿®æ”¹ä»£ç :</p><pre class="kd ke kf kg gt lo lp lq lr aw ls bi"><span id="030c" class="lt lu in lp b gy lv lw l lx ly">function myFunction(value) {<br/>  return new Promise((resolve) =&gt; {<br/>    console.log("My extra function is running");<br/>    resolve();<br/>  });<br/>}</span><span id="b06d" class="lt lu in lp b gy lz lw l lx ly">async function displayScores() {<br/>  const scores = [1, 2, 3, 4, 5];<br/>  console.log("Starting to display scores");<br/>  scores.forEach(async (score) =&gt; {<br/>    console.log('Before the async function:');<br/>    await myFunction()<br/>    console.log('The current score is ', score);<br/>  });<br/>  console.log("Finished displaying scores. This should execute last!");<br/>}<br/>displayScores();</span></pre><p id="28f8" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">ä½ åº”è¯¥æœŸæœ›<strong class="ku io">æ˜¾ç¤ºå®Œåˆ†æ•°ã€‚è¿™åº”è¯¥æœ€åæ‰§è¡Œï¼</strong>ä»ç„¶æœ€åæ‰“å°ï¼Œå› ä¸ºforEachæ˜¯åŒæ­¥çš„ã€‚</p><p id="a126" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">å®é™…ä¸Šï¼Œè¿™æ˜¯è¾“å‡ºç»“æœ:ğŸ¤¯</p><pre class="kd ke kf kg gt lo lp lq lr aw ls bi"><span id="0505" class="lt lu in lp b gy lv lw l lx ly">Starting to display scores<br/>Before the async function:<br/>My extra function is running<br/>Before the async function:<br/>My extra function is running<br/>Before the async function:<br/>My extra function is running<br/>Before the async function:<br/>My extra function is running<br/>Before the async function:<br/>My extra function is running<br/>Finished displaying scores. This should execute last!<br/>The current score is  1<br/>The current score is  2<br/>The current score is  3<br/>The current score is  4<br/>The current score is  5</span></pre><p id="fec3" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">å½“è¿™å¯¼è‡´æˆ‘æ­£åœ¨å¼€å‘çš„ä¸€ä¸ªwebåº”ç”¨ç¨‹åºå‡ºç°é”™è¯¯æ—¶ï¼Œæˆ‘å‘ç°äº†è¿™ä¸€ç‚¹ã€‚</p><p id="3136" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">æˆ‘æ„è¯†åˆ°å¯¹forEachä½¿ç”¨async/awaitä¼šå¯¼è‡´æ„æƒ³ä¸åˆ°çš„è¡Œä¸ºã€‚è™½ç„¶awaitå…³é”®å­—ä¼¼ä¹å·²ç»å®Œæˆäº†å®ƒçš„å·¥ä½œï¼Œä½†æ˜¯forEachå¾ªç¯åœ¨è¿›å…¥ä¸‹ä¸€ä¸ªå¾ªç¯æ—¶ä¸ä¼šç­‰å¾…æ‰¿è¯ºã€‚</p><p id="167a" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">æˆ‘å¯¹è¿™ç§æ„å¤–è¡Œä¸ºçš„ç†è§£å¯èƒ½ä¸å¤Ÿæ¸…æ¥šï¼Œè¯·<strong class="ku io">è¯„è®º</strong>æ‚¨å¯¹è¿™ç§è¡Œä¸ºçš„çœ‹æ³•ã€‚</p><p id="1125" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">ä¸ç®¡æ€æ ·ï¼Œæˆ‘å‘ç°è¿™ä¸ªè§£å†³æ–¹æ¡ˆæ˜¯å¯è¡Œçš„ã€‚</p><p id="5801" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">æ±‚åŠ©äºä½¿ç”¨åŸºæœ¬çš„forå¾ªç¯ï¼Œfor(ï¼›ï¼›ï¼›)å’Œforâ€¦of loopå®Œç¾åœ°å·¥ä½œç€ã€‚</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ma"><img src="../Images/a10048e14cd456d217717b07cdebab87.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GNai7c2ay4MP1lHjQTDwbA.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">For of loop worked fine.</figcaption></figure><p id="7d27" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">å¦ä¸€ä¸ªå¯è¡Œçš„è§£å†³æ–¹æ¡ˆæ˜¯å°†Array.mapä¸Promise.all()ä¸€èµ·ä½¿ç”¨ï¼Œå¦‚ä¸‹æ‰€ç¤º:</p><pre class="kd ke kf kg gt lo lp lq lr aw ls bi"><span id="f5e3" class="lt lu in lp b gy lv lw l lx ly">await Promise.all(<br/>    scores.map(async (score) =&gt; {<br/>        console.log('Before the async function:');<br/>        await myFunction()<br/>        console.log('The current score is ', score);<br/>    })<br/>);</span><span id="407b" class="lt lu in lp b gy lz lw l lx ly">// This works perfectly.</span><span id="423c" class="lt lu in lp b gy lz lw l lx ly">OUTPUT:<br/>Starting to display scores<br/>Before the async function:<br/>My extra function is running<br/>Before the async function:<br/>My extra function is running<br/>Before the async function:<br/>My extra function is running<br/>Before the async function:<br/>My extra function is running<br/>Before the async function:<br/>My extra function is running<br/>The current score is  1<br/>The current score is  2<br/>The current score is  3<br/>The current score is  4<br/>The current score is  5<br/>Finished displaying scores. This should execute last!</span></pre><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mb"><img src="../Images/de848b11cf47ac01d103b391c564b91c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VZD9gh1jgpduOffhSUGz0Q.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Surrounding Array.map with Promise.all()</figcaption></figure><p id="6513" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">åœ¨è¯„è®ºåŒºåˆ†äº«ä½ çš„æƒ³æ³•å’Œç»éªŒã€‚</p><p id="f3b4" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">è°¢è°¢ï¼ğŸ‘</p><p id="fb8a" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated"><em class="mc">æ›´å¤šå†…å®¹çœ‹</em> <a class="ae md" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ku io"> <em class="mc">è¯´ç™½äº†å°±æ˜¯</em> </strong> </a> <em class="mc">ã€‚æŠ¥åå‚åŠ æˆ‘ä»¬çš„</em> <a class="ae md" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ku io"> <em class="mc">å…è´¹å‘¨æŠ¥</em> </strong> </a> <em class="mc">ã€‚å…³æ³¨æˆ‘ä»¬å…³äº</em><a class="ae md" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="ku io"><em class="mc">Twitter</em></strong></a><em class="mc">å’Œ</em><a class="ae md" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="ku io"><em class="mc">LinkedIn</em></strong></a><em class="mc">ã€‚æŸ¥çœ‹æˆ‘ä»¬çš„</em> <a class="ae md" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="ku io"> <em class="mc">ç¤¾åŒºä¸å’Œè°</em> </strong> </a> <em class="mc">åŠ å…¥æˆ‘ä»¬çš„</em> <a class="ae md" href="https://inplainenglish.pallet.com/talent/welcome" rel="noopener ugc nofollow" target="_blank"> <strong class="ku io"> <em class="mc">äººæ‰é›†ä½“</em> </strong> </a> <em class="mc">ã€‚</em></p></div></div>    
</body>
</html>