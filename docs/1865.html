<html>
<head>
<title>How to Easily Share Data Between Two Angular Components</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在两个角度组件之间轻松共享数据</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-easily-share-data-between-two-angular-components-b2c8ea93048d?source=collection_archive---------2-----------------------#2022-04-26">https://javascript.plainenglish.io/how-to-easily-share-data-between-two-angular-components-b2c8ea93048d?source=collection_archive---------2-----------------------#2022-04-26</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="1559" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">使用RxJS主题在两个组件之间传递数据</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/336de14f4dfe7be5c3b24705a3ba0f69.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QK7HNkF1AasNLV5pY7oXuQ.jpeg"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@wocintechchat?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Christina @ wocintechchat.com</a> on <a class="ae ks" href="https://unsplash.com/s/photos/hosting?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="5ae3" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">说到角度组件通信，首先想到的是通过@Input() decorator的父子通信和通过@Output() decorator的父子通信。这并不是组件之间传递数据的唯一技术。这里我们将使用RxJS <strong class="kv io"> Subject </strong>在两个组件之间传递数据。我们唯一需要的是一个共享文件。(一些服务文件)。</p><p id="f849" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">并且这两个组件不必一定是父组件和子组件。</p><p id="8500" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">让我们看看我们如何能做它。</p><p id="c8ac" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们有两个组件组件1和组件2。我们的目标是将数据从第一个组件传递到第二个组件。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi lp"><img src="../Images/d7ce7e8a34cdae231416919ce3e2fc9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kNJNJKs9x9YkwdoiMM8w9g.png"/></div></div></figure><p id="5af3" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Component1包含一些编程语言的名称。单击发送数据按钮后，它应该会填充到第二个组件中。</p><h2 id="cb99" class="lq lr in bd ls lt lu dn lv lw lx dp ly lc lz ma mb lg mc md me lk mf mg mh mi bi translated">项目结构</h2><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi mj"><img src="../Images/0f854d73885d8ea38c10e7a9e71adfa9.png" data-original-src="https://miro.medium.com/v2/resize:fit:734/format:webp/1*pk_PSxy8QiSCRrgPtcVg1A.png"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Project Structure</figcaption></figure><p id="efca" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在这个项目中，我们有component1、component2和共享服务文件。</p><p id="cd23" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">共享服务是我们定义为“主题”的文件，以便在两个组件之间传递数据。</p><p id="530b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">让我们进入编码部分。</p><h2 id="2717" class="lq lr in bd ls lt lu dn lv lw lx dp ly lc lz ma mb lg mc md me lk mf mg mh mi bi translated">共享服务文件</h2><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mk ml l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">shared.service.ts</figcaption></figure><h2 id="57cf" class="lq lr in bd ls lt lu dn lv lw lx dp ly lc lz ma mb lg mc md me lk mf mg mh mi bi translated">组件1</h2><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mk ml l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk"><a class="ae ks" href="https://gist.github.com/Kanchana46/bbfdfd38b4c4b27d04b88c95d279e572#file-component1-component-html" rel="noopener ugc nofollow" target="_blank">component1.component.html</a></figcaption></figure><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mk ml l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk"><a class="ae ks" href="https://gist.github.com/Kanchana46/66bf6ae890cdbf072af1fd298656e553#file-component1-component-ts" rel="noopener ugc nofollow" target="_blank">component1.component.ts</a></figcaption></figure><p id="f5d6" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这里我们有一系列的编程语言。一旦点击发送数据按钮，这个数组将通过主题的<strong class="kv io"><em class="mm">【next()</em></strong>方法发出。</p><h2 id="9fc4" class="lq lr in bd ls lt lu dn lv lw lx dp ly lc lz ma mb lg mc md me lk mf mg mh mi bi translated">组件2</h2><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mk ml l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk"><a class="ae ks" href="https://gist.github.com/Kanchana46/ccf6836ebadc9b1cbcdd4a82bdede23a#file-component2-component-html" rel="noopener ugc nofollow" target="_blank">component2.component.html</a></figcaption></figure><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mk ml l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk"><a class="ae ks" href="https://gist.github.com/Kanchana46/abdc1bcbd2f27f510990d4323d60479d#file-component2-component-ts" rel="noopener ugc nofollow" target="_blank">component2.component.ts</a></figcaption></figure><p id="4c5f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在第二个组件中，我们有一个包含<strong class="kv io"> <em class="mm">语言</em> </strong>的空数组。我们要做的是用component1给出的数据填充这个数组。</p><p id="8763" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">因此，我们使用<strong class="kv io"> ngAfterContentInit </strong>生命周期钩子方法来订阅从component1传递的数据。您也可以使用onInit。</p><p id="0e04" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在onDestroy中取消订阅已订阅的观察对象是一个很好的做法。</p><p id="a61d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">就是这样。请注意，您也可以使用EventEmitter代替RxJS Subject。但这不是使用EventEmitter的子到父数据传递。</p><p id="e850" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">那么它应该在共享服务中定义如下。</p><pre class="kd ke kf kg gt mn mo mp mq aw mr bi"><span id="c338" class="lq lr in mo b gy ms mt l mu mv"><strong class="mo io"><em class="mm">@Output() send_data = new EventEmitter&lt;any&gt;()</em></strong></span></pre><p id="51b7" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">并且在component1中我们做<strong class="kv io"> <em class="mm"> emit() </em> </strong>而不是<strong class="kv io"> <em class="mm"> next() </em> </strong>。</p><pre class="kd ke kf kg gt mn mo mp mq aw mr bi"><span id="e04a" class="lq lr in mo b gy ms mt l mu mv"><strong class="mo io"><em class="mm">this.sharedService.send_data.emit(this.languages)</em></strong></span></pre><p id="ee43" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">组件2没有任何变化。</p><p id="7ea1" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">让我们看看它是如何工作的。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi lp"><img src="../Images/ce5754af3e2c17afd29b6fd92932aeb2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*DSIZ4xX2a0SF9dY4sHBHGA.png"/></div></div></figure><p id="0cfb" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">单击发送数据后，数据已被填充到组件2中。我们也可以在控制台中看到数据。</p></div><div class="ab cl mw mx hr my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="ig ih ii ij ik"><p id="aee9" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">当需要将数据从一个组件传递到另一个组件时，这种共享数据的方式非常有用。优点是我们可以应用这两个组件，并且本质上不需要父子关系。</p><p id="45a5" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">它不仅可以用于在两个组件之间传递数据，还可以用于当一个组件中发生某个动作而另一个组件中需要发生某个动作时。</p><p id="5d0e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">你可以在这里找到上面的样本代码<a class="ae ks" href="https://github.com/Kanchana46/angular-share-data.git" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="aebb" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">希望这对您有所帮助。</p><p id="c5b5" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">谢谢大家！</p><p id="bff8" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="mm">更多内容请看</em><a class="ae ks" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="mm">plain English . io</em></strong></a><em class="mm">。报名参加我们的</em> <a class="ae ks" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="mm">免费周报</em> </strong> </a> <em class="mm">。关注我们关于</em><a class="ae ks" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="mm">Twitter</em></strong></a><em class="mm">和</em><a class="ae ks" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="mm">LinkedIn</em></strong></a><em class="mm">。加入我们的</em> <a class="ae ks" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="mm">社区不和谐</em> </strong> </a> <em class="mm">。</em></p></div></div>    
</body>
</html>