<html>
<head>
<title>How to Improve Your Mongoose Model with TypeScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用TypeScript改进你的Mongoose模型</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/improving-mongoose-model-with-typescript-9a349f41c71?source=collection_archive---------0-----------------------#2022-07-31">https://javascript.plainenglish.io/improving-mongoose-model-with-typescript-9a349f41c71?source=collection_archive---------0-----------------------#2022-07-31</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="e971" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">使用TypeScript来改进类型检查，并向您的Mongoose模型添加静态方法。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/d850dbd3461328465ba7e990fb37f40e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*8FeX4OxqNRl2geToaWzIPA.jpeg"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk"><a class="ae ks" href="https://a-z-animals.com/media/2021/11/What-Eats-Snakes-Mongoose.jpg" rel="noopener ugc nofollow" target="_blank"><em class="kt">Source: a-z-animals.com</em></a></figcaption></figure><h1 id="369d" class="ku kv in bd kw kx ky kz la lb lc ld le jt lf ju lg jw lh jx li jz lj ka lk ll bi translated">什么是猫鼬？</h1><p id="686c" class="pw-post-body-paragraph lm ln in lo b lp lq jo lr ls lt jr lu lv lw lx ly lz ma mb mc md me mf mg mh ig bi translated">哈哈的笑..不要混淆。我不会在这里谈论我们照片上的小朋友。有几种方法可以让MongoDB与Node.js应用程序一起工作，其中一种方法是使用一个名为Mongoose的外部库。如果你访问官方猫鼬页面，你会发现:</p><blockquote class="mi"><p id="8970" class="mj mk in bd ml mm mn mo mp mq mr mh dk translated">优雅的<a class="ae ks" href="https://www.mongodb.com/" rel="noopener ugc nofollow" target="_blank"> mongodb </a>对象建模为<a class="ae ks" href="https://nodejs.org/en/" rel="noopener ugc nofollow" target="_blank"> node.js </a></p></blockquote><p id="0783" class="pw-post-body-paragraph lm ln in lo b lp ms jo lr ls mt jr lu lv mu lx ly lz mv mb mc md mw mf mg mh ig bi translated">我得说这是千真万确的。</p><p id="c6c0" class="pw-post-body-paragraph lm ln in lo b lp mx jo lr ls my jr lu lv mz lx ly lz na mb mc md nb mf mg mh ig bi translated">但是总有空间让我们的代码，我们的生活，比以前更好。为了使Mongoose模型更好，我们引入TypeScript。公平的警告，将TypeScript添加到任何现有的项目中可能看起来像是大量的工作。从某些方面来说，这实际上是很大的工作量。但是回报真的很好…</p></div><div class="ab cl nc nd hr ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="ig ih ii ij ik"><h1 id="4ef1" class="ku kv in bd kw kx nj kz la lb nk ld le jt nl ju lg jw nm jx li jz nn ka lk ll bi translated">🛠创建了一个猫鼬模型/模式</h1><p id="a8eb" class="pw-post-body-paragraph lm ln in lo b lp lq jo lr ls lt jr lu lv lw lx ly lz ma mb mc md me mf mg mh ig bi translated">为了让我们的应用程序代码能够与MongoDB通信，我们必须首先创建一个定义，称为模型/模式。我们可以把它看作是我们的数据的蓝图，以及什么样的数据应该被允许给用户。</p><p id="fd38" class="pw-post-body-paragraph lm ln in lo b lp mx jo lr ls my jr lu lv mz lx ly lz na mb mc md nb mf mg mh ig bi translated">使用TypeScript时，创建一个类型或接口是个好主意。用隐式类型定义定义属性真的很有帮助。</p><h1 id="41bf" class="ku kv in bd kw kx ky kz la lb lc ld le jt lf ju lg jw lh jx li jz lj ka lk ll bi translated">💻代码时间</h1><h2 id="2405" class="no kv in bd kw np nq dn la nr ns dp le lv nt nu lg lz nv nw li md nx ny lk nz bi translated">➕只是JavaScript第一</h2><p id="fd8a" class="pw-post-body-paragraph lm ln in lo b lp lq jo lr ls lt jr lu lv lw lx ly lz ma mb mc md me mf mg mh ig bi translated">考虑下面的例子。这里，我们为<code class="fe oa ob oc od b">User</code>创建一个模型，它将注册或登录到我们的应用程序中。用户需要提供他们的<code class="fe oa ob oc od b">firstName</code>、<code class="fe oa ob oc od b">lastName</code>、<code class="fe oa ob oc od b">email</code>和<code class="fe oa ob oc od b">password</code>进行注册，并提供<code class="fe oa ob oc od b">email</code>和<code class="fe oa ob oc od b">password</code>进行登录。很简单，对吧？我们的Mongoose模型看起来会像这样(用普通的JavaScript):</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oe"><img src="../Images/ab2f426b33e2b5477d2d0c8108386275.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4FAq2NkFPKU12QyjAxXeWA.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">User model defined in JavaScript.</figcaption></figure><h2 id="0008" class="no kv in bd kw np nq dn la nr ns dp le lv nt nu lg lz nv nw li md nx ny lk nz bi translated">➕添加类型脚本接口</h2><p id="eef9" class="pw-post-body-paragraph lm ln in lo b lp lq jo lr ls lt jr lu lv lw lx ly lz ma mb mc md me mf mg mh ig bi translated">是时候把打字稿拿来了。让我们定义我们的<code class="fe oa ob oc od b">interface</code>，它将被用来对我们的<code class="fe oa ob oc od b">User</code>模型进行类型检查。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi of"><img src="../Images/4853ca54b050a55cfbc22ab872ff6775.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*m5CLWL8a-GqpKWsUDDl06g.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Interfaces used for User model — IUser, IUserDocument, and IUserModel</figcaption></figure><ol class=""><li id="f6dd" class="og oh in lo b lp mx ls my lv oi lz oj md ok mh ol om on oo bi translated"><code class="fe oa ob oc od b">IUser</code> —定义<code class="fe oa ob oc od b">User</code>的外观、用户对象的属性以及允许的数据类型。</li><li id="e483" class="og oh in lo b lp op ls oq lv or lz os md ot mh ol om on oo bi translated"><code class="fe oa ob oc od b">IUserDocument</code> —定义当我们运行任何类型的查询从MongoDB获取数据时，模式和响应文档结构的外观。IUserDocument扩展了<code class="fe oa ob oc od b">IUser</code>和<code class="fe oa ob oc od b">Document</code>接口，实现了两者的属性。</li><li id="8caa" class="og oh in lo b lp op ls oq lv or lz os md ot mh ol om on oo bi translated"><code class="fe oa ob oc od b">IUserModel</code> —定义最终的<code class="fe oa ob oc od b">User</code>模型将会是什么样子，它将具有什么属性，以及它将包含什么额外的方法(如果有的话)。</li></ol><p id="08eb" class="pw-post-body-paragraph lm ln in lo b lp mx jo lr ls my jr lu lv mz lx ly lz na mb mc md nb mf mg mh ig bi translated">你可能会好奇那个<code class="fe oa ob oc od b">UserSchema.statics.buildUser</code>是什么？通常，我们会做一些类似于<code class="fe oa ob oc od b">let newUser = new User({...properties})</code>的事情来创建一个新用户。这正是在<code class="fe oa ob oc od b">buildUser(args: IUser)</code>方法中发生的事情，作为静态方法附加到<code class="fe oa ob oc od b">UserSchema</code>上。</p><h2 id="c7ea" class="no kv in bd kw np nq dn la nr ns dp le lv nt nu lg lz nv nw li md nx ny lk nz bi translated">🚨代码，集合！</h2><p id="c895" class="pw-post-body-paragraph lm ln in lo b lp lq jo lr ls lt jr lu lv lw lx ly lz ma mb mc md me mf mg mh ig bi translated">现在，我们有了普通的JS代码和TS接口，是时候把它们合二为一了。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ou"><img src="../Images/d47d481b6b34ad6301fa82270c5b13b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w8Eh6vDGqDfeD-k_1sCB0w.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Final User model with TypeScript interfaces added</figcaption></figure><ol class=""><li id="a053" class="og oh in lo b lp mx ls my lv oi lz oj md ok mh ol om on oo bi translated"><code class="fe oa ob oc od b">Schema&lt;IUserDocument&gt;</code> —定义模式结构、预期属性和各自的数据类型。</li><li id="046f" class="og oh in lo b lp op ls oq lv or lz os md ot mh ol om on oo bi translated"><code class="fe oa ob oc od b">buildUser(args: IUser): IUserDocument</code> —静态方法，附加到模型上，只是另一种创建新用户的方式，而不是使用<code class="fe oa ob oc od b">new User({...data})</code>。</li><li id="59b7" class="og oh in lo b lp op ls oq lv or lz os md ot mh ol om on oo bi translated">最后，<code class="fe oa ob oc od b">User</code>是一个Mongoose模型，它返回一个类型为<code class="fe oa ob oc od b">IUserDocument</code>的文档，并且具有在<code class="fe oa ob oc od b">IUserModel</code>中定义的方法和属性。</li></ol></div><div class="ab cl nc nd hr ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="ig ih ii ij ik"><p id="abfc" class="pw-post-body-paragraph lm ln in lo b lp mx jo lr ls my jr lu lv mz lx ly lz na mb mc md nb mf mg mh ig bi translated">我们有了！用接口定义的更安全的<code class="fe oa ob oc od b">User</code>模型。如果在创建新用户时传递了错误的数据类型，TypeScript编译器会立即对我们大喊，并抛出错误。</p><p id="3f54" class="pw-post-body-paragraph lm ln in lo b lp mx jo lr ls my jr lu lv mz lx ly lz na mb mc md nb mf mg mh ig bi translated"><a class="ae ks" href="https://mongoosejs.com" rel="noopener ugc nofollow" target="_blank">在猫鼬官方网站上阅读更多关于猫鼬的信息</a>。永远记住，没有比官方文件更好的了。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ov"><img src="../Images/9b6d7a4ccecc484e3bd292ef6ab530ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4P9s7EOCDI6OOJnXsYr-3A.jpeg"/></div></div></figure><p id="28cb" class="pw-post-body-paragraph lm ln in lo b lp mx jo lr ls my jr lu lv mz lx ly lz na mb mc md nb mf mg mh ig bi translated">感谢阅读🙏</p><p id="d8b9" class="pw-post-body-paragraph lm ln in lo b lp mx jo lr ls my jr lu lv mz lx ly lz na mb mc md nb mf mg mh ig bi translated">如果您喜欢这篇文章，请务必查看我的其他文章，其中我谈到了React和Node.js。</p><p id="b953" class="pw-post-body-paragraph lm ln in lo b lp mx jo lr ls my jr lu lv mz lx ly lz na mb mc md nb mf mg mh ig bi translated">🚀结束！</p><p id="7f74" class="pw-post-body-paragraph lm ln in lo b lp mx jo lr ls my jr lu lv mz lx ly lz na mb mc md nb mf mg mh ig bi translated"><em class="ow">更多内容请看</em><a class="ae ks" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="lo io"><em class="ow">plain English . io</em></strong></a><em class="ow">。报名参加我们的</em> <a class="ae ks" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="lo io"> <em class="ow">免费周报</em> </strong> </a> <em class="ow">。关注我们关于</em><a class="ae ks" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="lo io"><em class="ow">Twitter</em></strong></a><em class="ow">和</em><a class="ae ks" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="lo io"><em class="ow">LinkedIn</em></strong></a><em class="ow">。查看我们的</em> <a class="ae ks" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="lo io"> <em class="ow">社区不和谐</em> </strong> </a> <em class="ow">加入我们的</em> <a class="ae ks" href="https://inplainenglish.pallet.com/talent/welcome" rel="noopener ugc nofollow" target="_blank"> <strong class="lo io"> <em class="ow">人才集体</em> </strong> </a> <em class="ow">。</em></p></div></div>    
</body>
</html>