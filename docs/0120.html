<html>
<head>
<title>What You Need to Know about the Inversion of Control (for React)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">关于控制反转你需要知道什么(对于React)</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/what-you-need-to-know-about-the-inversion-of-control-for-react-278c0f4dcd18?source=collection_archive---------2-----------------------#2022-01-08">https://javascript.plainenglish.io/what-you-need-to-know-about-the-inversion-of-control-for-react-278c0f4dcd18?source=collection_archive---------2-----------------------#2022-01-08</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="6197" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">逆控制原理在反应工程中的应用</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/a11f9d1dabc72014980ecf29d69149b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NpienXPre-h19GMnjPksDw.jpeg"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Image by <a class="ae ks" href="https://unsplash.com/@martinsanchez" rel="noopener ugc nofollow" target="_blank">Martin Sanchez</a> on <a class="ae ks" href="https://unsplash.com/photos/SL1co_Etck8" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h2 id="430f" class="kt ku in bd kv kw kx dn ky kz la dp lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated"><strong class="ak">TL；博士</strong></h2><p id="f33b" class="pw-post-body-paragraph lp lq in lr b ls lt jo lu lv lw jr lx lc ly lz ma lg mb mc md lk me mf mg mh ig bi translated">当我在<a class="ae ks" href="https://en.wikipedia.org/wiki/Inversion_of_control" rel="noopener ugc nofollow" target="_blank">维基百科</a>上打开“控制反转”原理的解释时，我愣住了——它的描述如此复杂，不是人类可读的方式……在这篇文章中，你会找到一个关于“控制反转”原理的问题定义及其解决方案，希望这比维基百科的内容更容易理解。</p><p id="f2a2" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">简而言之，“控制反转”(IoC)原则是为某个模块构建API的一种方式，它允许在没有大量输入参数的情况下灵活定制该模块，例如:</p><ul class=""><li id="8e37" class="mn mo in lr b ls mi lv mj lc mp lg mq lk mr mh ms mt mu mv bi translated">标志(例如，“visibleIcon”、“disabledSubSecionSubmitButton”等)</li><li id="5b7b" class="mn mo in lr b ls mw lv mx lc my lg mz lk na mh ms mt mu mv bi translated">类型(例如，<code class="fe nb nc nd ne b">iconType="primary"</code>、<code class="fe nb nc nd ne b">subSectionSubmitButonType="secondary"</code>)</li></ul><p id="b396" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">这是没有实现IoC的React组件的常规用法:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nf ng l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Gist 1. Section w/o IoC</figcaption></figure><p id="e116" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">这就是我们如何使用这个遵循IoC原则并实现适当API的“部分”组件:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nf ng l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Gist 2. Section with IoC</figcaption></figure></div><div class="ab cl nh ni hr nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="ig ih ii ij ik"><p id="2105" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">假设您正在使用React构建一个大型应用程序。有一天，业务部门要求您为dropdown UI元素开发一个通用的解决方案——“drop down”React组件。我假设它可能看起来像下面这样(图片。1).</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi no"><img src="../Images/adfb7e8f5d985c74a55601fe3a8dc2ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:506/format:webp/1*-PyV1-owDwyXKw9phJmtIA.png"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Pic. 1. Dropdown v1 (<a class="ae ks" href="https://www.carbondesignsystem.com/components/dropdown/usage/" rel="noopener ugc nofollow" target="_blank">source</a>)</figcaption></figure><p id="4b99" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">你可能认为现在它看起来相当不错，绝对应该为你的工作感到骄傲！</p><p id="6fd8" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">随着时间的推移，这个“Dropdown”组件已经被许多开发人员在数百个地方使用。该组件按预期工作，并且在整个应用程序中看起来一致——这是在一个系统中使用共享组件的好处。它强制团队使用相同的技术方法，并产生一致的设计。</p><p id="37f5" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">下面是这个组件的代码。我不打算深入研究实现细节——只指定了与主题相关的主要部分。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nf ng l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Gist 3. Dropdown implementation w/o IoC</figcaption></figure><p id="885a" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">再一次。这是一个很好的解决方案。但是，不幸的是，不可扩展。</p><p id="3127" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">这是用法示例。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nf ng l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Gist 4. Dropdown usage w/o IoC</figcaption></figure><h2 id="0a56" class="kt ku in bd kv kw kx dn ky kz la dp lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">扩展性问题</h2><p id="8742" class="pw-post-body-paragraph lp lq in lr b ls lt jo lu lv lw jr lx lc ly lz ma lg mb mc md lk me mf mg mh ig bi translated">这款应用正在成长。对设计有了新的要求:下拉菜单在不同的地方应该有不同的视图形式。这意味着您需要允许将定制应用于“下拉”React组件。</p><p id="6e24" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">例如，需要向下拉选项添加两个UI元素:</p><ul class=""><li id="154c" class="mn mo in lr b ls mi lv mj lc mp lg mq lk mr mh ms mt mu mv bi translated">选项标题前面的图标</li><li id="bcac" class="mn mo in lr b ls mw lv mx lc my lg mz lk na mh ms mt mu mv bi translated">选项标题后的文本符号</li></ul><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi np"><img src="../Images/28b16fe34e2e9fca0d06c76254bc9a32.png" data-original-src="https://miro.medium.com/v2/resize:fit:504/format:webp/1*dXoKj1_cg71fkXKujSfSmg.png"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Pic. 2. Dropdown v2 (<a class="ae ks" href="https://www.carbondesignsystem.com/components/dropdown/usage" rel="noopener ugc nofollow" target="_blank">source</a>)</figcaption></figure><p id="7123" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">见图。1.请不要因为这张不漂亮的照片责怪我。我的目标是更多地开发有用的内容，所以现在，我宁愿忽略这些细节。希望你能理解。</p><p id="0906" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">我们可以遵循一种简单的方法来开发初始解决方案。这个解决方案假设添加控制这些新UI元素的道具——这是一个相当流行的解决方案。但不是很好，我们稍后会看到。</p><p id="3cef" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">让我们试试。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nf ng l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Gist 5. Complex dropdown implementation w/o IoC</figcaption></figure><p id="97de" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">这是用法示例。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nf ng l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Gist 6. Complex dropdown usage w/o IoC</figcaption></figure><p id="e701" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">看起来没那么糟。开发者可以使用“道具”来控制视图。但正如我已经提到的，这不是一个理想的解决方案。想象一下这个组件的未来增长——当一个组件有大量的道具控制UI元素时，这将是地狱。它还需要保持所有相关逻辑的同步。只要相信我，在前端开发人员的职业生涯中，支持这样的组件并不是一件更好的事情。😀</p><p id="7bf9" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">让我们返工这个组件！</p><h2 id="2199" class="kt ku in bd kv kw kx dn ky kz la dp lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">控制反转</h2><p id="b3f0" class="pw-post-body-paragraph lp lq in lr b ls lt jo lu lv lw jr lx lc ly lz ma lg mb mc md lk me mf mg mh ig bi translated">我们可以遵循几种模式来实现React组件的控制反转:</p><ul class=""><li id="bf07" class="mn mo in lr b ls mi lv mj lc mp lg mq lk mr mh ms mt mu mv bi translated"><a class="ae ks" href="https://reactjs.org/docs/render-props.html#gatsby-focus-wrapper" rel="noopener ugc nofollow" target="_blank">渲染道具</a></li><li id="c455" class="mn mo in lr b ls mw lv mx lc my lg mz lk na mh ms mt mu mv bi translated"><a class="ae ks" href="https://en.reactjs.org/docs/composition-vs-inheritance.html" rel="noopener ugc nofollow" target="_blank">反应过来的孩子</a></li></ul><p id="8319" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">这两种方法都不错。它们中的每一个都可能在不同的情况下有用。两者我都用，但在大多数情况下，我更喜欢第二种选择。我将倾向于这种方法并详细描述它。我相信“渲染道具”的方法对你来说很容易理解，如果你理解“儿童”的方法的话。还有，有很多关于“渲染道具”的很酷的文章，我不想重复。</p><p id="dd78" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">这些模式与本文中的<a class="ae ks" href="https://medium.com/unibuddy-technology-blog/compound-components-in-react-b04772f9eb58" rel="noopener">【复合组件】</a>模式紧密相连。对于开发<a class="ae ks" href="https://medium.com/clarityhub/low-coupling-high-cohesion-3610e35ac4a6" rel="noopener">内聚</a>组件来说，这是一件很有用的事情。有关更多详细信息，请参见提供的文章。</p><p id="1ecc" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">“children”方法的思想假设使用“children”属性(Capitan Obvious)和从可定制组件的根重新导出的公共组件。</p><p id="4451" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">这是根组件——“下拉菜单”。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nf ng l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Gist 7. Complex dropdown implementation with IoC</figcaption></figure><p id="fa84" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">然后我们需要开发代表自定义UI元素的组件——“选项”、“选项”。标题“，”选项。图标”和”选项。签字”。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nf ng l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Gist 8. Dropdown element — Option</figcaption></figure><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nf ng l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Gist 9. Dropdown element — Option.Title</figcaption></figure><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nf ng l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Gist 10. Dropdown element — Option.Icon</figcaption></figure><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nf ng l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Gist 11. Dropdown element — Option.Sign</figcaption></figure><p id="e9fc" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">现在我们需要将所有这些部分组装成一个实体。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nf ng l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Gist 12. Dropdown — assemble elements</figcaption></figure><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nf ng l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Gist 13. Dropdown option — assemble elements</figcaption></figure><p id="4c67" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">现在，让我们来看一下使用示例。这与第一个例子非常不同。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nf ng l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Gist 14. Complex dropdown with IoC — usage example</figcaption></figure><p id="29dd" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">看起来不错！是吗？</p><p id="e180" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">你可能认为有许多小块可以合并成一个实体。但这是不对的:我们需要这些小部件来提供扩展性和使用便利性的所有条件。</p><p id="1cc7" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">现在真的可以扩展了。让我提供一个添加新UI元素选项—“按钮”的例子。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nf ng l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Gist 15. Dropdown element — Option.Button</figcaption></figure><p id="581e" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">现在我们需要将这个新的“按钮”连接到“选项”上。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nf ng l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Gist 16. Dropdown option — assemble elements (with Button)</figcaption></figure><p id="a614" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">最后是使用示例。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nf ng l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Gist 17. Complex dropdown with IoC — usage example (with Button)</figcaption></figure></div><div class="ab cl nh ni hr nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="ig ih ii ij ik"><p id="3ec1" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">我可以继续这个话题。但不确定这是否有意义。我建议您停止阅读，打开您的代码编辑器，尝试建议的解决方案。这是学习最佳实践的最佳方法。</p><p id="4469" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">你也可以谷歌一下，找到很多与这个话题相关的有用资源。我喜欢<a class="nq nr ep" href="https://medium.com/u/db72389e89d8?source=post_page-----278c0f4dcd18--------------------------------" rel="noopener" target="_blank">肯特·c·多兹</a>的这篇<a class="ae ks" href="https://kentcdodds.com/blog/inversion-of-control" rel="noopener ugc nofollow" target="_blank">“控制反转”</a>的文章。</p><p id="3900" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">如果有任何问题，请随时与我联系。</p><p id="7a2f" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">祝你好运！</p><p id="dbfb" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated"><em class="ns">更多内容看</em> <a class="ae ks" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <em class="ns">说白了。报名参加我们的</em> </a><a class="ae ks" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <em class="ns">免费周报</em> </a> <em class="ns">。在我们的</em> <a class="ae ks" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <em class="ns">社区</em> </a> <em class="ns">获得独家写作机会和建议。</em></p></div></div>    
</body>
</html>