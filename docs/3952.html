<html>
<head>
<title>TypeScript — Ok I'll Try It. But Am I Happy About It?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">打字稿——好吧，我试试。但是我对此感到高兴吗？</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/typescript-ok-ill-try-it-am-i-happy-about-it-902c549beab8?source=collection_archive---------12-----------------------#2022-10-12">https://javascript.plainenglish.io/typescript-ok-ill-try-it-am-i-happy-about-it-902c549beab8?source=collection_archive---------12-----------------------#2022-10-12</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="1733" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">TypeScript现在已经10岁了。所以让我试着把我们的“旧”脚本转换成打字稿。我将在下面描述我对此的复杂感受。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/8137ed97d43fde49efd9126632d14394.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aHSbgyAdyK2wCRiPdCE0dQ.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Typescript</figcaption></figure><p id="e1f1" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">首先，这里的上下文不是“你应该或不应该使用Typescript”</p><h2 id="51f9" class="lo lp in bd lq lr ls dn lt lu lv dp lw lb lx ly lz lf ma mb mc lj md me mf mg bi translated">项目的背景</h2><p id="a756" class="pw-post-body-paragraph ks kt in ku b kv mh jo kx ky mi jr la lb mj ld le lf mk lh li lj ml ll lm ln ig bi translated">我试图把这个项目变成一个Typescript项目，它是一个在我们的合作伙伴网站上作为第三方脚本实现的脚本。这意味着它应该可以在许多浏览器、设备和环境中执行。因为它必须在浏览器中运行，所以运行时错误会时有发生。<br/>因此，使用Typescript“重写”的主要动机是避免运行时错误，并使重构和添加新功能更容易。</p><p id="fbe8" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">有了上面的语境，再来看看我发现了什么。</p><ol class=""><li id="14a8" class="mm mn in ku b kv kw ky kz lb mo lf mp lj mq ln mr ms mt mu bi translated"><strong class="ku io">你得到了打字检查！</strong></li><li id="dd42" class="mm mn in ku b kv mv ky mw lb mx lf my lj mz ln mr ms mt mu bi translated"><strong class="ku io">可以循序渐进！</strong></li><li id="6fed" class="mm mn in ku b kv mv ky mw lb mx lf my lj mz ln mr ms mt mu bi translated"><strong class="ku io">注意安全</strong></li><li id="78ee" class="mm mn in ku b kv mv ky mw lb mx lf my lj mz ln mr ms mt mu bi translated"><strong class="ku io">可读性变差，然后变好</strong></li><li id="b472" class="mm mn in ku b kv mv ky mw lb mx lf my lj mz ln mr ms mt mu bi translated"><strong class="ku io">你失去了速度——然后你获得了一些速度</strong></li><li id="3cb0" class="mm mn in ku b kv mv ky mw lb mx lf my lj mz ln mr ms mt mu bi translated"><strong class="ku io">你的重构游戏变强了</strong></li><li id="c4a9" class="mm mn in ku b kv mv ky mw lb mx lf my lj mz ln mr ms mt mu bi translated"><strong class="ku io">你得到了一些免费的文档</strong></li><li id="e955" class="mm mn in ku b kv mv ky mw lb mx lf my lj mz ln mr ms mt mu bi translated"><strong class="ku io">对项目来说是最好的事情吗？</strong></li></ol><h2 id="eae8" class="lo lp in bd lq lr ls dn lt lu lv dp lw lb lx ly lz lf ma mb mc lj md me mf mg bi translated">你得到了类型检查！</h2><p id="1464" class="pw-post-body-paragraph ks kt in ku b kv mh jo kx ky mi jr la lb mj ld le lf mk lh li lj ml ll lm ln ig bi translated">这应该是显而易见的，但它的流行是有原因的。甚至在实现typescript的开始，系统就发现了类型错误。所以对于代码的正确性来说，Typescript是绝对的赢家。毫无疑问，类型检查将使代码更加健壮，并捕获一些错误，否则这些错误将会在产品中终止。也就是说，适当的测试可以做很多相同的事情。这是我们的脚本中捕获的第一个运行时错误的一个小片段。</p><blockquote class="na nb nc"><p id="ff45" class="ks kt nd ku b kv kw jo kx ky kz jr la ne lc ld le nf lg lh li ng lk ll lm ln ig bi translated"><em class="in">打字稿前:</em></p></blockquote><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nh"><img src="../Images/ae3f8fc336ed640998ceb2e2456056e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GHxe0LX52wz3X-acfVpy-A.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Normal javascript</figcaption></figure><p id="0b15" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">该函数的基本思想是，如果我们正在使用移动设置，则基于数组中的一些值返回。虽然上面的代码像预期的那样工作并通过了我们的测试，但事实证明它并不完全正确。</p><p id="1f7a" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">棘手的是，根据<code class="fe nj nk nl nm b">String.includes </code>的<a class="ae ni" href="https://tc39.es/ecma262/multipage/text-processing.html#sec-string.prototype.includes" rel="noopener ugc nofollow" target="_blank">规范</a>,<code class="fe nj nk nl nm b">String.includes</code>的第一个输入参数是字符串类型。在上面的代码中，我实际上是将它解析为一个数组。它工作的原因是该方法自动将输入转换为字符串。在这种情况下，这并没有什么不同，但一般来说，用错误的参数类型调用函数是个坏主意。所以当把文件结尾改成<code class="fe nj nk nl nm b">.ts</code>的时候，Typescript捕捉到了这一点，这是错误的，我可以把函数改成下面这样。</p><blockquote class="na nb nc"><p id="2c33" class="ks kt nd ku b kv kw jo kx ky kz jr la ne lc ld le nf lg lh li ng lk ll lm ln ig bi translated"><em class="in">带打字稿:</em></p></blockquote><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nn"><img src="../Images/d6bd0251f04b6c945b08ae3dfa261af0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rD-j108tw4iuFh1JbTmBPQ.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Typescript version</figcaption></figure><h2 id="6df3" class="lo lp in bd lq lr ls dn lt lu lv dp lw lb lx ly lz lf ma mb mc lj md me mf mg bi translated"><strong class="ak">可以循序渐进！</strong></h2><p id="2f15" class="pw-post-body-paragraph ks kt in ku b kv mh jo kx ky mi jr la lb mj ld le lf mk lh li lj ml ll lm ln ig bi translated">重点是对我来说。转换成Typescript不一定是一个巨大的项目。实际上，所需要做的就是从<code class="fe nj nk nl nm b">.js</code>到<code class="fe nj nk nl nm b">.ts</code>一次重命名一个文件。那么类型检查将在新文件中抛出错误(如果有的话)。当然，它提供了更多的价值，你定义的类型越多，但Typescript并不强迫你定义你的所有类型，所以你可以按照适合你的节奏来做。</p><p id="cee9" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">然而，我确实相信许多人在开始时会想使用<code class="fe nj nk nl nm b">any</code>类型，这不会给你带来很多打字稿的好处。</p><h2 id="5a5a" class="lo lp in bd lq lr ls dn lt lu lv dp lw lb lx ly lz lf ma mb mc lj md me mf mg bi translated"><strong class="ak">注意依赖类型的安全性</strong></h2><p id="d6ed" class="pw-post-body-paragraph ks kt in ku b kv mh jo kx ky mi jr la lb mj ld le lf mk lh li lj ml ll lm ln ig bi translated">在将我们的项目转换成Typescript的过程中，我发现当第三方库支持Typescript时，这非常有用。这意味着它们的内部类型是可用的，因此您(开发人员)可以知道预期的输入和输出类型。<a class="ae ni" href="https://github.com/DefinitelyTyped/DefinitelyTyped/blob/master/types/doubleclick-gpt/index.d.ts" rel="noopener ugc nofollow" target="_blank">这里的</a>是谷歌的一个很好的例子。</p><p id="39a7" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">这个论点的另一面是很容易忘记一些库不提供类型。许多HTTP请求也是如此。因此，测试永远不应该被省略，仅仅因为你很难相信你的整个系统是“类型安全”的。</p><blockquote class="na nb nc"><p id="862d" class="ks kt nd ku b kv kw jo kx ky kz jr la ne lc ld le nf lg lh li ng lk ll lm ln ig bi translated">类型检查也不会发现一般逻辑中的错误！</p></blockquote><h2 id="7455" class="lo lp in bd lq lr ls dn lt lu lv dp lw lb lx ly lz lf ma mb mc lj md me mf mg bi translated"><strong class="ak">可读性变差，然后变好</strong></h2><p id="15c4" class="pw-post-body-paragraph ks kt in ku b kv mh jo kx ky mi jr la lb mj ld le lf mk lh li lj ml ll lm ln ig bi translated">一般来说，从Typescript开始需要一点时间来适应。因此，在开始时，许多东西看起来很奇怪，无论如何，对于不习惯阅读Typescript的人来说，可读性更差。</p><blockquote class="na nb nc"><p id="500c" class="ks kt nd ku b kv kw jo kx ky kz jr la ne lc ld le nf lg lh li ng lk ll lm ln ig bi translated">拿这个片段来说:</p></blockquote><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi no"><img src="../Images/a86cb070f4dd3387569e2d42e660afc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kpfBX62K73Ucq9gK8NL_Iw.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Dummy snippet</figcaption></figure><p id="abff" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">上面是一个非常简单的函数示例，它只接受一个类型为<code class="fe nj nk nl nm b">ConfigurationType</code>的参数，不返回任何值。让我们假设它做了一个<code class="fe nj nk nl nm b">console.log</code>。对于这个微不足道的例子，很容易理解发生了什么。但是任何快速阅读以上内容的人都不知道<code class="fe nj nk nl nm b">ConfigurationType</code>是什么。</p><p id="da54" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">如果<code class="fe nj nk nl nm b">ConfigurationType</code>只是一个数字或一个字符串，我会说上面的内容对直接可读性没有任何好处。在这种情况下，你最好像这样声明它</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi no"><img src="../Images/1673fd924f36adb5cc097e356cc4c5b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QcPO6W2JZ0MK9WY-o6SgRg.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">The input type is here a string</figcaption></figure><p id="226d" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">很多时候，输入类型可能比这要复杂一些，这时可读性会变得更好。对于对您的应用程序非常定制的较大类型，我相信拥有类型的额外描述会有很大的帮助。使用大多数IDE，您可以查找定义，这样就可以更全面地了解某个输入看起来是什么样子。</p><blockquote class="np"><p id="945b" class="nq nr in bd ns nt nu nv nw nx ny ln dk translated">Typescript更高级的部分使得我的观点更难阅读。你得到了非常特殊类型的好处，但这也是一种精神超载，随着时间的推移(随着你变得更好)，这种精神超载会逐渐减少。</p></blockquote><h2 id="cf30" class="lo lp in bd lq lr oa dn lt lu ob dp lw lb oc ly lz lf od mb mc lj oe me mf mg bi translated"><strong class="ak">你失去了速度——然后你获得了一些速度</strong></h2><p id="28dc" class="pw-post-body-paragraph ks kt in ku b kv mh jo kx ky mi jr la lb mj ld le lf mk lh li lj ml ll lm ln ig bi translated">这是一个经典的权衡，也是使用更严格类型化的“语言”的一个众所周知的方面。<br/>总的来说，我的经验是说<em class="nd">打字稿需要更长的时间是显而易见的。</em></p><p id="6044" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">所以在开始的时候，你要花更多的时间来弄清楚类型，并把它们写进去。但是说实话，我们作为开发人员使用的绝大多数时间并没有花在实际编写代码上。大多数时候，我们阅读代码和文档，思考解决方案，或者从涉众那里提取需求。</p><p id="9b31" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">Typescript在这里是为了帮助避免运行时错误，因此编写它的额外时间与我们预期的收益相比可以忽略不计。</p><h2 id="45d8" class="lo lp in bd lq lr ls dn lt lu lv dp lw lb lx ly lz lf ma mb mc lj md me mf mg bi translated"><strong class="ak">你的重构游戏变得更强大</strong></h2><p id="991f" class="pw-post-body-paragraph ks kt in ku b kv mh jo kx ky mi jr la lb mj ld le lf mk lh li lj ml ll lm ln ig bi translated">促使我尝试Typescript的一个重要因素是，我可以看到重构代码变得多么容易。我们当前的代码库增长很快，因此我们必须/想要定期重构一些代码。<br/>知道不同输入和输出的类型使得重构函数的内部变得容易得多。</p><h2 id="41e8" class="lo lp in bd lq lr ls dn lt lu lv dp lw lb lx ly lz lf ma mb mc lj md me mf mg bi translated"><strong class="ak">您可以获得一些免费文档</strong></h2><p id="865d" class="pw-post-body-paragraph ks kt in ku b kv mh jo kx ky mi jr la lb mj ld le lf mk lh li lj ml ll lm ln ig bi translated">通过定义重复出现的对象和结构，您可以快速获得系统中预期的对象的概况。Typescript并没有给你任何关于如何使用系统或任何业务逻辑的提示，但是它会给你系统中较小单元的文档。</p><blockquote class="na nb nc"><p id="e305" class="ks kt nd ku b kv kw jo kx ky kz jr la ne lc ld le nf lg lh li ng lk ll lm ln ig bi translated">看看这个</p></blockquote><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi of"><img src="../Images/1220d7fa032985a4d871dd6e1293cf9a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iTpn5NEgDAIajFLtnKbLXw.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">VS Code peek definition</figcaption></figure><p id="354e" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">最重要的是，你也可以把你的类型给你的合作伙伴/客户，这样他们就可以更容易更好地与你的软件集成。</p><h2 id="ab2d" class="lo lp in bd lq lr ls dn lt lu lv dp lw lb lx ly lz lf ma mb mc lj md me mf mg bi translated"><strong class="ak">对项目来说是最好的事情吗？</strong></h2><p id="a53b" class="pw-post-body-paragraph ks kt in ku b kv mh jo kx ky mi jr la lb mj ld le lf mk lh li lj ml ll lm ln ig bi translated">我开始相信答案永远是肯定的！</p><p id="8a86" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">我可以肯定地看到一些缺点，但我仍然在等着看他们是否会变成真正的问题。纯粹的事实告诉我，相比Typescript，更多的人可以读/写纯javascript。因此，你最终会使你的软件对一般的开发人员来说更加难以接近。我相信Typescript会自动地在大多数公司中获得更多的关注，所以总的来说，我相信采用它是一个好主意，尽管我仍然需要更多地使用它来做出我的最终决定。</p><blockquote class="na nb nc"><p id="1362" class="ks kt nd ku b kv kw jo kx ky kz jr la ne lc ld le nf lg lh li ng lk ll lm ln ig bi translated">你是什么类型的？</p></blockquote></div><div class="ab cl og oh hr oi" role="separator"><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol om"/><span class="oj bw bk ok ol"/></div><div class="ig ih ii ij ik"><p id="8903" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated"><em class="nd">更多内容请看</em><a class="ae ni" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="ku io"><em class="nd">plain English . io</em></strong></a><em class="nd">。报名参加我们的</em> <a class="ae ni" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ku io"> <em class="nd">免费周报</em> </strong> </a> <em class="nd">。关注我们关于</em><a class="ae ni" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="ku io"><em class="nd">Twitter</em></strong></a><a class="ae ni" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="ku io"><em class="nd">LinkedIn</em></strong></a><em class="nd"/><a class="ae ni" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"><strong class="ku io"><em class="nd">YouTube</em></strong></a><em class="nd"/><a class="ae ni" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"><strong class="ku io"><em class="nd">不和</em> </strong> </a> <em class="nd">。对增长黑客感兴趣？检查</em> <a class="ae ni" href="https://circuit.ooo/" rel="noopener ugc nofollow" target="_blank"> <strong class="ku io"> <em class="nd">电路</em> </strong> </a> <em class="nd">。</em></p></div></div>    
</body>
</html>