<html>
<head>
<title>How to Use JavaScript Promises or TypeScript Promises</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用JavaScript承诺或TypeScript承诺</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-use-javascript-promises-or-typescript-promises-538330eb0788?source=collection_archive---------14-----------------------#2022-04-12">https://javascript.plainenglish.io/how-to-use-javascript-promises-or-typescript-promises-538330eb0788?source=collection_archive---------14-----------------------#2022-04-12</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="e806" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">关于如何处理JavaScript承诺和TypeScript承诺的简单解释。</h2></div><p id="0569" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">当我们需要的数据不能立即得到时，JavaScript的承诺是很重要的。在本文中，我们将使用一个简单的John和Jane生日约定。</p><figure class="kz la lb lc gt ld gh gi paragraph-image"><div class="gh gi ky"><img src="../Images/1bf05c39970ea97a38a900ee4618ee2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1224/format:webp/1*2lD-xVV1jB_iiIfL9LQUtQ.jpeg"/></div><figcaption class="lg lh gj gh gi li lj bd b be z dk">How to use JavaScript promises or Typescript promises</figcaption></figure><p id="8b5c" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">好吧，说实话，在这个时代，<strong class="ke io">时间</strong>往往是至关重要的，我们都必须同意这一点。但这并不意味着我们不能找到<strong class="ke io">可选地</strong>与之绑定的方法。我们可以选择<strong class="ke io">等待</strong>或<strong class="ke io">从我们停止的地方</strong>继续，这两个概念是我们今天主题的基础，JavaScript承诺。</p><p id="6177" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">所以，在我看来，最好的学习方法是与现实世界进行类比。因此，我们将使用一个简单的例子，以便我们了解JavaScript承诺是什么，以及实际上如何使用它们。</p><p id="93da" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">由于TypeScript是JavaScript的超集，因此可以应用相同的规则。因此，在处理TypeScript承诺时，可以应用相同的逻辑。</p><p id="96d2" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="ke io">示例案例</strong></p><p id="b688" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">嗯，约翰和简是多年的朋友，在他们的任何一个生日，他们都同意奖励生日主人去保龄球馆。所以，这是一个<strong class="ke io">小拇指的承诺</strong>他们做出了，并且必须在他们的余生中遵守。</p><p id="858b" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">嗯，今年是简的生日，由于某些原因，约翰的薪水延迟了，不能像预期的那样按时发放，所以他给了简两个选择:</p><ol class=""><li id="95e5" class="lk ll in ke b kf kg ki kj kl lm kp ln kt lo kx lp lq lr ls bi translated">她可以等到月底约翰发工资，他们去打保龄球。</li><li id="fc2e" class="lk ll in ke b kf lt ki lu kl lv kp lw kt lx kx lp lq lr ls bi translated">约翰一有钱，就会带她去打保龄球。</li></ol><p id="2972" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">嗯，我不知道你会选择哪一个，但在我看来，你会选择最适合你的那个。</p><p id="3aad" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="ke io">用JavaScript解释承诺</strong></p><p id="12e7" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">因此，在上面的简单类比中，我们将使用几个关键字来清晰地展现JavaScript的承诺。这些是:</p><ol class=""><li id="caee" class="lk ll in ke b kf kg ki kj kl lm kp ln kt lo kx lp lq lr ls bi translated">生日所有者——但是我们将使用Jane，因为在这种情况下她是所有者。</li><li id="3ffd" class="lk ll in ke b kf lt ki lu kl lv kp lw kt lx kx lp lq lr ls bi translated">小指承诺。</li><li id="f243" class="lk ll in ke b kf lt ki lu kl lv kp lw kt lx kx lp lq lr ls bi translated">准时。</li><li id="9cc3" class="lk ll in ke b kf lt ki lu kl lv kp lw kt lx kx lp lq lr ls bi translated">等待直到<strong class="ke io">月底</strong>。</li><li id="f3ca" class="lk ll in ke b kf lt ki lu kl lv kp lw kt lx kx lp lq lr ls bi translated">一旦。</li></ol><p id="68a5" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">因此，让我们开始打破每个部分，看看什么是引擎盖下！</p><p id="2e7b" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="ke io">代码设置</strong></p><p id="bef0" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这是这个类比的完整代码。我们将用它来解释如何使用JavaScript promises，所以你可以根据需要参考这个。</p><pre class="kz la lb lc gt ly lz ma mb aw mc bi"><span id="a46f" class="md me in lz b gy mf mg l mh mi">/**<br/> * A pact between John and Jane, old time friends.<br/> * <br/> * NOTE: Some of the concepts such as resolving JavaScript Promises<br/> * are not explained here.<br/> */<br/>class JohnAndJanePact {<br/>    /**<br/>     * The agreed bowling voucher ticket value, irrespective of<br/>     * any delays.<br/>     */<br/>    bowlingTicketVoucherValue = 1000;</span><span id="cfcc" class="md me in lz b gy mj mg l mh mi">constructor() {<br/>        this.makeClaim();<br/>    }</span><span id="ec88" class="md me in lz b gy mj mg l mh mi">/**<br/>     * The birthday owner is the one who is charged with the role of<br/>     * making the claim for their gift.<br/>     */<br/>    makeClaim() {<br/>        <br/>        // Using patientjane<br/>        this.patientJane();</span><span id="6a56" class="md me in lz b gy mj mg l mh mi">// To use eagerJane, simply uncomment the below line<br/>        // this.eagerJane();<br/>    }</span><span id="78e7" class="md me in lz b gy mj mg l mh mi">/**<br/>     * She is the patient version of Jane the birthday owner.<br/>     * <br/>     * You will notice that patientJane's social life will be blocked until<br/>     * john fulfills his bowling gift voucher to her.<br/>     */<br/>    async patientJane() {<br/>        const voucher = await this.endMonthJohn();<br/>        console.log(`End Month Salary Was Paid So John Sent Voucher -&gt; ${voucher}`)<br/>        this.socialLifeOfJane();<br/>    }</span><span id="68fa" class="md me in lz b gy mj mg l mh mi">/**<br/>     * She is the eager version of Jane the birthday owner.<br/>     * <br/>     * You will notice that eagerJane's social life will keep on rolling!<br/>     */<br/>    eagerJane() {<br/>        this.sideIncomeJohn().then(voucher =&gt; {<br/>            console.log(`Side Income Came So John Sent Voucher -&gt; ${voucher}`)<br/>        });<br/>        this.socialLifeOfJane();<br/>    }</span><span id="be15" class="md me in lz b gy mj mg l mh mi">/**<br/>     * The rest of her social life.<br/>     */<br/>    socialLifeOfJane() {<br/>        console.log(`Jane's social life...`)<br/>    }</span><span id="8388" class="md me in lz b gy mj mg l mh mi">/**<br/>     * This john will wait for the end of the month to be paid.<br/>     */<br/>    async endMonthJohn() {<br/>        return this.waitForSalary();<br/>    }</span><span id="449c" class="md me in lz b gy mj mg l mh mi">/**<br/>     * Simulate john waiting for his salary to be available.<br/>     * <br/>     * We are using 3000 as the default timeout to mock a salary<br/>     * at the end of the month, you are free to change this value.<br/>     */<br/>    async waitForSalary() {<br/>        return new Promise((resolve, reject) =&gt; {<br/>            setTimeout(() =&gt; {<br/>                resolve(this.bowlingTicketVoucherValue)<br/>            }, 3000);<br/>        })<br/>    }</span><span id="d403" class="md me in lz b gy mj mg l mh mi">/**<br/>     * This john has a side income, so they will provide the<br/>     * voucher as soon as one of their side incomes generate a profite<br/>     */<br/>    async sideIncomeJohn() {<br/>        return this.waitForEarlySideIncome();<br/>    }</span><span id="180c" class="md me in lz b gy mj mg l mh mi">/**<br/>     * Simulate john waiting for his early side income salary to be available.<br/>     * <br/>     * We are using a default timeout of 1000 to mock an early side income, feel<br/>     * free to change this value as well.<br/>     */<br/>    async waitForEarlySideIncome() {<br/>        return new Promise((resolve, reject) =&gt; {<br/>            setTimeout(() =&gt; {<br/>                resolve(this.bowlingTicketVoucherValue)<br/>            }, 1000);<br/>        })<br/>    }<br/>}</span><span id="b248" class="md me in lz b gy mj mg l mh mi">// instantiate the pact<br/>new JohnAndJanePact();</span></pre><p id="194d" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="ke io">生日主人</strong></p><p id="a006" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">因此，我们可以把Jane看作是我们程序/代码的一部分，它需要来自另一部分(John)的数据。现在，简，作为一个函数，可以像往常一样继续她的社交生活，或者，如果绝对必要的话，<strong class="ke io">她必须等待约翰完成他的交易。</strong></p><p id="721c" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="ke io">小指承诺</strong></p><p id="1e76" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">因为约翰和简被一个小手指的承诺所束缚，我们都知道，你永远不会违背小手指的承诺，那么约翰必须确保无论如何，他需要交付。因此，约翰将被<strong class="ke io">绑定</strong>到承诺上，而<strong class="ke io">简将等待</strong>承诺被<strong class="ke io">解决</strong>。</p><p id="77b9" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在，如果你从JavaScript承诺的角度考虑，它以类似的方式工作。必须有一方<strong class="ke io">提供</strong>承诺，另一方<strong class="ke io">消费</strong>承诺。</p><p id="4234" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">通过将john 的<strong class="ke io">变体标记为<strong class="ke io"> async </strong>，这隐含地使它们默认返回一个承诺。</strong></p><p id="fe8e" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">另一件要注意的事情是，我们将<strong class="ke io">病人简</strong>标记为<strong class="ke io">异步</strong>，以便她能够<strong class="ke io">等待</strong>承诺被解决。</p><p id="451f" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="ke io">按时</strong></p><p id="ad5d" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">所以，既然约翰不能按时完成他的交易，那么在这种情况下，他必须给简我们上面提到的选择。</p><p id="d38e" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">类似地，这同样适用于使用JavaScript。程序的一部分可以立即返回需要的数据<strong class="ke io"/>和<strong class="ke io">总是按照预期的</strong>而没有延迟，<strong class="ke io">或</strong>它可以<strong class="ke io">去获取提供给它的数据</strong>。</p><p id="4742" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这就是JavaScript的前景，这就是我们对JavaScript前景的真实定义:</p><p id="af50" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">你的程序的一部分在将来的某个时间点向它们的调用者提供数据的承诺。</p><p id="f52d" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">所以，这基本上是我对JavaScript承诺的现实定义。因此，为了进一步理解这一点，让我们通过理解我们上面列出的最后两个关键字(4和5)来关注术语<strong class="ke io"> <em class="mk">未来时间点</em> </strong>。</p><p id="2cce" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="ke io">等到月底</strong></p><p id="6b53" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">所以，简可以选择等到月底再给约翰发工资。这意味着她所有的社交生活都将暂停，直到约翰的保龄球债务还清。</p><p id="da01" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">因此，这引入了JavaScript承诺的概念，称为<strong class="ke io"> async-await </strong>。嗯，如你所见，我们有<strong class="ke io"> await，有点类似于wait </strong>。所以，这将意味着简、<strong class="ke io">将等到约翰拿到钱</strong>，那将是在月末<strong class="ke io"/>。</p><p id="4dd7" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">类似地，当您使用async — await选项时，这意味着需要的数据将在一段时间后才可用。一旦数据可用，就可以使用了。</p><p id="461b" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这里我们将使用<strong class="ke io"> patientJane </strong>来等待<strong class="ke io"> endMonthJohn </strong>。此外，如上所述，当使用JavaScript承诺或TypeScript承诺时，为了使一个函数能够<strong class="ke io">等待</strong>另一个函数，该函数本身必须是一个<strong class="ke io">异步</strong>函数。因此，我们将<strong class="ke io">患者简</strong>标记为<strong class="ke io">异步</strong>的原因是。</p><p id="173b" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="ke io">一俟</strong></p><p id="086c" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">好吧，让我们假设另一个版本的简可以像往常一样继续她的社交生活，即使约翰没有按时分娩！因此，这意味着约翰一拿到钱，他们就可以去打保龄球。</p><p id="f0bd" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这同样适用于JavaScript承诺。你程序的一部分可以<strong class="ke io">监听</strong>寻找<strong class="ke io">当</strong>数据可用时<strong class="ke io">然后</strong>它可以消费它。</p><p id="2ef7" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这里我们将使用<strong class="ke io"> eagerJane </strong>来监听<strong class="ke io">sideinmejohn</strong>告诉她他有钱，然后他们可以去打保龄球！</p><p id="3f9c" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">请注意，由于<strong class="ke io"> eagerJane </strong>并没有<strong class="ke io">等待<strong class="ke io">sideinmejohn</strong>，即使<strong class="ke io">sideinmejohn</strong>正在等待他的副业收入，我们也没有将她(<strong class="ke io"> eagerJaneB </strong>)标记为<strong class="ke io">异步</strong>。</strong></p><p id="f4f4" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="ke io">最后</strong></p><p id="709e" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">显然，您现在可以使用JavaScript承诺，并在处理TypeScript承诺时应用相同的内容。如您所见，在处理JavaScript承诺或TypeScript承诺时，Jane和您一样有两种选择:</p><ol class=""><li id="f33f" class="lk ll in ke b kf kg ki kj kl lm kp ln kt lo kx lp lq lr ls bi translated">等待结果。</li><li id="a59a" class="lk ll in ke b kf lt ki lu kl lv kp lw kt lx kx lp lq lr ls bi translated">当结果可用时，倾听并消费它们。</li></ol><p id="f099" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="ke io">结论</strong></p><p id="0d77" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这是如何处理JavaScript承诺和TypeScript承诺的简单解释。</p><p id="0dbc" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">说完了，直到下一个！</p><p id="a699" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="ke io"> <em class="mk">快乐编码！</em>T55】</strong></p><p id="46a7" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">你对学习JavaScript感兴趣吗？在这里结账类似牛逼的文章:<a class="ae ml" href="https://bingeoncode.com/article/javascript/How%20to%20use%20JavaScript%20promises%20or%20Typescript%20promises#related-articles" rel="noopener ugc nofollow" target="_blank"> <em class="mk">相关文章</em> </a></p><p id="409f" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="mk">更多内容看</em> <a class="ae ml" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io"> <em class="mk">说白了就是</em> </strong> </a> <em class="mk">。报名参加我们的</em><strong class="ke io"><em class="mk"/></strong><a class="ae ml" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="ke io"><em class="mk">免费周报</em> </strong> </a> <em class="mk">。关注我们关于</em><a class="ae ml" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="ke io"><em class="mk">Twitter</em></strong></a><em class="mk">和</em><a class="ae ml" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="ke io"><em class="mk">LinkedIn</em></strong></a><em class="mk">。加入我们的</em><strong class="ke io"><em class="mk"/></strong><a class="ae ml" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"><strong class="ke io"><em class="mk">社区不和谐</em> </strong> </a> <em class="mk">。</em></p></div></div>    
</body>
</html>