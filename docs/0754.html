<html>
<head>
<title>10 Ways to Speed Up Web Font Loading</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">10种加速网页字体加载的方法</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/10-ways-to-speed-up-web-font-loading-fcc3eb136923?source=collection_archive---------6-----------------------#2022-02-11">https://javascript.plainenglish.io/10-ways-to-speed-up-web-font-loading-fcc3eb136923?source=collection_archive---------6-----------------------#2022-02-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="f5c6" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">字体加载会严重影响性能。本文向您展示了如何减少这种影响。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/7741d583fa568b0754403c4a4c96d9e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c2XzJKttHT_o_YFJYBKbgw.png"/></div></div></figure><p id="602d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">字体是当今网络上流行的工具。大多数现代网站使用自定义字体，通常来自谷歌字体，因为它给界面添加了自定义的风格，并允许更多的选项。然而，web上的字体有许多性能问题。字体通常有数百千字节，并且在另一个域中，这降低了网站的速度。幸运的是，你可以解决这些问题。以下是提高网站字体加载性能的十个技巧。</p><h1 id="707c" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">名单</h1><h2 id="d9a7" class="mf lo iq bd lp mg mh dn lt mi mj dp lx la mk ml lz le mm mn mb li mo mp md mq bi translated">1.自我你的字体</h2><p id="a201" class="pw-post-body-paragraph kr ks iq kt b ku mr jr kw kx ms ju kz la mt lc ld le mu lg lh li mv lk ll lm ij bi translated">当你浏览一个网站时，你经常会看到这样的内容:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="3d6b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这意味着该网站正在使用谷歌字体加载字体。Google Fonts非常适合做原型，因为它很简单，但是性能很差。性能很差，因为Google Fonts有一个复杂的字符串请求来获取字体，这大大增加了延迟。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/d11ce61e5e5ee75fc949796e9afb6f1f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qt0SO3SUNAOv_3tRnky5Eg.png"/></div></div></figure><p id="c39c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">正如你所看到的，谷歌字体的字体加载会很复杂。但是，通过自托管字体并将<code class="fe my mz na nb b">@font-face</code>声明放入CSS包而不是外部样式表，可以将需要的请求数量减少到一个。像<a class="ae nc" href="https://google-webfonts-helper.herokuapp.com/" rel="noopener ugc nofollow" target="_blank">谷歌网页字体助手</a>这样的工具可以对此有所帮助。</p><h2 id="fa98" class="mf lo iq bd lp mg mh dn lt mi mj dp lx la mk ml lz le mm mn mb li mo mp md mq bi translated">2.使用现代网络字体格式</h2><p id="77c9" class="pw-post-body-paragraph kr ks iq kt b ku mr jr kw kx ms ju kz la mt lc ld le mu lg lh li mv lk ll lm ij bi translated">字体就像网页上的图像，因为它们的格式是如何工作的。有了图像，像AVIF和WebP这样的现代网络格式取代了像PNG和JPEG这样压缩程度较低的格式。类似地，web字体有WOFF和WOFF2，它们提供了比TrueType和OpenType (TTF和OTF)更好的压缩。此外，web字体几乎得到普遍支持:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nd"><img src="../Images/aff5923bb6a6625ff2cbf0ba8e1ccf0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*iYU7txQ3LS23akY7"/></div></div></figure><p id="7489" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在这一点上，由于几乎普遍的浏览器支持，最好的做法是使用WOFF2和WOFF回退，尽管你甚至可以只使用WOFF2，因为大约96%的用户支持它。</p><h2 id="e4bb" class="mf lo iq bd lp mg mh dn lt mi mj dp lx la mk ml lz le mm mn mb li mo mp md mq bi translated">3.子集您的字体</h2><p id="ea9f" class="pw-post-body-paragraph kr ks iq kt b ku mr jr kw kx ms ju kz la mt lc ld le mu lg lh li mv lk ll lm ij bi translated">字体子集化意味着将你的字体修剪成你需要的字符。只要不使用要删除的字符，子集化可以节省大量的空间，而且没有任何缺点。最简单的方法是设置子集来删除不使用的语言。以Inter为例，它是最流行的字体之一。如果包含所有语言，包括拉丁字母、西里尔字母、越南语和希腊语，则WOFF2字体的大小为<strong class="kt ir"> 95kb </strong>。然而，有可能你没有使用所有这些语言。如果您删除英语语言之外的所有字符，大小将减少到只有<strong class="kt ir"> 16kb </strong>！有很多方法可以对字体进行子集化，包括Google Fonts(通过扩展，Google Webfonts Helper)、<a class="ae nc" href="https://everythingfonts.com/subsetter" rel="noopener ugc nofollow" target="_blank"> Everything Fonts </a>和<a class="ae nc" href="https://github.com/fonttools/fonttools" rel="noopener ugc nofollow" target="_blank"> fontTools </a>。</p><p id="68e6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">尺寸的减小对性能是有益的，但是如果你愿意承担更多的复杂性，你甚至可以做得更好。您可以通过子集化来精确地包含您所使用的内容，而不是通过广泛的字符范围来进行子集化。像fontTools这样的工具允许你通过任意的字符列表来选择字体。这种方法的问题是，您需要一个复杂的构建过程来获得您使用的每个字符。当然，您也可以手动添加每个字符，但这需要大量的工作🙁。</p><h2 id="793a" class="mf lo iq bd lp mg mh dn lt mi mj dp lx la mk ml lz le mm mn mb li mo mp md mq bi translated">4.使用字体显示</h2><p id="4a20" class="pw-post-body-paragraph kr ks iq kt b ku mr jr kw kx ms ju kz la mt lc ld le mu lg lh li mv lk ll lm ij bi translated">默认情况下，在加载正确的字体之前，文本不会在许多浏览器中显示。这种行为被称为不可见文本的闪现，简称FOIT。其他一些浏览器在加载时使用后备字体显示文本，这确保文本不可见，但会导致<a class="ae nc" href="https://web.dev/optimize-cls/#web-fonts-causing-foutfoit" rel="noopener ugc nofollow" target="_blank">布局偏移</a>。</p><p id="b9f9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">幸运的是，您可以通过<code class="fe my mz na nb b">@font-face</code>声明中的<code class="fe my mz na nb b">font-display</code>选项定制字体加载。<code class="fe my mz na nb b">font-display</code>的两个推荐值是<code class="fe my mz na nb b">swap</code>和<code class="fe my mz na nb b">optional</code>。<code class="fe my mz na nb b">swap</code>使用后备字体，然后在加载后切换到自定义字体，并且<code class="fe my mz na nb b">optional</code>阻止页面加载最长100ms以让字体加载，如果没有，则使用后备字体。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="abbe" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe my mz na nb b">font-display: optional</code>是不需要加载字体时的最佳选择，因为它可以防止任何布局偏移，并确保文本不可见。然而，当你需要字体加载时，<code class="fe my mz na nb b">font-display: swap</code>是最好的，因为即使它需要超过100毫秒，它也会在字体中交换。</p><h2 id="21e9" class="mf lo iq bd lp mg mh dn lt mi mj dp lx la mk ml lz le mm mn mb li mo mp md mq bi translated">5.将您的备用字体与您的自定义字体相匹配</h2><p id="38da" class="pw-post-body-paragraph kr ks iq kt b ku mr jr kw kx ms ju kz la mt lc ld le mu lg lh li mv lk ll lm ij bi translated">字体的间距和大小通常不同。比如Merriweather比Georgia大，即使CSS字体大小一样。如果你使用<code class="fe my mz na nb b">font-display: swap</code>，这些不一致会导致布局偏移，如果你使用<code class="fe my mz na nb b">font-display: optional</code>，会使字体不一致。幸运的是，您可以配置后备字体，使其看起来更像您正在使用的web字体。匹配两种字体可以通过定制间距和字体大小来消除不一致。一个有用的工具是<a class="ae nc" href="https://meowni.ca/font-style-matcher/" rel="noopener ugc nofollow" target="_blank">字体样式匹配器</a>，它允许你查看两种不同的字体，配置不同的间距属性，并查看布局变化的演示。</p><h2 id="6889" class="mf lo iq bd lp mg mh dn lt mi mj dp lx la mk ml lz le mm mn mb li mo mp md mq bi translated">6.使用CDN</h2><p id="51ce" class="pw-post-body-paragraph kr ks iq kt b ku mr jr kw kx ms ju kz la mt lc ld le mu lg lh li mv lk ll lm ij bi translated">cdn对于加速静态内容交付非常有用。它们将内容交付给更接近用户的用户，并经常提供其他加速交付的方式。将你的字体和所有其他静态资产放在CDN上是一个好主意。使用CDN还具有降低服务器成本的优势，因为与从源服务器服务请求相比，CDN通常更便宜。</p><h2 id="cb06" class="mf lo iq bd lp mg mh dn lt mi mj dp lx la mk ml lz le mm mn mb li mo mp md mq bi translated">7.预加载您的字体</h2><p id="9210" class="pw-post-body-paragraph kr ks iq kt b ku mr jr kw kx ms ju kz la mt lc ld le mu lg lh li mv lk ll lm ij bi translated">对于各种资源来说，预加载通常是一个好主意，因为它让浏览器知道它需要更快地下载资源，并提高该资源的优先级。字体也是同样的道理。但是，您并不总是希望预加载字体，因为这可能会使字体不必要地加载。这是因为在下载之前，浏览器会自动检测网站是否使用了页面上的字体，即使存在<code class="fe my mz na nb b">@font-face</code>。现在，您可能知道您总是使用包含在<code class="fe my mz na nb b">@font-face</code>中的字体。还有一个潜在的问题。如果你的字体优先级低，它可能会使其他资源花费更长的时间来加载。然而，如果这两种情况都不是真的，预加载可以是加快字体加载速度的好方法。</p><h2 id="04ba" class="mf lo iq bd lp mg mh dn lt mi mj dp lx la mk ml lz le mm mn mb li mo mp md mq bi translated">8.使用本地()</h2><p id="f084" class="pw-post-body-paragraph kr ks iq kt b ku mr jr kw kx ms ju kz la mt lc ld le mu lg lh li mv lk ll lm ij bi translated">根据字体的不同，用户通常可以在他们的计算机上本地安装您正在使用的字体。如果是这样，您可以很容易地在本地使用该字体，以防止自定义字体带来的任何性能下降。您可以在您的<code class="fe my mz na nb b">@font-face</code> <code class="fe my mz na nb b">src</code>规则中使用<code class="fe my mz na nb b">local()</code>语句来实现这一点。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="82de" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这个<code class="fe my mz na nb b">@font-face</code>检查用户本地是否有字体，如果没有，就远程下载。这意味着使用该字体的用户可以获得免费的性能提升，同时不会增加代码的复杂性，并且不会对本地没有该字体的用户造成不利影响。</p><h2 id="b64b" class="mf lo iq bd lp mg mh dn lt mi mj dp lx la mk ml lz le mm mn mb li mo mp md mq bi translated">9.实现缓存</h2><p id="138a" class="pw-post-body-paragraph kr ks iq kt b ku mr jr kw kx ms ju kz la mt lc ld le mu lg lh li mv lk ll lm ij bi translated">缓存非常重要，尤其是如果你有很多回头客。缓存允许字体在第一次下载后从磁盘加载。您可以通过<code class="fe my mz na nb b">Cache-Control</code>头实现缓存。如果您使用像Cloudflare这样的CDN，从仪表板上进行操作很简单。否则，您只需发送带有字体响应的标题即可。</p><h2 id="93f7" class="mf lo iq bd lp mg mh dn lt mi mj dp lx la mk ml lz le mm mn mb li mo mp md mq bi translated">10.不要使用自定义字体</h2><p id="9b28" class="pw-post-body-paragraph kr ks iq kt b ku mr jr kw kx ms ju kz la mt lc ld le mu lg lh li mv lk ll lm ij bi translated">我打赌你没看到那个😉。我说的是<a class="ae nc" href="https://systemfontstack.com/" rel="noopener ugc nofollow" target="_blank">系统字体栈</a>。系统字体非常适合正文或其他对品牌不重要的文本，因为它是内置的，而且界面更舒适，因为它与操作系统的字体相同。您可以通过上面链接的系统字体堆栈或<code class="fe my mz na nb b">system-ui</code>字体系列来实现系统用户界面字体。</p><h1 id="2a36" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">结论</h1><p id="8103" class="pw-post-body-paragraph kr ks iq kt b ku mr jr kw kx ms ju kz la mt lc ld le mu lg lh li mv lk ll lm ij bi translated">就这样！我希望你喜欢学习如何优化你的网页字体，我希望这有助于你优化你网站上的字体。如果您喜欢阅读本邮件，请务必在此处注册邮件列表<a class="ae nc" href="https://byteofdev.com/signup" rel="noopener ugc nofollow" target="_blank">。谢谢你的阅读！</a></p></div><div class="ab cl ne nf hu ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ij ik il im in"><p id="073a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><em class="nl">原为2022年2月11日在</em><a class="ae nc" href="https://byteofdev.com/posts/speed-up-font-loading/" rel="noopener ugc nofollow" target="_blank"><em class="nl">https://byteofdev.com</em></a><em class="nl">发表。</em></p><p id="a6ee" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><em class="nl">多内容于</em> <a class="ae nc" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir"> <em class="nl">中。注册我们的</em> <a class="ae nc" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir"> <em class="nl">免费周报</em> </strong> </a> <em class="nl">。在我们的</em> <a class="ae nc" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir"> <em class="nl">社区纠纷</em> </strong> </a> <em class="nl">中获得独家写作机会和建议。</em></strong></a></p></div></div>    
</body>
</html>