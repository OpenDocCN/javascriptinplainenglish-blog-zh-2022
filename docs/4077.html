<html>
<head>
<title>Motion Framer for JavaScript Animation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript动画的运动成帧器</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/motion-framer-for-javascript-animation-e939aedf9a37?source=collection_archive---------8-----------------------#2022-10-22">https://javascript.plainenglish.io/motion-framer-for-javascript-animation-e939aedf9a37?source=collection_archive---------8-----------------------#2022-10-22</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="2daf" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">除了使用CSS，您还可以使用JavaScript来触发和更新带有动画规范的动画。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/25f29926815bfb975921262a004d97e8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ltGPC5AMgUI0cM7M"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@theshubhamdhage?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Shubham Dhage</a> on <a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="677b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们使用css来制作动画，比如淡入淡出和滑动效果。然而，css动画有一些限制:它不能给我们一个真正的动画师的颗粒级控制，类似于我们处理css其余部分的方式。我们不直接操作动画的开始和结束，因此当这些事件发生时，我们无法得到通知。</p><p id="43fe" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">除了css，我们可以看看另一种方法，Javascript方式。</p><h2 id="cd52" class="lp lq in bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated">运动第一</h2><p id="9bb0" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">任何动画背后都有一个数学形式的运动基本概念:</p><pre class="kd ke kf kg gt mn mo mp mq aw mr bi"><span id="1f39" class="lp lq in mo b gy ms mt l mu mv">Motion speed = Travel distance / Travel time</span></pre><p id="ffbb" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">跑步就是在一定的时间内跑一定的距离。如果我们用一个离散的单位来看时间，比如<code class="fe mw mx my mo b">30ms</code>，我们创造了一个计算机化的运动。在Javascript中，<code class="fe mw mx my mo b">30ms</code>不能是一个固定的常数，因为还有其他竞争消耗计算机的能力，比如浏览器服务等。所以我们求助于让动画足够“流畅”。</p><p id="fe5a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如果我们将距离抽象成任何元素量，如<code class="fe mw mx my mo b">width</code>、<code class="fe mw mx my mo b">color</code>等，它就变成了一个实用程序包，如<a class="ae ks" href="https://github.com/Popmotion/popmotion" rel="noopener ugc nofollow" target="_blank">、<strong class="kv io">、【popmotion】、</strong>、</a>、<strong class="kv io">、</strong>，其中<strong class="kv io">、</strong>提供了一个函数<code class="fe mw mx my mo b">animate</code>将一个值从一个值传递到另一个值:</p><pre class="kd ke kf kg gt mn mo mp mq aw mr bi"><span id="a79c" class="lp lq in mo b gy ms mt l mu mv">animate({<br/>  from: 0,<br/>  to: 100,<br/>  onUpdate: latest =&gt; console.log(latest), <br/>  onPlay: () =&gt; {}, <br/>  onComplete: () =&gt; {} <br/>})</span></pre><p id="d267" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">由于该库是为DOM元素定制的，为了便于使用，该值支持字符串类型:</p><pre class="kd ke kf kg gt mn mo mp mq aw mr bi"><span id="d8ab" class="lp lq in mo b gy ms mt l mu mv">animate({ from: "0px", to: "100px" })</span></pre><p id="90fa" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">把易用性放在一边，<strong class="kv io">这才是真正的动画师。</strong>动画值实时变化。而且我们暴露了所有更新事件的接口，比如<code class="fe mw mx my mo b">onUpdate</code>、<code class="fe mw mx my mo b">onPlay</code>和<code class="fe mw mx my mo b">onComplete</code>。如果你想微调它，这是你进入动画的入口。</p><h1 id="4d73" class="mz lq in bd lr na nb nc lu nd ne nf lx jt ng ju ma jw nh jx md jz ni ka mg nj bi translated">仅Javascript</h1><p id="6ee3" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">如果你还没有注意到的话，现在一切都与javascript有关。即使没有任何前端库，也可以将动画应用于任何DOM元素。但是为了快速进入主题，请原谅我使用<a class="ae ks" href="https://github.com/framer/motion/tree/main/packages/framer-motion" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io">成帧器-运动</strong> </a>，一个派生的React版本来展示这种方法的一些特性。</p><pre class="kd ke kf kg gt mn mo mp mq aw mr bi"><span id="7a54" class="lp lq in mo b gy ms mt l mu mv">const MyComponent = ({ opacity }) =&gt; {<br/>  return &lt;motion.div animate={{ opacity }}&gt;Hello&lt;/motion.div&gt;<br/>)</span></pre><p id="134e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">该库允许您将任何DOM元素(如<code class="fe mw mx my mo b">div</code>)代理到一个新的motion元素<code class="fe mw mx my mo b">motion.div</code>，从而接受一个prop <code class="fe mw mx my mo b">animate</code>。在上面的my组件中，它的不透明度可以根据从它的父组件传递来的内容进行动画处理。</p><p id="2a62" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">听起来很简单，但你应该马上想到几个问题:</p><h2 id="6b03" class="lp lq in bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated">我如何触发动画</h2><p id="f40e" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">如何在React中触发状态变化？</p><pre class="kd ke kf kg gt mn mo mp mq aw mr bi"><span id="f632" class="lp lq in mo b gy ms mt l mu mv">const MyComponent = () =&gt; {<br/>  const [opacity, setOpacity] = useState(0)<br/>  useEffect(() =&gt; {<br/>    setOpacity(1)<br/>  }, [])<br/>  ...</span></pre><p id="6058" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们可以把它作为一种状态，而不是从道具中传递<code class="fe mw mx my mo b">opacity</code>,因此你可以在组件循环开始时触发动画。</p><h2 id="a679" class="lp lq in bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated">我如何改变动画</h2><p id="7a8b" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">这与上一个问题基本相同，基于任何事件，您都可以改变状态，从而使动画变形:</p><pre class="kd ke kf kg gt mn mo mp mq aw mr bi"><span id="f829" class="lp lq in mo b gy ms mt l mu mv">const MyComponent = () =&gt; {<br/>  const [opacity, setOpacity] = useState(0)<br/>  const onClick = () =&gt; {<br/>    setOpacity(1)<br/>  }<br/>  ...</span></pre><p id="f104" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在任何时间点，无论是通过用户交互还是任何计划好的序列，只要状态<code class="fe mw mx my mo b">opacity</code>通过<code class="fe mw mx my mo b">setOpacity</code>被更新，你就可以期待一个屏幕渲染来适应新的动画需求。</p><h2 id="0811" class="lp lq in bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated">我如何编码动画</h2><p id="3085" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">这是一个非常宽泛和开放的问题。我想我的直觉是，你仍然像以前一样用同样的方式编码，使用组件，并在你适应的过程中重构组件:</p><pre class="kd ke kf kg gt mn mo mp mq aw mr bi"><span id="7b58" class="lp lq in mo b gy ms mt l mu mv">const fadeTransition = (duration = 0.5, delay = 0.2) =&gt; ({<br/>  animate: {<br/>    opacity: 1,<br/>    transition: {<br/>      ease: 'easeInOut',<br/>      duration,<br/>      delay,<br/>    },<br/>  }, <br/>  ...<br/>});</span></pre><p id="e8f5" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如果我们遵循一般的重构原则，一个有趣的片段会脱颖而出，它看起来有点像动画的规范。为了应用这个规范，我们可以用一个通用组件连接它，比如<code class="fe mw mx my mo b">Fade</code>:</p><pre class="kd ke kf kg gt mn mo mp mq aw mr bi"><span id="a0af" class="lp lq in mo b gy ms mt l mu mv">const Fade = ({<br/>  children,<br/>  duration = 0.5,<br/>  delay = 0.2,<br/>  ...props<br/>}: FadeProps) =&gt; {<br/>  const variants = useMemo(() =&gt; {<br/>    return <strong class="mo io">fadeTransition</strong>(duration, delay);<br/>  }, [delay, duration]);</span><span id="4912" class="lp lq in mo b gy nk mt l mu mv">return (<br/>    &lt;motion.div<br/>      variants={variants}<br/>      <strong class="mo io">animate</strong>="animate"<br/>      {...props}<br/>    &gt;<br/>      {children}<br/>    &lt;/motion.div&gt;<br/>  );<br/>};</span></pre><p id="65c3" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在，每当我们需要一种淡入淡出效果时，我们只需将它环绕起来即可:</p><pre class="kd ke kf kg gt mn mo mp mq aw mr bi"><span id="8657" class="lp lq in mo b gy ms mt l mu mv">&lt;Fade delay={0.2}&gt;<br/>  ...<br/>&lt;/Fade&gt;</span></pre><p id="3f2c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">你可以看到，代码并不多，我们可能会用更少的代码向你展示，但我想用这种方式向你展示，以强调以下几点:</p><ul class=""><li id="a574" class="nl nm in kv b kw kx kz la lc nn lg no lk np lo nq nr ns nt bi translated">动画是组件的一部分，如果你愿意，你可以认为动画是另一个组件。</li><li id="872c" class="nl nm in kv b kw nu kz nv lc nw lg nx lk ny lo nq nr ns nt bi translated">可以通过配置或规范来配置动画，这对于我们自己的目的来说是非常灵活的。</li><li id="d36b" class="nl nm in kv b kw nu kz nv lc nw lg nx lk ny lo nq nr ns nt bi translated">这种方法的一个副作用，<em class="nz">如果我们改变动画的细节，团队可以很容易地一起检查代码并做出改变。</em></li></ul><h2 id="1aa7" class="lp lq in bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated">摘要</h2><p id="eacc" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">除了使用css，您还可以使用Javascript来触发和更新带有动画规范的动画。</p></div><div class="ab cl oa ob hr oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="ig ih ii ij ik"><p id="186c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="nz">更多内容请看</em><a class="ae ks" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="nz">plain English . io</em></strong></a><em class="nz">。报名参加我们的</em> <a class="ae ks" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="nz">免费周报</em> </strong> </a> <em class="nz">。关注我们关于</em><a class="ae ks" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="nz">Twitter</em></strong></a><a class="ae ks" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="nz">LinkedIn</em></strong></a><em class="nz"/><a class="ae ks" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="nz">YouTube</em></strong></a><em class="nz"/><a class="ae ks" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="nz">不和</em> </strong> </a> <em class="nz">。对增长黑客感兴趣？检查</em> <a class="ae ks" href="https://circuit.ooo/" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="nz">电路</em> </strong> </a> <em class="nz">。</em></p></div></div>    
</body>
</html>