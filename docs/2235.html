<html>
<head>
<title>Introducing Node.js 18 Fetch API</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Node.js 18 Fetch API简介</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/the-nodejs-18-fetch-api-2d4f06d85319?source=collection_archive---------6-----------------------#2022-05-24">https://javascript.plainenglish.io/the-nodejs-18-fetch-api-2d4f06d85319?source=collection_archive---------6-----------------------#2022-05-24</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="15ea" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">在后端和前端使用相同的获取API。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/e8a322180e22a6688d62a6ae6b60693e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1ztei_kPdV0G3Tpz1MyKww.png"/></div></div></figure><p id="f1ba" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">Node.js 18引入了一些很酷的新特性，其中最有用的一个是内置的Fetch API。这意味着我们不再需要使用像<code class="fe lk ll lm ln b">node-fetch</code>这样的第三方npm包，因为该功能现在是原生的，并被嵌入到节点中。我们需要安装的依赖项少了一个，所以我们的<code class="fe lk ll lm ln b">node_modules</code>文件夹应该稍微轻一点。</p><p id="6694" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在使用最新的Node.js特性(如Fetch API)之前，您首先需要检查您的计算机上是否运行了最新版本的Node.js。在你的控制台上运行命令<code class="fe lk ll lm ln b">node -v</code>，看看你运行的是哪个版本。如果低于18，那么你需要升级才能使用这些新功能。</p><h1 id="1686" class="lo lp in bd lq lr ls lt lu lv lw lx ly jt lz ju ma jw mb jx mc jz md ka me mf bi translated">使用获取API</h1><p id="2e17" class="pw-post-body-paragraph ko kp in kq b kr mg jo kt ku mh jr kw kx mi kz la lb mj ld le lf mk lh li lj ig bi translated">如果您已经熟悉在开发JavaScript应用程序时在浏览器中使用Fetch API，那么这个语法应该很容易理解。我们终于有了一个使用JavaScript在后端获取数据的本地解决方案。</p><pre class="kd ke kf kg gt ml ln mm mn aw mo bi"><span id="2031" class="mp lp in ln b gy mq mr l ms mt">const getAPI = async () =&gt; {<br/>    const res = await fetch('https://pokeapi.co/api/v2/pokemon/');</span><span id="8ddf" class="mp lp in ln b gy mu mr l ms mt">    if (res.ok) {<br/>        const data = await res.json();</span><span id="82d0" class="mp lp in ln b gy mu mr l ms mt">        console.log(data);<br/>    }<br/>};</span><span id="14db" class="mp lp in ln b gy mu mr l ms mt">getAPI();</span></pre><p id="f758" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">让我们创建一个实际的例子，这样您就可以看到一个潜在的用例。导航到一个目录，然后将下面的代码复制并粘贴到命令行中，以搭建一个项目。</p><pre class="kd ke kf kg gt ml ln mm mn aw mo bi"><span id="1eb9" class="mp lp in ln b gy mq mr l ms mt">mkdir node-backend-fetch<br/>cd node-backend-fetch<br/>npm init -y<br/>npm i express nodemon<br/>touch app.js<br/>mkdir controllers routes<br/>touch controllers/pokemon.js<br/>touch routes/pokemon.js</span></pre><p id="0c36" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在代码编辑器中打开项目，然后将下面的代码复制到相应的文件中。</p><p id="7b51" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><code class="fe lk ll lm ln b">controllers/pokemon.js</code></p><pre class="kd ke kf kg gt ml ln mm mn aw mo bi"><span id="aa8a" class="mp lp in ln b gy mq mr l ms mt">exports.getPokemon = async (req, res) =&gt; {<br/>    const api = await fetch('https://pokeapi.co/api/v2/pokemon/');</span><span id="8801" class="mp lp in ln b gy mu mr l ms mt">    if (api.ok) {<br/>        const data = await api.json();</span><span id="524d" class="mp lp in ln b gy mu mr l ms mt">        console.log(data);</span><span id="8d0a" class="mp lp in ln b gy mu mr l ms mt">        try {<br/>            res.json(data);<br/>        } catch (error) {<br/>            console.log(error);<br/>        }<br/>    }<br/>};</span><span id="449f" class="mp lp in ln b gy mu mr l ms mt">exports.getPokemonMoves = async (req, res) =&gt; {<br/>    const api = await fetch('https://pokeapi.co/api/v2/move/');</span><span id="43d9" class="mp lp in ln b gy mu mr l ms mt">    if (api.ok) {<br/>        const data = await api.json();</span><span id="e3d9" class="mp lp in ln b gy mu mr l ms mt">        console.log(data);</span><span id="696d" class="mp lp in ln b gy mu mr l ms mt">        try {<br/>            res.json(data);<br/>        } catch (error) {<br/>            console.log(error);<br/>        }<br/>    }<br/>};</span></pre><p id="eb87" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><code class="fe lk ll lm ln b">routes/pokemon.js</code></p><pre class="kd ke kf kg gt ml ln mm mn aw mo bi"><span id="8587" class="mp lp in ln b gy mq mr l ms mt">const express = require('express');</span><span id="bb95" class="mp lp in ln b gy mu mr l ms mt">const pokemonController = require('../controllers/pokemon');</span><span id="4b4a" class="mp lp in ln b gy mu mr l ms mt">const router = express.Router();</span><span id="0e0d" class="mp lp in ln b gy mu mr l ms mt">router.get('/pokemon', pokemonController.getPokemon);</span><span id="b451" class="mp lp in ln b gy mu mr l ms mt">router.get('/pokemon-moves', pokemonController.getPokemonMoves);</span><span id="07f7" class="mp lp in ln b gy mu mr l ms mt">module.exports = router;</span></pre><p id="4e5d" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><code class="fe lk ll lm ln b">app.js</code></p><pre class="kd ke kf kg gt ml ln mm mn aw mo bi"><span id="0f55" class="mp lp in ln b gy mq mr l ms mt">const express = require('express');</span><span id="5ca6" class="mp lp in ln b gy mu mr l ms mt">const pokemonRoute = require('./routes/pokemon');</span><span id="0cb1" class="mp lp in ln b gy mu mr l ms mt">const app = express();</span><span id="7422" class="mp lp in ln b gy mu mr l ms mt">app.use('/', pokemonRoute);</span><span id="5835" class="mp lp in ln b gy mu mr l ms mt">const port = process.env.PORT || 3000;</span><span id="f9db" class="mp lp in ln b gy mu mr l ms mt">app.listen(port, () =&gt; console.log(`Server running on ${port}, <a class="ae mv" href="http://localhost:${port}`));" rel="noopener ugc nofollow" target="_blank">http://localhost:${port}`));</a></span></pre><p id="14ef" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><code class="fe lk ll lm ln b">package.json</code></p><p id="c9d7" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">添加这些运行脚本。</p><pre class="kd ke kf kg gt ml ln mm mn aw mo bi"><span id="dabc" class="mp lp in ln b gy mq mr l ms mt">"scripts": {</span><span id="8008" class="mp lp in ln b gy mu mr l ms mt">"start": "node app.js",</span><span id="4670" class="mp lp in ln b gy mu mr l ms mt">"dev": "nodemon app.js"</span><span id="464a" class="mp lp in ln b gy mu mr l ms mt">},</span></pre><p id="d2b8" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">仔细检查以确保您使用的是节点18，然后运行命令<code class="fe lk ll lm ln b">npm run dev</code>来启动后端服务器。</p><p id="88b2" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">如果你走这条路线<a class="ae mv" href="http://localhost:3000/pokemon" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/pokemon</a>你应该有一个JSON返回的Pokemon列表。数据也会记录到控制台中。</p><p id="9656" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">如果你去这个路径<a class="ae mv" href="http://localhost:3000/pokemon-moves" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/Pokemon-moves</a>你应该有一个Pokemon moves的列表，它也作为JSON返回。与另一个例子一样，数据也被记录到控制台。</p><h1 id="060d" class="lo lp in bd lq lr ls lt lu lv lw lx ly jt lz ju ma jw mb jx mc jz md ka me mf bi translated">最后的想法</h1><p id="26fe" class="pw-post-body-paragraph ko kp in kq b kr mg jo kt ku mh jr kw kx mi kz la lb mj ld le lf mk lh li lj ig bi translated">这是对使用Node.js 18 Fetch API的简要介绍。要了解更多信息，请查看<a class="ae mv" href="https://nodejs.org/en/blog/announcements/v18-release-announce/" rel="noopener ugc nofollow" target="_blank">官方公告</a>。</p><p id="f511" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><em class="mw">更多内容看</em> <strong class="kq io"> <em class="mw"> </em> </strong> <a class="ae mv" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io"> <em class="mw">说白了. io </em> </strong> </a> <em class="mw">。报名参加我们的</em><strong class="kq io"><em class="mw"/></strong><a class="ae mv" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kq io"><em class="mw">免费周报</em> </strong> </a> <em class="mw">。关注我们关于</em><a class="ae mv" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="kq io"><em class="mw">Twitter</em></strong></a><em class="mw">和</em><a class="ae mv" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kq io"><em class="mw">LinkedIn</em></strong></a><em class="mw">。查看我们的</em> <a class="ae mv" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io"> <em class="mw">社区不和谐</em> </strong> </a> <em class="mw">加入我们的</em> <a class="ae mv" href="https://inplainenglish.pallet.com/talent/welcome" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io"> <em class="mw">人才集体</em> </strong> </a> <em class="mw">。</em></p></div></div>    
</body>
</html>