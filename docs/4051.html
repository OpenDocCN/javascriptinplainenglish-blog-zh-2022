<html>
<head>
<title>How to Get the Position of the Mouse in the React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何获得鼠标在React中的位置</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/react-get-mouse-position-d900c9fe09cd?source=collection_archive---------10-----------------------#2022-10-20">https://javascript.plainenglish.io/react-get-mouse-position-d900c9fe09cd?source=collection_archive---------10-----------------------#2022-10-20</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/d75197ed38ca72c4dbd0f0d19dc672ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*t7y4AkmcQJVUbctFHWq3vw.png"/></div></div></figure><p id="bc0c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">要获得鼠标在React中的位置，需要向<code class="fe kt ku kv kw b">window</code>对象添加一个<code class="fe kt ku kv kw b">mousemove</code>事件处理程序，并访问<code class="fe kt ku kv kw b">MouseEvent</code>对象的<code class="fe kt ku kv kw b">clientX</code>和<code class="fe kt ku kv kw b">clientY</code>属性，以分别获得鼠标的X和Y坐标。</p><p id="8c09" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">例如:</p><p id="6aab" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe kt ku kv kw b">App.js</code></p><pre class="kx ky kz la gt lb kw lc ld aw le bi"><span id="23fe" class="lf lg in kw b gy lh li l lj lk">import { useEffect, useState } from 'react';</span><span id="1add" class="lf lg in kw b gy ll li l lj lk">export default function App() {<br/>  const [mousePos, setMousePos] = useState({});</span><span id="cc3e" class="lf lg in kw b gy ll li l lj lk">  useEffect(() =&gt; {<br/>    const handleMouseMove = (event) =&gt; {<br/>      setMousePos({ x: event.clientX, y: event.clientY });<br/>    };</span><span id="65fb" class="lf lg in kw b gy ll li l lj lk">    window.addEventListener('mousemove', handleMouseMove);</span><span id="a928" class="lf lg in kw b gy ll li l lj lk">    return () =&gt; {<br/>      window.removeEventListener(<br/>        'mousemove',<br/>        handleMouseMove<br/>      );<br/>    };<br/>  }, []);</span><span id="26b4" class="lf lg in kw b gy ll li l lj lk">  return (<br/>    &lt;div&gt;<br/>      The mouse is at position{' '}<br/>      &lt;b&gt;<br/>        ({mousePos.x}, {mousePos.y})<br/>      &lt;/b&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><figure class="kx ky kz la gt jo gh gi paragraph-image"><div class="gh gi lm"><img src="../Images/5b0650c45bed05cb74aa2832839e318f.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/0*meWLn3bw_1XRg47E.gif"/></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk">The current mouse position is displayed.</figcaption></figure><p id="9217" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">当鼠标停留在一个元素上时，该元素触发<code class="fe kt ku kv kw b">mousemove</code>事件。更准确地说，当鼠标移动并且光标的热点在元素的边界内时，它被触发。</p><p id="2526" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们将事件监听器附加到<code class="fe kt ku kv kw b">window</code>对象，以便每当鼠标移动到页面上的任何位置时触发事件。</p><p id="d4f7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们向<a class="ae lr" href="https://reactjs.org/docs/hooks-effect.html" rel="noopener ugc nofollow" target="_blank"> useEffect </a>钩子传递了一个空的依赖数组，因为我们只想为<code class="fe kt ku kv kw b">mousemove</code>事件添加一个处理程序——当组件挂载时。</p><p id="f789" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在cleanup函数中，我们使用<code class="fe kt ku kv kw b">removeEventListener()</code>方法删除之前添加的事件监听器，并防止组件卸载时出现内存泄漏。</p><p id="0d26" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe kt ku kv kw b">mousemove</code>事件监听器接收一个<a class="ae lr" href="https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent" rel="noopener ugc nofollow" target="_blank">鼠标事件</a>对象，用于访问信息和执行与事件相关的动作。我们使用该对象的<code class="fe kt ku kv kw b">clientX</code>和<code class="fe kt ku kv kw b">clientY</code>属性来分别获取鼠标在应用程序视窗中X坐标和Y坐标上的位置。</p><h1 id="9952" class="ls lg in bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated">获取相对于React中元素的鼠标位置</h1><p id="7423" class="pw-post-body-paragraph jv jw in jx b jy mp ka kb kc mq ke kf kg mr ki kj kk ms km kn ko mt kq kr ks ig bi translated">在前面的例子中，我们能够获得鼠标在全局坐标中的位置。</p><p id="d56c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在全局坐标中，位置<code class="fe kt ku kv kw b">(0,0)</code>在网页的左上角，位置<code class="fe kt ku kv kw b">(Xmax, Ymax)</code>在右下角。</p><p id="09ee" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">相反，我们可能希望获得元素区域内的鼠标位置。</p><p id="0300" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">要获得相对于React中元素的鼠标位置，在元素上设置一个<code class="fe kt ku kv kw b">onMouseMove</code>事件处理程序，然后使用传递给事件处理程序的<code class="fe kt ku kv kw b">MouseEvent</code>对象的属性计算本地X和Y位置。</p><p id="8381" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">例如:</p><p id="aec9" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe kt ku kv kw b">App.js</code></p><pre class="kx ky kz la gt lb kw lc ld aw le bi"><span id="54d1" class="lf lg in kw b gy lh li l lj lk">import { useEffect } from 'react';<br/>import { useState } from 'react';</span><span id="5bac" class="lf lg in kw b gy ll li l lj lk">export default function App() {<br/>  const [globalMousePos, setGlobalMousePos] = useState({});<br/>  const [localMousePos, setLocalMousePos] = useState({});</span><span id="d188" class="lf lg in kw b gy ll li l lj lk">  const handleMouseMove = (event) =&gt; {<br/>    // 👇 Get mouse position relative to element<br/>    const localX = event.clientX - event.target.offsetLeft;<br/>    const localY = event.clientY - event.target.offsetTop;</span><span id="5c74" class="lf lg in kw b gy ll li l lj lk">    setLocalMousePos({ x: localX, y: localY });<br/>  };</span><span id="9652" class="lf lg in kw b gy ll li l lj lk">  useEffect(() =&gt; {<br/>    const handleMouseMove = (event) =&gt; {<br/>      setGlobalMousePos({<br/>        x: event.clientX,<br/>        y: event.clientY,<br/>      });<br/>    };</span><span id="78a6" class="lf lg in kw b gy ll li l lj lk">    window.addEventListener('mousemove', handleMouseMove);</span><span id="a0c0" class="lf lg in kw b gy ll li l lj lk">    return () =&gt; {<br/>      window.removeEventListener(<br/>        'mousemove',<br/>        handleMouseMove<br/>      );<br/>    };<br/>  }, []);</span><span id="4b16" class="lf lg in kw b gy ll li l lj lk">  return (<br/>    &lt;div&gt;<br/>      &lt;div<br/>        style={{<br/>          border: '1px solid gray',<br/>          display: 'inline-block',<br/>          padding: '75px',<br/>          textAlign: 'center',<br/>        }}<br/>        onMouseMove={handleMouseMove}<br/>      &gt;<br/>        Local<br/>        &lt;br /&gt;<br/>        &lt;b&gt;<br/>          ({localMousePos.x}, {localMousePos.y})<br/>        &lt;/b&gt;<br/>      &lt;/div&gt;<br/>      &lt;br /&gt;<br/>      Global<br/>      &lt;br /&gt;<br/>      &lt;b&gt;<br/>        ({globalMousePos.x}, {globalMousePos.y})<br/>      &lt;/b&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><p id="e0fd" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在产生的X和Y坐标将相对于元素。例如，位置<code class="fe kt ku kv kw b">(0,0)</code>将位于元素的左上角，而不是页面的左上角:</p><figure class="kx ky kz la gt jo gh gi paragraph-image"><div class="gh gi mu"><img src="../Images/1064ccd6c5c9b47fe94304e18124264b.png" data-original-src="https://miro.medium.com/v2/resize:fit:552/format:webp/0*fagOJT4R0w8sNM-i.png"/></div><figcaption class="ln lo gj gh gi lp lq bd b be z dk">The mouse position relative to an element is displayed.</figcaption></figure><p id="fea5" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们从<code class="fe kt ku kv kw b">MouseEvent</code>对象的<code class="fe kt ku kv kw b">clientX</code>属性中减去元素的<code class="fe kt ku kv kw b">offsetLeft</code>属性，得到相对于元素的X位置。</p><p id="225d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">类似地，为了获得Y位置，我们从<code class="fe kt ku kv kw b">MouseEvent</code>对象的<code class="fe kt ku kv kw b">clientY</code>属性中减去元素的<code class="fe kt ku kv kw b">offsetTop</code>属性。</p><pre class="kx ky kz la gt lb kw lc ld aw le bi"><span id="88fa" class="lf lg in kw b gy lh li l lj lk">const handleMouseMove = (event) =&gt; {<br/>  // Calculate position within bounds of element<br/>  const localX = event.clientX - event.target.offsetLeft;<br/>  const localY = event.clientY - event.target.offsetTop;</span><span id="9ce2" class="lf lg in kw b gy ll li l lj lk">  setLocalMousePos({ x: localX, y: localY });<br/>};</span></pre><p id="98af" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><a class="ae lr" href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetLeft" rel="noopener ugc nofollow" target="_blank"> offsetLeft </a>属性返回元素左侧位置与其父元素左侧位置之间的像素数。</p><p id="3589" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">同样，<a class="ae lr" href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetTop" rel="noopener ugc nofollow" target="_blank"> offsetTop </a>属性返回元素顶部位置与其父元素顶部位置之间的像素数。</p></div><div class="ab cl mv mw hr mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="ig ih ii ij ik"><p id="1842" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="nc">原载于</em><a class="ae lr" href="https://cbdev.link/896b8a" rel="noopener ugc nofollow" target="_blank"><em class="nc">codingbeautydev.com</em></a></p><h1 id="680e" class="ls lg in bd lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo bi translated">JavaScript做的每一件疯狂的事情</h1><p id="e18c" class="pw-post-body-paragraph jv jw in jx b jy mp ka kb kc mq ke kf kg mr ki kj kk ms km kn ko mt kq kr ks ig bi translated">一本关于JavaScript微妙的警告和鲜为人知的部分的迷人指南。</p><p id="7d6e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><a class="ae lr" href="https://cbdev.link/d3c4eb" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io">报名</strong> </a>立即免费领取一份。</p><p id="d385" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="nc">更多内容请看</em> <a class="ae lr" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io"> <em class="nc">说白了就是</em> </strong> </a> <em class="nc">。报名参加我们的</em> <a class="ae lr" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io"> <em class="nc">免费每周简讯</em> </strong> </a> <em class="nc">。关注我们关于</em><a class="ae lr" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="jx io"><em class="nc">Twitter</em></strong></a>，<a class="ae lr" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="jx io"><em class="nc">LinkedIn</em></strong></a><strong class="jx io"><em class="nc">，</em></strong><a class="ae lr" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"><em class="nc">YouTube</em></a><strong class="jx io"><em class="nc">，</em></strong><em class="nc"/><a class="ae lr" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"><strong class="jx io"><em class="nc">不和<em class="nc"/>T75】</em></strong></a></p></div></div>    
</body>
</html>