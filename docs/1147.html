<html>
<head>
<title>Scraping a Wikipedia Page with Node.js Using Puppeteer</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Puppeteer使用Node.js抓取维基百科页面</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/scraping-a-wikipedia-page-with-nodejs-261655790882?source=collection_archive---------2-----------------------#2022-03-06">https://javascript.plainenglish.io/scraping-a-wikipedia-page-with-nodejs-261655790882?source=collection_archive---------2-----------------------#2022-03-06</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="688a" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">用Node.js废弃网页，并将废弃的数据导出到CSV文件中</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/067804af9367adf1eec43f1f274b04c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pxfYLE4yUMJf8hNBgGoHng.png"/></div></div></figure><p id="d2ec" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">网络抓取是一种从网站中提取数据的方法。网络抓取一般用于价格监测、市场调研、新闻监测等。</p><p id="4225" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在本文中，我们将抓取维基百科页面中的一个表格，并生成一个包含该数据的CSV文件。</p></div><div class="ab cl lk ll hr lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="ig ih ii ij ik"><p id="5fa1" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我喜欢芒果，我想知道并在CSV文件中记录所有不同种类的芒果。我们将使用<code class="fe lr ls lt lu b"><a class="ae lv" href="https://www.npmjs.com/package/puppeteer" rel="noopener ugc nofollow" target="_blank">puppeteer</a></code>来抓取维基页面。</p><p id="5876" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><code class="fe lr ls lt lu b">Puppeteer</code>是一个节点库，它提供了一个高级API来控制Chrome或DevTools协议上的Chrome。</p><h1 id="2d4a" class="lw lx in bd ly lz ma mb mc md me mf mg jt mh ju mi jw mj jx mk jz ml ka mm mn bi translated">用Node.js抓取维基百科页面:</h1><p id="9d0c" class="pw-post-body-paragraph ko kp in kq b kr mo jo kt ku mp jr kw kx mq kz la lb mr ld le lf ms lh li lj ig bi translated"><em class="mt">确保您已经安装了节点和NPM</em></p><p id="d6a3" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">创建一个文件夹并初始化<code class="fe lr ls lt lu b">npm</code>。</p><pre class="kd ke kf kg gt mu lu mv mw aw mx bi"><span id="b464" class="my lx in lu b gy mz na l nb nc">mkdir wiki-scraper</span><span id="8c08" class="my lx in lu b gy nd na l nb nc">npm init -y</span></pre><p id="4001" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">安装<code class="fe lr ls lt lu b">puppeteer</code></p><pre class="kd ke kf kg gt mu lu mv mw aw mx bi"><span id="a1f7" class="my lx in lu b gy mz na l nb nc">cd wiki-scraper</span><span id="c38a" class="my lx in lu b gy nd na l nb nc">npm i puppeteer</span></pre><p id="5ed9" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">创造<code class="fe lr ls lt lu b">index.js</code></p><pre class="kd ke kf kg gt mu lu mv mw aw mx bi"><span id="6898" class="my lx in lu b gy mz na l nb nc">Touch index.js</span></pre><p id="2b70" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在您选择的代码编辑器中打开该文件夹。</p><h2 id="d46d" class="my lx in bd ly ne nf dn mc ng nh dp mg kx ni nj mi lb nk nl mk lf nm nn mm no bi translated">使用Puppeteer开始使用Node.js进行Web抓取:</h2><p id="11c6" class="pw-post-body-paragraph ko kp in kq b kr mo jo kt ku mp jr kw kx mq kz la lb mr ld le lf ms lh li lj ig bi translated">在<code class="fe lr ls lt lu b">index.js</code>中，</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi np"><img src="../Images/68035735268cb044b723566bc6558983.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rVlzgNfDB6BX6EoZSfI-Gw.png"/></div></div><figcaption class="nq nr gj gh gi ns nt bd b be z dk">index.js</figcaption></figure><p id="fe0a" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">这是<code class="fe lr ls lt lu b">puppeteer</code>的基本设置。在这里，我们按顺序做以下事情:</p><ul class=""><li id="aaed" class="nu nv in kq b kr ks ku kv kx nw lb nx lf ny lj nz oa ob oc bi translated">创建浏览器实例</li><li id="d486" class="nu nv in kq b kr od ku oe kx of lb og lf oh lj nz oa ob oc bi translated">创建/打开新标签</li><li id="5ff3" class="nu nv in kq b kr od ku oe kx of lb og lf oh lj nz oa ob oc bi translated">导航到该URL</li><li id="a808" class="nu nv in kq b kr od ku oe kx of lb og lf oh lj nz oa ob oc bi translated">捕获页面的屏幕截图</li><li id="6526" class="nu nv in kq b kr od ku oe kx of lb og lf oh lj nz oa ob oc bi translated">关闭浏览器。</li></ul><p id="9bf4" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">它保存了我们提供的页面截图。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oi"><img src="../Images/d35a93a9da57e2e3b1ed3cfffa84a2d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*n-tl0MDcBUjinD1dTw2-Hg.png"/></div></div><figcaption class="nq nr gj gh gi ns nt bd b be z dk">captured screenshot with puppeteer</figcaption></figure><h1 id="8261" class="lw lx in bd ly lz ma mb mc md me mf mg jt mh ju mi jw mj jx mk jz ml ka mm mn bi translated">从维基百科页面抓取芒果数据</h1><p id="9acd" class="pw-post-body-paragraph ko kp in kq b kr mo jo kt ku mp jr kw kx mq kz la lb mr ld le lf ms lh li lj ig bi translated">为了抓取mangoes表，我们将找到特定表的CSS选择器。</p><p id="6840" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">为此，打开Inspect developer工具并查找表格。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oj"><img src="../Images/b4897c57e1e7d1dfa2ead89f8c09097d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*3qNmUd-gGe7f-tEHHjq6Rg.png"/></div></div><figcaption class="nq nr gj gh gi ns nt bd b be z dk">Inspecting the wiki page of mangoes</figcaption></figure><p id="d7d4" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">然后在<code class="fe lr ls lt lu b">index.js</code>，</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ok"><img src="../Images/d30730ae09842a66d5a1f7d6a56642db.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LwtTkX0-QBXUp8sTz8VpfQ.png"/></div></div><figcaption class="nq nr gj gh gi ns nt bd b be z dk">index.js</figcaption></figure><p id="32cc" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在这里，我们是:</p><ul class=""><li id="48b0" class="nu nv in kq b kr ks ku kv kx nw lb nx lf ny lj nz oa ob oc bi translated">等待选择器<code class="fe lr ls lt lu b">table.wikitable</code>加载。</li><li id="b3dc" class="nu nv in kq b kr od ku oe kx of lb og lf oh lj nz oa ob oc bi translated">创建一个包含所有行和列的2D数组。</li></ul><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oj"><img src="../Images/a3807aee61d666d11e9c5798aeee9dba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_cjBi6WgWWOcmnw2501sGw.png"/></div></div><figcaption class="nq nr gj gh gi ns nt bd b be z dk">scraping result</figcaption></figure><p id="5edd" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在我们有了表格数据，让我们将2D数组转换成CSV文件。</p><h1 id="fe78" class="lw lx in bd ly lz ma mb mc md me mf mg jt mh ju mi jw mj jx mk jz ml ka mm mn bi translated">使用抓取的数据生成CSV文件</h1><p id="42ff" class="pw-post-body-paragraph ko kp in kq b kr mo jo kt ku mp jr kw kx mq kz la lb mr ld le lf ms lh li lj ig bi translated">CSV文件有许多约定，但我们将使用以下约定:</p><ol class=""><li id="9d56" class="nu nv in kq b kr ks ku kv kx nw lb nx lf ny lj ol oa ob oc bi translated">逗号<code class="fe lr ls lt lu b">(,)</code>代表一个新列</li><li id="6c1b" class="nu nv in kq b kr od ku oe kx of lb og lf oh lj ol oa ob oc bi translated">新行<code class="fe lr ls lt lu b">(\n)</code>代表新的一行</li><li id="b8f8" class="nu nv in kq b kr od ku oe kx of lb og lf oh lj ol oa ob oc bi translated">双引号<code class="fe lr ls lt lu b">( “ ”)</code>代表一个单元格</li></ol><p id="9c03" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">有了这个，在<code class="fe lr ls lt lu b">index.js</code></p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi om"><img src="../Images/fa899e3f072e66889e8cc8f68f160cb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_hRvkpzCtKHIdHS9pbBEVg.png"/></div></div><figcaption class="nq nr gj gh gi ns nt bd b be z dk">creating a csv file of the scrapped content</figcaption></figure><p id="7cdd" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我们到了:</p><ul class=""><li id="a8ca" class="nu nv in kq b kr ks ku kv kx nw lb nx lf ny lj nz oa ob oc bi translated">创建CSV文件的第一行。</li><li id="8136" class="nu nv in kq b kr od ku oe kx of lb og lf oh lj nz oa ob oc bi translated">创建一个文件并将第一行写入文件。</li><li id="3c0f" class="nu nv in kq b kr od ku oe kx of lb og lf oh lj nz oa ob oc bi translated">迭代内容并根据上面提到的规则生成一个字符串。</li><li id="d0e1" class="nu nv in kq b kr od ku oe kx of lb og lf oh lj nz oa ob oc bi translated">迭代后，将生成的字符串追加到CSV文件中。</li></ul><p id="461c" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">因此，我们在CSV文件中有芒果的类型！</p><p id="a77e" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">本文中的代码可以在<a class="ae lv" href="https://github.com/S0npaRi11/wiki-scraper" rel="noopener ugc nofollow" target="_blank"> Github </a>上获得。</p></div><div class="ab cl lk ll hr lm" role="separator"><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp lq"/><span class="ln bw bk lo lp"/></div><div class="ig ih ii ij ik"><p id="b465" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">链接到我的其他文章:</p><div class="on oo gp gr op oq"><a href="https://paragwebdev.medium.com/restful-api-with-express-and-nodejs-3aa2f2ab1d33" rel="noopener follow" target="_blank"><div class="or ab fo"><div class="os ab ot cl cj ou"><h2 class="bd io gy z fp ov fr fs ow fu fw im bi translated">带有Express和NodeJS的RESTful API</h2><div class="ox l"><h3 class="bd b gy z fp ov fr fs ow fu fw dk translated">使用Express和NodeJS构建REST API。Nodejs是一个javascript运行时，运行在chrome的V8引擎上，执行…</h3></div><div class="oy l"><p class="bd b dl z fp ov fr fs ow fu fw dk translated">paragwebdev.medium.com</p></div></div><div class="oz l"><div class="pa l pb pc pd oz pe km oq"/></div></div></a></div><div class="on oo gp gr op oq"><a href="https://paragwebdev.medium.com/what-is-fetch-api-in-javascript-and-how-it-works-50ff57ca1240" rel="noopener follow" target="_blank"><div class="or ab fo"><div class="os ab ot cl cj ou"><h2 class="bd io gy z fp ov fr fs ow fu fw im bi translated">JavaScript中的Fetch API是什么，它是如何工作的</h2><div class="ox l"><h3 class="bd b gy z fp ov fr fs ow fu fw dk translated">JavaScript的Fetch API是旧的ajax和jQuery的强大且易于使用的替代品。让我们看看如何使用它…</h3></div><div class="oy l"><p class="bd b dl z fp ov fr fs ow fu fw dk translated">paragwebdev.medium.com</p></div></div><div class="oz l"><div class="pf l pb pc pd oz pe km oq"/></div></div></a></div><h2 id="b683" class="my lx in bd ly ne nf dn mc ng nh dp mg kx ni nj mi lb nk nl mk lf nm nn mm no bi translated">进一步阅读</h2><div class="on oo gp gr op oq"><a rel="noopener  ugc nofollow" target="_blank" href="/automate-web-scraping-with-an-easy-to-use-browser-extension-cb6073f1e61d"><div class="or ab fo"><div class="os ab ot cl cj ou"><h2 class="bd io gy z fp ov fr fs ow fu fw im bi translated">使用易于使用的浏览器扩展自动抓取网页</h2><div class="ox l"><h3 class="bd b gy z fp ov fr fs ow fu fw dk translated">如何使用Listly，一个初学者友好的无代码工具，轻松实现web抓取过程的自动化。</h3></div><div class="oy l"><p class="bd b dl z fp ov fr fs ow fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="oz l"><div class="pg l pb pc pd oz pe km oq"/></div></div></a></div><p id="55b5" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><em class="mt">更多内容请看</em><a class="ae lv" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kq io"><em class="mt">plain English . io</em></strong></a><em class="mt">。报名参加我们的</em> <a class="ae lv" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io"> <em class="mt">免费周报</em> </strong> </a> <em class="mt">。关注我们关于</em><a class="ae lv" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="kq io"><em class="mt">Twitter</em></strong></a><a class="ae lv" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kq io"><em class="mt">LinkedIn</em></strong></a><em class="mt"/><a class="ae lv" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"><strong class="kq io"><em class="mt">YouTube</em></strong></a><em class="mt"/><a class="ae lv" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"><strong class="kq io"><em class="mt">不和</em> </strong> </a> <em class="mt">。</em></p></div></div>    
</body>
</html>