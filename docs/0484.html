<html>
<head>
<title>6 Useful JavaScript Code Snippets</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">6个有用的JavaScript代码片段</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/6-useful-javascript-code-snippets-part-ii-1b30b79bcb0f?source=collection_archive---------18-----------------------#2022-01-27">https://javascript.plainenglish.io/6-useful-javascript-code-snippets-part-ii-1b30b79bcb0f?source=collection_archive---------18-----------------------#2022-01-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="7b10" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">第2部分:针对常见用例的JavaScript一行程序和函数的编译列表。没有插件。仅香草JS。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/cb0c3fdf2254dee29b1776e7a7243b39.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4A4IZCWi3n1upqiS"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@juanjodev02?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Juanjo Jaramillo</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="3b00" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在过去的几个月里，当我在业余时间开发离线浏览器工具时，我发现自己在我收藏的<code class="fe ls lt lu lv b">.js</code>文件中反复搜索，以检索旧的代码片段。因此，我认为使用下面的经常使用的JavaScript方法列表作为参考，可能对与我有相似用例的其他人有益。</p><h2 id="0bff" class="lw lx iq bd ly lz ma dn mb mc md dp me lf mf mg mh lj mi mj mk ln ml mm mn mo bi translated">仅供参考——关于❝6实用JavaScript代码Snippets❞的第一部分，请参考:</h2><div class="mp mq gp gr mr ms"><a rel="noopener  ugc nofollow" target="_blank" href="/6-useful-javascript-code-snippets-91424efd1c55"><div class="mt ab fo"><div class="mu ab mv cl cj mw"><h2 class="bd ir gy z fp mx fr fs my fu fw ip bi translated">6个有用的JavaScript代码片段</h2><div class="mz l"><h3 class="bd b gy z fp mx fr fs my fu fw dk translated">这个列表可能很主观，但我还是分享了我自己的版本。示例和代码。</h3></div><div class="na l"><p class="bd b dl z fp mx fr fs my fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="nb l"><div class="nc l nd ne nf nb ng kp ms"/></div></div></a></div><h2 id="f5fb" class="lw lx iq bd ly lz ma dn mb mc md dp me lf mf mg mh lj mi mj mk ln ml mm mn mo bi translated">1.通知未保存的更改</h2><pre class="kg kh ki kj gt nh lv ni bn nj nk bi"><span id="2d1c" class="nl lx iq lv b be nm nn l no np">window.addEventListener('beforeunload', (event) =&gt; {<br/>  event.preventDefault();<br/>  event.returnValue = '';<br/>});</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/9d113ca3eea60552a042915474970a85.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*oH67zfkgSN1tyDiV7LvM9Q.gif"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Screencapture by Author | Demo of the code snippet below i.e. A “double confirmation” is necessary before a browser page closed.</figcaption></figure><p id="8b47" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当用户在输入字段中输入了未保存的数据，并且如果页面被卸载，这些数据将会丢失时，上面的代码片段特别有用。在上图中，用户上传了几个图像文件后，浏览器会继续提示用户是否保存了图像输出以防止数据丢失。</p><h2 id="ea8d" class="lw lx iq bd ly lz ma dn mb mc md dp me lf mf mg mh lj mi mj mk ln ml mm mn mo bi translated">2.异步上传多个文件</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="2b50" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">上面的代码片段确保在浏览器继续执行注释后的代码逻辑之前，所有上传的图像文件已经被编码成Base64字符串(<code class="fe ls lt lu lv b">fileredr.<strong class="ky ir">readAsDataURL</strong>(file);</code>):</p><pre class="kg kh ki kj gt nh lv ni bn nj nk bi"><span id="ad3a" class="nl lx iq lv b be nm nn l no np">/* TO DO LOGIC HERE */</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/13822a87bc57c2866f448b86c253eac1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*Us3AqDj2PHG7KpvLqkWLbQ.gif"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Screencapture by Author | The above executes the code logic below the comment | An image node is created for each image file uploaded and appended to the &lt;body&gt;&lt;/body&gt; of the HTML document.</figcaption></figure><h2 id="666f" class="lw lx iq bd ly lz ma dn mb mc md dp me lf mf mg mh lj mi mj mk ln ml mm mn mo bi translated">3.insertAdjacentHTML—before begin | after begin | before end | after end</h2><p id="4e74" class="pw-post-body-paragraph kw kx iq ky b kz nt jr lb lc nu ju le lf nv lh li lj nw ll lm ln nx lp lq lr ij bi translated">回头参考<strong class="ky ir">点1) </strong>中的截屏，可以通过<code class="fe ls lt lu lv b"><strong class="ky ir">insertAdjacentHTML(&lt;position&gt;,&lt;HTML String&gt;)</strong></code>将HTML添加到元素中:</p><pre class="kg kh ki kj gt nh lv ni bn nj nk bi"><span id="6b6c" class="nl lx iq lv b be nm nn l no np">&lt;Element&gt;.insertAdjacentHTML('beforeend'|'afterbegin'|'beforeend'|'afterend', &lt;HTML String&gt;);</span></pre><p id="00ec" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下图说明了每个选项相对于<code class="fe ls lt lu lv b">&lt;Element&gt;</code>(即<code class="fe ls lt lu lv b">&lt;p&gt;&lt;/p&gt;</code>)的位置:</p><pre class="kg kh ki kj gt nh lv ni bn nj nk bi"><span id="8886" class="nl lx iq lv b be nm nn l no np">&lt;!-- beforebegin --&gt;<br/>&lt;p&gt;<br/>  &lt;!-- afterbegin --&gt;<br/>  foo<br/>  &lt;!-- beforeend --&gt;<br/>&lt;/p&gt;<br/>&lt;!-- afterend --&gt;</span></pre><p id="4b57" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由于在<strong class="ky ir">点1) </strong>中，目标是附加额外的表格行(<code class="fe ls lt lu lv b">&lt;tr&gt;&lt;/tr&gt;</code>)，所以使用了位置<code class="fe ls lt lu lv b">beforeend</code>。</p><h2 id="75ef" class="lw lx iq bd ly lz ma dn mb mc md dp me lf mf mg mh lj mi mj mk ln ml mm mn mo bi translated">4.检查JSON字符串是否有效</h2><p id="9374" class="pw-post-body-paragraph kw kx iq ky b kz nt jr lb lc nu ju le lf nv lh li lj nw ll lm ln nx lp lq lr ij bi translated">由于我在业余时间创建的大多数离线浏览器实用程序都需要用户上传数据文件，其中一些文件需要是JSON格式的，所以对JSON文件进行数据格式验证检查的一种简单而直接的方法是:</p><pre class="kg kh ki kj gt nh lv ni bn nj nk bi"><span id="3edc" class="nl lx iq lv b be nm nn l no np">function isValidJSON(str) {<br/>  try {<br/>    JSON.parse(str);<br/>    return true;<br/>  } catch (e) {<br/>    return false;<br/>  }<br/>}<br/>// returns a Boolean</span></pre><h2 id="df95" class="lw lx iq bd ly lz ma dn mb mc md dp me lf mf mg mh lj mi mj mk ln ml mm mn mo bi translated">5.将原始HTML字符串编码成Unicode实体</h2><pre class="kg kh ki kj gt nh lv ni bn nj nk bi"><span id="dc05" class="nl lx iq lv b be nm nn l no np">function encodeHTMLChars(rawStr) {<br/>  return rawStr.replace(/[\u00A0-\u9999&lt;&gt;\&amp;]/g, ((i) =&gt; `&amp;#${i.charCodeAt(0)};`));<br/>}</span></pre><p id="5528" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要在HTML页面上显示文本<strong class="ky ir"> &lt; img &gt; </strong>，字符串必须编码如下:</p><pre class="kg kh ki kj gt nh lv ni bn nj nk bi"><span id="7dbf" class="nl lx iq lv b be nm nn l no np">var inputHTMLStr='&lt;img&gt;';<br/>var encodedHTMLStr=encodeHTMLChars(inputHTMLStr);<br/>console.log(encodedHTMLStr); <br/>// Output: &amp;#60;img&amp;#62;</span></pre><p id="3dba" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当需要在网页上显示HTML代码片段时，这通常很方便，因为其原始形式，即<strong class="ky ir"> " &lt; img &gt; " </strong>被浏览器自动解释为HTML DOM元素，而不是用于显示的原始文本。</p><h2 id="da50" class="lw lx iq bd ly lz ma dn mb mc md dp me lf mf mg mh lj mi mj mk ln ml mm mn mo bi translated">6.将XML转换成JSON</h2><p id="394e" class="pw-post-body-paragraph kw kx iq ky b kz nt jr lb lc nu ju le lf nv lh li lj nw ll lm ln nx lp lq lr ij bi translated">2个利用率最低的JavaScript APIs包括:<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/API/DOMParser" rel="noopener ugc nofollow" target="_blank"> DOMParser() </a>和<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/API/DOMParser/parseFromString" rel="noopener ugc nofollow" target="_blank">DOM parser . parsefromstring()</a></p><p id="f1bd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">即使像<a class="ae kv" href="https://www.npmjs.com/package/xml-js" rel="noopener ugc nofollow" target="_blank"> xml-js </a>和<a class="ae kv" href="https://www.npmjs.com/package/xml2js" rel="noopener ugc nofollow" target="_blank"> xml2js </a>这样的npm包很容易获得，这个逻辑也可以通过普通的JavaScript实现，如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="e205" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">免责声明:</strong>以上代码逻辑最初由<a class="ae kv" href="https://davidwalsh.name/" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir">David Walsh</strong></a><strong class="ky ir">在</strong> <a class="ae kv" href="https://davidwalsh.name/convert-xml-json" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir">将XML转换为JSON </strong> </a>实现。</p></div><div class="ab cl ny nz hu oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="ij ik il im in"><p id="5273" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我的文章到此结束！非常感谢你坚持到最后！❤希望你觉得这很有用，如果你想了解更多与网络相关的内容，请随时关注我的<a class="ae kv" href="https://medium.com/@geek-cc" rel="noopener"> Medium </a>地理空间分析&amp;数据分析。会非常感激—😀</p><p id="9b6e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">— 🌮请给我买一份玉米卷🎀˶❛◡❛)</p><div class="mp mq gp gr mr ms"><a href="https://geek-cc.medium.com/membership" rel="noopener follow" target="_blank"><div class="mt ab fo"><div class="mu ab mv cl cj mw"><h2 class="bd ir gy z fp mx fr fs my fu fw ip bi translated">通过我的推荐链接加入灵媒——李思欣·崔</h2><div class="mz l"><h3 class="bd b gy z fp mx fr fs my fu fw dk translated">获得李思欣·崔和其他作家在媒体上的所有帖子！😃您的会员费直接…</h3></div><div class="na l"><p class="bd b dl z fp mx fr fs my fu fw dk translated">geek-cc.medium.com</p></div></div><div class="nb l"><div class="of l nd ne nf nb ng kp ms"/></div></div></a></div><p id="938f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="og">更多内容请看</em><a class="ae kv" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="og">plain English . io</em></strong></a><em class="og">。报名参加我们的</em> <a class="ae kv" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="og">免费每周简讯</em> </strong> </a> <em class="og">。在我们的</em> <a class="ae kv" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="og">社区</em> </strong> </a> <em class="og">获取独家写作机会和建议。</em></p></div></div>    
</body>
</html>