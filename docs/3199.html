<html>
<head>
<title>7 Best Practices to Design Cutting-Edge GraphQL Schemas</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">设计前沿GraphQL模式的7个最佳实践</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/7-best-practices-to-design-cutting-edge-graphql-schemas-8ee53be2e601?source=collection_archive---------9-----------------------#2022-08-08">https://javascript.plainenglish.io/7-best-practices-to-design-cutting-edge-graphql-schemas-8ee53be2e601?source=collection_archive---------9-----------------------#2022-08-08</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="6093" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">设计和开发可伸缩的GraphQL模式。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/8dd4c3f01b020e38724d0786066b95ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*v28QeWFuMsZpZB6q"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@kellysikkema?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Kelly Sikkema</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="31a8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">GraphQL是Meta(以前的脸书)带给世界的一项相对较新的技术。尽管是新的，但它越来越受欢迎。</p><p id="9592" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">几乎所有的大行业和许多小组织和创业公司都使用GraphQL。这就是为什么它是当今时代每个web开发人员的必备知识。</p><p id="4c71" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在使用GraphQL模式时，我们必须遵循一些设计前沿模式的最佳实践。否则随着项目的成长，就不会有顺利的设计，项目就会一塌糊涂。</p><p id="9cb6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">今天，我们将讨论设计GraphQL模式时的一些最佳实践。所以，不多说了，让我们直接进入要点。</p><h2 id="c198" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">1.正确使用反对消息。</h2><p id="040c" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">在团队中工作时，有许多需求变化的场景。有时，我们需要更改字段名或删除一些字段。</p><p id="9eb9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">例如，假设你正在建立一个博客网站。您正在设计一个获取博客的模式。该模式最初看起来如下所示:</p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="6ebf" class="ls lt iq mr b gy mv mw l mx my">blog(id: $id) {<br/>  title<br/>  subtitle<br/>  imageUrl<br/>}</span></pre><p id="322d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，需求已经改变，您被告知要为图像包含alt文本；现在，您可以设计如下所示的模式:</p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="7cc5" class="ls lt iq mr b gy mv mw l mx my">blog(id: $id) {<br/>  title<br/>  subtitle<br/>  image {<br/>    src<br/>    alt<br/>  }<br/>}</span></pre><p id="ba6a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，您更改了API，并将其发布到生产环境中。</p><p id="48d1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是，等等！</p><p id="6e64" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一旦你发布你对产品的新修改，你的应用就会崩溃，因为你的前端团队还没有实现你的修改！即使你正在实现一个公共的或者合作伙伴的API，直接推动这些改变也是一个很大的拒绝！</p><p id="ba19" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">相反，保留这个字段也不能解决问题，因为它是一个冗余字段。您的前端团队或最终用户可能不知道该字段是否会被删除。你也不知道你会保持这个领域多久。</p><p id="75dd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这个例子中保留这个字段可能不是一个大问题，但是可能有很多区域应该在某个时候被删除。</p><p id="d361" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">那么有什么解决办法呢？</strong></p><p id="30f9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不要删除该字段，而要说明删除该字段的原因和日期。这样，前端开发人员将有机会研究这个问题，他们可以在某个时候更改这个字段。</p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="0682" class="ls lt iq mr b gy mv mw l mx my">type Blog {<br/>  title: String<br/>  subtitle: String<br/>  imageUrl: String @deprecated(reason: "This field is deprecated and will be removed on Aug 6, 2022. Use `image` field instead.")<br/>  image: {<br/>    src: String<br/>    alt: String<br/>  }<br/>}</span></pre><h2 id="9ed2" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">2.显式命名变量。</h2><p id="c6bd" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">如果您显式命名您的模式变量，将会有所帮助。变量名应该简洁，并返回它承诺的输出。此外，您的变量命名不应该曲解其用途或类型。</p><p id="87a3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以下是设计GraphQL模式时命名变量的一些示例:</p><p id="59ab" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">不好</strong></p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="707a" class="ls lt iq mr b gy mv mw l mx my">imageUrlString<br/>descriptionText</span></pre><p id="d910" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">好的</strong></p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="e670" class="ls lt iq mr b gy mv mw l mx my">imageUrl<br/>likesCount</span></pre><p id="6eea" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这个例子中，如果您用变量传递一个图像URL，您应该将其命名为<code class="fe mz na nb mr b">imageURL</code>。另一方面，如果你给一个图像对象加上<code class="fe mz na nb mr b">width</code>、<code class="fe mz na nb mr b">height</code>、<code class="fe mz na nb mr b">src</code>和<code class="fe mz na nb mr b">alt</code>文本，你应该调用这个变量<code class="fe mz na nb mr b">image</code>。</p><p id="ef33" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">类似的情况也适用于<code class="fe mz na nb mr b">likesCount</code>。<code class="fe mz na nb mr b">likesCount</code>意味着我们在这个变量中传递喜欢的数量，但是如果我们选择<code class="fe mz na nb mr b">likes</code>作为我们的命名，这将意味着喜欢这个帖子的用户的列表。</p><p id="b0b3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所以，明确地命名你的变量。</p><h2 id="d66e" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">3.使用别名。</h2><p id="abdf" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">使用别名可以解决很多冗余问题。为了更好地理解，我们来看看下面的例子。</p><p id="9988" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">假设我们需要为我们的模式返回两种不同类型的描述。一个是<code class="fe mz na nb mr b">description</code>，一个是<code class="fe mz na nb mr b">descriptionHtml</code>。我们可以使用别名添加这两个相同类型的字段。</p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="d73e" class="ls lt iq mr b gy mv mw l mx my">{<br/>  description<br/>  descriptionHtml: description(format: "HTML")<br/>}</span></pre><p id="d6c3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是如此强大，我们可以在许多用例中使用它，如下所示:</p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="0dbd" class="ls lt iq mr b gy mv mw l mx my">{<br/>  descriptionEn: description(lang: "en")<br/>  descriptionEnHTML: description(format: "HTML", lang: "en")<br/>  descriptionFr: description(lang: "fr")<br/>}</span></pre><h2 id="1aca" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">4.使字段可为空。</h2><p id="d5aa" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">这是在开发每个GraphQL项目时可以考虑的另一个基本但简单的实践。这很简单，因为默认情况下，GraphQL使字段<strong class="ky ir">可为空</strong>。</p><p id="14aa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使字段可为空是有帮助的，因为我们可能会在项目需求改变时弃用某个字段，并停止为该变量赋值。</p><p id="7150" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果我们不使字段可空，这将抛出一个错误。因此，保持字段为空是一个好主意，除非您应该使它们不可为空。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nc"><img src="../Images/0b72848e434e929454a6a83ab0b71e42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0F6zE3cxCqj-rqe1drqauQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Examples of nullable and non-nullable fields</figcaption></figure><h2 id="db64" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">5.使用分页时使用中继游标连接规范。</h2><p id="97b2" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">我写了一篇文章，解释了为什么我们需要在GraphQL中实现中继光标连接规范，以及如何在Nest JS中实现。想看的话可以看看这两篇。</p><div class="nd ne gp gr nf ng"><a rel="noopener  ugc nofollow" target="_blank" href="/best-practices-to-work-with-graphql-pagination-8f0d1f9937c2"><div class="nh ab fo"><div class="ni ab nj cl cj nk"><h2 class="bd ir gy z fp nl fr fs nm fu fw ip bi translated">使用GraphQL分页的最佳实践</h2><div class="nn l"><h3 class="bd b gy z fp nl fr fs nm fu fw dk translated">再也不用担心使用GraphQL分页了</h3></div><div class="no l"><p class="bd b dl z fp nl fr fs nm fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="np l"><div class="nq l nr ns nt np nu kp ng"/></div></div></a></div><div class="nd ne gp gr nf ng"><a rel="noopener  ugc nofollow" target="_blank" href="/implement-relay-cursor-connections-specification-in-nestjs-with-graphql-relay-9ba96c4bca79"><div class="nh ab fo"><div class="ni ab nj cl cj nk"><h2 class="bd ir gy z fp nl fr fs nm fu fw ip bi translated">用GraphQL中继实现NestJS中的中继游标连接规范</h2><div class="nn l"><h3 class="bd b gy z fp nl fr fs nm fu fw dk translated">在NestJS中实现基于GraphQL中继光标的分页的简单步骤。</h3></div><div class="no l"><p class="bd b dl z fp nl fr fs nm fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="np l"><div class="nv l nr ns nt np nu kp ng"/></div></div></a></div><h2 id="241c" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">6.为经过身份验证的用户创建用户入口点。</h2><p id="6dba" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">不允许客户端应用程序提供用户身份。使用身份验证令牌获取用户数据。此外，创建一个用户入口点来获取经过身份验证的用户的信息。</p><p id="7278" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">不良</strong></p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="ce51" class="ls lt iq mr b gy mv mw l mx my">user(email: $email) {<br/>  username<br/>  email<br/>  name<br/>  lastLoggedIn<br/>}</span></pre><p id="4289" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">好的</strong></p><pre class="kg kh ki kj gt mq mr ms mt aw mu bi"><span id="0068" class="ls lt iq mr b gy mv mw l mx my">me {<br/>  username<br/>  email<br/>  name<br/>  lastLoggedIn<br/>}</span></pre><p id="4a7f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此外，请记住，不要将您的身份验证令牌保存在cookies或本地存储中。我写过一篇文章，描述了在JavaScript 中存储认证令牌的最佳方式<a class="ae kv" rel="noopener ugc nofollow" target="_blank" href="/the-ultimate-way-to-store-authentication-tokens-in-javascript-41900756c1ae">。想看的话可以看看这篇文章。</a></p><div class="nd ne gp gr nf ng"><a rel="noopener  ugc nofollow" target="_blank" href="/the-ultimate-way-to-store-authentication-tokens-in-javascript-41900756c1ae"><div class="nh ab fo"><div class="ni ab nj cl cj nk"><h2 class="bd ir gy z fp nl fr fs nm fu fw ip bi translated">在JavaScript中存储身份验证令牌的最终方式</h2><div class="nn l"><h3 class="bd b gy z fp nl fr fs nm fu fw dk translated">像专业人士一样处理认证</h3></div><div class="no l"><p class="bd b dl z fp nl fr fs nm fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="np l"><div class="nw l nr ns nt np nu kp ng"/></div></div></a></div><h2 id="d54c" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">7.在生产中关闭内省。</h2><p id="18cf" class="pw-post-body-paragraph kw kx iq ky b kz ml jr lb lc mm ju le lf mn lh li lj mo ll lm ln mp lp lq lr ij bi translated">这是最重要的事情之一。在生产中关闭GraphQL服务器的自检。除非您为公共应用程序构建API，否则您不希望向公众公开您的API设计。</p></div><div class="ab cl nx ny hu nz" role="separator"><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc"/></div><div class="ij ik il im in"><p id="5969" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">就是这样。希望这篇文章对你有帮助。祝您愉快！</p></div><div class="ab cl nx ny hu nz" role="separator"><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc"/></div><div class="ij ik il im in"><p id="434f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="oe">想要连接？</em> </strong></p><p id="8107" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="oe">通过</em><a class="ae kv" href="https://www.linkedin.com/in/ludehsar/" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="oe">Linkedin</em></strong></a><em class="oe">或</em> <a class="ae kv" href="https://rashedul-alam.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="oe">与我联系我的网站</em> </strong> </a> <em class="oe">。</em></p><h2 id="e3a8" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">参考</h2><ul class=""><li id="57bf" class="of og iq ky b kz ml lc mm lf oh lj oi ln oj lr ok ol om on bi translated"><a class="ae kv" href="https://www.youtube.com/watch?v=fG8zy1OROp4" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=fG8zy1OROp4</a></li><li id="5787" class="of og iq ky b kz oo lc op lf oq lj or ln os lr ok ol om on bi translated"><a class="ae kv" href="https://www.youtube.com/watch?v=fBkmlFfwRu0" rel="noopener ugc nofollow" target="_blank">https://www.youtube.com/watch?v=fBkmlFfwRu0</a></li></ul></div><div class="ab cl nx ny hu nz" role="separator"><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc od"/><span class="oa bw bk ob oc"/></div><div class="ij ik il im in"><p id="5f85" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="oe">更多内容请看</em><a class="ae kv" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="oe">plain English . io</em></strong></a><em class="oe">。报名参加我们的</em> <a class="ae kv" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="oe">免费每周简讯</em> </strong> </a> <em class="oe">。关注我们关于</em><a class="ae kv" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="oe">Twitter</em></strong></a><a class="ae kv" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="oe">LinkedIn</em></strong></a><strong class="ky ir"><em class="oe"/></strong><em class="oe">与</em> <a class="ae kv" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="oe">不和</em> </strong> </a> <em class="oe">。</em></p></div></div>    
</body>
</html>