<html>
<head>
<title>Add Newsletter Subscription Form to React Website</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">向React网站添加时事通讯订阅表格</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/add-newsletter-subscription-form-to-react-website-2ce6091ec906?source=collection_archive---------7-----------------------#2022-01-23">https://javascript.plainenglish.io/add-newsletter-subscription-form-to-react-website-2ce6091ec906?source=collection_archive---------7-----------------------#2022-01-23</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/12c32625f0df18f25cbd4e0244ad569a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pi-mY8zQazzXIU9kb-JZuQ.jpeg"/></div></div></figure><p id="2a53" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你是一个开发者，不喜欢在你的网站上毫无意义地嵌入第三方代码，这是一篇非常适合你的文章。我们将为您的网站建立一个定制的电子邮件注册表单，这样您就可以增加您的受众。我们将使用React，但同样的原则适用于任何库或框架，如Gatsby或Next.js。</p><p id="46f6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你是一个回到我博客的人，你可能会注意到几乎任何页面底部都有一个小表格。这是一个你可以注册订阅我的时事通讯的表格，这些年来我已经改变了一些。下面是写作时表单的外观:</p><figure class="kx ky kz la gt jr gh gi paragraph-image"><div class="gh gi kw"><img src="../Images/577ad8b59bf9be048e944fd4d9cf9b84.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/format:webp/0*VZOdE7wfTUgWNMZL.png"/></div></figure><p id="ffe8" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">起初，我使用了各种提供商提供的一些现成的解决方案。我最满意的是<a class="ae lb" href="https://convertkit.com?lmref=EVgZiQ" rel="noopener ugc nofollow" target="_blank"> ConvertKit </a>，它的形式看起来，所以我用了一段时间。我在<a class="ae lb" href="https://convertkit.com?lmref=EVgZiQ" rel="noopener ugc nofollow" target="_blank"> ConvertKit </a>的UI中设计了表单，并将其HTML嵌入到我的博客中。这是它早期的样子:</p><figure class="kx ky kz la gt jr gh gi paragraph-image"><div class="gh gi kw"><img src="../Images/a69fc676f96b468ff67bbfcf9e21489d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/format:webp/0*zFmiChmijE5ImjYW.png"/></div></figure><p id="94d9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">他们的表单生成器给我留下了深刻的印象，但是作为一名开发人员，我不太喜欢复制很多我不太了解的代码和样式。当然，我本可以一头扎进CSS里想出来的。每当我想调整表单外观时，我都必须这样做。但是我总是希望用我的风格和行为创建一个适合我的自定义表单。</p><p id="991b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">所以，事不宜迟，让我们来看看如何设计和放置一个允许用户订阅的定制表单。</p><h1 id="6922" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">表单布局</h1><p id="f1ac" class="pw-post-body-paragraph jy jz iq ka b kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr me kt ku kv ij bi translated">如果你想扩大你的时事通讯，你可能只需要一个注册人的名字和电子邮件。当然，你可以疯狂地创建这种超级长表格，但人们填写它并注册你的简讯的机会可能会下降。但是，嘿，我有什么资格阻止你？请自便。</p><p id="3750" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，我们可以构建一个简单的HTML表单，包含两个输入字段和一个提交按钮。为了提醒您，我将展示如何在React上下文中实现这一点，但是如何在原始HTML或其他一些库/框架中实现这一点应该非常直观。这是JSX的版本:</p><pre class="kx ky kz la gt mf mg mh mi aw mj bi"><span id="b253" class="mk ld iq mg b gy ml mm l mn mo">const SubscribeForm = () =&gt; {<br/>  const [email, setEmail] = useState("")<br/>  const [name, setName] = useState("")<br/><br/>  const handleSubmit = async (event: React.FormEvent) =&gt; {<br/>    // TODO<br/>  }<br/><br/>  const handleEmailChange = (event: React.ChangeEvent&lt;HTMLInputElement&gt;) =&gt; {<br/>    const { value } = event.target<br/>    setEmail(value)<br/>  }<br/><br/>  const handleNameChange = (event: React.ChangeEvent&lt;HTMLInputElement&gt;) =&gt; {<br/>    const { value } = event.target<br/>    setName(value)<br/>  }<br/><br/>  return (<br/>    &lt;form onSubmit={handleSubmit}&gt;<br/>      &lt;input<br/>        aria-label="Your first name"<br/>        name="fields[first_name]"<br/>        placeholder="Your first name"<br/>        type="text"<br/>        onChange={handleNameChange}<br/>        value={name}<br/>      /&gt;<br/>      &lt;input<br/>        aria-label="Your email address"<br/>        name="email_address"<br/>        placeholder="Your email address"<br/>        required<br/>        type="email"<br/>        onChange={handleEmailChange}<br/>        value={email}<br/>      /&gt;<br/>      &lt;button&gt;SUBSCRIBE&lt;/button&gt;<br/>    &lt;/form&gt;<br/>  )<br/>}</span></pre><p id="481d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">恭喜你，你刚刚在React的实现中看到了一个经典的HTML表单。一个<code class="fe mp mq mr mg b">form</code>标签，由两个<code class="fe mp mq mr mg b">input</code>和一个<code class="fe mp mq mr mg b">button</code>绑在一起。但是，我们不要跳过它。当我们向<a class="ae lb" href="https://convertkit.com?lmref=EVgZiQ" rel="noopener ugc nofollow" target="_blank"> ConvertKit </a>提交数据时，有一些重要的信息会对我们有所帮助。请回头看一下两个输入字段及其名称。<code class="fe mp mq mr mg b">fields[first_name]</code>和<code class="fe mp mq mr mg b">email_address</code>很快就会证明它们的价值。</p><h1 id="9694" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">发送数据</h1><p id="cedb" class="pw-post-body-paragraph jy jz iq ka b kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr me kt ku kv ij bi translated">好了，我们得到了表单呈现，但是如果您发布这个表单，没有用户能够订阅并显示在<a class="ae lb" href="https://convertkit.com?lmref=EVgZiQ" rel="noopener ugc nofollow" target="_blank"> ConvertKit </a>中。为了允许用户订阅，我们需要自己发送数据给<a class="ae lb" href="https://convertkit.com/?lmref=EVgZiQ" rel="noopener ugc nofollow" target="_blank"> ConvertKit </a>。下面是我们如何在我们的<code class="fe mp mq mr mg b">handleSubmit</code>函数中实现它:</p><pre class="kx ky kz la gt mf mg mh mi aw mj bi"><span id="dacb" class="mk ld iq mg b gy ml mm l mn mo">const SubscribeForm = () =&gt; {<br/>  ...<br/>  const FORM_URL = `your form URL, we will describe it in a sec`<br/><br/>  const handleSubmit = async (event: React.FormEvent) =&gt; {<br/>    event.preventDefault()<br/><br/>    const data = new FormData(event.target as HTMLFormElement)<br/><br/>    try {<br/>      const response = await fetch(FORM_URL, {<br/>        method: "post",<br/>        body: data,<br/>        headers: {<br/>          accept: "application/json",<br/>        },<br/>      })<br/>      const json = await response.json()<br/><br/>      if (json.status === "success") {<br/>        return<br/>      }<br/>    } catch (err) {<br/>      console.log(err)<br/>    }<br/>  }<br/><br/>  ...<br/>}</span></pre><p id="ea2a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">很好，我们添加了向带有表单数据的<code class="fe mp mq mr mg b">FORM_URL</code>发出POST请求的逻辑，并且我们考虑了在这个过程中发生的任何错误。作为一个完整的解决方案，我们还缺少一个合适的<code class="fe mp mq mr mg b">FORM_URL</code>值。您可以通过<a class="ae lb" href="https://help.convertkit.com/en/articles/3860348-how-to-create-your-first-form-in-convertkit?lmref=EVgZiQ" rel="noopener ugc nofollow" target="_blank">在ConvertKit </a>上创建一个表单来创建自己的表单。</p><p id="1dfe" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">创建表单后，从<a class="ae lb" href="https://convertkit.com?lmref=EVgZiQ" rel="noopener ugc nofollow" target="_blank"> ConvertKit </a>的表单编辑器URL中复制表单ID。例如，编辑表单的URL可以是这样的<code class="fe mp mq mr mg b">https://app.convertkit.com/forms/designers/123456/edit</code>。<code class="fe mp mq mr mg b">123456</code>是你的表单ID。然后，你就可以把<code class="fe mp mq mr mg b">FORM_URL</code>用胶带粘在一起成为<code class="fe mp mq mr mg b"><a class="ae lb" href="https://app.convertkit.com/forms/123456/subscriptions." rel="noopener ugc nofollow" target="_blank">https://app.convertkit.com/forms/123456/subscriptions</a></code> <a class="ae lb" href="https://app.convertkit.com/forms/123456/subscriptions." rel="noopener ugc nofollow" target="_blank">。</a></p><p id="1563" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当你试图嵌入你的表单时，你也可以从<a class="ae lb" href="https://convertkit.com/?lmref=EVgZiQ" rel="noopener ugc nofollow" target="_blank"> ConvertKit </a>得到它。转到HTML选项进行嵌入，在那里你会发现类似这样的东西:</p><pre class="kx ky kz la gt mf mg mh mi aw mj bi"><span id="300b" class="mk ld iq mg b gy ml mm l mn mo">&lt;form action="https://app.convertkit.com/forms/123456/subscriptions" ...&gt;<br/>  ...<br/>&lt;/form&gt;</span></pre><p id="2e53" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><code class="fe mp mq mr mg b">action</code>值是您需要在自定义表单中获取和使用的值。</p><p id="94a4" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">现在，您还记得我们之前提到的那些输入名称属性吗？我要提醒你—我们在输入字段中添加了<code class="fe mp mq mr mg b">fields[first_name]</code>和<code class="fe mp mq mr mg b">email_address</code>。这些名称将构建ConvertKit期望的适当的FormData对象。所以我们只是模仿了嵌入式ConvertKit表单为我们做的事情。现在，当用户点击“订阅”按钮时，他们将作为订阅者出现在<a class="ae lb" href="https://convertkit.com/?lmref=EVgZiQ" rel="noopener ugc nofollow" target="_blank"> ConvertKit </a>中。多整洁啊。</p><p id="9fc0" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们现在可以在下一部分升级用户体验。请继续阅读。</p><h1 id="d2cd" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">个人风格</h1><p id="7ffb" class="pw-post-body-paragraph jy jz iq ka b kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr me kt ku kv ij bi translated">为什么我们要构建一个与第三部分一样的自定义表单呢？是的，我们可以更好地定义它的风格，并且我们可以更好地控制向用户显示什么。但是我这样做的原因是为了给表单添加更多的功能。例如，当你订阅我的时事通讯时，你会得到一个甜蜜的过渡，说谢谢你并提到你的名字。这肯定不是必要的，但我发现它很有魅力，并认为这是一个很好的用户体验。</p><p id="0585" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你也可以自己做，让我们在下面的例子中尝试一下:</p><pre class="kx ky kz la gt mf mg mh mi aw mj bi"><span id="9c1e" class="mk ld iq mg b gy ml mm l mn mo">const SubscribeForm = () =&gt; {<br/>  const [status, setStatus] = useState&lt;string | null&gt;(null)<br/>  const [email, setEmail] = useState("")<br/>  const [name, setName] = useState("")<br/><br/>  const FORM_URL = `the URL you created in the previous section`<br/><br/>  const handleSubmit = async (event: React.FormEvent) =&gt; {<br/>    event.preventDefault()<br/><br/>    const data = new FormData(event.target as HTMLFormElement)<br/><br/>    try {<br/>      const response = await fetch(FORM_URL, {<br/>        method: "post",<br/>        body: data,<br/>        headers: {<br/>          accept: "application/json",<br/>        },<br/>      })<br/><br/>      setEmail("")<br/>      const json = await response.json()<br/><br/>      if (json.status === "success") {<br/>        setStatus("SUCCESS")<br/>        return<br/>      }<br/>    } catch (err) {<br/>      setStatus("ERROR")<br/>      console.log(err)<br/>    }<br/>  }<br/><br/>  const handleEmailChange = (event: React.ChangeEvent&lt;HTMLInputElement&gt;) =&gt; {<br/>    const { value } = event.target<br/>    setEmail(value)<br/>  }<br/><br/>  const handleNameChange = (event: React.ChangeEvent&lt;HTMLInputElement&gt;) =&gt; {<br/>    const { value } = event.target<br/>    setName(value)<br/>  }<br/><br/>  return (<br/>    &lt;div&gt;<br/>      {status === "SUCCESS" &amp;&amp; (<br/>          &lt;p&gt;<br/>            Welcome aboard{name ? `, ${name}` : ""}{" "}<br/>            &lt;span role="img" aria-label="Ship"&gt;<br/>              🚢<br/>            &lt;/span&gt;<br/>          &lt;/p&gt;<br/>          &lt;p&gt;Please check your inbox to confirm the subscription!&lt;/p&gt;<br/>      )}<br/>      {status === "ERROR" &amp;&amp; (<br/>          &lt;p&gt;Oops, something went wrong...&lt;/p&gt;<br/>          &lt;p&gt;<br/>            Please,{" "}<br/>            &lt;button onClick={() =&gt; setStatus(null)}&gt;try again.&lt;/button&gt;<br/>          &lt;/p&gt;<br/>      )}<br/>      {status === null &amp;&amp; (<br/>          &lt;form onSubmit={handleSubmit}&gt;<br/>            &lt;input<br/>              aria-label="Your first name"<br/>              name="fields[first_name]"<br/>              placeholder="Your first name"<br/>              type="text"<br/>              onChange={handleNameChange}<br/>              value={name}<br/>            /&gt;<br/>            &lt;input<br/>              aria-label="Your email address"<br/>              name="email_address"<br/>              placeholder="Your email address"<br/>              required<br/>              type="email"<br/>              onChange={handleEmailChange}<br/>              value={email}<br/>            /&gt;<br/>            &lt;button&gt;SUBSCRIBE&lt;/button&gt;<br/>          &lt;/form&gt;<br/>      )}<br/>    &lt;/div&gt;<br/>  )<br/>}</span></pre><p id="5694" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我们正在做和以前类似的事情，除了我们添加了一个表单的<code class="fe mp mq mr mg b">STATUS</code>。可以是<code class="fe mp mq mr mg b">null</code>、<code class="fe mp mq mr mg b">SUCCESS</code>或<code class="fe mp mq mr mg b">ERROR</code>。我们基于这三个值为用户呈现不同的输出。当用户订阅时，我在博客上是这样做的:</p><figure class="kx ky kz la gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ms"><img src="../Images/34e95574f7de0c250a28d0d23287ab95.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*w8WkpAocNc5HI6SC.gif"/></div></div></figure><p id="cd09" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当不好的事情发生时是这样做的:</p><figure class="kx ky kz la gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi ms"><img src="../Images/b64d3b45f6fd97c5980f664502a0c2b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*SM56DOJY80-tKv_8.gif"/></div></div></figure><p id="40e7" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">但是不要相信我发的gif。自己试试吧，在这篇博文的底部注册<a class="ae lb" href="https://pragmaticpineapple.com/newsletter" rel="noopener ugc nofollow" target="_blank">我的简讯</a>，让我知道你对注册体验的看法。</p><h1 id="c543" class="lc ld iq bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">总结</h1><p id="8789" class="pw-post-body-paragraph jy jz iq ka b kb ma kd ke kf mb kh ki kj mc kl km kn md kp kq kr me kt ku kv ij bi translated">对你放在网站上的内容拥有控制权和最终决定权是很棒的。它可以帮助您定制它的显示和行为方式，这并不是一件不常见的事情。在这篇博客文章中，我们展示了如何为时事通讯建立自己的表单，这样用户只需稍加修改就可以注册。</p><p id="3c9e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我的博客是开源的，你可以在<a class="ae lb" href="https://github.com/nikolalsvk/blog/blob/master/src/components/subscribe-form.tsx" rel="noopener ugc nofollow" target="_blank">博客回购这里</a>找到这个表格(但是有样式)。欢迎和鼓励拉请求、明星和建议。</p><p id="0736" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果你喜欢它，我敢说你可以在你的网站上这样做，但是如果你喜欢的话，可以加入一些动画。如果你有兴趣看到更多类似的内容，可以考虑订阅我们提到过几次的新闻简报。</p><p id="908b" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我想做一个类似的博客帖子，创建一个推文的自定义显示。通常，你从Twitter上复制代码并粘贴到你的网站上以嵌入推文。我计划自己构建一些东西来显示tweets，所以我不会加载很多Twitter代码。敬请关注。</p><p id="3ba9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">总之，感谢你收听并关注这篇博文。如果你觉得有用，可以在Twitter上与你的朋友和同事分享:</p><figure class="kx ky kz la gt jr"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="c42d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">直到下一个，干杯。</p></div><div class="ab cl mv mw hu mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="ij ik il im in"><p id="1d3c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="nc">原载于2022年1月23日https://pragmaticpineapple.com</em><a class="ae lb" href="https://pragmaticpineapple.com/add-newsletter-subscription-form-to-react-website/" rel="noopener ugc nofollow" target="_blank"><em class="nc"/></a><em class="nc">。</em></p><p id="329e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="nc">更多内容请看</em><a class="ae lb" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir"><em class="nc">plain English . io</em></strong></a><em class="nc">。报名参加我们的</em> <a class="ae lb" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir"> <em class="nc">免费周报</em> </strong> </a> <em class="nc">。关注我们关于</em><a class="ae lb" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir"><em class="nc">Twitter</em></strong></a><em class="nc">和</em><a class="ae lb" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="ka ir"><em class="nc">LinkedIn</em></strong></a><em class="nc">。加入我们的</em> <a class="ae lb" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir"> <em class="nc">社区不和谐</em> </strong> </a> <em class="nc">。</em></p></div></div>    
</body>
</html>