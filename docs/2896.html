<html>
<head>
<title>Easy User Authentication with React + Node.js + Firebase: A Complete Guide</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用React + Node.js + Firebase轻松进行用户身份验证:完整指南</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/auth-react-node-firebase-10030d160707?source=collection_archive---------8-----------------------#2022-07-13">https://javascript.plainenglish.io/auth-react-node-firebase-10030d160707?source=collection_archive---------8-----------------------#2022-07-13</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="d69a" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">使用React.js、Node.js和Firebase SDKs在web应用程序中实现用户身份验证的全面指南。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/19dbc91e26f81e6c12792815b6ceef6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mpxqDoHyGHVJEeOm95ns3g.png"/></div></div></figure><p id="2734" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">身份认证对于验证用户的身份至关重要，以便了解他们应该能够访问哪些数据以及他们应该能够执行哪些特权操作。Firebase平台提供了强大的库，让我们可以轻松地将身份验证集成到我们的项目中。</p><p id="8fb7" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在本文中，我们将通过构建一个RESTful API和一个web应用程序来实现身份验证，该应用程序允许用户使用一个只有该用户才能访问的安全注释进行注册。我们将使用Node.js和Express来构建API，使用React.js来创建单页面web应用程序。</p><p id="91e1" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">该应用程序的完整源代码可在GitHub的<a class="ae lk" href="https://github.com/tariibaba/CB-Auth-Tutorial" rel="noopener ugc nofollow" target="_blank">这里</a>获得。</p><h1 id="2131" class="ll lm in bd ln lo lp lq lr ls lt lu lv jt lw ju lx jw ly jx lz jz ma ka mb mc bi translated">你需要什么</h1><ul class=""><li id="163e" class="md me in kq b kr mf ku mg kx mh lb mi lf mj lj mk ml mm mn bi translated">Node.js已安装</li><li id="6173" class="md me in kq b kr mo ku mp kx mq lb mr lf ms lj mk ml mm mn bi translated">谷歌账户——使用Firebase</li><li id="ced5" class="md me in kq b kr mo ku mp kx mq lb mr lf ms lj mk ml mm mn bi translated">React.js和Node.js的基础知识</li><li id="9da2" class="md me in kq b kr mo ku mp kx mq lb mr lf ms lj mk ml mm mn bi translated">代码编辑器——类似于Visual Studio代码</li></ul><h1 id="9291" class="ll lm in bd ln lo lp lq lr ls lt lu lv jt lw ju lx jw ly jx lz jz ma ka mb mc bi translated">设置Firebase</h1><p id="6d47" class="pw-post-body-paragraph ko kp in kq b kr mf jo kt ku mg jr kw kx mt kz la lb mu ld le lf mv lh li lj ig bi translated">在我们开始编码之前，让我们到Firebase控制台并创建一个新项目，这样我们就可以访问Firebase服务。我给我的起名叫<code class="fe mw mx my mz b">cb-auth-tutorial</code>，但是你可以给你的起你喜欢的名字。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi na"><img src="../Images/4b90cf43010e6112a2032c4ffeda4c07.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*uuUfz2Ewh2pXfsnt.png"/></div></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk">Creating a new Firebase project</figcaption></figure><p id="3ed7" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在给它命名后，你会被询问是否要启用谷歌分析。在本教程中，我们不会使用该服务，但如果您愿意，可以将其打开。</p><p id="351c" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">完成所有步骤后，您将被带到仪表板，在那里您可以看到您的Firebase项目的概述。它应该是这样的:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi na"><img src="../Images/b5a505aef5fa0f9cc14e2377448e622e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*zDLLCevi8XsnkLMI.png"/></div></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk">The Firebase dashboard</figcaption></figure><p id="6060" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">让我们创建一个web应用程序。单击此图标按钮开始:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi nf"><img src="../Images/7949c96cb3f6d1aff739b4e7ade64eae.png" data-original-src="https://miro.medium.com/v2/resize:fit:104/format:webp/0*5voWnb73ZpX3g_qO.png"/></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk">Click this icon to start creating the web app</figcaption></figure><p id="003e" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">您将被要求输入该应用程序的昵称。这也可以是你喜欢的任何东西。为了与项目名称对称，我将我的命名为<code class="fe mw mx my mz b">CB Auth Tutorial</code>。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi na"><img src="../Images/4da8222620424296906ffdb0579186a8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*nzIwsqjVJVKXgJVf.png"/></div></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk">Completing the steps to create the web app</figcaption></figure><p id="8d94" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">注册应用程序后，将为您提供一个配置，您需要用它来初始化您的应用程序，以便能够访问各种Firebase APIs和服务。</p><p id="0376" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">从仪表板侧边栏中，单击<code class="fe mw mx my mz b">Build &gt; Authentication</code>，然后在显示的屏幕上单击<code class="fe mw mx my mz b">Get started</code>以启用Firebase身份验证。您将被要求添加初始登录方法。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi na"><img src="../Images/a1f5cf917c2dc4cae9b0769fe11cc838.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*myHfiDHDabM-Nsbp.png"/></div></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk">Adding a sign-in method</figcaption></figure><p id="5cbb" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">点击<code class="fe mw mx my mz b">Email/Password</code>并打开开关使其启动。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi na"><img src="../Images/6222c1af76f9d36b5bf86478bf2286cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*3L5PX9bIMbseAvST.png"/></div></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk">Enabling sign-in with email/password</figcaption></figure><p id="ca85" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">接下来，我们将设置Firebase Firestore。</p><p id="caa4" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">点击侧边栏中的<code class="fe mw mx my mz b">Build &gt; Firestore Database</code>，然后点击页面上的<code class="fe mw mx my mz b">Create database</code>按钮以启用Firestore。</p><p id="210f" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">您将看到一个对话框，引导您完成创建数据库的步骤。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ng"><img src="../Images/c9bf5c1fb16460ee5494dbe5e5819328.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jX1-nKS2Zw4CzTjU.png"/></div></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk">The dialog used to create the Firestore database</figcaption></figure><p id="b366" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我们不会从客户端访问Firestore，所以我们可以在生产模式下创建数据库。Firebase Admin在与Firestore交互时会忽略安全规则。</p><p id="0d00" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">接下来，我们需要生成一个服务帐户密钥，这是一个JSON文件，其中包含我们用来初始化管理应用程序的信息，以便能够创建将发送给客户端的自定义web令牌。遵循Firebase文档中的这些说明<a class="ae lk" href="https://firebase.google.com/docs/admin/setup#initialize-sdk" rel="noopener ugc nofollow" target="_blank">来完成此操作。</a></p><p id="e55c" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">让我们用NPM安装Firebase CLI工具。为此，请在终端中运行以下命令:</p><pre class="kd ke kf kg gt nh mz ni nj aw nk bi"><span id="8088" class="nl lm in mz b gy nm nn l no np">npm i -g firebase-tools</span></pre><p id="f0ec" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">让我们为项目创建一个新文件夹。我将我的命名为<code class="fe mw mx my mz b">auth-tutorial</code>,因为它与Firebase项目对称，但是你可以随意命名。</p><p id="455d" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">使用以下命令初始化项目目录中的Firebase:</p><pre class="kd ke kf kg gt nh mz ni nj aw nk bi"><span id="ed04" class="nl lm in mz b gy nm nn l no np">firebase init</span></pre><p id="26bb" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我们将使用Firebase函数和Firebase模拟器，所以当要求选择您想要为项目目录设置的特性时，请选择这些。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/fdb2695bd0b7206ba21a1cac5799e4ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1116/format:webp/0*C4s2HWVklunxAYv3.png"/></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk">Setting up Firebase features in the project directory</figcaption></figure><p id="f637" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">下一个提示是让您将项目目录与Firebase项目关联起来。选择<code class="fe mw mx my mz b">Use an existing project</code> <strong class="kq io"> </strong>并选择您之前创建的项目。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/6445e9a8a0150a8d4fb9e16117f1dbd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1180/format:webp/0*KHnri6yPuCTdTBQA.png"/></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk">Associating the project directory with a Firebase project</figcaption></figure><p id="7545" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我们将使用普通的JavaScript来编写函数，所以当询问您想要使用哪种语言时，请选择普通的JavaScript。</p><p id="62f4" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我们将使用Firebase函数模拟器来测试我们的函数，所以当要求设置模拟器时选择它。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/2c5ac33b39de9837222c250e68c9469b.png" data-original-src="https://miro.medium.com/v2/resize:fit:818/format:webp/0*fwTlaMGV7MQVuog1.png"/></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk">Setting up Firebase emulators</figcaption></figure><p id="1a4c" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">初始化Firebase后，项目目录结构应该如下所示:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi nt"><img src="../Images/e4b62d1354aa581864a6d0ad3ba58e8a.png" data-original-src="https://miro.medium.com/v2/resize:fit:520/format:webp/0*2PiIpCWcvJ0dQp41.png"/></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk">Our project directory structure after initializing Firebase</figcaption></figure><h1 id="82a5" class="ll lm in bd ln lo lp lq lr ls lt lu lv jt lw ju lx jw ly jx lz jz ma ka mb mc bi translated">创建REST API</h1><p id="1270" class="pw-post-body-paragraph ko kp in kq b kr mf jo kt ku mg jr kw kx mt kz la lb mu ld le lf mv lh li lj ig bi translated">我们将需要以下NPM包来编写我们的函数:</p><ul class=""><li id="a69b" class="md me in kq b kr ks ku kv kx nu lb nv lf nw lj mk ml mm mn bi translated"><code class="fe mw mx my mz b">express</code> : Node.js web框架加速开发。</li><li id="45e6" class="md me in kq b kr mo ku mp kx mq lb mr lf ms lj mk ml mm mn bi translated"><code class="fe mw mx my mz b">cors</code> : Express中间件，实现CORS(跨源资源共享)。</li><li id="ddd2" class="md me in kq b kr mo ku mp kx mq lb mr lf ms lj mk ml mm mn bi translated"><code class="fe mw mx my mz b">morgan</code>:用于Express的日志中间件。</li><li id="ae9a" class="md me in kq b kr mo ku mp kx mq lb mr lf ms lj mk ml mm mn bi translated"><code class="fe mw mx my mz b">is-email</code>:用于服务器端邮件验证。</li><li id="2da6" class="md me in kq b kr mo ku mp kx mq lb mr lf ms lj mk ml mm mn bi translated"><code class="fe mw mx my mz b">firebase</code>:使用Firebase Web SDK对用户进行身份验证。</li></ul><p id="9a68" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">让我们用一个命令安装它们:</p><pre class="kd ke kf kg gt nh mz ni nj aw nk bi"><span id="c02d" class="nl lm in mz b gy nm nn l no np">npm i express cors morgan is-email firebase</span></pre><p id="133a" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">让我们为<code class="fe mw mx my mz b">/register</code>端点编写处理函数。在<code class="fe mw mx my mz b">functions</code>目录下创建一个名为<code class="fe mw mx my mz b">express</code>的新文件夹，其中包含一个名为<code class="fe mw mx my mz b">routes</code>的子文件夹，并使用以下代码在routes中创建一个新的<code class="fe mw mx my mz b">register.js</code>文件:</p><p id="c2ab" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io">functions/express/routes/register . js</strong></p><pre class="kd ke kf kg gt nh mz ni nj aw nk bi"><span id="7620" class="nl lm in mz b gy nm nn l no np">const {<br/>  getAuth,<br/>  createUserWithEmailAndPassword,<br/>} = require('firebase/auth');<br/>const {<br/>  getAuth: getAdminAuth,<br/>} = require('firebase-admin/auth');<br/>const firestore = require('firebase-admin').firestore();</span><span id="9ecf" class="nl lm in mz b gy nx nn l no np">async function register(req, res) {<br/>  const { email, password, secureNote } = req.body;<br/>  if (!secureNote) {<br/>    res<br/>      .status(400)<br/>      .json({ error: { code: 'no-secure-note' } });<br/>    return;<br/>  }</span><span id="e11d" class="nl lm in mz b gy nx nn l no np">  try {<br/>    const auth = getAuth();<br/>    const credential = await createUserWithEmailAndPassword(<br/>      auth,<br/>      email,<br/>      password<br/>    );<br/>    const adminAuth = getAdminAuth();<br/>    const token = await adminAuth.createCustomToken(<br/>      credential.user.uid<br/>    );<br/>    await firestore<br/>      .doc(`users/${credential.user.uid}`)<br/>      .set({ secureNote });<br/>    res.status(201).json({ token });<br/>  } catch (err) {<br/>    const { code } = err;<br/>    if (code === 'auth/email-already-in-use') {<br/>      res.status(400);<br/>    } else {<br/>      res.status(500);<br/>    }<br/>    res.json({<br/>      error: {<br/>        code: code ? code.replace('auth/', '') : undefined,<br/>      },<br/>    });<br/>  }<br/>}</span><span id="93bb" class="nl lm in mz b gy nx nn l no np">module.exports = register;</span></pre><p id="cd95" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">如果所有验证都成功，新用户的安全注释将保存在Firestore数据库中。让我们在一个新的<code class="fe mw mx my mz b">login.js</code>文件中创建一个处理向<code class="fe mw mx my mz b">/login</code>端点的POST请求的函数，该文件也保存在<code class="fe mw mx my mz b">routes</code>目录中。</p><p id="aaa2" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io">功能/快递/路线/登陆. js </strong></p><pre class="kd ke kf kg gt nh mz ni nj aw nk bi"><span id="e1bf" class="nl lm in mz b gy nm nn l no np">const {<br/>  getAuth: getClientAuth,<br/>  signInWithEmailAndPassword,<br/>} = require('firebase/auth');<br/>const {<br/>  getAuth: getAdminAuth,<br/>} = require('firebase-admin/auth');</span><span id="99fc" class="nl lm in mz b gy nx nn l no np">async function login(req, res) {<br/>  const { email, password } = req.body;<br/>  try {<br/>    const credential = await signInWithEmailAndPassword(<br/>      getClientAuth(),<br/>      email,<br/>      password<br/>    );<br/>    const token = await getAdminAuth().createCustomToken(<br/>      credential.user.uid<br/>    );<br/>    res.status(200).json({ token });<br/>  } catch (error) {<br/>    if (<br/>      error.code === 'auth/wrong-password' ||<br/>      error.code === 'auth/user-not-found'<br/>    ) {<br/>      res.status(403);<br/>    } else {<br/>      res.status(500);<br/>    }<br/>    res.json({<br/>      error: { code: error.code.replace('auth/', '') },<br/>    });<br/>  }<br/>}</span><span id="6869" class="nl lm in mz b gy nx nn l no np">module.exports = login;</span></pre><p id="4ea1" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">请注意<code class="fe mw mx my mz b">/login</code>和<code class="fe mw mx my mz b">/register</code>路由处理程序不会对请求中发送的电子邮件或密码执行验证。这是因为我们将创建自定义的<a class="ae lk" href="https://expressjs.com/en/guide/using-middleware.html" rel="noopener ugc nofollow" target="_blank"> Express中间件</a>来代替它。在<code class="fe mw mx my mz b">express</code>文件夹中创建一个新的<code class="fe mw mx my mz b">middleware</code>子文件夹，并在其中创建一个新的<code class="fe mw mx my mz b">validate-email-and-password.js</code>文件，包含以下代码:</p><p id="cc97" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io">功能/快递/中间件/验证电子邮件和密码. js </strong></p><pre class="kd ke kf kg gt nh mz ni nj aw nk bi"><span id="457f" class="nl lm in mz b gy nm nn l no np">const isEmail = require('is-email');</span><span id="d82e" class="nl lm in mz b gy nx nn l no np">function validateEmailAndPassword(req, res, next) {<br/>  const { email, password } = req.body;</span><span id="7b7b" class="nl lm in mz b gy nx nn l no np">  if (!email) {<br/>    res.status(400).send({ error: { code: 'no-email' } });<br/>    return;<br/>  }</span><span id="4fa9" class="nl lm in mz b gy nx nn l no np">  if (!isEmail(email)) {<br/>    res<br/>      .status(400)<br/>      .send({ error: { code: 'invalid-email' } });<br/>    return;<br/>  }</span><span id="4735" class="nl lm in mz b gy nx nn l no np">  if (!password) {<br/>    res<br/>      .status(400)<br/>      .send({ error: { code: 'no-password' } });<br/>    return;<br/>  }</span><span id="22fe" class="nl lm in mz b gy nx nn l no np">  next();<br/>}</span><span id="97a9" class="nl lm in mz b gy nx nn l no np">module.exports = validateEmailAndPassword;</span></pre><p id="cb95" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在这里，我们检查在请求正文中是否指定了密码和有效的电子邮件。如果是，则请求将被传递给下一个中间件。否则，我们将以错误结束请求。</p><p id="e56b" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">让我们创建一个允许获取已登录用户的安全注释的端点。我们将在<code class="fe mw mx my mz b">routes</code>文件夹中保存的新<code class="fe mw mx my mz b">get-user.js</code>文件中执行此操作。</p><p id="8521" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io">功能/快递/路线/get-user.js </strong></p><pre class="kd ke kf kg gt nh mz ni nj aw nk bi"><span id="8416" class="nl lm in mz b gy nm nn l no np">const firestore = require('firebase-admin').firestore();</span><span id="3677" class="nl lm in mz b gy nx nn l no np">async function getUser(req, res) {<br/>  const userId = req.params.id;<br/>  if (!userId) {<br/>    res.status(400).json({ error: { code: 'no-user-id' } });<br/>    return;<br/>  }</span><span id="3ff0" class="nl lm in mz b gy nx nn l no np">  if (userId !== req.token.uid) {<br/>    res<br/>      .status(403)<br/>      .json({ error: { code: 'unauthorized' } });<br/>  }</span><span id="93fa" class="nl lm in mz b gy nx nn l no np">  const snapshot = await firestore<br/>    .collection('users')<br/>    .doc(userId)<br/>    .get();<br/>  if (!snapshot.exists) {<br/>    res<br/>      .status(404)<br/>      .json({ error: { code: 'user-not-found' } });<br/>    return;<br/>  }<br/>  const user = snapshot.data();</span><span id="b8a7" class="nl lm in mz b gy nx nn l no np">  res.status(200).json({ secureNote: user.secureNote });<br/>}</span><span id="1f1c" class="nl lm in mz b gy nx nn l no np">module.exports = getUser;</span></pre><p id="fdac" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">如果未指定使用者，或提出资料要求的使用者不是拥有者，我们就会回应错误。</p><p id="9fa2" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><code class="fe mw mx my mz b">req.token.uid</code>由另一个中间件提供，该中间件在向API发出经过身份验证的请求时验证所发送的令牌。让我们在<code class="fe mw mx my mz b">express/middleware</code>文件夹中的<code class="fe mw mx my mz b">firebase-auth.js</code>文件中创建这个中间件。</p><p id="0b42" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io">功能/表达/中间件/firebase-auth.js </strong></p><pre class="kd ke kf kg gt nh mz ni nj aw nk bi"><span id="3aed" class="nl lm in mz b gy nm nn l no np">const { getAuth } = require('firebase-admin/auth');</span><span id="74f7" class="nl lm in mz b gy nx nn l no np">async function firebaseAuth(req, res, next) {<br/>  const regex = /Bearer (.+)/i;<br/>  try {<br/>    const idToken =<br/>      req.headers['authorization'].match(regex)?.[1];<br/>    req.token = await getAuth().verifyIdToken(idToken);<br/>    next();<br/>  } catch (err) {<br/>    res<br/>      .status(401)<br/>      .json({ error: { code: 'unauthenticated' } });<br/>  }<br/>}</span><span id="74d5" class="nl lm in mz b gy nx nn l no np">module.exports = firebaseAuth;</span></pre><p id="e00c" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我们验证发送的JSON web令牌是否为有效令牌，并将其分配给<code class="fe mw mx my mz b">req.token</code>属性(如果是)。否则，我们发出<code class="fe mw mx my mz b">401</code>错误。</p><p id="b132" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在是时候将所有这些模块整合到一个Express应用程序中了，该应用程序将响应任何对<code class="fe mw mx my mz b">api</code>云功能的请求。将<code class="fe mw mx my mz b">functions</code>文件夹中的<code class="fe mw mx my mz b">index.js</code>文件替换为以下代码:</p><pre class="kd ke kf kg gt nh mz ni nj aw nk bi"><span id="dabf" class="nl lm in mz b gy nm nn l no np">const functions = require('firebase-functions');<br/>const express = require('express');<br/>const admin = require('firebase-admin');<br/>const validateEmailAndPassword = require('./express/middleware/validate-email-and-password');<br/>const firebaseConfig = require('./firebase.config');<br/>const { initializeApp } = require('firebase/app');<br/>const cors = require('cors');<br/>const morgan = require('morgan');<br/>const serviceAccount = require('./service-account-key.json');</span><span id="22fa" class="nl lm in mz b gy nx nn l no np">admin.initializeApp({<br/>  credential: admin.credential.cert(serviceAccount),<br/>});<br/>initializeApp(firebaseConfig);</span><span id="9cae" class="nl lm in mz b gy nx nn l no np">const register = require('./express/routes/register');<br/>const login = require('./express/routes/login');<br/>const firebaseAuth = require('./express/middleware/firebase-auth');<br/>const getUser = require('./express/routes/get-user');</span><span id="cba1" class="nl lm in mz b gy nx nn l no np">const app = express();<br/>app.use(cors());<br/>app.use(morgan('dev'));</span><span id="18f1" class="nl lm in mz b gy nx nn l no np">app.post('/login', validateEmailAndPassword, login);<br/>app.post('/register', validateEmailAndPassword, register);<br/>app.get('/users/:id', firebaseAuth, getUser);</span><span id="a32a" class="nl lm in mz b gy nx nn l no np">exports.api = functions.https.onRequest(app);</span></pre><p id="9383" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">将运行该文件来启动Firebase函数。我们使用了来自<code class="fe mw mx my mz b">firebase-admin</code>模块的<code class="fe mw mx my mz b">initializeApp()</code>方法来初始化Firebase Admin SDK，该SDK带有您应该在前面创建的服务帐户密钥文件。</p><p id="ebcf" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我们还使用了来自<code class="fe mw mx my mz b">firebase/app</code>模块的<code class="fe mw mx my mz b">initalizeApp()</code>方法，用存储在<code class="fe mw mx my mz b">firebase.config.js</code>文件中的配置初始化Firebase Web。当您在Firebase控制台中创建web应用程序时，已经获得了这个配置。</p><p id="35cb" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io">functions/firebase . config . js</strong></p><pre class="kd ke kf kg gt nh mz ni nj aw nk bi"><span id="4fd7" class="nl lm in mz b gy nm nn l no np">/**<br/>  Enter the configuration for your Firebase web app<br/>  module.exports = {<br/>  apiKey: ...,<br/>  authDomain: ...,<br/>  projectId: ...,<br/>  storageBucket: ...,<br/>  messagingSenderId: ...,<br/>  appId: ...,<br/>  measurementId: ...<br/>}; */</span></pre><p id="ec28" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我们现在可以在模拟器中启动Firebase函数，方法是在项目目录中运行以下命令。</p><pre class="kd ke kf kg gt nh mz ni nj aw nk bi"><span id="959f" class="nl lm in mz b gy nm nn l no np">firebase emulators:start --only functions</span></pre><h1 id="874d" class="ll lm in bd ln lo lp lq lr ls lt lu lv jt lw ju lx jw ly jx lz jz ma ka mb mc bi translated">测试API</h1><p id="ef23" class="pw-post-body-paragraph ko kp in kq b kr mf jo kt ku mg jr kw kx mt kz la lb mu ld le lf mv lh li lj ig bi translated">我们还没有编写客户端代码，但是我们可以用像<a class="ae lk" href="https://www.postman.com/" rel="noopener ugc nofollow" target="_blank"> Postman </a>这样的工具测试我们的API，或者我们可以使用Firebase文档中<a class="ae lk" href="https://firebase.google.com/docs/functions/unit-testing" rel="noopener ugc nofollow" target="_blank">这里</a>描述的方法之一。</p><p id="bc92" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">这里我们用Postman测试<code class="fe mw mx my mz b">/register</code>端点:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ny"><img src="../Images/2989392197e0cb23232f4d0708b15fae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*alOBYMk2vkNrPxDV.png"/></div></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk">Testing the “/register” endpoint with Postman</figcaption></figure><h1 id="bf2f" class="ll lm in bd ln lo lp lq lr ls lt lu lv jt lw ju lx jw ly jx lz jz ma ka mb mc bi translated">使用React创建客户端应用程序</h1><p id="4882" class="pw-post-body-paragraph ko kp in kq b kr mf jo kt ku mg jr kw kx mt kz la lb mu ld le lf mv lh li lj ig bi translated">让我们编写将与RESTful API交互的客户端应用程序。使用创建React应用程序创建新的React应用程序。</p><pre class="kd ke kf kg gt nh mz ni nj aw nk bi"><span id="f567" class="nl lm in mz b gy nm nn l no np">npx create-react-app client</span></pre><p id="2d87" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我们将在React应用程序中使用以下NPM包:</p><ul class=""><li id="2b4b" class="md me in kq b kr ks ku kv kx nu lb nv lf nw lj mk ml mm mn bi translated">Material UI ( <code class="fe mw mx my mz b">@mui/material</code>、<code class="fe mw mx my mz b">@emotion/react</code>、<code class="fe mw mx my mz b">@emotion/styled</code>):为我们的客户端UI设计风格，使其更具吸引力。</li><li id="5593" class="md me in kq b kr mo ku mp kx mq lb mr lf ms lj mk ml mm mn bi translated"><code class="fe mw mx my mz b">axios</code>:向我们创建的API发出HTTP请求。</li><li id="b911" class="md me in kq b kr mo ku mp kx mq lb mr lf ms lj mk ml mm mn bi translated"><code class="fe mw mx my mz b">react-router-dom</code>:用于单页app路由。</li><li id="2df9" class="md me in kq b kr mo ku mp kx mq lb mr lf ms lj mk ml mm mn bi translated"><code class="fe mw mx my mz b">react-hook-form</code>:用于更容易的反应形式验证。</li><li id="0b50" class="md me in kq b kr mo ku mp kx mq lb mr lf ms lj mk ml mm mn bi translated"><code class="fe mw mx my mz b">firebase</code>:Firebase Web SDK库。</li><li id="ca7a" class="md me in kq b kr mo ku mp kx mq lb mr lf ms lj mk ml mm mn bi translated"><code class="fe mw mx my mz b">react-firebase-hooks</code>:为Firebase提供一套可重复使用的React挂钩。</li><li id="02e2" class="md me in kq b kr mo ku mp kx mq lb mr lf ms lj mk ml mm mn bi translated"><code class="fe mw mx my mz b">is-email</code>:用于客户端邮件验证。</li></ul><pre class="kd ke kf kg gt nh mz ni nj aw nk bi"><span id="8ebc" class="nl lm in mz b gy nm nn l no np">npm install @mui/material @emotion/react @emotion/styled axios react-router-dom react-hook-form firebase react-firebase-hooks is-email</span></pre><p id="b55b" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">为了完成材质UI的设置，我们将添加Roboto字体，方法是将这个<code class="fe mw mx my mz b">link</code>元素放在我们的<code class="fe mw mx my mz b">client/public/index.html</code>文件的head标签中。</p><pre class="kd ke kf kg gt nh mz ni nj aw nk bi"><span id="4ee6" class="nl lm in mz b gy nm nn l no np">&lt;link<br/>  rel="stylesheet"<br/>  href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700&amp;display=swap"<br/>/&gt;</span></pre><p id="4671" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">使用以下命令在<code class="fe mw mx my mz b">client</code>目录中启动React:</p><pre class="kd ke kf kg gt nh mz ni nj aw nk bi"><span id="34db" class="nl lm in mz b gy nm nn l no np">npm start</span></pre><p id="1255" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">通过在浏览器中打开<code class="fe mw mx my mz b">localhost:3000</code>来测试应用是否已启动并运行。您将在您的<code class="fe mw mx my mz b">client/src/App.js</code>文件中看到标准React.js样板文件的结果。我们稍后将编辑该文件。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi na"><img src="../Images/622f73856672ff8e616a061b1a8c6fb1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*YzdUrl8v4Tix7EUY.png"/></div></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk">Testing the newly created React app</figcaption></figure><p id="50da" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在模拟器中运行的云函数的URL来源与在生产环境中运行的不同。让我们创建一个<code class="fe mw mx my mz b">.env</code>文件来指定不同的原点。您需要指定的值将取决于您为Firebase项目指定的名称。</p><p id="c917" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io">客户/src/。环境</strong></p><pre class="kd ke kf kg gt nh mz ni nj aw nk bi"><span id="80f9" class="nl lm in mz b gy nm nn l no np">REACT_APP_CF_PROD_=https://us-central1-cb-auth-tutorial.cloudfunctions.net<br/>REACT_APP_CF_DEV=http://localhost:5001/cb-auth-tutorial/us-central1</span></pre><p id="71d0" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我们还将创建一个<code class="fe mw mx my mz b">functions-origin.js</code>模块，它将根据我们当前的节点环境提供正确的原点。</p><p id="77d8" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io">client/src/functions-origin . js</strong></p><pre class="kd ke kf kg gt nh mz ni nj aw nk bi"><span id="dd44" class="nl lm in mz b gy nm nn l no np">export const CLOUD_FUNCTIONS_ORIGIN =<br/>  process.env.NODE_ENV === 'development'<br/>    ? process.env.REACT_APP_CF_DEV<br/>    : process.env.REACT_APP_CF_PROD;</span></pre><p id="277c" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">让我们创建一个模块，负责使用<code class="fe mw mx my mz b">axios</code>向我们的RESTful API发出HTTP请求。在一个<code class="fe mw mx my mz b">api-service.js</code>文件中创建这个模块。</p><p id="ae16" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">下面是该模块的代码:</p><p id="4c8b" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io">client/src/API-service . js</strong></p><pre class="kd ke kf kg gt nh mz ni nj aw nk bi"><span id="1b1b" class="nl lm in mz b gy nm nn l no np">import axios from 'axios';<br/>import { CLOUD_FUNCTIONS_ORIGIN } from './functions-origin';</span><span id="5012" class="nl lm in mz b gy nx nn l no np">const apiUrl = `${CLOUD_FUNCTIONS_ORIGIN}/api`;</span><span id="f044" class="nl lm in mz b gy nx nn l no np">export async function signIn({ email, password }) {<br/>  const url = `${apiUrl}/login`;<br/>  const res = await axios.post(url, { email, password });<br/>  return res.data;<br/>}</span><span id="ee30" class="nl lm in mz b gy nx nn l no np">export async function signUp({<br/>  email,<br/>  password,<br/>  secureNote,<br/>}) {<br/>  const url = `${apiUrl}/register`;<br/>  const res = await axios.post(url, {<br/>    email,<br/>    password,<br/>    secureNote,<br/>  });<br/>  return res.data;<br/>}</span><span id="cd96" class="nl lm in mz b gy nx nn l no np">export async function getUserData({ userIdToken, userId }) {<br/>  const url = `${apiUrl}/users/${userId}`;<br/>  const res = await axios.get(url, {<br/>    headers: {<br/>      Authorization: `Bearer ${userIdToken}`,<br/>    },<br/>  });<br/>  return res.data;<br/>}</span></pre><p id="e717" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">之后，我们需要创建一些实用程序来帮助进行身份验证。用下面的代码创建一个新的<code class="fe mw mx my mz b">auth.js</code>文件:</p><p id="9e79" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io">客户端/src/auth.js </strong></p><pre class="kd ke kf kg gt nh mz ni nj aw nk bi"><span id="053f" class="nl lm in mz b gy nm nn l no np">import * as apiService from './api-service';<br/>import { useLocation, Navigate } from 'react-router-dom';<br/>import {<br/>  useEffect,<br/>  createContext,<br/>  useContext,<br/>} from 'react';<br/>import {<br/>  getAuth,<br/>  signInWithCustomToken,<br/>  signOut as firebaseSignOut,<br/>} from 'firebase/auth';<br/>import { useAuthState } from 'react-firebase-hooks/auth';</span><span id="d9a3" class="nl lm in mz b gy nx nn l no np">export function RequireAuth({ children }) {<br/>  let auth = useAuth();<br/>  let location = useLocation();</span><span id="1a6f" class="nl lm in mz b gy nx nn l no np">  useEffect(() =&gt; {}, [auth.loading]);</span><span id="2023" class="nl lm in mz b gy nx nn l no np">  return auth.loading ? undefined : auth.user ? (<br/>    children<br/>  ) : (<br/>    &lt;Navigate<br/>      to="/signin"<br/>      state={{ from: location }}<br/>      replace<br/>    /&gt;<br/>  );<br/>}</span><span id="b57a" class="nl lm in mz b gy nx nn l no np">export const AuthContext = createContext(undefined);</span><span id="3aa2" class="nl lm in mz b gy nx nn l no np">export function useAuth() {<br/>  return useContext(AuthContext);<br/>}</span><span id="9b82" class="nl lm in mz b gy nx nn l no np">export function AuthProvider({ children }) {<br/>  const auth = getAuth();<br/>  const [user, loading] = useAuthState(auth);</span><span id="de13" class="nl lm in mz b gy nx nn l no np">  const signIn = async ({ email, password }) =&gt; {<br/>    const { token } = await apiService.signIn({<br/>      email,<br/>      password,<br/>    });<br/>    await signInWithCustomToken(auth, token);<br/>  };</span><span id="e5c3" class="nl lm in mz b gy nx nn l no np">  const signUp = async ({<br/>    email,<br/>    password,<br/>    secureNote,<br/>  }) =&gt; {<br/>    const { token } = await apiService.signUp({<br/>      email,<br/>      password,<br/>      secureNote,<br/>    });<br/>    await signInWithCustomToken(getAuth(), token);<br/>  };</span><span id="f1c1" class="nl lm in mz b gy nx nn l no np">  const signOut = async () =&gt; {<br/>    const auth = getAuth();<br/>    await firebaseSignOut(auth);<br/>  };</span><span id="3359" class="nl lm in mz b gy nx nn l no np">  const value = { user, loading, signIn, signOut, signUp };</span><span id="cf23" class="nl lm in mz b gy nx nn l no np">  return (<br/>    &lt;AuthContext.Provider value={value}&gt;<br/>      {children}<br/>    &lt;/AuthContext.Provider&gt;<br/>  );<br/>}</span></pre><p id="7d44" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">将route组件包装在<code class="fe mw mx my mz b">RequireAuth</code>组件中可以确保只有经过身份验证的用户才能查看它。如果没有登录，用户将被带到<code class="fe mw mx my mz b">/signin</code>路线，然后在成功登录后被重定向回他们试图查看的路线。</p><p id="dc55" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><code class="fe mw mx my mz b">AuthProvider</code>组件允许其子组件使用React上下文及其提供者访问重要的认证相关数据和方法。<code class="fe mw mx my mz b">useAuth()</code>钩子将用<code class="fe mw mx my mz b">useContext()</code>钩子向子组件提供上下文值。</p><p id="cccd" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><code class="fe mw mx my mz b">signIn()</code>和<code class="fe mw mx my mz b">signUp()</code>方法向API发出请求。如果成功，将从<code class="fe mw mx my mz b">firebase/auth</code>模块接收令牌并传递给<code class="fe mw mx my mz b">signInWithCustomToken()</code>方法，以在浏览器中验证用户。</p><p id="8986" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在是创建注册页面的时候了。用户通过电子邮件、密码和安全提示注册。我们将在新的<code class="fe mw mx my mz b">routes</code>文件夹中的<code class="fe mw mx my mz b">SignUp.jsx</code>文件中执行此操作。</p><p id="81b8" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io">client/src/routes/sign up . jsx</strong></p><pre class="kd ke kf kg gt nh mz ni nj aw nk bi"><span id="1dc7" class="nl lm in mz b gy nm nn l no np">import {<br/>  Box,<br/>  Button,<br/>  LinearProgress,<br/>  TextField,<br/>  Typography,<br/>} from '@mui/material';<br/>import { useState } from 'react';<br/>import { useForm, Controller } from 'react-hook-form';</span><span id="e63f" class="nl lm in mz b gy nx nn l no np">import isEmail from 'is-email';<br/>import { useAuth } from '../auth';<br/>import { useNavigate } from 'react-router-dom';</span><span id="6e09" class="nl lm in mz b gy nx nn l no np">export default function SignUp() {<br/>  const {<br/>    control,<br/>    handleSubmit,<br/>    setError,<br/>    formState: { errors },<br/>  } = useForm();<br/>  const [errorMessage, setErrorMessage] =<br/>    useState(undefined);<br/>  const [isSigningUp, setIsSigningUp] = useState(false);<br/>  const { signUp } = useAuth();<br/>  const navigate = useNavigate();</span><span id="3952" class="nl lm in mz b gy nx nn l no np">  const onSubmit = async (data) =&gt; {<br/>    const { email, password, secureNote } = data;<br/>    setIsSigningUp(true);<br/>    setErrorMessage(undefined);<br/>    try {<br/>      await signUp({ email, password, secureNote });<br/>      navigate('/');<br/>    } catch (error) {<br/>      const res = error.response;<br/>      if (res) {<br/>        const code = res.data?.error?.code;<br/>        if (code === 'email-already-in-use') {<br/>          setError('email', {<br/>            message: 'This email is taken',<br/>          });<br/>          return;<br/>        }<br/>      }<br/>      setErrorMessage("Can't sign up right now");<br/>    } finally {<br/>      setIsSigningUp(false);<br/>    }<br/>  };</span><span id="fc6e" class="nl lm in mz b gy nx nn l no np">  return (<br/>    &lt;Box<br/>      sx={{<br/>        height: '100%',<br/>        display: 'flex',<br/>        justifyContent: 'center',<br/>        alignItems: 'center',<br/>      }}<br/>    &gt;<br/>      &lt;form<br/>        onSubmit={handleSubmit(onSubmit)}<br/>        style={{ display: 'flex', flexDirection: 'column' }}<br/>      &gt;<br/>        &lt;Controller<br/>          control={control}<br/>          name="email"<br/>          rules={{<br/>            required: 'Enter an email',<br/>            validate: {<br/>              validateEmail: (email) =&gt;<br/>                isEmail(email) || 'Enter a valid email',<br/>            },<br/>          }}<br/>          render={({ field }) =&gt; (<br/>            &lt;TextField<br/>              {...field}<br/>              label="Email"<br/>              helperText={errors?.email?.message}<br/>              error={Boolean(errors.email)}<br/>              type="email"<br/>            /&gt;<br/>          )}<br/>        /&gt;<br/>        &lt;Controller<br/>          control={control}<br/>          name="password"<br/>          rules={{ required: 'Enter a password' }}<br/>          render={({ field }) =&gt; (<br/>            &lt;TextField<br/>              label="Password"<br/>              {...field}<br/>              helperText={errors?.password?.message}<br/>              error={Boolean(errors.password)}<br/>              sx={{ marginTop: 2 }}<br/>              type="password"<br/>            /&gt;<br/>          )}<br/>        /&gt;<br/>        &lt;Controller<br/>          control={control}<br/>          name="secureNote"<br/>          rules={{ required: 'Enter a secure note' }}<br/>          render={({ field }) =&gt; (<br/>            &lt;TextField<br/>              {...field}<br/>              label="Secure note"<br/>              helperText={errors?.secureNote?.message}<br/>              error={Boolean(errors?.secureNote)}<br/>              sx={{ marginTop: 2 }}<br/>            /&gt;<br/>          )}<br/>        /&gt;<br/>        &lt;LinearProgress<br/>          variant="indeterminate"<br/>          sx={{<br/>            marginTop: 2,<br/>            visibility: isSigningUp ? 'visible' : 'hidden',<br/>          }}<br/>        /&gt;<br/>        &lt;Button<br/>          variant="contained"<br/>          type="submit"<br/>          sx={{ marginTop: 2 }}<br/>        &gt;<br/>          Sign up<br/>        &lt;/Button&gt;<br/>        &lt;Box sx={{ marginTop: 2, textAlign: 'center' }}&gt;<br/>          &lt;Typography<br/>            sx={{<br/>              visibility: errorMessage<br/>                ? 'visible'<br/>                : 'hidden',<br/>            }}<br/>            color="error"<br/>          &gt;<br/>            {errorMessage}<br/>          &lt;/Typography&gt;<br/>        &lt;/Box&gt;<br/>      &lt;/form&gt;<br/>    &lt;/Box&gt;<br/>  );<br/>}</span></pre><p id="96ef" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我们使用来自<code class="fe mw mx my mz b">react-hook-form</code>的<code class="fe mw mx my mz b">Controller</code>组件向<code class="fe mw mx my mz b">react-hook-form</code>注册材质UI TextField组件。我们使用<code class="fe mw mx my mz b">Controller</code> <code class="fe mw mx my mz b">rules</code>属性设置验证规则，以确保用户输入有效的电子邮件、密码和安全注释。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/2ece5153d7a13d70d5b8bad48f89bcf3.png" data-original-src="https://miro.medium.com/v2/resize:fit:652/format:webp/0*pRNeDf8nonMu_LqE.png"/></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk">Form validation on the sign-up page</figcaption></figure><p id="3dbe" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><code class="fe mw mx my mz b">react-hook-form</code>确保<code class="fe mw mx my mz b">onSubmit()</code>函数仅在满足所有验证规则时被调用。在这个函数中，我们用之前创建的<code class="fe mw mx my mz b">useAuth()</code>钩子中的<code class="fe mw mx my mz b">signUp()</code>方法注册用户。如果成功，我们把用户带到索引路线(<code class="fe mw mx my mz b">/</code>)。否则，我们会显示适当的错误消息。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi oa"><img src="../Images/e89eb5cf6b7694652fe020238dbeee0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:654/format:webp/0*bwIvymF_Fv1bJK63.png"/></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk">Displaying an error message after receiving an API response</figcaption></figure><p id="f035" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">让我们在同一个<code class="fe mw mx my mz b">routes</code>文件夹中的<code class="fe mw mx my mz b">SignIn.jsx</code>文件中创建登录页面。</p><p id="c578" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io">client/src/routes/sign in . jsx</strong></p><pre class="kd ke kf kg gt nh mz ni nj aw nk bi"><span id="4b56" class="nl lm in mz b gy nm nn l no np">import {<br/>  Box,<br/>  Button,<br/>  LinearProgress,<br/>  TextField,<br/>  Typography,<br/>} from '@mui/material';<br/>import { useState } from 'react';<br/>import { useForm, Controller } from 'react-hook-form';<br/>import isEmail from 'is-email';<br/>import { useNavigate } from 'react-router-dom';<br/>import { useAuth } from '../auth';</span><span id="5eeb" class="nl lm in mz b gy nx nn l no np">export default function SignIn() {<br/>  const {<br/>    control,<br/>    handleSubmit,<br/>    setError,<br/>    formState: { errors },<br/>  } = useForm();<br/>  const [errorMessage, setErrorMessage] =<br/>    useState(undefined);<br/>  const navigate = useNavigate();<br/>  const { signIn } = useAuth();</span><span id="d672" class="nl lm in mz b gy nx nn l no np">  const onSubmit = async (data) =&gt; {<br/>    const { email, password } = data;<br/>    setIsSigningIn(true);<br/>    setErrorMessage(undefined);<br/>    try {<br/>      await signIn({ email, password });<br/>      navigate('/');<br/>    } catch (error) {<br/>      const res = error.response;<br/>      if (res) {<br/>        const code = res.data?.error?.code;<br/>        if (code === 'user-not-found') {<br/>          setError('email', {<br/>            message: 'No user has this email',<br/>          });<br/>          return;<br/>        }<br/>        if (code === 'wrong-password') {<br/>          setError('password', {<br/>            message: 'Wrong password',<br/>          });<br/>          return;<br/>        }<br/>      }<br/>      setErrorMessage("Can't sign in right now");<br/>    } finally {<br/>      setIsSigningIn(false);<br/>    }<br/>  };</span><span id="47d4" class="nl lm in mz b gy nx nn l no np">  const [isSigningIn, setIsSigningIn] = useState(false);</span><span id="d16b" class="nl lm in mz b gy nx nn l no np">  return (<br/>    &lt;Box<br/>      sx={{<br/>        display: 'flex',<br/>        justifyContent: 'center',<br/>        alignItems: 'center',<br/>        height: '100%',<br/>      }}<br/>    &gt;<br/>      &lt;form<br/>        onSubmit={handleSubmit(onSubmit)}<br/>        style={{<br/>          display: 'flex',<br/>          flexDirection: 'column',<br/>        }}<br/>      &gt;<br/>        &lt;Controller<br/>          control={control}<br/>          name="email"<br/>          rules={{<br/>            required: 'Enter an email',<br/>            validate: {<br/>              validateEmail: (email) =&gt;<br/>                isEmail(email) || 'Enter a valid email',<br/>            },<br/>          }}<br/>          render={({ field }) =&gt; (<br/>            &lt;TextField<br/>              label="Email"<br/>              {...field}<br/>              helperText={errors.email?.message}<br/>              error={Boolean(errors.email)}<br/>              type="email"<br/>            /&gt;<br/>          )}<br/>        /&gt;<br/>        &lt;Controller<br/>          control={control}<br/>          name="password"<br/>          rules={{ required: 'Enter a password' }}<br/>          render={({ field }) =&gt; (<br/>            &lt;TextField<br/>              label="Password"<br/>              {...field}<br/>              helperText={errors.password?.message}<br/>              error={Boolean(errors.password)}<br/>              sx={{ marginTop: 2 }}<br/>              type="password"<br/>            /&gt;<br/>          )}<br/>        /&gt;<br/>        &lt;LinearProgress<br/>          variant="indeterminate"<br/>          sx={{<br/>            visibility: isSigningIn ? 'visible' : 'hidden',<br/>            marginTop: 2,<br/>          }}<br/>        /&gt;<br/>        &lt;Button<br/>          variant="contained"<br/>          type="submit"<br/>          sx={{ marginTop: 2 }}<br/>        &gt;<br/>          Sign in<br/>        &lt;/Button&gt;<br/>        &lt;Box<br/>          sx={{<br/>            marginTop: 2,<br/>            textAlign: 'center',<br/>          }}<br/>        &gt;<br/>          &lt;Typography<br/>            sx={{<br/>              visibility: errorMessage<br/>                ? 'visible'<br/>                : 'hidden',<br/>            }}<br/>            color="error"<br/>          &gt;<br/>            {errorMessage}<br/>          &lt;/Typography&gt;<br/>        &lt;/Box&gt;<br/>      &lt;/form&gt;<br/>    &lt;/Box&gt;<br/>  );<br/>}</span></pre><p id="0295" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">与在<code class="fe mw mx my mz b">SignUp</code>组件中不同，这里我们使用来自<code class="fe mw mx my mz b">useAuth()</code>钩子的<code class="fe mw mx my mz b">signIn()</code>方法让用户登录。</p><p id="5746" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我们在这里处理的HTTP错误与我们在<code class="fe mw mx my mz b">SignUp</code>中处理的不同。在<code class="fe mw mx my mz b">SignUp</code>中，如果用户试图注册的电子邮件已经被使用，我们会显示一个错误。但是这里我们显示一个不存在的电子邮件或一个错误的密码的错误。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/acd6d117d41fee02fc3e14ab69574731.png" data-original-src="https://miro.medium.com/v2/resize:fit:652/format:webp/0*yZTXhkiOg6ZvU4is.png"/></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk">Displaying an error message for a wrong password after receiving an API response</figcaption></figure><p id="b663" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在让我们创建将为我们的索引路由显示的组件。用以下内容替换<code class="fe mw mx my mz b">App.js</code>的内容:</p><p id="1b09" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io"> client/src/App.js </strong></p><pre class="kd ke kf kg gt nh mz ni nj aw nk bi"><span id="fcbd" class="nl lm in mz b gy nm nn l no np">import logo from './logo.svg';<br/>import './App.css';<br/>import { useAuth } from './auth';<br/>import { useEffect, useRef, useState } from 'react';<br/>import { Button, Typography, Box } from '@mui/material';<br/>import { Link } from 'react-router-dom';<br/>import * as apiService from './api-service';</span><span id="7471" class="nl lm in mz b gy nx nn l no np">function App() {<br/>  const { user, loading } = useAuth();<br/>  const [dataState, setDataState] = useState(undefined);<br/>  const secureNoteRef = useRef(undefined);</span><span id="a30e" class="nl lm in mz b gy nx nn l no np">  useEffect(() =&gt; {<br/>    (async () =&gt; {<br/>      if (!loading) {<br/>        if (user) {<br/>          setDataState('loading');<br/>          const userIdToken = await user.getIdToken();<br/>          try {<br/>            const { secureNote } =<br/>              await apiService.getUserData({<br/>                userIdToken,<br/>                userId: user.uid,<br/>              });<br/>            secureNoteRef.current = secureNote;<br/>            setDataState('success');<br/>          } catch {<br/>            setDataState('error');<br/>          }<br/>        }<br/>      }<br/>    })();<br/>  }, [user, loading]);</span><span id="c9e5" class="nl lm in mz b gy nx nn l no np">  const child = loading ? (<br/>    &lt;&gt;&lt;/&gt;<br/>  ) : user ? (<br/>    dataState === 'loading' ? (<br/>      &lt;Typography&gt;Getting your data...&lt;/Typography&gt;<br/>    ) : dataState === 'error' ? (<br/>      &lt;Typography&gt;An error occured.&lt;/Typography&gt;<br/>    ) : dataState === 'success' ? (<br/>      &lt;div&gt;<br/>        &lt;Typography variant="h6"&gt;Secure note&lt;/Typography&gt;<br/>        &lt;Typography&gt;{secureNoteRef.current}&lt;/Typography&gt;<br/>      &lt;/div&gt;<br/>    ) : undefined<br/>  ) : (<br/>    &lt;div&gt;<br/>      &lt;Typography&gt;You're not signed in&lt;/Typography&gt;<br/>      &lt;Box<br/>        sx={{<br/>          marginTop: 2,<br/>        }}<br/>      &gt;<br/>        &lt;Button LinkComponent={Link} to="/signin"&gt;<br/>          Sign in<br/>        &lt;/Button&gt;<br/>        &lt;Button<br/>          LinkComponent={Link}<br/>          to="/signup"<br/>          sx={{ marginLeft: 2 }}<br/>        &gt;<br/>          Sign up<br/>        &lt;/Button&gt;<br/>      &lt;/Box&gt;<br/>    &lt;/div&gt;<br/>  );<br/>  return (<br/>    &lt;div<br/>      style={{<br/>        display: 'flex',<br/>        justifyContent: 'center',<br/>        alignItems: 'center',<br/>        height: '100%',<br/>      }}<br/>    &gt;<br/>      {child}<br/>    &lt;/div&gt;<br/>  );<br/>}</span><span id="dce8" class="nl lm in mz b gy nx nn l no np">export default App;</span></pre><p id="1234" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">如果用户没有通过认证，我们会让他们知道他们没有登录，并包含相关链接。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/9ec6c65fc609740be383dc0463e300da.png" data-original-src="https://miro.medium.com/v2/resize:fit:578/format:webp/0*kEW7C9l0GC0Dfbd7.png"/></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk">The view displayed to a user that is yet to be authenticated</figcaption></figure><p id="5b13" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">如果他们已经登录，我们向API发出请求以获取安全注释并显示它。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/73b981414989de79ac5d59e85d2888e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:578/format:webp/0*5wExCsIB1z6uGXD2.png"/></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk">Displaying the private secure note to the user</figcaption></figure><p id="6d00" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我们使用了一个<code class="fe mw mx my mz b">dataState</code>变量来跟踪API请求的当前状态，并基于此向用户显示适当的视图。</p><p id="785b" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我们在发出请求之前将<code class="fe mw mx my mz b">dataState</code>设置为<code class="fe mw mx my mz b">loading</code>，让用户知道他们的数据正在被检索。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/445d9f069b56177cf4341f8b27ad0ae7.png" data-original-src="https://miro.medium.com/v2/resize:fit:578/format:webp/0*2ZZ5Ztgz3dP4_lsS.png"/></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk">The view displayed when “dataState” is “loading”</figcaption></figure><p id="48d5" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">如果在此过程中出现错误，我们通过将<code class="fe mw mx my mz b">dataState</code>设置为<code class="fe mw mx my mz b">error</code>让他们知道:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/956783b1668cfd4470a28df6ecac8f9e.png" data-original-src="https://miro.medium.com/v2/resize:fit:578/format:webp/0*ZSd1_KP7M872xSQ1.png"/></div><figcaption class="nb nc gj gh gi nd ne bd b be z dk">The view displayed when “dataState” is “error”</figcaption></figure><p id="c67b" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">最后，让我们初始化Firebase，并在我们的<code class="fe mw mx my mz b">index.js</code>文件中设置路由逻辑。</p><p id="d2b2" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io"> client/src/index.js </strong></p><pre class="kd ke kf kg gt nh mz ni nj aw nk bi"><span id="a53d" class="nl lm in mz b gy nm nn l no np">import React from 'react';<br/>import ReactDOM from 'react-dom/client';<br/>import './index.css';<br/>import App from './App';<br/>import reportWebVitals from './reportWebVitals';<br/>import {<br/>  BrowserRouter,<br/>  Route,<br/>  Routes,<br/>} from 'react-router-dom';<br/>import SignIn from './routes/SignIn';<br/>import { AuthProvider } from './auth';<br/>import { initializeApp } from 'firebase/app';<br/>import firebaseConfig from './firebase.config';<br/>import SignUp from './routes/SignUp';</span><span id="658f" class="nl lm in mz b gy nx nn l no np">initializeApp(firebaseConfig);</span><span id="160e" class="nl lm in mz b gy nx nn l no np">const root = ReactDOM.createRoot(<br/>  document.getElementById('root')<br/>);<br/>root.render(<br/>  &lt;React.StrictMode&gt;<br/>    &lt;AuthProvider&gt;<br/>      &lt;BrowserRouter&gt;<br/>        &lt;Routes&gt;<br/>          &lt;Route path="/" element={&lt;App /&gt;} /&gt;<br/>          &lt;Route path="/signin" element={&lt;SignIn /&gt;} /&gt;<br/>          &lt;Route path="/signup" element={&lt;SignUp /&gt;} /&gt;<br/>        &lt;/Routes&gt;<br/>      &lt;/BrowserRouter&gt;<br/>    &lt;/AuthProvider&gt;<br/>  &lt;/React.StrictMode&gt;<br/>);</span><span id="4c14" class="nl lm in mz b gy nx nn l no np">reportWebVitals();</span></pre><p id="0144" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在您的<code class="fe mw mx my mz b">src</code>目录中应该有一个<code class="fe mw mx my mz b">firebase.config.js</code>文件，它包含您在Firebase控制台中设置web应用程序时收到的配置。这与我们在编写API时在管理环境中初始化Web SDK时使用的配置相同。</p><p id="ee47" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io">client/src/firebase . config . js</strong></p><pre class="kd ke kf kg gt nh mz ni nj aw nk bi"><span id="3b52" class="nl lm in mz b gy nm nn l no np">/**<br/>  Enter the configuration for your Firebase web app<br/>  module.exports = {<br/>  apiKey: ...,<br/>  authDomain: ...,<br/>  projectId: ...,<br/>  storageBucket: ...,<br/>  messagingSenderId: ...,<br/>  appId: ...,<br/>  measurementId: ...<br/>}; */</span></pre><p id="790d" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">该应用程序现在应该功能齐全！</p><h1 id="d197" class="ll lm in bd ln lo lp lq lr ls lt lu lv jt lw ju lx jw ly jx lz jz ma ka mb mc bi translated">结论</h1><p id="e8d0" class="pw-post-body-paragraph ko kp in kq b kr mf jo kt ku mg jr kw kx mt kz la lb mu ld le lf mv lh li lj ig bi translated">在本文中，我们学习了如何使用Firebase在web应用程序中轻松设置身份验证。我们使用Node.js和Express框架创建了一个RESTful API，以处理来自客户端应用程序的请求，该客户端应用程序是使用React.js和Material UI构建的。</p><p id="05a2" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><em class="oc">更新于:</em><a class="ae lk" href="https://cbdev.link/ed7145" rel="noopener ugc nofollow" target="_blank"><em class="oc">【codingbeautydev.com】</em>T5】</a></p></div><div class="ab cl od oe hr of" role="separator"><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi oj"/><span class="og bw bk oh oi"/></div><div class="ig ih ii ij ik"><h1 id="ef1b" class="ll lm in bd ln lo ok lq lr ls ol lu lv jt om ju lx jw on jx lz jz oo ka mb mc bi translated">JavaScript做的每一件疯狂的事情</h1><p id="9a76" class="pw-post-body-paragraph ko kp in kq b kr mf jo kt ku mg jr kw kx mt kz la lb mu ld le lf mv lh li lj ig bi translated">一本关于JavaScript微妙的警告和鲜为人知的部分的迷人指南。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi op"><img src="../Images/143ee152ba78025ea8643ba5b9726a20.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*YS5Oub8REWy8vnOEqBnsyQ.png"/></div></figure><p id="7d6e" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><a class="ae lk" href="https://cbdev.link/d3c4eb" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io">报名</strong> </a>立即免费领取一份。</p></div></div>    
</body>
</html>