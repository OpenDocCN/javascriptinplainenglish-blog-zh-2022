<html>
<head>
<title>How to Use Embedded JavaScript (EJS) as a Template Engine in Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Node.js中使用嵌入式JavaScript (EJS)作为模板引擎</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-use-embedded-javascript-ejs-as-a-template-engine-in-nodejs-full-explanation-80f0d3b92fed?source=collection_archive---------4-----------------------#2022-09-20">https://javascript.plainenglish.io/how-to-use-embedded-javascript-ejs-as-a-template-engine-in-nodejs-full-explanation-80f0d3b92fed?source=collection_archive---------4-----------------------#2022-09-20</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="9db2" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">什么是模板引擎？模板引擎是一种使您能够在应用程序中使用静态模板文件的机制。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/2897790f0765b3ac185fd26075ebf93a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*lRZWKh1bpgty_22JGb1Vxw.jpeg"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo By Joan Gamell on Unsplash</figcaption></figure><p id="621c" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">在我们开始之前，让我们了解什么是模板引擎。</p><p id="8bcd" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">模板引擎是一种使您能够在应用程序中使用静态模板文件的机制。它将web模板文件中的变量替换为实际值(在运行时)，然后将模板转换为HTML文件，并与动态数据一起发送给客户端。</p><p id="38f2" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">所以我们可以说，它帮助我们创建动态HTML内容！</p><p id="9546" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">在本文中，我将向您展示如何使用EJS作为Node.js应用程序的模板引擎。我还将使用MDB的CDN链接作为我们的CSS框架。</p><h1 id="c44f" class="lo lp in bd lq lr ls lt lu lv lw lx ly jt lz ju ma jw mb jx mc jz md ka me mf bi translated">安装快速和EJS</h1><p id="e9b1" class="pw-post-body-paragraph ks kt in ku b kv mg jo kx ky mh jr la lb mi ld le lf mj lh li lj mk ll lm ln ig bi translated">首先，创建一个文件夹(想怎么命名就怎么命名)，然后创建一个<code class="fe ml mm mn mo b">index.js</code>文件。</p><p id="5f62" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">现在你需要通过终端安装<code class="fe ml mm mn mo b">express</code>:</p><pre class="kd ke kf kg gt mp mo mq mr aw ms bi"><span id="41c6" class="mt lp in mo b gy mu mv l mw mx">$ npm install express</span></pre><p id="7e8e" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">一旦安装了Express，安装<code class="fe ml mm mn mo b">ejs</code>，这是我们的模板引擎:</p><pre class="kd ke kf kg gt mp mo mq mr aw ms bi"><span id="c0fe" class="mt lp in mo b gy mu mv l mw mx">$ npm install ejs</span></pre><p id="f3aa" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">现在你的文件夹结构应该看起来像下面的图片:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi my"><img src="../Images/2455beb05781698dc0e927f2896af632.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/0*nWHx29Pzwc5XCvTF.png"/></div></figure><h1 id="5e50" class="lo lp in bd lq lr ls lt lu lv lw lx ly jt lz ju ma jw mb jx mc jz md ka me mf bi translated">设置您的应用</h1><p id="821a" class="pw-post-body-paragraph ks kt in ku b kv mg jo kx ky mh jr la lb mi ld le lf mj lh li lj mk ll lm ln ig bi translated">我们需要导入<code class="fe ml mm mn mo b">express</code> &amp; <code class="fe ml mm mn mo b">ejs</code>，然后配置我们的应用程序使用快速功能。</p><p id="9fb1" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">在您的<code class="fe ml mm mn mo b">index.js</code>文件中，键入以下代码:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="566e" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">现在我们需要创建一个<code class="fe ml mm mn mo b">pages</code>文件夹来存储我们的HTML页面。这个文件夹将有一个名为<code class="fe ml mm mn mo b">layouts</code>的子文件夹，它将存储我们的HTML页面的子部分，如导航栏和页脚。</p><p id="8d0b" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">一旦你创建了<code class="fe ml mm mn mo b">pages</code>文件夹，创建一个文件并命名为<code class="fe ml mm mn mo b">home.ejs</code>。该文件将成为我们主页的模板:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi my"><img src="../Images/e7dec8ef37ce33c2ec8ad86ea0102861.png" data-original-src="https://miro.medium.com/v2/resize:fit:790/format:webp/0*dKg8F87TGcjnlL7Z.png"/></div></figure><p id="dc23" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">现在我们需要告诉express使用<code class="fe ml mm mn mo b">ejs</code>作为我们的模板引擎(视图引擎),因为我们的<code class="fe ml mm mn mo b">views</code>目录将会不同，我们将告诉express使用<code class="fe ml mm mn mo b">./pages</code>文件夹作为我们的<code class="fe ml mm mn mo b">views</code>目录。</p><p id="b76d" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated"><em class="nb"/><code class="fe ml mm mn mo b"><em class="nb">views</em></code><em class="nb">目录是存储您所有模板文件的目录。</em></p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="c505" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">让我们创建一个简单的HTML页面，欢迎我们进入应用程序的主页。</p><p id="47b8" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">复制下面的HTML并粘贴到<code class="fe ml mm mn mo b">pages/home.ejs</code>文件中，这是我们主页的模板:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mz na l"/></div></figure><h1 id="4ef3" class="lo lp in bd lq lr ls lt lu lv lw lx ly jt lz ju ma jw mb jx mc jz md ka me mf bi translated">创建路线</h1><p id="8d03" class="pw-post-body-paragraph ks kt in ku b kv mg jo kx ky mh jr la lb mi ld le lf mj lh li lj mk ll lm ln ig bi translated">在<code class="fe ml mm mn mo b">index.js</code>文件中，我们将创建一个到主页的路径，并呈现负责主页的HTML模板。</p><p id="17ea" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">我将使用<code class="fe ml mm mn mo b">render</code>方法来渲染负责主页的模板。</p><p id="49d1" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">该方法接受两个参数，它们是:</p><ul class=""><li id="1b5d" class="nc nd in ku b kv kw ky kz lb ne lf nf lj ng ln nh ni nj nk bi translated">我们试图呈现的HTML页面的文件名</li><li id="d8c0" class="nc nd in ku b kv nl ky nm lb nn lf no lj np ln nh ni nj nk bi translated">我们希望发送到页面数据</li></ul><p id="43cf" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">确保您试图渲染的文件存在于视图目录中，即<code class="fe ml mm mn mo b">/pages</code>文件夹</p><p id="9107" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">因为我想在用户导航到我们网站的根目录时将文件<code class="fe ml mm mn mo b">home.ejs</code>呈现为主页，所以我会这样做</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="269d" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">注意，我们没有在render方法中提供<code class="fe ml mm mn mo b">home.ejs</code>文件的扩展名。</p><p id="3198" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">现在，在我们启动我们的应用程序之前，我们需要让它监听所提供的端口号。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="41ae" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">下面是<code class="fe ml mm mn mo b">index.js</code>的完整代码:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mz na l"/></div></figure><h1 id="cdfd" class="lo lp in bd lq lr ls lt lu lv lw lx ly jt lz ju ma jw mb jx mc jz md ka me mf bi translated">启动您的应用程序</h1><p id="7c98" class="pw-post-body-paragraph ks kt in ku b kv mg jo kx ky mh jr la lb mi ld le lf mj lh li lj mk ll lm ln ig bi translated">使用终端，启动您的应用程序:</p><pre class="kd ke kf kg gt mp mo mq mr aw ms bi"><span id="d49a" class="mt lp in mo b gy mu mv l mw mx">$ node index.js</span></pre><p id="9a8f" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">然后在你的浏览器上访问这个网址<code class="fe ml mm mn mo b">localhost:5000</code></p><p id="5007" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">如果您正确地遵循了这些步骤，您应该会看到欢迎页面:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nq"><img src="../Images/87569c0b1050822404dfaff5d701938e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/format:webp/0*nK9CnuE9mlcI-AGY.png"/></div></div></figure><p id="3b7d" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">如果你已经到了这一步，这里有一轮掌声，因为你即将理解<code class="fe ml mm mn mo b">ejs</code>是如何工作的。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/62faab1ee6cf0e1dd3ae61d0c29510f8.png" data-original-src="https://miro.medium.com/v2/resize:fit:996/0*kAn6K99tXVnnrnAK.gif"/></div></figure><h1 id="c15b" class="lo lp in bd lq lr ls lt lu lv lw lx ly jt lz ju ma jw mb jx mc jz md ka me mf bi translated">创建页面布局</h1><p id="e31c" class="pw-post-body-paragraph ks kt in ku b kv mg jo kx ky mh jr la lb mi ld le lf mj lh li lj mk ll lm ln ig bi translated">现在我们需要为所有页面创建3个布局。这些布局将存在于<code class="fe ml mm mn mo b">./pages/layouts/</code>目录下的不同文件中</p><p id="7177" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">因此，在这个目录<code class="fe ml mm mn mo b">./pages/layouts/</code>中，创建一个<code class="fe ml mm mn mo b">head.ejs</code>文件并添加下面的代码:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="88de" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">仅仅看一下上面的代码，你就应该知道它是放在网页的<code class="fe ml mm mn mo b">head</code>标签里面的内容。</p><p id="6ea4" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">仍然在<code class="fe ml mm mn mo b">./pages/layouts/</code>目录中，创建一个<code class="fe ml mm mn mo b">navbar.ejs</code>文件并添加以下代码:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="2bb6" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">最后，在同一个目录中创建一个<code class="fe ml mm mn mo b">footer.ejs</code>文件，然后添加下面的代码:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="5e80" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">目前，我们的主页，也就是<code class="fe ml mm mn mo b">home.ejs</code>文件没有吸引力。</p><p id="d5d1" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">让我们包括布局；使用ejs的页眉、导航栏和页脚。</p><p id="94bf" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">要在页面中包含布局，请将下面的代码放在希望布局呈现的任何位置:</p><pre class="kd ke kf kg gt mp mo mq mr aw ms bi"><span id="c8f8" class="mt lp in mo b gy mu mv l mw mx">&lt;%- include('PATH_TO_LAYOUT') %&gt;</span></pre><p id="f8ba" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">这意味着无论您将代码放在哪里，它都将导入指定的布局并在那里呈现。</p><p id="61b2" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">这也意味着您对布局所做的任何更改都会影响包含它的任何页面。</p><p id="f787" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">所以在<code class="fe ml mm mn mo b">home.ejs</code>文件中，我会做这样的事情:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="8182" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">为了确保我们在同一页上，这是我的文件夹结构。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi ns"><img src="../Images/0995e4754fef084bcee729beaf143755.png" data-original-src="https://miro.medium.com/v2/resize:fit:666/format:webp/0*B9zC9hv5pFVyTxhi.png"/></div></figure><p id="5322" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">现在让我们重新加载我们的浏览器并检查到目前为止的进度:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nt"><img src="../Images/7df442151cef5844835831ff942cce26.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*WzJ7cqJqyV51TVxL.png"/></div></div></figure><p id="b055" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">你可以证明，用最少的代码，我们仍然能够生成一个完整的主页。</p><p id="b82f" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">让我们继续前进！</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/348be69545e742e130474263aaa24b0e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/0*eYtdlM2_deCBaOtr.jpg"/></div></figure><h1 id="c873" class="lo lp in bd lq lr ls lt lu lv lw lx ly jt lz ju ma jw mb jx mc jz md ka me mf bi translated">编写动态HTML</h1><p id="1fff" class="pw-post-body-paragraph ks kt in ku b kv mg jo kx ky mh jr la lb mi ld le lf mj lh li lj mk ll lm ln ig bi translated">现在，我们准备将数据从后端发送到前端。</p><p id="8b08" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">让我们创建一个呈现<code class="fe ml mm mn mo b">fruits</code>页面的路径。该页面还将从后端接收水果进行显示。</p><p id="e2bd" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">回想一下，<code class="fe ml mm mn mo b">render</code>方法接受两个参数，它们是:</p><ul class=""><li id="0c14" class="nc nd in ku b kv kw ky kz lb ne lf nf lj ng ln nh ni nj nk bi translated">我们试图呈现的HTML页面的文件名</li><li id="4a8b" class="nc nd in ku b kv nl ky nm lb nn lf no lj np ln nh ni nj nk bi translated">我们希望发送到页面数据</li></ul><p id="c5e5" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">所以在我的例子中，我希望将水果数组作为数据发送到页面。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="2791" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">现在在<code class="fe ml mm mn mo b">./pages/</code>目录下创建一个新的<code class="fe ml mm mn mo b">fruits.ejs</code>模板，然后添加下面的代码:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mz na l"/></div></figure><h1 id="3c85" class="lo lp in bd lq lr ls lt lu lv lw lx ly jt lz ju ma jw mb jx mc jz md ka me mf bi translated">是解释的时候了</h1><p id="dca2" class="pw-post-body-paragraph ks kt in ku b kv mg jo kx ky mh jr la lb mi ld le lf mj lh li lj mk ll lm ln ig bi translated">如果您查看上面的代码片段，您会注意到这段代码<code class="fe ml mm mn mo b">&lt;%= fruitsAry.length %&gt;</code>类似于用来包含布局的代码。</p><p id="fd89" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">除了这个允许我们直接访问和打印渲染数据。</p><p id="98d3" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">所以我下面有一个小语法来演示它是如何工作的:</p><ul class=""><li id="d552" class="nc nd in ku b kv kw ky kz lb ne lf nf lj ng ln nh ni nj nk bi translated">如果您想执行代码或访问呈现的数据而不将其打印出来，请执行以下操作:</li></ul><pre class="kd ke kf kg gt mp mo mq mr aw ms bi"><span id="2e1b" class="mt lp in mo b gy mu mv l mw mx">&lt;% CODE_TO_EXECUTE %&gt;</span></pre><ul class=""><li id="82db" class="nc nd in ku b kv kw ky kz lb ne lf nf lj ng ln nh ni nj nk bi translated">但是，如果您想执行代码或访问呈现的数据&amp;并将其打印出来，请执行以下操作:</li></ul><pre class="kd ke kf kg gt mp mo mq mr aw ms bi"><span id="6de1" class="mt lp in mo b gy mu mv l mw mx">&lt;%= CODE_TO_EXECUTE %&gt;<br/>//or<br/>&lt;%- CODE_TO_EXECUTE %&gt;</span></pre><ul class=""><li id="6bff" class="nc nd in ku b kv kw ky kz lb ne lf nf lj ng ln nh ni nj nk bi translated">不要忘记在页面上包含布局的语法:</li></ul><pre class="kd ke kf kg gt mp mo mq mr aw ms bi"><span id="f2f8" class="mt lp in mo b gy mu mv l mw mx">&lt;%- include("PATH_TO_LAYOUT") %&gt;</span></pre><p id="1985" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">有了这个<code class="fe ml mm mn mo b">&lt;% for(let i=0; i &lt; fruitsAry.length; i++){ ... }%&gt;</code>，我们能够嵌入JavaScript代码(这就是为什么它被称为嵌入式JavaScript，对吗？)使用一个<code class="fe ml mm mn mo b">for loop</code>遍历从后端发送的水果数组，然后为数组中的每个水果创建一个列表项。</p><p id="ca89" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">重启服务器，然后在浏览器上访问该URL<code class="fe ml mm mn mo b">localhost:5000/fruits</code></p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nv"><img src="../Images/ed7707a923b2c2f713b437ffc3bbb8ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*KnA8aw0XgBtudzNv.png"/></div></div></figure><p id="ba2d" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">太神奇了…对吧？</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi nw"><img src="../Images/106dda903c1f445b22f19571b4832a3d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/0*JUQZ-pWGmK3oVLtH.jpg"/></div></figure><h1 id="14c5" class="lo lp in bd lq lr ls lt lu lv lw lx ly jt lz ju ma jw mb jx mc jz md ka me mf bi translated">让我们写一个条件语句</h1><p id="cb68" class="pw-post-body-paragraph ks kt in ku b kv mg jo kx ky mh jr la lb mi ld le lf mj lh li lj mk ll lm ln ig bi translated">就像我上面解释的将JavaScript直接嵌入模板文件一样，也可以在这个文件中编写条件语句。</p><p id="fa77" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">比方说，我有一个变量<code class="fe ml mm mn mo b">loggedIn</code>来检查用户是否登录了我们的应用程序，也就是说，如果用户登录了，这个变量的值将是<code class="fe ml mm mn mo b">true</code>，如果用户没有登录，这个值将是<code class="fe ml mm mn mo b">false</code>。</p><p id="0173" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">现在我想使用这个变量有条件地在我的导航栏上显示两个链接中的一个，它们是<code class="fe ml mm mn mo b">login</code>和<code class="fe ml mm mn mo b">logout</code>。如果用户未登录，您将在导航栏上看到<code class="fe ml mm mn mo b">login</code>，如果用户已登录，您将看到<code class="fe ml mm mn mo b">logout</code>。</p><p id="d4e9" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">在<code class="fe ml mm mn mo b">./layouts/navbar</code>文件中，将下面的代码添加到水果的导航项之后。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="33fd" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">现在，我们需要修改我们的服务器文件<code class="fe ml mm mn mo b">./index.js</code>并将变量<code class="fe ml mm mn mo b">loggedIn</code>添加到全局空间，以便它可以被我们应用程序中的所有页面访问。</p><p id="29ce" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">就在到主页的路径之前，添加以下代码</p><pre class="kd ke kf kg gt mp mo mq mr aw ms bi"><span id="b5dc" class="mt lp in mo b gy mu mv l mw mx">//make variable globally accessible<br/>global.loggedIn = false //default value is false</span></pre><p id="e5c6" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">现在让我们为登录和注销页面创建路由。如果您点击登录，它会将全局变量设置为<code class="fe ml mm mn mo b">true</code>，如果您点击注销，它会将全局变量设置为<code class="fe ml mm mn mo b">false</code></p><p id="095c" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">就在到<code class="fe ml mm mn mo b">fruits</code>页面的路线之后，添加以下代码</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="cee0" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">现在让我们重新加载服务器并进行测试。</p><p id="79a5" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">这是当我点击登录链接时在我的导航栏上发生的事情</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nx"><img src="../Images/ca69f009f9155f36e4d005e1a92d88b6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6sIm-u1dkIJ6qyVr.png"/></div></div></figure><p id="867f" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">你会在导航栏上看到<code class="fe ml mm mn mo b">logout</code>链接，而不是<code class="fe ml mm mn mo b">login</code></p><p id="c264" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">现在让我们点击<code class="fe ml mm mn mo b">logout</code>链接</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nx"><img src="../Images/3b102a3e00a218dc36f03789f727bac4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*eoGgSB9yVc0Kjxtj.png"/></div></div></figure><p id="a933" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">太棒了。有一个<code class="fe ml mm mn mo b">login</code>链接。</p><h1 id="b3c3" class="lo lp in bd lq lr ls lt lu lv lw lx ly jt lz ju ma jw mb jx mc jz md ka me mf bi translated">结论</h1><p id="ed0b" class="pw-post-body-paragraph ks kt in ku b kv mg jo kx ky mh jr la lb mi ld le lf mj lh li lj mk ll lm ln ig bi translated">我们已经在本文中介绍了如此多的细节。以下是我们到目前为止所做工作的总结:</p><ul class=""><li id="f1fd" class="nc nd in ku b kv kw ky kz lb ne lf nf lj ng ln nh ni nj nk bi translated">在你可以在你的应用中使用<code class="fe ml mm mn mo b">ejs</code>模板引擎之前，你必须告诉express使用它作为你的视图引擎。</li><li id="5b3e" class="nc nd in ku b kv nl ky nm lb nn lf no lj np ln nh ni nj nk bi translated">如果您有不同的<code class="fe ml mm mn mo b">views</code>目录，告诉express使用它，然后确保它包含您的模板。</li><li id="e2c1" class="nc nd in ku b kv nl ky nm lb nn lf no lj np ln nh ni nj nk bi translated">使用布局来存储其他页面需要的页面部分。例如导航条、页脚等。</li><li id="0147" class="nc nd in ku b kv nl ky nm lb nn lf no lj np ln nh ni nj nk bi translated"><code class="fe ml mm mn mo b">render</code>方法接受两个参数。</li><li id="05c0" class="nc nd in ku b kv nl ky nm lb nn lf no lj np ln nh ni nj nk bi translated">第一个是您试图呈现的模板。</li><li id="e5bb" class="nc nd in ku b kv nl ky nm lb nn lf no lj np ln nh ni nj nk bi translated">第二个是您想要发送到该模板的数据。该数据必须作为<code class="fe ml mm mn mo b">object</code>传递。</li><li id="b6ef" class="nc nd in ku b kv nl ky nm lb nn lf no lj np ln nh ni nj nk bi translated">您开始使用语法<code class="fe ml mm mn mo b">&lt;% ... %&gt;</code>在模板中嵌入JavaScript。</li><li id="bf84" class="nc nd in ku b kv nl ky nm lb nn lf no lj np ln nh ni nj nk bi translated">要在页面上包含布局，必须使用语法<code class="fe ml mm mn mo b">&lt;%- include('PATH_TO_LAYOUT_FILE') %&gt;</code>指定布局文件的路径。</li><li id="1b23" class="nc nd in ku b kv nl ky nm lb nn lf no lj np ln nh ni nj nk bi translated">要访问和打印从后端发送的数据，使用语法<code class="fe ml mm mn mo b">&lt;%= THE_OBJECT_KEY %&gt;</code>或<code class="fe ml mm mn mo b">&lt;%- THE_OBJECT_KEY %&gt;</code>，其中<code class="fe ml mm mn mo b">the_object_key</code>是从<code class="fe ml mm mn mo b">res.render( 'SOME_TEMPLATE', { KEY : VALUE } )</code>发送的密钥。</li></ul><p id="f961" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">目前就这些。如果您想要这篇文章的源代码，请访问下面的我的GitHub repo:</p><div class="ny nz gp gr oa ob"><a href="https://github.com/Octagon-simon/ejs-class" rel="noopener  ugc nofollow" target="_blank"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd io gy z fp og fr fs oh fu fw im bi translated">GitHub - Octagon-simon/ejs-class:学习如何使用嵌入式javascript (ejs)作为模板引擎…</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">github.com</p></div></div><div class="ok l"><div class="ol l om on oo ok op km ob"/></div></div></a></div><p id="5928" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">如果您有任何问题、建议或贡献，请随时在下面留言，我会处理的。</p><p id="0712" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">你喜欢这篇文章吗？<a class="ae oq" href="https://www.paypal.com/donate/?hosted_button_id=ZYK9PQ8UFRTA4" rel="noopener ugc nofollow" target="_blank">考虑给我小费</a>😁</p><p id="e831" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">感谢您的阅读。</p></div><div class="ab cl or os hr ot" role="separator"><span class="ou bw bk ov ow ox"/><span class="ou bw bk ov ow ox"/><span class="ou bw bk ov ow"/></div><div class="ig ih ii ij ik"><p id="3c50" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated"><em class="nb">更多内容请看</em><a class="ae oq" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="ku io"><em class="nb">plain English . io</em></strong></a><em class="nb">。报名参加我们的</em> <a class="ae oq" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ku io"> <em class="nb">免费周报</em> </strong> </a> <em class="nb">。关注我们关于</em><a class="ae oq" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="ku io"><em class="nb">Twitter</em></strong></a><a class="ae oq" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="ku io"><em class="nb">LinkedIn</em></strong></a><em class="nb"/><a class="ae oq" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"><strong class="ku io"><em class="nb">YouTube</em></strong></a><em class="nb"/><a class="ae oq" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"><strong class="ku io"><em class="nb">不和</em> </strong> </a> <em class="nb">。对增长黑客感兴趣？检查</em> <a class="ae oq" href="https://circuit.ooo/" rel="noopener ugc nofollow" target="_blank"> <strong class="ku io"> <em class="nb">电路</em> </strong> </a> <em class="nb">。</em></p></div></div>    
</body>
</html>