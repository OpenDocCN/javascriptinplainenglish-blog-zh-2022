<html>
<head>
<title>How to Establish a Connection to MongoDB with Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Node.js建立到MongoDB的连接</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-establish-a-connection-to-mongodb-with-node-js-8685f31bff2c?source=collection_archive---------10-----------------------#2022-06-29">https://javascript.plainenglish.io/how-to-establish-a-connection-to-mongodb-with-node-js-8685f31bff2c?source=collection_archive---------10-----------------------#2022-06-29</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><h2 id="d288" class="il im in bd b dl io ip iq ir is it dk iu translated" aria-label="kicker paragraph">MongoDB</h2><div class=""/><div class=""><h2 id="ecd9" class="pw-subtitle-paragraph jt iw in bd b ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk dk translated">如何用Mongoose创建到MongoDB的连接？</h2></div><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi kl"><img src="../Images/ada1f458d8187a563ceb9b60c8b5cf6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ljgibb2a1UZI6twQ.png"/></div></div><figcaption class="kx ky gj gh gi kz la bd b be z dk">mongodb.com</figcaption></figure><p id="8572" class="pw-post-body-paragraph lb lc in ld b le lf jx lg lh li ka lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">MongoDB是一个数据库集合平台，其中保存了预定义的数据，这些数据具有可以用编程语言访问的模式。今天，我们将看看如何使用Node.js连接到数据库。</p><p id="5e12" class="pw-post-body-paragraph lb lc in ld b le lf jx lg lh li ka lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">如果您在MongoDB上还没有帐户，请创建一个，这是数据库管理所必需的，<a class="ae lx" href="https://www.mongodb.com/" rel="noopener ugc nofollow" target="_blank">这里是</a>。</p></div><div class="ab cl ly lz hr ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ig ih ii ij ik"><h2 id="713c" class="mf mg in bd mh mi mj dn mk ml mm dp mn lk mo mp mq lo mr ms mt ls mu mv mw it bi translated">创建一个组织</h2><p id="e5c2" class="pw-post-body-paragraph lb lc in ld b le mx jx lg lh my ka lj lk mz lm ln lo na lq lr ls nb lu lv lw ig bi translated">现在，我们可以专注于MongoDB提供的服务，从现在开始，我们将致力于他们的云页面<a class="ae lx" href="https://cloud.mongodb.com/v2" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><p id="af12" class="pw-post-body-paragraph lb lc in ld b le lf jx lg lh li ka lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">首先，我们需要创建一个组织，在一个地方用一个名字存储我们所有的集群。你可以把一个组织想象成你的团队，它拥有你的团队需要瞄准的所有项目。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nc"><img src="../Images/908a799a73cf03fb1aad977a34477ab0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GZudl5lP6NlxEy5O6c6fGg.jpeg"/></div></div></figure><p id="3025" class="pw-post-body-paragraph lb lc in ld b le lf jx lg lh li ka lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">在主云页面上，您可以创建自己的组织，然后邀请团队成员。现在您可以输入您的组织名称并选择MongoDB Atlas。</p></div><div class="ab cl ly lz hr ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ig ih ii ij ik"><h2 id="de11" class="mf mg in bd mh mi mj dn mk ml mm dp mn lk mo mp mq lo mr ms mt ls mu mv mw it bi translated">项目创建</h2><p id="78a0" class="pw-post-body-paragraph lb lc in ld b le mx jx lg lh my ka lj lk mz lm ln lo na lq lr ls nb lu lv lw ig bi translated">网站将要求您创建一个项目并填写相关信息。创建项目后，您可以通过点击<code class="fe nd ne nf ng b">Build a Database</code>按钮来构建您的第一个数据库。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nh"><img src="../Images/e4e59077bd4a831259f1dad3569ec7d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5YkR1Ckfpo5Ga2rhs6965A.png"/></div></div></figure></div><div class="ab cl ly lz hr ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ig ih ii ij ik"><h2 id="6b4b" class="mf mg in bd mh mi mj dn mk ml mm dp mn lk mo mp mq lo mr ms mt ls mu mv mw it bi translated">集群创建</h2><p id="6034" class="pw-post-body-paragraph lb lc in ld b le mx jx lg lh my ka lj lk mz lm ln lo na lq lr ls nb lu lv lw ig bi translated">在此步骤中，请选择您希望如何部署数据库。您可以从<code class="fe nd ne nf ng b">serverless</code>(0.10美元/1M读数)、<code class="fe nd ne nf ng b">dedicated</code>(0.80美元/小时)或<code class="fe nd ne nf ng b">shared</code>(免费)中进行选择，我们将在这里使用这些选项。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi ni"><img src="../Images/53720c9b69f77cad513a0fe79f52c5b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sDAxJ2Yxu6mMNtm-0T0ONA.jpeg"/></div></div></figure><p id="a534" class="pw-post-body-paragraph lb lc in ld b le lf jx lg lh li ka lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">现在选择您想要使用的云提供商，您可以从<code class="fe nd ne nf ng b">AWS</code>、<code class="fe nd ne nf ng b">Google Cloud</code>或<code class="fe nd ne nf ng b">Azure</code>中选择。</p><p id="e6ff" class="pw-post-body-paragraph lb lc in ld b le lf jx lg lh li ka lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">接下来，选择一个您希望运行数据库的服务器的大致位置。运行这两个接下来的设置，如果你想调整它们，但预定义的设置应该没问题。</p><p id="3fe7" class="pw-post-body-paragraph lb lc in ld b le lf jx lg lh li ka lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">最后，为集群选择一个名称。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nj"><img src="../Images/e56966011ea6e86756646d87d8e93f4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*csqSeAFc1zOQPIig0sqCHw.jpeg"/></div></div></figure><p id="a416" class="pw-post-body-paragraph lb lc in ld b le lf jx lg lh li ka lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">在最后一步中，您将创建授权凭证，通过它您可以操作数据库数据(名称和密码)。</p><p id="1234" class="pw-post-body-paragraph lb lc in ld b le lf jx lg lh li ka lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">然后，选择您希望授予哪些IP地址来操作数据库的数据。如果您想允许从任何地方进行修改访问，请输入IP地址<code class="fe nd ne nf ng b">0.0.0.0</code>。</p></div><div class="ab cl ly lz hr ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ig ih ii ij ik"><h2 id="4dbd" class="mf mg in bd mh mi mj dn mk ml mm dp mn lk mo mp mq lo mr ms mt ls mu mv mw it bi translated">初始化Node.js项目</h2><p id="cd25" class="pw-post-body-paragraph lb lc in ld b le mx jx lg lh my ka lj lk mz lm ln lo na lq lr ls nb lu lv lw ig bi translated">我们可以像往常一样启动一个项目的存储库——通过键入命令<code class="fe nd ne nf ng b">npm init</code>,然后我们可以继续填写关于该项目的信息。我们需要安装两个NPM软件包— <code class="fe nd ne nf ng b">mongoose</code>和<code class="fe nd ne nf ng b">dotenv</code>。</p><p id="9ed4" class="pw-post-body-paragraph lb lc in ld b le lf jx lg lh li ka lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">包<code class="fe nd ne nf ng b">mongoose</code>用于以更简单的方式访问MongoDB数据库，包<code class="fe nd ne nf ng b">dotenv</code>用于存储后端敏感数据，这些数据不应该被前端用户看到。</p></div><div class="ab cl ly lz hr ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ig ih ii ij ik"><h2 id="81de" class="mf mg in bd mh mi mj dn mk ml mm dp mn lk mo mp mq lo mr ms mt ls mu mv mw it bi translated">连接到数据库</h2><p id="3807" class="pw-post-body-paragraph lb lc in ld b le mx jx lg lh my ka lj lk mz lm ln lo na lq lr ls nb lu lv lw ig bi translated">在我们创建了Node.js项目和我们需要的一切之后，我们可以将我们的应用程序连接到它。在部署页面上，单击我们刚刚创建的集群上的<code class="fe nd ne nf ng b">Connect</code>按钮。</p><p id="cd64" class="pw-post-body-paragraph lb lc in ld b le lf jx lg lh li ka lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">现在，我们可以选择<code class="fe nd ne nf ng b">Connect your application</code>选项。Node.js的版本可以在modal的顶部输入(如果您想用不同的编程语言连接也可以)。将显示一个连接字符串，您可以使用它通过您的应用程序进行连接。</p><figure class="km kn ko kp gt kq gh gi paragraph-image"><div role="button" tabindex="0" class="kr ks di kt bf ku"><div class="gh gi nk"><img src="../Images/690eb73d1be949fa23924851bd7dcdb9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FyoWpzNqlPERPTNYd4ezNQ.jpeg"/></div></div></figure><p id="09b3" class="pw-post-body-paragraph lb lc in ld b le lf jx lg lh li ka lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">在将字符串插入应用程序之前，我们需要用之前设置的凭证之一替换登录凭证。全权证书的格式为<code class="fe nd ne nf ng b">username:password</code>。</p><p id="a952" class="pw-post-body-paragraph lb lc in ld b le lf jx lg lh li ka lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">现在，我们可以将连接字符串粘贴到我们的<code class="fe nd ne nf ng b">.env</code>文件中，并使用适合该值的输入键:</p><pre class="km kn ko kp gt nl ng nm nn aw no bi"><span id="2985" class="mf mg in ng b gy np nq l nr ns"><strong class="ng ix">MONGODB</strong>=mongodb+srv://<strong class="ng ix">admin</strong>:<strong class="ng ix">admin</strong>@cluster0.bn1ofkw.mongodb.net/?retryWrites=true&amp;w=majority</span></pre><p id="e148" class="pw-post-body-paragraph lb lc in ld b le lf jx lg lh li ka lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">现在，我们可以导入2个NPM包，并从主JavaScript文件的<code class="fe nd ne nf ng b">.env</code>文件中提取<code class="fe nd ne nf ng b">MONGODB</code>变量，如下所示:</p><pre class="km kn ko kp gt nl ng nm nn aw no bi"><span id="1f9b" class="mf mg in ng b gy np nq l nr ns">const <strong class="ng ix">mongoose</strong> = require(’mongoose’);<br/>require(’dotenv’).<strong class="ng ix">config</strong>();</span><span id="2fdc" class="mf mg in ng b gy nt nq l nr ns">const { <strong class="ng ix">MONGODB</strong> } = process.env;</span></pre><p id="0bef" class="pw-post-body-paragraph lb lc in ld b le lf jx lg lh li ka lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">导入所有必需的包和变量后，我们可以在主JavaScript文件中建立连接，如下所示:</p><pre class="km kn ko kp gt nl ng nm nn aw no bi"><span id="f63c" class="mf mg in ng b gy np nq l nr ns">mongoose.<strong class="ng ix">connect</strong>(<br/>    <strong class="ng ix">MONGODB</strong>,<br/>    { useNewUrlParser: true, useUnifiedTopology: true },  <br/>    () =&gt; console.<strong class="ng ix">log</strong>(’Successfully connected to database.’)<br/>);</span></pre><p id="e9e5" class="pw-post-body-paragraph lb lc in ld b le lf jx lg lh li ka lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated">建立连接后，我们的控制台会显示一条消息，提示成功，一切就绪。</p></div><div class="ab cl ly lz hr ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ig ih ii ij ik"><h2 id="de8d" class="mf mg in bd mh mi mj dn mk ml mm dp mn lk mo mp mq lo mr ms mt ls mu mv mw it bi translated"><strong class="ak">结论</strong></h2><p id="b1ef" class="pw-post-body-paragraph lb lc in ld b le mx jx lg lh my ka lj lk mz lm ln lo na lq lr ls nb lu lv lw ig bi translated">数据库可能是项目中非常有用的工具，选择MongoDB平台是一个很好的开始。我希望这篇文章能帮助您澄清MongoDB系统，如果您在下一个项目中开始使用这项技术，我会很高兴。</p><p id="f048" class="pw-post-body-paragraph lb lc in ld b le lf jx lg lh li ka lj lk ll lm ln lo lp lq lr ls lt lu lv lw ig bi translated"><em class="nu">更多内容请看</em><a class="ae lx" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="ld ix"><em class="nu">plain English . io</em></strong></a><em class="nu">。报名参加我们的</em> <a class="ae lx" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ld ix"> <em class="nu">免费周报</em> </strong> </a> <em class="nu">。关注我们关于</em><a class="ae lx" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="ld ix"><em class="nu">Twitter</em></strong></a><em class="nu">和</em><a class="ae lx" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="ld ix"><em class="nu">LinkedIn</em></strong></a><em class="nu">。查看我们的</em> <a class="ae lx" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="ld ix"> <em class="nu">社区不和谐</em> </strong> </a> <em class="nu">加入我们的</em> <a class="ae lx" href="https://inplainenglish.pallet.com/talent/welcome" rel="noopener ugc nofollow" target="_blank"> <strong class="ld ix"> <em class="nu">人才集体</em> </strong> </a> <em class="nu">。</em></p></div></div>    
</body>
</html>