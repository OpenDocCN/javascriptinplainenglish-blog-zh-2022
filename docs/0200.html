<html>
<head>
<title>Node.js Best Practices for Beginners and Experts</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">初学者和专家的最佳实践</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/node-js-best-practices-for-beginners-and-experts-7fb64c832ce2?source=collection_archive---------7-----------------------#2022-01-12">https://javascript.plainenglish.io/node-js-best-practices-for-beginners-and-experts-7fb64c832ce2?source=collection_archive---------7-----------------------#2022-01-12</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="d11c" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">Node.js开发人员构建高效且更易维护的应用程序的一些最佳实践。</h2></div><p id="37f2" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Node.js是最流行的web开发框架之一。它被几家公司使用，从小型项目到大型解决方案。<br/>有了它，您可以通过为浏览器编写JavaScript代码来创建轻量级、可扩展、快速且健壮的服务器端web应用程序。</p><p id="34b9" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">今天，我们将讨论一些使用Node.js开发的最佳实践，这些实践将帮助所有类型的开发人员构建一个高效且更易维护的应用程序，从初学者到最有经验的人都可以。</p><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="gh gi ky"><img src="../Images/09d93c06ec5ed2d749f3d7ef3144c062.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*dED9EesZyJbRKZnnQjTyyQ.jpeg"/></div></div></figure><h2 id="bd33" class="lk ll in bd lm ln lo dn lp lq lr dp ls kl lt lu lv kp lw lx ly kt lz ma mb mc bi translated">每次更改时重新启动应用程序</h2><p id="b54b" class="pw-post-body-paragraph kc kd in ke b kf md jo kh ki me jr kk kl mf kn ko kp mg kr ks kt mh kv kw kx ig bi translated">在开发时，应用程序会随着代码的每一次更改而停止和重新启动，这可能会造成麻烦，并会导致注意力和工作效率的损失。要解决这个问题，您可以使用避免重复重启应用程序的工具来反映变化。</p><p id="42a7" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">下面是一些最流行的Node.js代码监控包:</p><ol class=""><li id="35ab" class="mi mj in ke b kf kg ki kj kl mk kp ml kt mm kx mn mo mp mq bi translated">Nodemon:它提供了一个每当新代码发生变化时自动重启的功能。要使用Nodemon，只需用Nodemon替换节点。</li><li id="2f64" class="mi mj in ke b kf mr ki ms kl mt kp mu kt mv kx mn mo mp mq bi translated">永远:它还提供了自动启动功能以及其他配置，如写入日志和将工作目录设置为特定文件。</li><li id="b9b5" class="mi mj in ke b kf mr ki ms kl mt kp mu kt mv kx mn mo mp mq bi translated">PM2:与前两个工具相比，另一个过程管理工具具有出色的控制和特性。</li></ol><p id="a78a" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">《永远》和《PM2》都可以在生产环境中使用。有了它们，就可以保证代码在运行时错误后被恢复，并且在服务器停机时保证快速启动。</p><h2 id="2b01" class="lk ll in bd lm ln lo dn lp lq lr dp ls kl lt lu lv kp lw lx ly kt lz ma mb mc bi translated">用异步替换回调</h2><p id="0b07" class="pw-post-body-paragraph kc kd in ke b kf md jo kh ki me jr kk kl mf kn ko kp mg kr ks kt mh kv kw kx ig bi translated">最初，回调用于在Node.js中创建异步方法，但是当连续嵌套时，它们往往会失去控制。此时代码变得不可读。随着异步/等待的引入，开发人员注意到这个问题有所缓解。然而，为了避免回调，有必要确保异步/等待的使用。您可以通过用异步和等待调用替换它来轻松避免这种糟糕的回调场景。</p><h2 id="cd88" class="lk ll in bd lm ln lo dn lp lq lr dp ls kl lt lu lv kp lw lx ly kt lz ma mb mc bi translated">应用集群</h2><p id="f3cc" class="pw-post-body-paragraph kc kd in ke b kf md jo kh ki me jr kk kl mf kn ko kp mg kr ks kt mh kv kw kx ig bi translated">Node.js运行时仅限于单个CPU内核，在大型服务器上部署非集群的Node.js应用程序可能会浪费资源。相反，选择向您的应用程序添加集群支持，这样您就可以充分利用多核。在群集的支持下，即使在小型硬件上运行单个进程，您也可以获得灵活性。</p><h2 id="98f0" class="lk ll in bd lm ln lo dn lp lq lr dp ls kl lt lu lv kp lw lx ly kt lz ma mb mc bi translated">避免垃圾</h2><p id="30a3" class="pw-post-body-paragraph kc kd in ke b kf md jo kh ki me jr kk kl mf kn ko kp mg kr ks kt mh kv kw kx ig bi translated">Node.js有一个默认限制为1.5GB的慢速垃圾回收器。这个垃圾回收器将一直等待，直到它实际上有未使用的内存可以回收。如果内存不足，不是因为泄漏，而是因为垃圾收集器的懒惰行为。但是，您可以通过为V8提供标志来完全控制垃圾收集器。</p><p id="e7ef" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><code class="fe mw mx my mz b">web: node — optimize_for_size — max_old_space_size=920 — gc_interval=100 server.js</code></p><p id="041f" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这一点至关重要，尤其是当您在内存小于1.5GB的环境中运行节点时。</p><p id="a819" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><code class="fe mw mx my mz b">web: node — optimize_for_size — max_old_space_size=460 — gc_interval=100 server.js</code></p><p id="ec17" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">上面的代码可以用来为一个512MB的容器定制节点。</p><h2 id="cf25" class="lk ll in bd lm ln lo dn lp lq lr dp ls kl lt lu lv kp lw lx ly kt lz ma mb mc bi translated">干净的代码</h2><p id="b9f2" class="pw-post-body-paragraph kc kd in ke b kf md jo kh ki me jr kk kl mf kn ko kp mg kr ks kt mh kv kw kx ig bi translated">我们已经在之前的文章中讨论了干净代码的好处，以及它的采用如何帮助提高代码质量。为了有助于这种采用，我将强调ide和用于语义和风格修正的插件的使用如何在编码时帮助程序员。除了Node之外，我们还可以使用一个“Lint”插件来查找语义和语法错误代码并发出警告，同时我们可以使用一个格式化程序来处理风格因素，以确保一组格式和样式在整个项目中保持一致。我们有一些非常著名的插件，如ESLint、JSLint和JSHint，它们被大多数IDEs代码编辑器接受，如Atom和VSCode，它们重视代码质量并提供格式化插件。这些ide提供了额外的特性，比如重构、自动完成、文档支持、自动导入、调试工具、代码导航等等。</p><h2 id="2a86" class="lk ll in bd lm ln lo dn lp lq lr dp ls kl lt lu lv kp lw lx ly kt lz ma mb mc bi translated">依赖注入</h2><p id="6015" class="pw-post-body-paragraph kc kd in ke b kf md jo kh ki me jr kk kl mf kn ko kp mg kr ks kt mh kv kw kx ig bi translated">这种软件设计提倡将依赖项或服务作为参数注入或传递给模块，而不是创建它们。这个奇特的术语使你的模块保持独立、灵活、可伸缩和应用范围可测试。通过依赖注入，您可以使您的函数更加通用和灵活。除了依赖注入之外，还有其他实践可以让你的软件变得更好，为此，我推荐阅读这篇文章，在这篇文章中，我讨论了S.O.L.I.D .的原则。</p><ul class=""><li id="84ef" class="mi mj in ke b kf kg ki kj kl mk kp ml kt mm kx na mo mp mq bi translated">不要重复</li><li id="2b2d" class="mi mj in ke b kf mr ki ms kl mt kp mu kt mv kx na mo mp mq bi translated">单一责任原则</li><li id="208b" class="mi mj in ke b kf mr ki ms kl mt kp mu kt mv kx na mo mp mq bi translated">保持简单(保持简单)</li><li id="facd" class="mi mj in ke b kf mr ki ms kl mt kp mu kt mv kx na mo mp mq bi translated">关注点划分</li><li id="1a93" class="mi mj in ke b kf mr ki ms kl mt kp mu kt mv kx na mo mp mq bi translated">避免早期优化</li><li id="b929" class="mi mj in ke b kf mr ki ms kl mt kp mu kt mv kx na mo mp mq bi translated">依赖注入</li></ul><h2 id="49c8" class="lk ll in bd lm ln lo dn lp lq lr dp ls kl lt lu lv kp lw lx ly kt lz ma mb mc bi translated">使用安全、分层、环境感知的配置</h2><p id="4863" class="pw-post-body-paragraph kc kd in ke b kf md jo kh ki me jr kk kl mf kn ko kp mg kr ks kt mh kv kw kx ig bi translated">一个好的故障安全设置的标志包括:秘密信息不会提交给代码，层次模式之后是一个易于搜索的设置，并且密钥可以从环境变量中读取。密切关注项目设置，以满足DevOps团队的配置需求。</p><h2 id="4850" class="lk ll in bd lm ln lo dn lp lq lr dp ls kl lt lu lv kp lw lx ly kt lz ma mb mc bi translated">用头盔设计你的网络应用</h2><p id="b587" class="pw-post-body-paragraph kc kd in ke b kf md jo kh ki me jr kk kl mf kn ko kp mg kr ks kt mh kv kw kx ig bi translated">构建web应用程序非常有趣。为了让你的编码更简单，首先，保护你的应用。使用:</p><ul class=""><li id="b219" class="mi mj in ke b kf kg ki kj kl mk kp ml kt mm kx na mo mp mq bi translated">XSS保护</li><li id="4ec7" class="mi mj in ke b kf mr ki ms kl mt kp mu kt mv kx na mo mp mq bi translated">设置上下文安全策略头</li><li id="ab1c" class="mi mj in ke b kf mr ki ms kl mt kp mu kt mv kx na mo mp mq bi translated">确保所有连接都是HTTPS</li><li id="67ee" class="mi mj in ke b kf mr ki ms kl mt kp mu kt mv kx na mo mp mq bi translated">使用X-Frame-Options避免点击劫持</li><li id="1866" class="mi mj in ke b kf mr ki ms kl mt kp mu kt mv kx na mo mp mq bi translated">禁用X-Powered-By标头，使攻击者无法穿透您对特定软件的攻击</li></ul><p id="cfa7" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果你觉得做上面的练习有点令人生畏，只需使用默认设置的头盔，你就可以根据需要进行调整。</p><h2 id="b42a" class="lk ll in bd lm ln lo dn lp lq lr dp ls kl lt lu lv kp lw lx ly kt lz ma mb mc bi translated">结论</h2><p id="3703" class="pw-post-body-paragraph kc kd in ke b kf md jo kh ki me jr kk kl mf kn ko kp mg kr ks kt mh kv kw kx ig bi translated">在找到最佳推荐实践之前，没有开发是太难的，也没有语言是太容易的。我建议您在Node.js中构建的后端项目的最佳实践，这将在本文中介绍。</p><p id="c264" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我希望它能帮助您找到构建健壮的、可伸缩的、灵活的软件的方法。</p><p id="b3e5" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="nb">更多内容请看</em><a class="ae nc" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="ke io"><em class="nb">plain English . io</em></strong></a><em class="nb">。报名参加我们的</em> <a class="ae nc" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io"> <em class="nb">免费周报</em> </strong> </a> <em class="nb">。在我们的</em> <a class="ae nc" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io"> <em class="nb">社区</em> </strong> </a> <em class="nb">获得独家获得写作机会和建议。</em></p></div></div>    
</body>
</html>