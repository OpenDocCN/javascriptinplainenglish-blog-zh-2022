<html>
<head>
<title>PostgreSQL &amp; Sequelize: Should You Use a Relational Database?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">PostgreSQL &amp; Sequelize:应该使用关系数据库吗？</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/postgresql-sequelize-should-you-use-the-same-5a840814722f?source=collection_archive---------8-----------------------#2022-05-11">https://javascript.plainenglish.io/postgresql-sequelize-should-you-use-the-same-5a840814722f?source=collection_archive---------8-----------------------#2022-05-11</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="9988" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">你真的需要一个ORM还是你自己可以做？</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/bdfad4ade755ae89cff4bbe5e57279d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SEfonxxMIktyFJWwA_oTTg.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">NodeJS and Sequelize</figcaption></figure><p id="fe9b" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">真正的第一个问题是:</p><p id="4454" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">你应该使用关系数据库吗？</p><p id="9df8" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">我们假设答案是肯定的。那样的话，你可以继续读下去。</p><p id="8fb2" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">Sequelize 是所谓的ORM(“对象关系管理器”)。<br/>现在，您的应用程序不一定需要这些库来与您的数据库对话。在接下来的几行中，你可以读到我关于ORM在哪些地方非常有用，在哪些地方可能没有用的一些想法。</p><p id="e6fd" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">我将假设读者已经了解PostgreSQL和Node.js的基础知识。</p><p id="6162" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">首先，顺序化的基础是什么:</p><ul class=""><li id="8de2" class="lp lq in ku b kv kw ky kz lb lr lf ls lj lt ln lu lv lw lx bi translated">它适用于许多不同的数据库:Postgres、MySQL、MariaDB、SQLite等等</li><li id="8498" class="lp lq in ku b kv ly ky lz lb ma lf mb lj mc ln lu lv lw lx bi translated">您定义您的模型和类型(非常类似于数据库层本身)</li><li id="aabc" class="lp lq in ku b kv ly ky lz lb ma lf mb lj mc ln lu lv lw lx bi translated">您可以获得许多现成的功能</li><li id="2f78" class="lp lq in ku b kv ly ky lz lb ma lf mb lj mc ln lu lv lw lx bi translated">从应用程序到数据库的所有事务都通过Sequelize发生。这个额外的层使得设置安全措施变得更加容易，因此脏数据不会被写入数据库。</li></ul><h2 id="569c" class="md me in bd mf mg mh dn mi mj mk dp ml lb mm mn mo lf mp mq mr lj ms mt mu mv bi translated">定义您的模型</h2><p id="d98d" class="pw-post-body-paragraph ks kt in ku b kv mw jo kx ky mx jr la lb my ld le lf mz lh li lj na ll lm ln ig bi translated">现在，这是使用ORM最酷的事情之一——在代码中拥有数据库模式和模型。这有点像基础设施的代码，但对于你的数据库。让我们看一个例子:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nb nc l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Example model</figcaption></figure><p id="abb1" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">拥有这样的<code class="fe nd ne nf ng b">MyDBModel</code>,允许我在Sequelize中使用内置的数据类型，这将自动为我们提供类型检查。上面是一个简单的例子，有一个主键和几个不同的数据类型字段。<br/>现在我们可以使用上面的定义来插入新项目以及执行功能。</p></div><div class="ab cl nh ni hr nj" role="separator"><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm nn"/><span class="nk bw bk nl nm"/></div><div class="ig ih ii ij ik"><p id="32b9" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">假设我们想从具有特定名称的所有行中获取<code class="fe nd ne nf ng b">id</code>、<code class="fe nd ne nf ng b">name</code>、<code class="fe nd ne nf ng b">date</code>和<code class="fe nd ne nf ng b">incrementMe</code>:</p><h2 id="b3a0" class="md me in bd mf mg mh dn mi mj mk dp ml lb mm mn mo lf mp mq mr lj ms mt mu mv bi translated">1.ORM方式</h2><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nb nc l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">A helper function using Sequelize</figcaption></figure><h2 id="c5f6" class="md me in bd mf mg mh dn mi mj mk dp ml lb mm mn mo lf mp mq mr lj ms mt mu mv bi translated">2.SQL方式</h2><p id="75f9" class="pw-post-body-paragraph ks kt in ku b kv mw jo kx ky mx jr la lb my ld le lf mz lh li lj na ll lm ln ig bi translated">以上将返回与等效的原始SQL查询相同的结果:</p><pre class="kd ke kf kg gt no ng np nq aw nr bi"><span id="521b" class="md me in ng b gy ns nt l nu nv">SELECT id, date, name, incrementMe<br/>FROM MODEL<br/>WHERE name = 'YOUR NAME'<br/>ORDER BY date DESC</span></pre><p id="8d8f" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">现在，这似乎不是一个大的胜利。但是在第一个例子中，构建额外的逻辑并在代码的许多地方重用该函数要容易得多。这只是一个简单的例子，但是我的观点越深入就越清晰。</p><h2 id="03cd" class="md me in bd mf mg mh dn mi mj mk dp ml lb mm mn mo lf mp mq mr lj ms mt mu mv bi translated">开箱即用的</h2><p id="a624" class="pw-post-body-paragraph ks kt in ku b kv mw jo kx ky mx jr la lb my ld le lf mz lh li lj na ll lm ln ig bi translated">对于插入，我们还增加了类型检查的功能。其他有用的功能有:</p><ul class=""><li id="677c" class="lp lq in ku b kv kw ky kz lb lr lf ls lj lt ln lu lv lw lx bi translated"><code class="fe nd ne nf ng b">findOrCreate</code>这确实如其所说。创建一个条目或检索现有的条目(如果有的话)。</li><li id="7222" class="lp lq in ku b kv ly ky lz lb ma lf mb lj mc ln lu lv lw lx bi translated">这对于创建与分页相关的查询很有用。</li><li id="7d8c" class="lp lq in ku b kv ly ky lz lb ma lf mb lj mc ln lu lv lw lx bi translated">这些是你可以分配给你的字段的额外“检查”。这些与<code class="fe nd ne nf ng b">type</code>字段不同，因为它本质上是由Sequelize创建的预配置正则表达式。这可能是你将只允许x字符在一个特定的领域或你将只允许<code class="fe nd ne nf ng b">isIPv6</code>在另一个领域。更长的验证列表可以在<a class="ae lo" href="https://sequelize.org/docs/v6/core-concepts/validations-and-constraints/" rel="noopener ugc nofollow" target="_blank">这里</a>找到</li></ul><h2 id="735f" class="md me in bd mf mg mh dn mi mj mk dp ml lb mm mn mo lf mp mq mr lj ms mt mu mv bi translated">结论</h2><p id="2618" class="pw-post-body-paragraph ks kt in ku b kv mw jo kx ky mx jr la lb my ld le lf mz lh li lj na ll lm ln ig bi translated">许多人都不擅长写SQL，包括我自己。这很可能是由于我在职业生涯中所扮演的角色，我没有过多关注数据库层。<br/>在非常大的系统中，将重点放在数据库上并尽可能优化它的所有部分会很有帮助。</p><p id="2ac8" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">根据我的经验，这在大型项目中是有意义的，但是在较小的项目中，数据库的东西通常只是你在开始/创建数据库的过程中接触到的东西。由于这些原因，我从未在编写查询和专攻超高级数据库模式方面得到一致的实践。因此，我也发现使用ORM是一件令人愉快的事情，因为它看起来更有条理，这让我感觉更舒服。<br/>为了更简单，ORM有时会为您创建一些查询，但这些查询的性能并不如一个超级熟练的开发人员所能编写的那样好。对于我的用例来说，性能目前还不错。</p><p id="214f" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">最后一点:ORM通常是相对较大的库，所以会有这样的情况，所有增加的代码不会给你带来比额外的代码、构建时间、部署时间等更多的好处。那也正在被添加。</p><p id="aeb9" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">/保持干净！</p><p id="67a7" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated"><em class="nw">更多内容看</em> <a class="ae lo" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ku io"> <em class="nw">说白了。报名参加我们的</em> <a class="ae lo" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ku io"> <em class="nw">免费周报</em> </strong> </a> <em class="nw">。关注我们关于</em><a class="ae lo" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="ku io"><em class="nw">Twitter</em></strong></a><em class="nw">和</em><strong class="ku io"><em class="nw"/></strong><a class="ae lo" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="ku io"><em class="nw">LinkedIn</em></strong></a><em class="nw">。加入我们的</em> <a class="ae lo" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="ku io"> <em class="nw">社区</em> </strong> </a> <em class="nw">。</em></strong></a></p></div></div>    
</body>
</html>