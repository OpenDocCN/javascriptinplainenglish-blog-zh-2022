<html>
<head>
<title>A Guide on How to Use Emit in Vue.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">关于如何在Vue.js中使用Emit的指南</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/a-guide-on-how-to-use-emit-in-vue-js-d3dc668d9f6b?source=collection_archive---------10-----------------------#2022-05-10">https://javascript.plainenglish.io/a-guide-on-how-to-use-emit-in-vue-js-d3dc668d9f6b?source=collection_archive---------10-----------------------#2022-05-10</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/6c1d4e5f6b3de4fd945f3886b4a99e11.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*XaS-c2om8ptP5ffF-S__CA.png"/></div></div></figure><p id="b9c8" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在Vue.js中，数据通常以单向方式从父组件传递到其子组件。这是用<a class="ae kt" href="https://fjolt.com/article/vue-how-do-props-work" rel="noopener ugc nofollow" target="_blank"> props </a>传递的，props 是我们赋予<a class="ae kt" href="https://fjolt.com/article/vue-using-components" rel="noopener ugc nofollow" target="_blank">组件</a>的属性或特性。</p><p id="0fee" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">例如，如果我们调用一个组件<code class="fe ku kv kw kx b">PageOne</code>，它有一个名为<code class="fe ku kv kw kx b">name</code>的属性，那么这个<code class="fe ku kv kw kx b">name</code>属性将在<code class="fe ku kv kw kx b">PageOne</code>组件本身中变得可用，让我们可以用它做我们想做的事情。这样，当我们在父组件或页面中声明数据时，数据将被传递给子组件:</p><figure class="kz la lb lc gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ky"><img src="../Images/adca5f19be5b690e88f8b265ec3aa5c4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*jbHk2ksgt-_Ad9u4.png"/></div></div></figure><p id="dc06" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在大多数情况下，道具允许我们用数据做所有需要做的事情。<strong class="jx io">然而，有时我们需要向上发出数据</strong>——从子组件到其父组件。为此，我们使用了<code class="fe ku kv kw kx b">$emit</code>，它允许我们向上发送数据，然后在触发<code class="fe ku kv kw kx b">$emit</code>事件时触发父组件中的一个事件。</p><h1 id="6a0c" class="ld le in bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">$emit如何在Vue.js中工作</h1><p id="bb75" class="pw-post-body-paragraph jv jw in jx b jy mb ka kb kc mc ke kf kg md ki kj kk me km kn ko mf kq kr ks ig bi translated">在Vue.js中有三种方式来触发<code class="fe ku kv kw kx b">$emit</code>,这取决于你是使用选项API、组合API还是内联你的<code class="fe ku kv kw kx b">$emit</code>事件。如果你不确定，<a class="ae kt" href="https://fjolt.com/article/vue-composition-api-vs-options-api" rel="noopener ugc nofollow" target="_blank">你可以在这里阅读组合API和选项API的区别。</a></p><ul class=""><li id="c742" class="mg mh in jx b jy jz kc kd kg mi kk mj ko mk ks ml mm mn mo bi translated"><code class="fe ku kv kw kx b">this.$emit</code>在选项API内。</li><li id="5239" class="mg mh in jx b jy mp kc mq kg mr kk ms ko mt ks ml mm mn mo bi translated"><code class="fe ku kv kw kx b">$emit</code>如果在你的HTML模板中使用。</li><li id="ca18" class="mg mh in jx b jy mp kc mq kg mr kk ms ko mt ks ml mm mn mo bi translated"><code class="fe ku kv kw kx b">defineEmits</code>和<code class="fe ku kv kw kx b">emit</code>如果在组合API中使用。</li></ul><p id="1e8a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">让我们通过一个愚蠢的例子来看看这是如何工作的。假设我们有一个计数器组件，如下所示:</p><pre class="kz la lb lc gt mu kx mv mw aw mx bi"><span id="42dd" class="my le in kx b gy mz na l nb nc">&lt;template&gt;<br/>    &lt;button @click="$emit('counterEvent')"&gt;Click Me&lt;/button&gt;<br/>&lt;/template&gt;</span></pre><p id="3e3c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这个组件存储在一个名为<code class="fe ku kv kw kx b">Counter.vue</code>的文件中。我们的组件不能被更改，因为它在其他地方被使用，但是它确实有一个<code class="fe ku kv kw kx b">$emit</code>事件在它被点击时被触发。这是完美的，因为我们可以在父组件中使用它。</p><p id="63d1" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">那么，如果我们想在某个地方添加这个组件——例如，在我们的<code class="fe ku kv kw kx b">App.vue</code>文件中——并使用它来显示我们的计数器的值。现在让我们试着这样做:</p><pre class="kz la lb lc gt mu kx mv mw aw mx bi"><span id="26b1" class="my le in kx b gy mz na l nb nc">&lt;template&gt;<br/>    &lt;h1&gt;{{ counter }}&lt;/h1&gt;<br/>    &lt;Counter @counter-event="incrCounter"/&gt;<br/>&lt;/template&gt;</span><span id="a5ba" class="my le in kx b gy nd na l nb nc">&lt;script&gt;<br/>import Counter from './Counter.vue'<br/>export default {<br/>    // Add our components<br/>    components: {<br/>      Counter<br/>    },<br/>    // Store our data<br/>    data() {<br/>        return {<br/>            counter: 0<br/>        }<br/>    },<br/>    methods: {<br/>        incrCounter: function() {<br/>            this.counter += 1;<br/>        }<br/>    }<br/>}<br/>&lt;/script&gt;</span></pre><p id="ff59" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">让我们来分解一下——首先，我们包括我们的<code class="fe ku kv kw kx b">Counter</code>。因为它有一个名为<code class="fe ku kv kw kx b">counterEvent</code>的<code class="fe ku kv kw kx b">$emit</code>事件，我们可以将它附加到我们的<code class="fe ku kv kw kx b">Counter</code> HTML中。每当<code class="fe ku kv kw kx b">$emit</code>触发时，它将触发<code class="fe ku kv kw kx b">counterEvent</code>，从而触发该属性中的函数。<strong class="jx io">在这里，我们随时运行</strong><code class="fe ku kv kw kx b"><strong class="jx io">incrCounter</strong></code><strong class="jx io"/><code class="fe ku kv kw kx b"><strong class="jx io">counterEvent</strong></code><strong class="jx io">火灾。</strong></p><p id="1d75" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">通过这样做，我们还将我们的<code class="fe ku kv kw kx b">counter</code>数据增加1，因为这就是<code class="fe ku kv kw kx b">incrCounter</code>所做的。因此，我们已经将click事件向上发送到父组件。</p><h1 id="e943" class="ld le in bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">烤肉串盒</h1><p id="2d00" class="pw-post-body-paragraph jv jw in jx b jy mb ka kb kc mc ke kf kg md ki kj kk me km kn ko mf kq kr ks ig bi translated">您可能会注意到，当我们定义我们的<code class="fe ku kv kw kx b">$emit</code>事件时，我们使用了camel case ( <code class="fe ku kv kw kx b">counterEvent</code>)，但是在跟踪事件时，我们使用了kebab case ( <code class="fe ku kv kw kx b">counter-event</code>)。</p><p id="6015" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在<strong class="jx io"> Vue 3 </strong>中，可以互换使用<code class="fe ku kv kw kx b">counterEvent</code>和<code class="fe ku kv kw kx b">counter-event</code>，因为Vue 3会自动将<code class="fe ku kv kw kx b">counterEvent</code>转换为<code class="fe ku kv kw kx b">counter-event</code>。在<strong class="jx io"> Vue 2 </strong>中，该功能不存在，所以两者都使用<code class="fe ku kv kw kx b">counter-event</code>即可。</p><h1 id="b4a3" class="ld le in bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">用$emit传递数据</h1><p id="5a5e" class="pw-post-body-paragraph jv jw in jx b jy mb ka kb kc mc ke kf kg md ki kj kk me km kn ko mf kq kr ks ig bi translated">相反，我们希望我们的组件定义<code class="fe ku kv kw kx b">counterEvent</code>应该增加多少。如果我们想这样做，我们可以向<code class="fe ku kv kw kx b">$emit</code>函数传递第二个参数，即值:</p><pre class="kz la lb lc gt mu kx mv mw aw mx bi"><span id="27ee" class="my le in kx b gy mz na l nb nc">&lt;template&gt;<br/>    &lt;button @click="$emit('counterEvent', 2)"&gt;Click Me&lt;/button&gt;<br/>&lt;/template&gt;</span></pre><p id="19e0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">这里是</strong>，我们正在将值<code class="fe ku kv kw kx b">2</code>传递给我们的<code class="fe ku kv kw kx b">counterEvent</code>。让我们回到我们的<code class="fe ku kv kw kx b">App.vue</code>文件。为了在<code class="fe ku kv kw kx b">counterEvent</code>中利用这个值，我们需要把它写成一个函数。下面，<code class="fe ku kv kw kx b">n</code>是数值:</p><pre class="kz la lb lc gt mu kx mv mw aw mx bi"><span id="ea1c" class="my le in kx b gy mz na l nb nc">&lt;template&gt;<br/>    &lt;h1&gt;{{ counter }}&lt;/h1&gt;<br/>    &lt;Counter @counter-event="(n) =&gt; incrCounter(n)"/&gt;<br/>&lt;/template&gt;</span><span id="49dd" class="my le in kx b gy nd na l nb nc">&lt;script&gt;<br/>import Counter from './Counter.vue'<br/>export default {<br/>    // Add our components<br/>    components: {<br/>      Counter<br/>    },<br/>    // Store our data<br/>    data() {<br/>        return {<br/>            counter: 0<br/>        }<br/>    },<br/>    methods: {<br/>        incrCounter: function(value) {<br/>            this.counter += value;<br/>        }<br/>    }<br/>}<br/>&lt;/script&gt;</span></pre><p id="8e73" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在，我们的计数器将增加子组件中的值，从而允许我们将数据传递给父组件。正如您所料，这不仅限于数字，还可以包括任何数据结构——包括对象和字符串。</p><h1 id="fc63" class="ld le in bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">将$emit与选项API一起使用</h1><p id="eab1" class="pw-post-body-paragraph jv jw in jx b jy mb ka kb kc mc ke kf kg md ki kj kk me km kn ko mf kq kr ks ig bi translated">我们已经展示了一个非常简单的例子，但是我们也可以使用一个函数来编写我们的<code class="fe ku kv kw kx b">Counter.vue</code>子组件。下面是一个使用<code class="fe ku kv kw kx b">this.$emit</code>的<strong class="jx io">选项API </strong>的例子:</p><pre class="kz la lb lc gt mu kx mv mw aw mx bi"><span id="0c27" class="my le in kx b gy mz na l nb nc">&lt;template&gt;<br/>    &lt;button @click="emitFunction"&gt;Click Me&lt;/button&gt;<br/>&lt;/template&gt;</span><span id="32bc" class="my le in kx b gy nd na l nb nc">&lt;script&gt;<br/>export default {<br/>  emits: [ 'counterEvent' ],<br/>    methods: {<br/>        emitFunction: function() {<br/>            this.$emit('counterEvent', 2)<br/>        }<br/>    }<br/>}<br/>&lt;/script&gt;</span></pre><p id="da05" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这可能是一种稍微干净的使用<code class="fe ku kv kw kx b">$emit</code>的方式，尤其是当你想在点击按钮的同时使用<code class="fe ku kv kw kx b">$emit</code>做其他事情的时候。</p><h1 id="4c6b" class="ld le in bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">将您的发出事件添加到原型中</h1><p id="849f" class="pw-post-body-paragraph jv jw in jx b jy mb ka kb kc mc ke kf kg md ki kj kk me km kn ko mf kq kr ks ig bi translated">您可能会注意到，我们还在原型的<code class="fe ku kv kw kx b">emits</code>中定义了我们的emit事件。这是一个很好的实践，原因有二:</p><ul class=""><li id="c134" class="mg mh in jx b jy jz kc kd kg mi kk mj ko mk ks ml mm mn mo bi translated"><strong class="jx io">它通过显示在这个组件中哪些发射事件是可能的，让你自我记录代码</strong>。</li><li id="dea3" class="mg mh in jx b jy mp kc mq kg mr kk ms ko mt ks ml mm mn mo bi translated"><strong class="jx io">它帮助您跟踪已被否决的发射</strong>，因为如果使用了发射事件，但在<code class="fe ku kv kw kx b">emits</code>数组中没有找到，Vue将抛出一个错误。</li></ul><h1 id="d3cd" class="ld le in bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">将$emit与组合API一起使用</h1><p id="2d80" class="pw-post-body-paragraph jv jw in jx b jy mb ka kb kc mc ke kf kg md ki kj kk me km kn ko mf kq kr ks ig bi translated">我们可以在组合API中使用<code class="fe ku kv kw kx b">$emit</code>——唯一的区别是我们必须使用<code class="fe ku kv kw kx b">defineEmits</code>来代替。</p><pre class="kz la lb lc gt mu kx mv mw aw mx bi"><span id="a1e3" class="my le in kx b gy mz na l nb nc">&lt;template&gt;<br/>    &lt;button @click="emitFunction"&gt;Click Me&lt;/button&gt;<br/>&lt;/template&gt;</span><span id="3cb0" class="my le in kx b gy nd na l nb nc">&lt;script setup&gt;<br/>import { defineEmits } from 'vue'</span><span id="9ff4" class="my le in kx b gy nd na l nb nc">const emit = defineEmits(['counterEvent']);<br/>const emitFunction = function() {<br/>    emit('counterEvent', 2)<br/>}<br/>&lt;/script&gt;</span></pre><p id="2142" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe ku kv kw kx b">defineEmits</code>用于定义所有允许的<code class="fe ku kv kw kx b">emit</code>事件的完整列表。这里，我们只有一个，<code class="fe ku kv kw kx b">counterEvent</code>。如果你有不止一个，你可以这样定义它们:</p><pre class="kz la lb lc gt mu kx mv mw aw mx bi"><span id="a8e3" class="my le in kx b gy mz na l nb nc">const emit = defineEmits(['counterEvent', 'anotherEvent', 'finalEvent']);</span></pre><p id="c615" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如果使用未在<code class="fe ku kv kw kx b">defineEmits</code>中列出的发射事件，Vue将抛出一个警告，类似于在选项API上使用<code class="fe ku kv kw kx b">emits</code>。否则，您可以像往常一样使用<code class="fe ku kv kw kx b">emit()</code>函数来发射，根本不需要使用<strong class="jx io">选项API </strong>。</p><h1 id="1f62" class="ld le in bd lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated">最终想法和最佳实践</h1><p id="f97d" class="pw-post-body-paragraph jv jw in jx b jy mb ka kb kc mc ke kf kg md ki kj kk me km kn ko mf kq kr ks ig bi translated">Emit是一个强大的工具，可以在必要时将数据发送回父节点。这意味着Vue.js中的数据流可以是双向的。在定义<code class="fe ku kv kw kx b">emit</code>代码时，两个主要的最佳实践是:</p><ul class=""><li id="c7da" class="mg mh in jx b jy jz kc kd kg mi kk mj ko mk ks ml mm mn mo bi translated">总是在<code class="fe ku kv kw kx b">emits</code>或<code class="fe ku kv kw kx b">defineEmits</code>中定义您的emit事件，这将帮助您保持代码的整洁和良好的文档记录</li><li id="051a" class="mg mh in jx b jy mp kc mq kg mr kk ms ko mt ks ml mm mn mo bi translated">Vue 3中通常的惯例是在HTML中使用kebab大小写(<code class="fe ku kv kw kx b">this-is-kebab-case</code>)，在脚本中使用camel大小写(<code class="fe ku kv kw kx b">thisIsCamelCase</code>)。因此，这里最好也遵循这个惯例。</li></ul><p id="b6fb" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我希望你喜欢这个关于<code class="fe ku kv kw kx b">$emit</code>如何工作的指南。敬请关注更多<a class="ae kt" href="https://fjolt.com/category/vue" rel="noopener ugc nofollow" target="_blank"> Vue内容</a>。</p></div><div class="ab cl ne nf hr ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ig ih ii ij ik"><p id="3258" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="nl">更多内容请看</em><a class="ae kt" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="jx io"><em class="nl">plain English . io</em></strong></a><em class="nl">。报名参加我们的</em> <a class="ae kt" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io"> <em class="nl">免费周报</em> </strong> </a> <em class="nl">。关注我们关于</em><a class="ae kt" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="jx io"><em class="nl">Twitter</em></strong></a><em class="nl">和</em><a class="ae kt" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="jx io"><em class="nl">LinkedIn</em></strong></a><em class="nl">。加入我们的</em> <a class="ae kt" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io"> <em class="nl">社区不和谐</em> </strong> </a> <em class="nl">。</em></p></div></div>    
</body>
</html>