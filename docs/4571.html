<html>
<head>
<title>How To Buy a Car With JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用JavaScript买车</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-buy-a-car-with-javascript-ca2809fc0db5?source=collection_archive---------11-----------------------#2022-12-14">https://javascript.plainenglish.io/how-to-buy-a-car-with-javascript-ca2809fc0db5?source=collection_archive---------11-----------------------#2022-12-14</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><h2 id="8575" class="ip iq ir bd b dl is it iu iv iw ix dk iy translated" aria-label="kicker paragraph">毁灭2022</h2><div class=""/><div class=""><h2 id="00c4" class="pw-subtitle-paragraph jx ja ir bd b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko dk translated">不是在现实中，而是为了解决一个灾难性的2022问题</h2></div><figure class="kq kr ks kt gu ku gi gj paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gi gj kp"><img src="../Images/62530ccdf9085aff802cde722e113816.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*63UbXDKXKHIxDum3OrkYQw.jpeg"/></div></div></figure><p id="e8e9" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">今天的《毁灭2022》特别有趣。它本身并不复杂，只是计算两条曲线的交点。最有趣的事情是折射结果。不过还是从问题的正文开始吧。</p><h1 id="5c5f" class="lx ly ir bd lz ma mb mc md me mf mg mh kg mi kh mj kj mk kk ml km mm kn mn mo bi translated">问题:买车</h1><p id="b16e" class="pw-post-body-paragraph lb lc ir ld b le mp kb lg lh mq ke lj lk mr lm ln lo ms lq lr ls mt lu lv lw ik bi translated">链接到<a class="ae mu" href="https://www.codewars.com/kata/554a44516729e4d80b000012" rel="noopener ugc nofollow" target="_blank">形</a></p><p id="b2de" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">一个男人有一辆相当旧的车，值得买。他看到一辆二手车值<code class="fe mv mw mx my b">$8000</code>。他想保留他的旧车，直到他能买到二手车。</p><p id="bca3" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">他认为他每个月可以节省1000美元，但是他的旧车和新车的价格每个月下降了<code class="fe mv mw mx my b">1.5</code>%。此外，在每两个月结束时，这一损失百分比会增加<code class="fe mv mw mx my b">0.5</code>个百分点。我们的人发现做这些计算很困难。</p><p id="6ecb" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">你能帮助他吗？</p><p id="6e0c" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">他需要多少个月才能攒够钱买他想要的车，他还会剩下多少钱？</p><p id="bf26" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated"><strong class="ld jb">参数和函数返回:</strong></p><pre class="kq kr ks kt gu mz my na bn nb nc bi"><span id="c26e" class="nd ly ir my b be ne nf l ng nh">parameter (positive int or float, guaranteed) start_price_old (Old car price)<br/>parameter (positive int or float, guaranteed) start_price_new (New car price)<br/>parameter (positive int or float, guaranteed) saving_per_month<br/>parameter (positive float or int, guaranteed) percent_loss_by_month<br/><br/>nbMonths(2000, 8000, 1000, 1.5) should return [6, 766] or (6, 766)</span></pre><p id="6d80" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated"><strong class="ld jb">上述示例的详细信息:</strong></p><pre class="kq kr ks kt gu mz my na bn nb nc bi"><span id="ba9a" class="nd ly ir my b be ne nf l ng nh">end month 1: percent_loss 1.5 available -4910.0<br/>end month 2: percent_loss 2.0 available -3791.7999...<br/>end month 3: percent_loss 2.0 available -2675.964<br/>end month 4: percent_loss 2.5 available -1534.06489...<br/>end month 5: percent_loss 2.5 available -395.71327...<br/>end month 6: percent_loss 3.0 available 766.158120825...<br/>return [6, 766] or (6, 766)</span></pre><p id="2dac" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">其中<code class="fe mv mw mx my b">6</code>是在<strong class="ld jb">结束时</strong>他可以购买新车的月数，而<code class="fe mv mw mx my b">766</code>是最接近<code class="fe mv mw mx my b">766.158...</code>的整数(四舍五入<code class="fe mv mw mx my b">766.158</code>得到<code class="fe mv mw mx my b">766</code>)。</p><p id="d2f6" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated"><strong class="ld jb">注:</strong></p><p id="2510" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">销售、购买和储蓄通常在月末进行。计算在每个月的月底进行，但是如果从一开始就偶然发现旧车的价值大于新车的价值或者相等，则没有节省，不需要等待，因此他可以在月初购买新车:</p><pre class="kq kr ks kt gu mz my na bn nb nc bi"><span id="ddbd" class="nd ly ir my b be ne nf l ng nh">nbMonths(12000, 8000, 1000, 1.5) should return [0, 4000]<br/>nbMonths(8000, 8000, 1000, 1.5) should return [0, 0]</span></pre><p id="f7c2" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">我们不处理银行储蓄存款:-)</p><h1 id="872d" class="lx ly ir bd lz ma mb mc md me mf mg mh kg mi kh mj kj mk kk ml km mm kn mn mo bi translated">我的解决方案</h1><figure class="kq kr ks kt gu ku gi gj paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gi gj kp"><img src="../Images/64f9038ac2c0c7858599a482c28aeff6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R5QemjtE-F4DSLu6bL88UA.jpeg"/></div></div></figure><p id="4fc0" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">解决方案大概是这样的:</p><pre class="kq kr ks kt gu mz my na bn nb nc bi"><span id="8dff" class="nd ly ir my b be ne nf l ng nh">export function nbMonths(p) {<br/>  while (getMoneyLeft(p) &lt; 0) {<br/>    p = { ...updateValues(p) };<br/>  }<br/><br/>  return [p.month, Math.round(getMoneyLeft(p))];<br/>}</span></pre><p id="b19f" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">如果我们愿意，我们可以使用递归函数:</p><pre class="kq kr ks kt gu mz my na bn nb nc bi"><span id="e578" class="nd ly ir my b be ne nf l ng nh">export function nbMonths(p) {<br/>  const moneyLeft = getMoneyLeft(p);<br/><br/>  if (moneyLeft &gt;= 0) {<br/>    return [p.month, Math.round(getMoneyLeft(p))];<br/>  } else {<br/>    return nbMonths(updateValues(p));<br/>  }<br/>}</span></pre><p id="5e25" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">显然，这些解决方案使用了其他功能。我决定把这个问题分成几个单独的函数，从概念上简化它。</p><p id="e0b1" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">这是一个编程选择。就我个人而言，我更喜欢使用简单的功能，并将其作为乐高积木来构建更大的东西。在这种情况下，没有必要。无需拆分代码，解决方案如下:</p><pre class="kq kr ks kt gu mz my na bn nb nc bi"><span id="6b0c" class="nd ly ir my b be ne nf l ng nh">export function nbMonths(<br/>  priceOld: number,<br/>  priceNew: number,<br/>  saving: number,<br/>  percentLoss: number<br/>): number[] {<br/>  let available: number = 0;<br/>  let month: number = 0;<br/><br/>  while (available + priceOld &lt; priceNew) {<br/>    month++;<br/>    percentLoss += month % 2 == 0 ? 0.5 : 0;<br/>    priceNew *= (100 - percentLoss) / 100;<br/>    priceOld *= (100 - percentLoss) / 100;<br/>    available += saving;<br/>  }<br/><br/>  return [month, Math.round(available + priceOld - priceNew)];<br/>}</span></pre><p id="08e6" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">但是这段代码中有我不喜欢的地方。而且是参数的问题。这是一个有太多参数的函数。在这种情况下，我更喜欢使用一个对象:</p><pre class="kq kr ks kt gu mz my na bn nb nc bi"><span id="5074" class="nd ly ir my b be ne nf l ng nh">type Param = {<br/>  priceOld: number;<br/>  priceNew: number;<br/>  saving: number;<br/>  percentLoss: number;<br/>  month: number;<br/>};</span></pre><p id="3a8a" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">然后我开始把问题分成几部分。首先，我需要一个函数来计算两辆汽车的更新价格。</p><pre class="kq kr ks kt gu mz my na bn nb nc bi"><span id="a4a2" class="nd ly ir my b be ne nf l ng nh">const value = (price: number, delta: number): number =&gt;<br/>  price * (1 - delta / 100);<br/><br/>const updatePriceNew = (p: Param): number =&gt; value(p.priceNew, p.percentLoss);<br/>const updatePriceOld = (p: Param): number =&gt; value(p.priceOld, p.percentLoss);</span></pre><p id="cf46" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">接下来，我需要更新损坏率的东西。因为它每两个月发生一次，所以我可以检查该月是否是偶数:</p><pre class="kq kr ks kt gu mz my na bn nb nc bi"><span id="781d" class="nd ly ir my b be ne nf l ng nh">const updatePercentLoss = (p: Param): number =&gt;<br/>  p.percentLoss + (1 - (p.month % 2)) * 0.5;</span></pre><p id="3999" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">更新月份号非常简单:</p><pre class="kq kr ks kt gu mz my na bn nb nc bi"><span id="f96b" class="nd ly ir my b be ne nf l ng nh">const updateMonth = (p: Param): number =&gt; p.month + 1;</span></pre><p id="9caf" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">我还需要一个函数来计算购买后剩下的钱。这样，如果价值为负，我知道我们还买不起这辆车。</p><pre class="kq kr ks kt gu mz my na bn nb nc bi"><span id="8dca" class="nd ly ir my b be ne nf l ng nh">const getMoneyLeft = (p: Param): number =&gt;<br/>  p.month * p.saving + p.priceOld - p.priceNew;</span></pre><p id="a6ff" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">我现在有了解决这个问题所需的所有部件。</p><pre class="kq kr ks kt gu mz my na bn nb nc bi"><span id="854e" class="nd ly ir my b be ne nf l ng nh">export function nbMonths(<br/>  priceOld: number,<br/>  priceNew: number,<br/>  saving: number,<br/>  percentLoss: number,<br/>  month: number = 0<br/>): number[] {<br/>  let p: Param = { priceOld, priceNew, saving, percentLoss, month };<br/><br/>  while (getMoneyLeft(p) &lt; 0) {<br/>    p.month = updateMonth(p);<br/>    p.percentLoss = updatePercentLoss(p);<br/>    p.priceNew = updatePriceNew(p);<br/>    p.priceOld = updatePriceOld(p);<br/>  }<br/><br/>  return [p.month, Math.round(getMoneyLeft(p))];<br/>}</span></pre><p id="0408" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">如果我们想做过头，我们可以增加一个新功能:</p><pre class="kq kr ks kt gu mz my na bn nb nc bi"><span id="8156" class="nd ly ir my b be ne nf l ng nh">const updateValues = (p: Param): Param =&gt; {<br/>  return {<br/>    priceOld: updatePriceOld(p),<br/>    priceNew: updatePriceNew(p),<br/>    saving: p.saving,<br/>    percentLoss: updatePercentLoss(p),<br/>    month: updateMonth(p),<br/>  };<br/>};</span></pre><p id="a9de" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">这让我们回到最初的解决方案。将各个部分放在一起，并使代码适应<a class="ae mu" href="https://www.codewars.com/" rel="noopener ugc nofollow" target="_blank"> CodeWars </a>测试，我们得到:</p><pre class="kq kr ks kt gu mz my na bn nb nc bi"><span id="e644" class="nd ly ir my b be ne nf l ng nh">type Param = {<br/>  priceOld: number;<br/>  priceNew: number;<br/>  saving: number;<br/>  percentLoss: number;<br/>  month: number;<br/>};<br/><br/>const value = (price: number, delta: number): number =&gt;<br/>  price * (1 - delta / 100);<br/><br/>const updatePercentLoss = (p: Param): number =&gt;<br/>  p.percentLoss + (1 - (p.month % 2)) * 0.5;<br/>const updatePriceNew = (p: Param): number =&gt; value(p.priceNew, p.percentLoss);<br/>const updatePriceOld = (p: Param): number =&gt; value(p.priceOld, p.percentLoss);<br/>const updateMonth = (p: Param): number =&gt; p.month + 1;<br/><br/>const getMoneyLeft = (p: Param): number =&gt;<br/>  p.month * p.saving + p.priceOld - p.priceNew;<br/><br/>const updateValues = (p: Param): Param =&gt; {<br/>  return {<br/>    priceOld: updatePriceOld(p),<br/>    priceNew: updatePriceNew(p),<br/>    saving: p.saving,<br/>    percentLoss: updatePercentLoss(p),<br/>    month: updateMonth(p),<br/>  };<br/>};<br/><br/>export function nbMonths(<br/>  priceOld: number,<br/>  priceNew: number,<br/>  saving: number,<br/>  percentLoss: number,<br/>  month: number = 0<br/>): number[] {<br/>  let p: Param = { priceOld, priceNew, saving, percentLoss, month };<br/><br/>  while (getMoneyLeft(p) &lt; 0) {<br/>    p = { ...updateValues(p) };<br/>  }<br/><br/>  return [p.month, Math.round(getMoneyLeft(p))];<br/>}</span></pre><p id="7158" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">感谢阅读！敬请关注更多内容。</p></div><div class="ab cl ni nj hv nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="ik il im in io"><p id="9ef0" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated"><strong class="ld jb"> <em class="np">不要错过我的下一篇文章—报名我的</em> </strong> <a class="ae mu" href="https://medium.com/subscribe/@el3um4s" rel="noopener"> <strong class="ld jb"> <em class="np">中邮箱列表</em> </strong> </a></p><div class="nq nr gq gs ns nt"><a href="https://el3um4s.medium.com/membership" rel="noopener follow" target="_blank"><div class="nu ab fp"><div class="nv ab nw cl cj nx"><h2 class="bd jb gz z fq ny fs ft nz fv fx ja bi translated">通过我的推荐链接加入Medium—Samuele</h2><div class="oa l"><h3 class="bd b gz z fq ny fs ft nz fv fx dk translated">阅读萨缪尔的每一个故事(以及媒体上成千上万的其他作家)。不是中等会员？在这里加入一块…</h3></div><div class="ob l"><p class="bd b dl z fq ny fs ft nz fv fx dk translated">el3um4s.medium.com</p></div></div><div class="oc l"><div class="od l oe of og oc oh kz nt"/></div></div></a></div><p id="f448" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated"><em class="np">更多内容看</em> <a class="ae mu" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ld jb"> <em class="np">说白了。报名参加我们的</em> <a class="ae mu" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ld jb"> <em class="np">免费周报</em> </strong> </a> <em class="np">。关注我们关于</em> <a class="ae mu" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"> <strong class="ld jb"> <em class="np">推特</em> </strong> </a>，<a class="ae mu" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="ld jb"><em class="np">LinkedIn</em></strong></a><em class="np">，</em><a class="ae mu" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"><strong class="ld jb"><em class="np">YouTube</em></strong></a><em class="np">，以及</em> <a class="ae mu" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="ld jb"> <em class="np">不和</em> </strong> </a> <strong class="ld jb"> <em class="np">。</em> </strong></strong></a></p><p id="b0ea" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated"><strong class="ld jb"> <em class="np">有兴趣缩放你的软件启动</em> </strong> <em class="np">？检查出</em> <a class="ae mu" href="https://circuit.ooo/?utm=publication-post-cta" rel="noopener ugc nofollow" target="_blank"> <strong class="ld jb"> <em class="np">电路</em> </strong> </a> <em class="np">。</em></p></div></div>    
</body>
</html>