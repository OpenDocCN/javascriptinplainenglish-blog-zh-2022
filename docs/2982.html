<html>
<head>
<title>What React is NOT Made For</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">什么反应不是为</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/what-reactjs-is-not-made-for-7a3a9eb109?source=collection_archive---------15-----------------------#2022-07-19">https://javascript.plainenglish.io/what-reactjs-is-not-made-for-7a3a9eb109?source=collection_archive---------15-----------------------#2022-07-19</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="ea7e" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">React是为数据驱动的动态网站设计的——但对于较小的项目来说，它会使过程变得更长。学会什么时候不使用React。</h2></div><p id="8351" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">当某个工具变得难以置信的流行时，很容易陷入在知道问题之前选择工具的陷阱。这就像先买一把锤子，然后再看计划需要的是螺丝还是钉子。</p><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="gh gi ky"><img src="../Images/feb170c1360b7a92c2c442158121311d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MtYBBSl9agaWNifcYt_GVg.jpeg"/></div></div></figure><h1 id="94e5" class="lk ll in bd lm ln lo lp lq lr ls lt lu jt lv ju lw jw lx jx ly jz lz ka ma mb bi translated">摘要</h1><p id="e810" class="pw-post-body-paragraph kc kd in ke b kf mc jo kh ki md jr kk kl me kn ko kp mf kr ks kt mg kv kw kx ig bi translated">我一直在热情地学习React，但不太明白它的设计目的是什么，不是什么。因此，我尝试用普通的JavaScript和React构建了许多小应用程序，以理解事物是如何从一个转换到另一个的。以下是我学到的！</p><h2 id="d6ec" class="mh ll in bd lm mi mj dn lq mk ml dp lu kl mm mn lw kp mo mp ly kt mq mr ma ms bi translated">React的设计目的是什么？</h2><p id="8095" class="pw-post-body-paragraph kc kd in ke b kf mc jo kh ki md jr kk kl me kn ko kp mf kr ks kt mg kv kw kx ig bi translated">React是为数据驱动的动态网站设计的，通常是单页面应用程序，其中数据是从服务器请求的，然后由浏览器使用来呈现页面。React有助于将应用程序分解成许多小的UI组件，这使得在大型团队中进行思维映射和共享组件变得更加容易。脸书是一个完美的例子(React的创造者)。</p><h2 id="bdbe" class="mh ll in bd lm mi mj dn lq mk ml dp lu kl mm mn lw kp mo mp ly kt mq mr ma ms bi translated">我试图建造什么？</h2><p id="c316" class="pw-post-body-paragraph kc kd in ke b kf mc jo kh ki md jr kk kl me kn ko kp mf kr ks kt mg kv kw kx ig bi translated">一个节拍器应用程序，没有服务器端编程或从数据库获取数据。只是复杂的客户端节拍器逻辑，为音乐家创建一个工具。</p><h2 id="8fe2" class="mh ll in bd lm mi mj dn lq mk ml dp lu kl mm mn lw kp mo mp ly kt mq mr ma ms bi translated">我成功了吗？</h2><p id="1d71" class="pw-post-body-paragraph kc kd in ke b kf mc jo kh ki md jr kk kl me kn ko kp mf kr ks kt mg kv kw kx ig bi translated">是的，实际上！但是使用React更加困难，需要更多的代码行和更多的依赖项。</p><h1 id="4ec8" class="lk ll in bd lm ln lo lp lq lr ls lt lu jt lv ju lw jw lx jx ly jz lz ka ma mb bi translated">该项目</h1><p id="9e88" class="pw-post-body-paragraph kc kd in ke b kf mc jo kh ki md jr kk kl me kn ko kp mf kr ks kt mg kv kw kx ig bi translated">我的目标是在React中重建我的<a class="ae mt" href="https://github.com/michaelpgalen/SwingDivision" rel="noopener ugc nofollow" target="_blank">swing division节拍器</a>，目的是了解React的更多弱点以及如何克服它们。</p><h2 id="51cc" class="mh ll in bd lm mi mj dn lq mk ml dp lu kl mm mn lw kp mo mp ly kt mq mr ma ms bi translated">我的挑战，我在哪里找到帮助和解决方案！</h2><p id="990c" class="pw-post-body-paragraph kc kd in ke b kf mc jo kh ki md jr kk kl me kn ko kp mf kr ks kt mg kv kw kx ig bi translated"><strong class="ke io"> <em class="mu">挑战一:节拍器构造函数放在哪里？</em> </strong></p><p id="b224" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">对于vanilla JS版本，我创建了一个计时器构造函数(灵感来自YouTube上音乐和编码的创建者)。然后，我使用metronome的回调和错误函数声明了timer函数的一个实例。这有助于我将一些复杂性分成更小的块。在React中，我不知道在哪里写我的构造函数代码，以便它可以用于我的节拍器。构造函数依赖于“this”关键字，但在React中将所有东西都分解成模块时，这个关键字似乎丢失了。</p><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="gh gi mv"><img src="../Images/5169e20ffa65dfbe2e045e134b94f3fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SiXc46Z5SZn-sRAH-o-cQg.png"/></div></div><figcaption class="mw mx gj gh gi my mz bd b be z dk">The vanilla JS constructor function for my metronome</figcaption></figure><p id="5c59" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="ke io"> <em class="mu">解</em> </strong></p><p id="954b" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我从来没有弄清楚在哪里编写这样的构造函数，以及如何在React中使用它，但是相反，我意识到我不需要函数的多个实例。所以，我只是将函数逻辑直接写入我的startStopBtn组件，而不需要' this '关键字。</p><p id="7446" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="ke io"> <em class="mu">挑战二:状态需要管理在哪里？</em>T15】</strong></p><p id="cfb1" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我的普通JS版本不需要考虑太多状态管理，因为我所有的UI都编码在一个文件中。常规JS变量通过事件处理程序声明并绑定到用户输入，然后读入metronome逻辑和UI。</p><p id="2030" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在React中，每个UI组件都是自己的模块。因此，在创建了UI的静态版本之后，我必须考虑状态。哪些变量需要改变，哪些组件需要接受这些改变？</p><p id="1f53" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="ke io"> <em class="mu">解</em> </strong></p><p id="a722" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我映射了组件架构，然后通过识别读取特定状态的所有组件的最近公共祖先，来标记哪些组件需要管理哪个状态变量。</p><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="gh gi na"><img src="../Images/31ac273a92549bb418202b21ee1ebfd2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hLoJ6YD3Yt2dQ9iscnymUA.png"/></div></div><figcaption class="mw mx gj gh gi my mz bd b be z dk">Component Architecture Map</figcaption></figure><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="gh gi nb"><img src="../Images/61a19db24b6cb71479fd621840487687.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SyFn5DXg2w44l8KerOmEpA.png"/></div></div><figcaption class="mw mx gj gh gi my mz bd b be z dk">UserInput module, managing state for rhythm and beatCount</figcaption></figure><p id="b155" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="ke io"> <em class="mu">挑战三:每个新渲染丢失timeoutID时如何清除Timeout？</em> </strong></p><p id="33c1" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这是我最大的障碍！我使用google、StackOverflow、slack groups等等，到处寻找解决方案。至少有一半的答案使用了React的旧类模型，所以我不得不改进我的搜索以使用Hooks进行React。我发现的所有解决方案/示例都是针对单次超时的，这需要在用户没有主动取消任务的情况下自动清除超时。我的问题是不同的，因为我有一个递归超时，我希望clearTimeout由onClick事件触发。这些细节都不符合我找到的解决方案。</p><p id="11df" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">问题是:每一次状态改变——从而重新呈现——都会导致我丢失超时Id。因此，当用户单击“STOP”时，React再次呈现UI组件并丢失超时ID，使clearTimeout函数变得无用。我尝试使用Context来维护我正在丢失的超时ID，但是不起作用。所有这些搜索促使我学习了很多关于使用状态、使用上下文和使用效果的知识。</p><p id="47ba" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="ke io"> <em class="mu">解</em> </strong></p><p id="bb86" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">深入研究React钩子文档，我了解到尽管useEffect钩子不需要返回任何东西(这是典型的)，但是可以让它们的useEffect块返回一个arrow函数，它将在组件生命周期结束时被调用。因此，在下一次渲染之前，当组件卸载时，将返回useEffect。有了这个发现，我能够将我的节拍器逻辑放入useEffect，并返回clearTimeout。这样，当用户单击“STOP”时，它会触发状态更改，但在卸载组件和装载新实例之前，会返回以前的useEffect，在超时ID丢失之前清除超时。</p><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="gh gi nc"><img src="../Images/ec962a614d22af31ff7df3f022fffaba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rB_9MB7MAaEzR0zGBaelbg.png"/></div></div><figcaption class="mw mx gj gh gi my mz bd b be z dk">The useEffect() block and the return() with all my essential metronome logic.</figcaption></figure><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="gh gi nd"><img src="../Images/57536b0adfcb18213dce19ec613d380b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ViVok-81r-M51uy0Dq15Bg.png"/></div></div><figcaption class="mw mx gj gh gi my mz bd b be z dk">The order of execution for State and useEffect in React</figcaption></figure><p id="d137" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="ke io"> <em class="mu">挑战4:如何使用How ljs——是否真的需要？</em>T15】</strong></p><p id="8785" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">HowlJS是一个伟大的javascript库，解决了许多网络音频挑战。在我的普通JS版本的应用程序中，这是一个有用的工具，它允许我的音频文件自行中断并重放。没有嚎叫，节拍器点击将被跳过，直到当前音频文件播放完毕。不好！</p><p id="53ab" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">不幸的是，我的嚎叫音频对象没有在React版本中播放。我查阅了how js文档和google，寻找如何将how js整合到React项目中的信息和示例。</p><p id="e24e" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我发现人们已经开发了必要的React钩子来成功地合并HowlJS。</p><p id="ede5" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="ke io"> <em class="mu">解</em> </strong></p><p id="660d" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在学习新的HowlJS钩子的API之前，我思考了React的魔力。它如何创建虚拟DOM并只呈现改变状态的UI组件。我测试了在没有嚎叫的情况下制作节拍器，经过一些障碍后，它成功了！React的state magic已经解决了vanilla JS在回放音频文件时遇到的问题。</p><h1 id="a8a7" class="lk ll in bd lm ln lo lp lq lr ls lt lu jt lv ju lw jw lx jx ly jz lz ka ma mb bi translated">结论</h1><p id="05bd" class="pw-post-body-paragraph kc kd in ke b kf mc jo kh ki md jr kk kl me kn ko kp mf kr ks kt mg kv kw kx ig bi translated">React是为动态数据驱动的网站设计的，在这种网站中，数据是从服务器请求的，然后由客户端的浏览器用来呈现页面。React使工程师能够将UI组件封装到可以管理它们自己状态的模块中。这有助于大型组织管理包含大量组件的应用程序。我的metronome应用程序不需要大型团队协作，也不需要从服务器上获取数据。因此，React并不是这项工作的最佳工具。不过，我还是推荐这种学习React或任何其他JavaScript框架/库的方法。</p><p id="8578" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">首先，用vanilla JS构建一个项目，因为在核心处，这就是所有这些前端框架要转换的内容。你对普通JS理解得越好，你就越容易使用更高级的框架。</p><p id="f5a0" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">第二，尝试使用React或任何你想学习的框架来重建应用程序。对挑战要有耐心。记住，你的目标不是成品，而是学习。因此，欢迎挑战和他们需要的所有解决方案挖掘！</p></div><div class="ab cl ne nf hr ng" role="separator"><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj nk"/><span class="nh bw bk ni nj"/></div><div class="ig ih ii ij ik"><p id="973d" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="mu">更多内容请看</em><a class="ae mt" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="ke io"><em class="mu">plain English . io</em></strong></a><em class="mu">。报名参加我们的</em> <a class="ae mt" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io"> <em class="mu">免费周报</em> </strong> </a> <em class="mu">。关注我们关于</em><a class="ae mt" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="ke io"><em class="mu">Twitter</em></strong></a><a class="ae mt" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="ke io"><em class="mu">LinkedIn</em></strong></a><em class="mu"/><a class="ae mt" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"><strong class="ke io"><em class="mu">YouTube</em></strong></a><em class="mu"/><a class="ae mt" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"><strong class="ke io"><em class="mu">不和</em> </strong> </a> <em class="mu">。对增长黑客感兴趣？检查</em> <a class="ae mt" href="https://circuit.ooo/" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io"> <em class="mu">电路</em> </strong> </a> <em class="mu">。</em></p></div></div>    
</body>
</html>