<html>
<head>
<title>Use of DTO for Validation in NestJS Application</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在NestJS应用程序中使用DTO进行验证</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/use-of-dto-for-validation-in-nestjs-application-d37ff55f0560?source=collection_archive---------1-----------------------#2022-03-08">https://javascript.plainenglish.io/use-of-dto-for-validation-in-nestjs-application-d37ff55f0560?source=collection_archive---------1-----------------------#2022-03-08</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="fb88" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">如何用NestJS框架处理和验证REST端点的数据。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/353acc11c0df79aef715c9a8ec1a1e34.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ts2OZ2puBTih3vPV0BuLIA.png"/></div></div></figure><p id="a452" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">本文的目的是展示如何用<a class="ae lk" href="https://nestjs.com/" rel="noopener ugc nofollow" target="_blank"> NestJS </a>框架处理和验证rest端点的数据。</p><h1 id="94ee" class="ll lm in bd ln lo lp lq lr ls lt lu lv jt lw ju lx jw ly jx lz jz ma ka mb mc bi translated"><strong class="ak">什么是DTO？</strong></h1><p id="c237" class="pw-post-body-paragraph ko kp in kq b kr md jo kt ku me jr kw kx mf kz la lb mg ld le lf mh lh li lj ig bi translated">DTO是数据传输对象的简称。使用DTO来验证传入的请求。</p><p id="cf4c" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">DTO本身更多的是为开发者和那些使用API的人提供一个指南，让他们知道请求体期望是什么样的形状，它本身实际上并不运行任何验证<strong class="kq io">！！！</strong>。</p><h1 id="4e8d" class="ll lm in bd ln lo lp lq lr ls lt lu lv jt lw ju lx jw ly jx lz jz ma ka mb mc bi translated">我们为什么要用DTO？</h1><p id="1832" class="pw-post-body-paragraph ko kp in kq b kr md jo kt ku me jr kw kx mf kz la lb mg ld le lf mh lh li lj ig bi translated">在<strong class="kq io"> Nest </strong>中还有一些其他的重要概念。<strong class="kq io"> js </strong> : <strong class="kq io"> DTO </strong>:数据传输对象是定义数据如何通过网络发送的对象。接口:类型脚本接口<strong class="kq io">用于</strong>类型检查和定义可以传递给控制器或<strong class="kq io">嵌套</strong>服务的数据类型。</p><h1 id="9390" class="ll lm in bd ln lo lp lq lr ls lt lu lv jt lw ju lx jw ly jx lz jz ma ka mb mc bi translated">我们如何使用它？</h1><p id="bd63" class="pw-post-body-paragraph ko kp in kq b kr md jo kt ku me jr kw kx mf kz la lb mg ld le lf mh lh li lj ig bi translated">假设我们想要创建一个端点来添加一个产品，并且我们想要在进入服务之前验证这个产品。我们希望在控制器级别验证它。使用NestJS的方法是什么？</p><p id="e8ec" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我们需要创建我们的d to类💁‍♀️，带有应该被验证的字段(我们应该安装库类验证器来验证数据)</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mi mj l"/></div></figure><p id="c52e" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在我们想添加一个名为product_type的枚举字段，并想通过DTO进行验证。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mi mj l"/></div></figure><p id="d7b2" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我们不仅可以验证单个字段，还可以用NestJS中的DTO验证一组对象。为此，我们需要使用一个类转换器。例如，我们有一个产品数组，其中我们需要验证多个产品对象。我们将制作一个<strong class="kq io">类型</strong>的数组，然后我们将验证它。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mi mj l"/></div></figure><p id="578a" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我们已经讨论了足够多的DTO，但在此之前，我们只需要创建一个全局验证管道，下面是对其属性的解释:</p><ul class=""><li id="6e91" class="mk ml in kq b kr ks ku kv kx mm lb mn lf mo lj mp mq mr ms bi translated"><strong class="kq io">白名单</strong>:删除不在DTO中的请求主体的所有属性</li><li id="2fd4" class="mk ml in kq b kr mt ku mu kx mv lb mw lf mx lj mp mq mr ms bi translated"><strong class="kq io">转换</strong>:这个属性允许我们转换属性，例如，将一个整数转换成一个字符串。我们今天不讨论这个。</li></ul><h1 id="40a9" class="ll lm in bd ln lo lp lq lr ls lt lu lv jt lw ju lx jw ly jx lz jz ma ka mb mc bi translated">一些要点:</h1><ul class=""><li id="5ae5" class="mk ml in kq b kr md ku me kx my lb mz lf na lj mp mq mr ms bi translated"><strong class="kq io">dto用于减少代码重复</strong></li><li id="1a48" class="mk ml in kq b kr mt ku mu kx mv lb mw lf mx lj mp mq mr ms bi translated"><strong class="kq io">为了实现部分验证，可以使用</strong> <code class="fe nb nc nd ne b"><strong class="kq io">PartialType</strong></code> <strong class="kq io">效用函数。你可以在这里了解一下:</strong><a class="ae lk" href="https://docs.nestjs.com/openapi/mapped-types#partial" rel="noopener ugc nofollow" target="_blank"><strong class="kq io">https://docs.nestjs.com/openapi/mapped-types#partial</strong></a></li></ul><p id="ca47" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><em class="nf">更多内容请看</em><a class="ae lk" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kq io"><em class="nf">plain English . io</em></strong></a><em class="nf">。报名参加我们的</em><strong class="kq io"><em class="nf"/></strong><a class="ae lk" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kq io"><em class="nf">免费周报</em> </strong> </a> <em class="nf">。关注我们关于</em><a class="ae lk" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="kq io"><em class="nf">Twitter</em></strong></a><em class="nf">和</em><a class="ae lk" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kq io"><em class="nf">LinkedIn</em></strong></a><em class="nf">。加入我们的</em> <a class="ae lk" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io"> <em class="nf">社区</em> </strong> </a> <em class="nf">。</em></p></div></div>    
</body>
</html>