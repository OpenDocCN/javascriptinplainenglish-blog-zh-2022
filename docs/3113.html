<html>
<head>
<title>How Provide and Inject Work in Vue.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Vue.js中提供和注入工作</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-provide-and-inject-work-in-vue-js-5b2de8a93ae?source=collection_archive---------10-----------------------#2022-08-01">https://javascript.plainenglish.io/how-provide-and-inject-work-in-vue-js-5b2de8a93ae?source=collection_archive---------10-----------------------#2022-08-01</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="621a" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">提供和注入让我们将数据放在应用程序结构中较低的位置。让我们看看它们是如何工作的。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/8946068dd8715b023524930f13f1daa4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I71iq7jwnWMfqtBtLyXBqA.png"/></div></div></figure><p id="7cd0" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在Vue中很容易为子元素提供/赋予属性。Vue中的属性是我们将数据从父元素或Vue模板传递到子元素的主要方式之一。例如，在下面的代码中，我们赋予子元素<code class="fe ll lm ln lo b">PopularList</code>属性<code class="fe ll lm ln lo b">name</code>，并将其设置为<code class="fe ll lm ln lo b">Most Popular Posts</code>。这意味着<code class="fe ll lm ln lo b">PopularList</code>现在可以访问数据<code class="fe ll lm ln lo b">Most Popular Posts</code>:</p><pre class="kd ke kf kg gt lp lo lq lr aw ls bi"><span id="2eea" class="lt lu in lo b gy lv lw l lx ly">&lt;PopularList name="Most Popular Posts" /&gt;</span></pre><p id="8f52" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">然而，有时子元素可以包含其他子元素。如果我们想将数据从父组件传递到孙组件，更简单的方法是使用<strong class="kq io">provide</strong>/<strong class="kq io">inject</strong>。这让我们<strong class="kq io">在父级别提供</strong>数据，而<strong class="kq io">在它之下的任何级别注入</strong>数据。</p><p id="cdbb" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">这意味着如果我们有一个属性不是由子代使用，而是由<strong class="kq io">孙代</strong>使用，我们不必像<code class="fe ll lm ln lo b">Parent → Child → GrandChild</code>一样通过两者传递它——我们可以简单地将它作为<code class="fe ll lm ln lo b">Parent → Grandchild</code>传递，如下图所示:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi lz"><img src="../Images/ddce2dadbdf5208e0f1d0cdc72d19dab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*aHpnfq_ELCy1wXx_.png"/></div></div></figure><h1 id="7990" class="ma lu in bd mb mc md me mf mg mh mi mj jt mk ju ml jw mm jx mn jz mo ka mp mq bi translated">如何在Vue中使用提供和注入</h1><p id="bf9d" class="pw-post-body-paragraph ko kp in kq b kr mr jo kt ku ms jr kw kx mt kz la lb mu ld le lf mv lh li lj ig bi translated">如果您正在使用composition API，您可以使用<code class="fe ll lm ln lo b">provide</code>函数<code class="fe ll lm ln lo b">provide</code>任何数据集:</p><pre class="kd ke kf kg gt lp lo lq lr aw ls bi"><span id="ce5e" class="lt lu in lo b gy lv lw l lx ly">&lt;script setup&gt;<br/>    import { provide } from 'vue'<br/>    provide('myKey', 'message');<br/>&lt;/script&gt;</span></pre><p id="cc15" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><code class="fe ll lm ln lo b">provide</code>既有键又有值——以上，键是<code class="fe ll lm ln lo b">myKey</code>，值是<code class="fe ll lm ln lo b">message</code>。与props一样，这可以是一个对象、一个数字或任何其他有效的类型。我们还可以让这个属性成为reactive，这样它就可以通过使用<code class="fe ll lm ln lo b">ref</code>函数在孙元素中保持最新:</p><pre class="kd ke kf kg gt lp lo lq lr aw ls bi"><span id="c59c" class="lt lu in lo b gy lv lw l lx ly">&lt;script setup&gt;<br/>    import { provide, ref } from 'vue'<br/>    const message = ref('message');<br/>    provide('myKey', message);<br/>&lt;/script&gt;</span></pre><p id="baf8" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">如果您使用的是Options API，则可以使用以下结构在组件中提供数据:</p><pre class="kd ke kf kg gt lp lo lq lr aw ls bi"><span id="0c11" class="lt lu in lo b gy lv lw l lx ly">export default {<br/>    provide: {<br/>        myKey: 'message'<br/>    }<br/>}</span></pre><p id="ef46" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">如果你想在<code class="fe ll lm ln lo b">provide</code>中选择API版本的反应性，你必须使用<code class="fe ll lm ln lo b">computed</code>。因此，组合API与<code class="fe ll lm ln lo b">provide/inject</code>一起使用更加简单。如果我们给出每个实例的状态，也就是数据来自<code class="fe ll lm ln lo b">data() </code>函数，我们也需要使用<code class="fe ll lm ln lo b">provide()</code>符号。</p><pre class="kd ke kf kg gt lp lo lq lr aw ls bi"><span id="5fc4" class="lt lu in lo b gy lv lw l lx ly">export default {<br/>    data() {<br/>        return {<br/>            message: 'message'<br/>        }<br/>    },<br/>    provide() {<br/>        return {<br/>            // This sets `myKey` to the message property from data().<br/>            // Putting it in `computed()` makes it reactive.<br/>            myKey: computed(() =&gt; this.message)<br/>        }<br/>    }<br/>}</span></pre><p id="d40e" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io">现在</strong>我们已经提供了数据，可以通过使用<code class="fe ll lm ln lo b">inject</code>函数在任何级别的任何子组件中访问它。</p><h1 id="107e" class="ma lu in bd mb mc md me mf mg mh mi mj jt mk ju ml jw mm jx mn jz mo ka mp mq bi translated">在Vue中使用注入访问父数据</h1><p id="c791" class="pw-post-body-paragraph ko kp in kq b kr mr jo kt ku ms jr kw kx mt kz la lb mu ld le lf mv lh li lj ig bi translated">现在我们已经在组件中定义了<code class="fe ll lm ln lo b">provide</code>，您可以使用<code class="fe ll lm ln lo b">inject</code>来访问该数据。在子组件或孙组件中，我们可以访问<code class="fe ll lm ln lo b">myKey</code>来引用<code class="fe ll lm ln lo b">message</code>。例如，假设我们有一个Vue组件，如下所示:</p><pre class="kd ke kf kg gt lp lo lq lr aw ls bi"><span id="c60f" class="lt lu in lo b gy lv lw l lx ly">&lt;script setup&gt;<br/>    import { ref, provide } from 'vue'<br/>    import ChildElement from './Child.vue';<br/>    const message = ref('message');<br/>    provide('myKey', message);<br/>&lt;/script&gt;<br/>&lt;template&gt;<br/>    &lt;p&gt;Hello World!&lt;/p&gt;<br/>    &lt;ChildElement /&gt;<br/>&lt;/template&gt;</span></pre><p id="fa55" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">…然后是一个子元素(<code class="fe ll lm ln lo b">Child.vue</code>)，如下所示:</p><pre class="kd ke kf kg gt lp lo lq lr aw ls bi"><span id="8162" class="lt lu in lo b gy lv lw l lx ly">&lt;script setup&gt;<br/>    import GrandChildElement from './GrandChildElement.vue';<br/>&lt;/script&gt;<br/>&lt;template&gt;<br/>    &lt;GrandChildElement /&gt;<br/>&lt;/template&gt;</span></pre><p id="dd45" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在<code class="fe ll lm ln lo b">GrandChildElement</code>中，我们可以访问<code class="fe ll lm ln lo b">myKey</code>，因为我们在父节点中提供了它。我们也可以在<code class="fe ll lm ln lo b">Child.vue</code>中这样做，但是我们也可以只使用道具。<code class="fe ll lm ln lo b">provide</code>赋予我们从多个层面获取数据的能力。为了在<code class="fe ll lm ln lo b">GrandChildElement</code>中访问这些数据，我们使用<code class="fe ll lm ln lo b">inject</code>。我们的<code class="fe ll lm ln lo b">GrandChildElement.vue</code>文件可能看起来有点像这样:</p><pre class="kd ke kf kg gt lp lo lq lr aw ls bi"><span id="d7b3" class="lt lu in lo b gy lv lw l lx ly">&lt;script setup&gt;<br/>import { inject } from 'vue'<br/>const message = inject('myKey')<br/>&lt;/script&gt;</span></pre><p id="f248" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><code class="fe ll lm ln lo b">const message</code>这里将返回文本<code class="fe ll lm ln lo b">message</code>，因为这是我们用<code class="fe ll lm ln lo b">provide</code>设置的<code class="fe ll lm ln lo b">myKey</code>。如果您使用的是Options API，您可以这样做:</p><pre class="kd ke kf kg gt lp lo lq lr aw ls bi"><span id="ea1f" class="lt lu in lo b gy lv lw l lx ly">export default {<br/>    inject: [ 'myKey' ],<br/>    created() {<br/>        // Can access this.myKey here<br/>    }<br/>}</span></pre><p id="b80b" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在<code class="fe ll lm ln lo b">myKey</code>的值可用于孙组件，而不需要先通过props传递给子组件。</p></div><div class="ab cl mw mx hr my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="ig ih ii ij ik"><p id="d314" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><em class="nd">更内容于</em> <a class="ae lk" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io"> <em class="nd">普通英语</em> </strong> </a> <em class="nd">。报名参加我们的</em> <a class="ae lk" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io"> <em class="nd">免费周报</em> </strong> </a> <em class="nd">。</em> <a class="ae lk" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io"> <em class="nd">推特</em> </strong> </a> <em class="nd">和</em><a class="ae lk" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kq io"><em class="nd">LinkedIn</em></strong></a><em class="nd">追随我们。查看我们的</em> <a class="ae lk" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io"> <em class="nd">社区不和</em> </strong> </a> <em class="nd">并加入我们的</em> <a class="ae lk" href="https://inplainenglish.pallet.com/talent/welcome" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io"> <em class="nd">人才集体</em> </strong> </a> <em class="nd">。</em></p></div></div>    
</body>
</html>