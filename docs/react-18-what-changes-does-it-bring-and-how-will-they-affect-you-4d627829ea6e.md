# 反应 18——它带来了什么变化，它们会如何影响你？

> 原文：<https://javascript.plainenglish.io/react-18-what-changes-does-it-bring-and-how-will-they-affect-you-4d627829ea6e?source=collection_archive---------19----------------------->

## React 刚刚收到了其版本 18 发布的稳定版；我们得到了什么改变，它们将如何影响你？

![](img/5a8af092e1c26faf143263cd20e782b7.png)

*   React 刚刚收到了其版本 18 发布的稳定版；
*   有许多改变将改善 React 开发人员的生活，包括服务器组件、悬念改进或并发渲染；
*   与任何工具一样，这个工具也有它的使用案例。它对某些任务来说很棒，但对其他任务来说不是最佳的。自然，脸书的图书馆也不例外，它不是没有一些缺陷；
*   在所有这些重大改进在 Vercel 的 Next.js 或 Shopify 的 Hydrogen 的稳定版本中落地之前，我们还需要等待一段时间。

React，脸书用于构建用户界面的图书馆刚刚接受了下一次重大提升。有很多令人兴奋的事情，从新的*并发渲染*开始，通过新的*钩子*，以*React*的编译器结束，我们可能会看到，也可能不会看到。有很多东西需要解开，在此之前，让我们先回答一个关键问题:“升级有多难。”

# 升级

这个过程应该很简单。与此同时，该团队声称迁移大多数应用程序不会花费超过一个下午的时间。您可以访问众多新功能[“只需对您的应用程序代码做最少或不做任何更改”](https://reactjs.org/blog/2021/06/08/the-plan-for-react-18.html)。新功能包括全新的并发渲染。如果你想知道，“[[w]我们[脸书的 React 团队]成功地将并发特性发布到脸书的成千上万个组件中，根据我们的经验，我们发现大多数 React 组件“只需工作”,无需额外的更改。”](https://reactjs.org/blog/2021/06/08/the-plan-for-react-18.html#a-gradual-adoption-strategy)

当然，如果你想利用**所有**新的可能性，那么你将不得不花一些时间重构。时间投资是值得的，因为您现在可以控制哪些组件何时更新，以及其他功能。

## React 18 会破坏我的应用吗？

简答:**极不可能**。长话短说:有时候，你的应用程序会崩溃，但是，这种情况不太可能发生。

一个更常见的情况，你的应用程序不工作，是新的，更严格，严格的模式。如果升级失败，一定要检查你的应用程序是否启用了它。尽管我们知道你会怎么想，但还是考虑一段时间吧。

有几个突破性的变化会让开发者流下幸福的眼泪。React 18 放弃对 Internet Explorer 11 的支持，甚至在微软计划结束支持之前。虽然您期望包的大小会减小，但它并没有减小，现在还没有。[代码仍然在那里](https://news.ycombinator.com/item?id=30844414#30847683)，团队[将在稍后的日期](https://news.ycombinator.com/item?id=30844414#30847683)删除它。对于大多数团队来说，这是个好消息。对大多数人来说，一些企业仍然需要支持微软的浏览器:比如为英国国民医疗服务系统工作的企业。

其他突破性变化？[有一些](https://reactjs.org/blog/2022/03/08/react-18-upgrade-guide.html#other-breaking-changes)你需要注意:

*   其中三个连接到新的，改进的*悬念*，
*   *useEffect* 现在计时一致，
*   不仅 IE 11 失宠，更老的环境也是如此，

这个至关重要的话题结束后，让我们进入新特性的细节。

# React 编译器

React 是一种库，它给你提供构建模块，而不需要告诉你如何用它来高效地构建某个东西。有些人喜欢它，有些人讨厌它:同样的问题有无数种解决方案。另一方面，这也意味着你可能在没有意识到你刚刚犯了一个可怕的错误，或者没有意识到你的解决方案是次优的情况下构建一些东西。

这就是为什么脸书大学的工程团队正在研究一种叫做“React Forget”的实验性编译器从表面上看，这个概念似乎很好。一个为你处理优化的编译器？自动？多酷啊。问题是，这是实验性技术，**和**我们甚至不知道它是否会向公众发布。此外，其他库，如 Vue.js，为你做了所有的优化，“免费”，**和** [比 React](https://krausest.github.io/js-framework-benchmark/current.html) 快。

# React 18 工作组

作为一个开源项目，React 必须与参与创建该库的社区保持联系。从去年开始，有一个 [React 18 工作组](https://github.com/reactwg/react-18)。与 React 社区的规模相比，它很小，而且只接受受邀者。

很高兴看到 React 的团队从一个“有代表性的”开发团队那里获得反馈。毕竟，库背后的基本原理是与外界共享项目，使许多人更容易解决问题。另一方面，人们不得不怀疑更广泛的群体是否不应该至少为工作组成员投票。毕竟，许多人已经投入了无数的时间来改善图书馆。

# 客户端和服务器组件

这里的这个特性可以给**带来很多价值，**不费吹灰之力。说真的。

如果您使用的是相对“干净”的 React 版本，您会非常清楚，您必须将许多库与您的代码捆绑在一起。将 markdown 转换成 HTML，或者将 rich text 转换成 HTML，这是您在客户端经常要做的事情，因为 React 是…一个客户端库。不再是了，因为服务器组件还处于 alpha 阶段。你可能会在你的服务器组件中添加大量的代码，因此**会给你的用户增加 0 字节的负载。有人甚至会说，我们现在正在处理一个全栈库，而不是一个高度集中的前端库。**

服务器组件肯定会全面减少捆绑包的大小，并且**会显著**提高无数网站的性能。ITMAGINATION 的首席创新官马尔钦·dąbrowski 对此表示赞同，他说“React 的全新服务器组件是减小应用程序大小的一个很好的方法。”唯一的问题是它们还不稳定，所以我们不建议你现在使用它们。它的时代将在 18.x 这个次要版本发布后到来。请关注我们的博客，当客户端组件可以在生产中使用时，我们会及时更新。或者，如果你足够勇敢，你可能现在就开始黑客。

# 等一下…等一下…悬念

我们不得不承认，悬疑不是什么新鲜事。这是一个“老”特性，在 React 16.x 中引入。然而，直到现在，该功能还相当有限。不再是了。

悬念让你更快的显示用户界面。矛盾的是，也许这个新特性允许你更快地显示你的组件来显示一个加载状态，比如一个微调器。尽管如此，这是对用户体验的一个重大改进:现在你的用户至少会得到一些反馈；他们会知道幕后发生了什么。至关重要的是，您的组件现在可以彼此独立地呈现。

# 悬念和服务器端渲染

服务器端渲染(SSR)是一种实践，在将所有内容发送给访问者之前，我们在服务器上渲染我们的应用程序。这种方法存在几个问题，尽管有一句话很好地概括了这些问题:“要么全有，要么全无。”

**1。整个页面**需要在我们发送之前准备好；

**2。整个页面**需要发送到浏览器，我们才能显示；

**3。在我们让用户与之交互之前，整个页面**需要具有交互性。

如你所想，这不是最有效的方法。

想象一个博客。一个博客，我们呈现在服务器上，为最好的搜索引擎优化。有时，有些作品既冗长又互动。很自然，你想尽可能快地向你的读者展示你为他们准备的内容。问题是，到目前为止，文本的主体会阻止其余部分显示出来。此外，**它还会阻止整个页面的交互**。不理想，是吧？如果我们不等待一个麻烦制造者，而是首先显示标题、描述和其他部分，同时等待实际内容的加载，会怎么样？

我们甚至可以更进一步。首先，我们显示最少的内容，同时我们还在等待交互元素的加载。尽管这不会是一次完整的体验，我们会让我们的读者忙碌起来，给我们时间把沉重的片段拼凑在一起。悬念保持组件水合作用(增加交互性)**独立。**

为了向 React 的观众说明这一点，React 的团队在他们的 YouTube 频道上邀请了网飞的高级软件工程师 Shaundai Person。整个视频突出了悬念对于视频流媒体平台和其他更重的应用程序来说意味着多少。网飞的团队应该对优化网络应用略知一二。就其本质而言，视频点播平台又重又慢，但你可能会觉得它们又轻又快。关键是用占位符代替较重的部分。然后，一旦缺失的数据准备好，你的应用程序将为你提供完整的体验。

这种模式使得无数的公司减少了跳出率、交互时间等等。最重要的是你的团队要利用新的、改进的悬念。

# 严格模式更改

脸书的团队为未来准备了应用程序，并为未来的性能改进做好了准备。这就是为什么，有一个新的，开发专用，检查。引用文档，“每当组件第一次装载时，这种新的检查将自动卸载并重新装载每个组件，在第二次装载时恢复以前的状态。”更多详情，请点击[此处](https://reactjs.org/blog/2022/03/08/react-18-upgrade-guide.html#updates-to-strict-mode)。

# 自动配料

自动批处理是指状态更新的自动批处理(分组)。目前，多个状态更新会一起执行，这比过去更常见。以前，组件会不必要地多次重新渲染，从而导致问题和速度变慢。[引用文档](https://reactjs.org/blog/2022/03/08/react-18-upgrade-guide.html#updates-to-strict-mode)，“这是一个突破性的改变，但是**我们希望这会减少渲染工作量，从而提高应用程序的性能。**

如果你想退出这个改变，你可以使用 *flushSync* 来完成。由于新机制承诺带来性能改进，我们不鼓励您这样做。

关于这个话题的深入探讨，请参考 GitHub 上的[这个讨论](https://github.com/reactwg/react-18/discussions/21)。

# 并发渲染和用户反馈

并发渲染是一种新的组件渲染方式，它将带来许多更好的变化。并发是逻辑的无序执行，而不改变最终结果。而是要同时处理很多事情。

最初，有传言说“并发模式”会破坏你的应用程序，你需要重写你的应用程序，因为它不再工作了。正如你很容易猜到的，社区对此并不太兴奋。幸运的是，项目背后的团队改变了主意，转而采用渐进的方法。

最后，该功能是 React 应用程序运行的一种强大的新方式。然而，我们所看到的仅仅是一个开始。这些新特性也将成为未来改进的新基础。[引用 React 文档:](https://reactjs.org/blog/2022/03/29/react-v18.html#what-is-concurrent-react)

*“并发渲染是 React 中一个强大的新工具，我们的大多数新功能都是为了利用它而构建的，包括悬念、过渡和流媒体服务器渲染。但 React 18 只是我们在这个新基础上构建的目标的开始。”*

# React 框架:接下来，氢

如果你想知道诸如 Next.js 之类的全栈框架是否会消失，那么我们有好消息告诉你:它们不会。脸书开源库的开发者甚至没有打算替换它们。事实上，Shopify [的一名工程师有机会在 React Conf 2021](https://www.youtube.com/watch?v=HS6vIYkSNks) 上发言。在谈话过程中，我们可以发现服务器组件和所有新功能的集成并不需要普遍采用。

Next.js 也是一样: [React 18 的服务器组件](https://nextjs.org/docs/advanced-features/react-18/overview#react-server-components-alpha)，或者说 [React 18 的“流”](https://nextjs.org/docs/advanced-features/react-18/streaming)功能还在 alpha 阶段，开始在生产中使用它们需要一个勇敢的团队。另一方面，有一种说法是财富偏爱勇敢的人。

如果你能让新功能工作，如果你能承受偶尔的故障，那么确保你的业务升级到新版本。18 版值得。

# 反应 18 批判

如果我们不列出至少一些对 React 及其新版本的常见批评，我们就不能被认为是客观的。

首先，从一个小型库开始，变成了一个庞然大物，现在还包括一些全栈功能(！).人们喜欢取笑 Angular(包括文中的作者)，但最起码它是朝一个方向走的，而且一直停留在那里。它被认为是一个巨大的企业应用框架，事实也的确如此。

其次，新的钩子给已经很复杂——尽管看起来很简单——的 React 带来了更多的复杂性。此外，我们(经常)不能再编写常规的 JavaScript 了。通常，我们不是写我们想写的任何东西，而是必须将所有东西包装在几个钩子中，以确保我们以“最优”的方式做所有事情。这可能会引入一些难以跟踪的细微错误等等。对于那些喜欢钩子的人来说，他们永远也看不够，请看看“React Forget”视频。作为替代，对于那些介意手动优化一切的人，请查看 Vue.js。它在幕后进行优化，让您可以自由地做实际的工作。你也可以用它来写 *jsx* 。

最后，React 正在变成一个黑匣子。有一些关于这个库的问题是开发人员不理解的，或者他们认为他们理解了，然后它就在他们面前爆发了。不要从我这里拿，从贾里德·帕尔默和[他的文章](https://jaredpalmer.com/blog/react-is-becoming-a-black-box) …从 2019 年开始。

如果这几点让你不愿意使用 React，请随时与我们的建筑师安排一次“没有隐藏的捕获，没有附加条件”的咨询，以了解可能的替代方案以及脸书图书馆是否是正确的选择。

# 摘要

毫无疑问，React 是当前网络的统治者。当然，它也不是没有缺陷，批评家提出的一些观点显然是有道理的。然而，没有一个库是没有缺陷的。编程，和生活一样，是一门做出取舍的艺术。问题是你是否做出了正确的选择。大多数现代 web 开发人员倾向于同意这一点。

难怪这个全新的行业选择脸书图书馆作为它的发电站。无论哪个行业，这都是大多数公司开发新产品的默认选择。我们甚至可以更进一步:[基于 React 的 React Native](https://www.itmagination.com/blog/cross-platform-mobile-apps) ，是那些[构建跨平台移动应用](https://www.itmagination.com/ebooks/developing-performant-mobile-apps-native-cross-platform-pwas)的绝佳选择。

新版本 18.0.0 将使新(和旧)应用程序感觉更快:只有团队正确应用上述新功能。我们还可能在无数网站上加载更少的 JavaScript，并且能够更快地与内容进行交互。这一切都归功于 React 18 的改进，也归功于逐步采用的方法。如果您是为数不多的正在努力进行迁移的公司之一，或者正在寻找 web 应用程序开发合作伙伴， [**请随时联系我们的专家**](https://www.itmagination.com/services/node-js-development) **。**

*原载于*[*https://www.itmagination.com*](https://www.itmagination.com/blog/react-18-what-changes-does-it-bring)*。*

*更多内容请看* [***说白了就是***](https://plainenglish.io/) *。报名参加我们的**[***免费每周简讯***](http://newsletter.plainenglish.io/) *。关注我们* [***推特***](https://twitter.com/inPlainEngHQ) *和*[***LinkedIn***](https://www.linkedin.com/company/inplainenglish/)*。加入我们的**[***社区不和谐***](https://discord.gg/GtDtUAvyhW) *。***