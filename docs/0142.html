<html>
<head>
<title>You Shouldn’t be Using Mixins in Vue.js Anymore</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">你不应该再在Vue.js中使用Mixins了</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/you-shouldnt-be-using-mixins-in-vue-js-anymore-ec8c09824f9f?source=collection_archive---------1-----------------------#2022-01-10">https://javascript.plainenglish.io/you-shouldnt-be-using-mixins-in-vue-js-anymore-ec8c09824f9f?source=collection_archive---------1-----------------------#2022-01-10</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/1d6ae1e934451544b1e218d086346936.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*fcTAP9ZhXAVVN2mB"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/@greysonjoralemon?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Greyson Joralemon</a> on <a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="018a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Mixins是Vue 2中组件间共享可重用逻辑的首选方式。但是现在有了组合API，我们可以用更干净的方式实现代码重用。</p><h1 id="df1b" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">什么是混合蛋白？</h1><p id="e29f" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">mixin是通过将mixin的属性与组件合并来在组件之间重用功能的一种方式。它允许我们一次定义某个逻辑，并在多个组件上使用它。</p><h1 id="1ff7" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">为什么我不应该使用mixins？</h1><p id="c74f" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">嗯，混合通常不是共享逻辑的理想方式，因为它们有一些缺点:</p><h2 id="d833" class="mb kz in bd la mc md dn le me mf dp li kl mg mh lm kp mi mj lq kt mk ml lu mm bi translated">重名</h2><p id="0adf" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">命名冲突经常出现在混合中。在合并过程中，mixins和组件之间冲突的属性会基于某种合并策略被覆盖。这可能会在我们的应用程序中导致一些意外的行为。</p><h2 id="7e81" class="mb kz in bd la mc md dn le me mf dp li kl mg mh lm kp mi mj lq kt mk ml lu mm bi translated">紧密结合</h2><p id="b2f4" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">mixin和组件之间的隐式依赖并不少见。这使得在不破坏现有代码的情况下重构组件或mixin变得异常困难。随着时间的推移，随着新需求的出现，mixin也可以与其他mixin紧密耦合。</p><h2 id="4ae5" class="mb kz in bd la mc md dn le me mf dp li kl mg mh lm kp mi mj lq kt mk ml lu mm bi translated">难以理解和调试</h2><p id="905b" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">对于一个新的开发者来说，理解一个有很多混合代码的代码库是非常困难的。属性来自哪里并不明显，尤其是如果有全局注册的mixins。随着应用程序的增长，隔离bug也变成了一场噩梦。</p><h1 id="67fe" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">用组件替换混合组件</h1><p id="cde3" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">让我们从一个例子开始，来说明mixins的一些缺陷，以及我们如何用组合API解决这些问题。</p><p id="7e0e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">假设我们有一个简单的倒计时器，在显示组件的主要内容之前等待几秒钟。我们将这个逻辑提取到一个名为<code class="fe mn mo mp mq b">countDownMixin</code>的mixin中。代码如下所示:</p><figure class="mr ms mt mu gt jo"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="82d4" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">通过注册这个mixin，我们将能够把递减计数逻辑“混合”到组件中。</p><figure class="mr ms mt mu gt jo"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="0da4" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">乍一看，这似乎是一个很好的解决方案，但是如果我想等待20秒而不是10秒呢？</p><p id="5cbe" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">一个解决方案是从消费组件覆盖<code class="fe mn mo mp mq b">countDown</code>的初始状态。通过这样做，我们显式地创建了冲突的名称，因为我们知道组件中定义的数据属性将被赋予最高优先级。</p><figure class="mr ms mt mu gt jo"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="8b51" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这种解决方案是可行的，但是拥有这种能力也使得mixin容易受到其他选项的无意替换。现在，如果组件定义了一个<code class="fe mn mo mp mq b">decrement</code>方法，而不知道<code class="fe mn mo mp mq b">countDownMixin</code>也有一个同名的方法，那么组件将不再像预期的那样工作。</p><figure class="mr ms mt mu gt jo"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="f17d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">尽管<code class="fe mn mo mp mq b">decrement</code>方法被定义为仅供内部使用，但它不可能不被覆盖。</p><h2 id="e485" class="mb kz in bd la mc md dn le me mf dp li kl mg mh lm kp mi mj lq kt mk ml lu mm bi translated">使用组合API的更好的解决方案</h2><figure class="mr ms mt mu gt jo"><div class="bz fp l di"><div class="mv mw l"/></div></figure><p id="8331" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">通过使用Composition API，我们避免了使用mixins时面临的所有问题。<code class="fe mn mo mp mq b">useCountDown</code> composable将倒计时持续时间作为一个参数。不需要覆盖任何东西，依赖关系被整齐地组织为可组合函数的参数。</p><p id="6604" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">它还公开了仅供消费组件使用的属性，并且内部状态受到保护，因此组件不会意外改变可组合组件的行为。</p><p id="88ef" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">名称重叠也不是问题，因为我们需要显式地为所有返回的可组合变量提供名称。</p><figure class="mr ms mt mu gt jo"><div class="bz fp l di"><div class="mv mw l"/></div></figure><h1 id="3ab4" class="ky kz in bd la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv bi translated">结束语</h1><p id="e5cc" class="pw-post-body-paragraph ka kb in kc b kd lw kf kg kh lx kj kk kl ly kn ko kp lz kr ks kt ma kv kw kx ig bi translated">组合API使得代码重用变得非常简单明了。我希望这篇文章足以说服您从mixins中迁移出来，接受composables的力量。如果你需要更多关于组合API的信息，请查看<a class="ae jz" href="https://v3.vuejs.org/guide/composition-api-introduction.html" rel="noopener ugc nofollow" target="_blank">官方文档</a>。感谢您的阅读。</p><p id="a22f" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="mx">更多内容看</em> <a class="ae jz" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <em class="mx">说白了。报名参加我们的</em> </a><a class="ae jz" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <em class="mx">免费每周简讯</em> </a> <em class="mx">。在我们的</em> <a class="ae jz" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <em class="mx">社区</em> </a> <em class="mx">获得独家写作机会和建议。</em></p></div></div>    
</body>
</html>