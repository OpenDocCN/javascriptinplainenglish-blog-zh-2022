<html>
<head>
<title>Deploy Frontend Repositories With a Single Click</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">只需一次点击即可部署前端存储库</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/deploying-frontend-repositories-in-a-single-click-e7ab8c25fe75?source=collection_archive---------12-----------------------#2022-09-15">https://javascript.plainenglish.io/deploying-frontend-repositories-in-a-single-click-e7ab8c25fe75?source=collection_archive---------12-----------------------#2022-09-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="b950" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">关于如何使用Vercel API部署前端存储库的指南</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/0cf89b9db47047437b36ab9e92f7425c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WXuL7y83nXYnnUzrknC5Pw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Vercel API documentation website screenshot</figcaption></figure><h2 id="7d94" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">在后台</h2><p id="8613" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">当我们想要部署我们的定制存储库来为我们的用户预览部署链接时，故事就开始了。我们最终使用代码沙盒API，但是它显示了在浏览器的框架内运行容器的一个问题，所以我们最终移除了部署预览。在今天的故事中，我们将解决同样的问题，但使用Vercel API而不是代码沙箱。</p><h2 id="ec56" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">入门指南</h2><p id="f4db" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">如果你是Vercel的新手，那么<a class="ae mk" href="https://medium.com/nerd-for-tech/5-reasons-why-vercel-is-the-best-for-application-deployment-92009b17e601" rel="noopener">在这里</a>阅读更多细节。我们有一个自定义存储库部分，为用户提供现成的存储库。用户可以下载、查看、保存和共享资源库，共同成长。每个自定义存储库都需要一个部署，以便在成功运行时预览存储库的结果，作为参考，查看右侧代码沙箱中代码的结果。它几乎看起来像一个浏览器，干净，简单，易于使用。</p><p id="1af6" class="pw-post-body-paragraph lr ls iq lt b lu ml jr lw lx mm ju lz le mn mb mc li mo me mf lm mp mh mi mj ij bi translated">我们的议程是提供一个界面来预览用户在网站上查看的每一个自定义存储库的结果。</p></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><h2 id="5373" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">解决方案一</h2><p id="8a1f" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">经过大量的研究，我们决定使用代码沙盒API，它对我们来说很成功，但它也有自己的局限性。每个部署的存储库都在容器中运行，然后显示存储库的结果。</p><p id="a6f1" class="pw-post-body-paragraph lr ls iq lt b lu ml jr lw lx mm ju lz le mn mb mc li mo me mf lm mp mh mi mj ij bi translated">如果您部署一个简单的Next.js存储库，只显示h1标记，代码沙箱将使用yarn run dev等命令在容器中运行存储库，然后显示存储库的结果。</p></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><h2 id="1f05" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">限制</h2><p id="5885" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">以下是我们对代码沙箱部署API不满意的原因:</p><ul class=""><li id="a0c3" class="mx my iq lt b lu ml lx mm le mz li na lm nb mj nc nd ne nf bi translated">代码沙箱运行容器中每个已部署的存储库，而不是直接部署存储库。</li><li id="468f" class="mx my iq lt b lu ng lx nh le ni li nj lm nk mj nc nd ne nf bi translated">在容器中构建和运行存储库既费时又耗费网络资源。</li><li id="b107" class="mx my iq lt b lu ng lx nh le ni li nj lm nk mj nc nd ne nf bi translated">有时存储库部署失败了，却没有给出任何错误，这使得调试变得非常困难。</li></ul></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><h2 id="f5e3" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">解决方案二</h2><p id="fedc" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">当然，我们确实有一个想法来创建我们的自定义部署API，为此，我们需要一些时间，因为我们必须围绕码头工人工作。既然我们已经使用一个接口在Vercel上部署了我们的存储库，为什么不在创建我们的定制部署之前尝试一下Vercel API呢？</p></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><h2 id="8849" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">部署方法</h2><p id="0055" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">我们的方法可以概括为以下几个字</p><ul class=""><li id="f790" class="mx my iq lt b lu ml lx mm le mz li na lm nb mj nc nd ne nf bi translated">创建一个简单易用的存储库。</li><li id="96a6" class="mx my iq lt b lu ng lx nh le ni li nj lm nk mj nc nd ne nf bi translated">为我们的存储库架构创建一个JSON数据结构(我将在本文后面详细解释这一部分)。</li><li id="4560" class="mx my iq lt b lu ng lx nh le ni li nj lm nk mj nc nd ne nf bi translated">为部署创建一个端点，将存储库JSON传递给Vercel API，并将其部署到自定义链接。</li></ul><p id="c5ff" class="pw-post-body-paragraph lr ls iq lt b lu ml jr lw lx mm ju lz le mn mb mc li mo me mf lm mp mh mi mj ij bi translated">在3个步骤内，我们可以部署我们的存储库。</p></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><h2 id="61d8" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">执行</h2><p id="4a37" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">让我们从创建一个简单的next js存储库开始。我没有创建一个，因为我们有一个自定义的回购部分，它一次性提供了所有现成的存储库。您可以从这里下载您的存储库。</p><p id="1ba8" class="pw-post-body-paragraph lr ls iq lt b lu ml jr lw lx mm ju lz le mn mb mc li mo me mf lm mp mh mi mj ij bi translated">一旦存储库准备就绪，我们就可以使用next js提供的无服务器功能来创建部署端点。如果您不熟悉这种无服务器功能，这里有文章链接。</p><p id="6ee0" class="pw-post-body-paragraph lr ls iq lt b lu ml jr lw lx mm ju lz le mn mb mc li mo me mf lm mp mh mi mj ij bi translated">然后，我们为我们的存储库创建JSON数据结构，并将其传递给我们的无服务器部署端点。我们的无服务器部署端点将使用Vercel提供的POST /deployment端点来部署我们简单的下一个js存储库。</p></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><h2 id="7878" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">创建集成</h2><p id="c67f" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">在我们开始使用Vercel API之前。我们需要获取访问令牌，每个对Vercel服务器的API请求都需要这个令牌。</p><p id="b076" class="pw-post-body-paragraph lr ls iq lt b lu ml jr lw lx mm ju lz le mn mb mc li mo me mf lm mp mh mi mj ij bi translated">您可以将访问令牌视为JWT令牌或授权令牌。在Vercel网站上，打开您的集成控制台，通过填写所有必填字段来创建一个集成。</p><p id="1050" class="pw-post-body-paragraph lr ls iq lt b lu ml jr lw lx mm ju lz le mn mb mc li mo me mf lm mp mh mi mj ij bi translated">添加您的产品详细信息并创建您的集成只需不到5分钟的时间。</p><p id="ac92" class="pw-post-body-paragraph lr ls iq lt b lu ml jr lw lx mm ju lz le mn mb mc li mo me mf lm mp mh mi mj ij bi translated">一旦集成成功创建，集成控制台将显示我们需要存储的客户端id和客户端密码，因为我们将需要它们来获取我们的访问令牌。</p><p id="a988" class="pw-post-body-paragraph lr ls iq lt b lu ml jr lw lx mm ju lz le mn mb mc li mo me mf lm mp mh mi mj ij bi translated">🔗<a class="ae mk" href="https://vercel.com/dashboard/integrations/console" rel="noopener ugc nofollow" target="_blank">链接到Vercel集成控制台</a></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nl"><img src="../Images/75dd4d4209bc0cfa4cac5a1ad71b2e2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*04spkp8JRh-BCWBKHYxJ-Q.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">My integration of client id and client secret</figcaption></figure><p id="8096" class="pw-post-body-paragraph lr ls iq lt b lu ml jr lw lx mm ju lz le mn mb mc li mo me mf lm mp mh mi mj ij bi translated">请不要使用我的客户id和密钥，因为它不会为你工作。每个用户都有一个唯一的客户端id和密钥。</p></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><h2 id="e353" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">安装集成</h2><p id="7c94" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">我们现在将安装刚刚创建的集成。实现安装的两种方式—</p><ul class=""><li id="c258" class="mx my iq lt b lu ml lx mm le mz li na lm nb mj nc nd ne nf bi translated">外部方式——向Vercel服务器发出API请求，在您的应用程序中安装集成</li><li id="d543" class="mx my iq lt b lu ng lx nh le ni li nj lm nk mj nc nd ne nf bi translated">内部方式——直接从Vercel网站上的集成市场安装集成。</li></ul><p id="0767" class="pw-post-body-paragraph lr ls iq lt b lu ml jr lw lx mm ju lz le mn mb mc li mo me mf lm mp mh mi mj ij bi translated">我们将遵循外部方式，因为我们将处理我们的应用程序本身的集成。</p><p id="0aa0" class="pw-post-body-paragraph lr ls iq lt b lu ml jr lw lx mm ju lz le mn mb mc li mo me mf lm mp mh mi mj ij bi translated">在我们的应用程序中，我们将创建一个按钮来添加我们的集成。该按钮将触发对端点的POST请求，在API的参数中使用我们的应用程序的slug名称。</p><pre class="kg kh ki kj gt nm nn no np aw nq bi"><span id="b07b" class="kv kw iq nn b gy nr ns l nt nu">https://vercel.com/integrations/:slug/new</span></pre><p id="b0f2" class="pw-post-body-paragraph lr ls iq lt b lu ml jr lw lx mm ju lz le mn mb mc li mo me mf lm mp mh mi mj ij bi translated">在参数中传递您的集成段名称，并在浏览器中打开链接以连接集成。</p><p id="adbe" class="pw-post-body-paragraph lr ls iq lt b lu ml jr lw lx mm ju lz le mn mb mc li mo me mf lm mp mh mi mj ij bi translated">成功添加集成后，您将被重定向到回调或重定向URI，代码附加在API的参数中</p><p id="8443" class="pw-post-body-paragraph lr ls iq lt b lu ml jr lw lx mm ju lz le mn mb mc li mo me mf lm mp mh mi mj ij bi translated">保存代码值，因为我们将需要它来创建访问令牌。</p></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><h2 id="9398" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">根据客户端Id和密码创建访问令牌</h2><p id="f9fd" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">下一个也是最后一个部分是通过向Vercel端点发出另一个API请求来获取访问令牌，在params中传递客户机id和秘密，params的响应将为我们提供访问令牌以交换代码。</p><p id="d6eb" class="pw-post-body-paragraph lr ls iq lt b lu ml jr lw lx mm ju lz le mn mb mc li mo me mf lm mp mh mi mj ij bi translated">对<a class="ae mk" href="https://api.vercel.com/v2/oauth/access_token" rel="noopener ugc nofollow" target="_blank">https://api.vercel.com/v2/oauth/access_token</a>端点的post请求将返回用户id和令牌。</p></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><h2 id="bd0c" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">列出已部署的存储库</h2><p id="71b5" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">Vervel API提供了一个端点来查看所有已部署存储库的列表。我们将发出请求的端点是<code class="fe nv nw nx nn b">/v6/deployments</code>,访问令牌开始在头中传递。</p><p id="587c" class="pw-post-body-paragraph lr ls iq lt b lu ml jr lw lx mm ju lz le mn mb mc li mo me mf lm mp mh mi mj ij bi translated">我附上了邮递员的API响应截图，请确保您使用了您的访问令牌，否则它会抛出一个未经授权的错误。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ny"><img src="../Images/b96cd65b0e3dcef3c72d6bd46e28269a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y2CVpK-jjRLCdDSYQjp30A.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Deployments API response</figcaption></figure><p id="eefb" class="pw-post-body-paragraph lr ls iq lt b lu ml jr lw lx mm ju lz le mn mb mc li mo me mf lm mp mh mi mj ij bi translated">一旦用户在您的应用程序中连接了Vercel，您就可以获取他/她部署的所有项目，并在您的应用程序中查看它们，以获得更好的进一步特性。</p></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><h2 id="f812" class="kv kw iq bd kx ky kz dn la lb lc dp ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">部署</h2><p id="e6b9" class="pw-post-body-paragraph lr ls iq lt b lu lv jr lw lx ly ju lz le ma mb mc li md me mf lm mg mh mi mj ij bi translated">我们已经到了最后一个阶段，每个存储库都可以使用它的API部署在vervel子域上。我们需要一个访问令牌作为每个Vercel部署API头中的授权令牌。</p><p id="ca47" class="pw-post-body-paragraph lr ls iq lt b lu ml jr lw lx mm ju lz le mn mb mc li mo me mf lm mp mh mi mj ij bi translated">在带有请求数据的头中添加令牌，Vercel API将部署我们的存储库，并返回我们部署的链接和部署的项目id。</p><p id="5955" class="pw-post-body-paragraph lr ls iq lt b lu ml jr lw lx mm ju lz le mn mb mc li mo me mf lm mp mh mi mj ij bi translated">下次见，祝你愉快。<br/>继续发展<br/>Shrey<br/>T6】IHA tereading</p></div><div class="ab cl mq mr hu ms" role="separator"><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv mw"/><span class="mt bw bk mu mv"/></div><div class="ij ik il im in"><p id="1b29" class="pw-post-body-paragraph lr ls iq lt b lu ml jr lw lx mm ju lz le mn mb mc li mo me mf lm mp mh mi mj ij bi translated"><em class="nz">更多内容看</em> <a class="ae mk" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="lt ir"> <em class="nz">说白了。报名参加我们的</em> <a class="ae mk" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="lt ir"> <em class="nz">免费周报</em> </strong> </a> <em class="nz">。关注我们关于</em> <a class="ae mk" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"> <strong class="lt ir"> <em class="nz">推特</em> </strong> </a>，<a class="ae mk" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="lt ir"><em class="nz">LinkedIn</em></strong></a><em class="nz">，</em><a class="ae mk" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"><strong class="lt ir"><em class="nz">YouTube</em></strong></a><em class="nz">，以及</em> <a class="ae mk" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="lt ir"> <em class="nz">不和</em> </strong> </a> <em class="nz">。对增长黑客感兴趣？检查</em> <a class="ae mk" href="https://circuit.ooo/" rel="noopener ugc nofollow" target="_blank"> <strong class="lt ir"> <em class="nz">电路</em> </strong> </a> <em class="nz">。</em></strong></a></p></div></div>    
</body>
</html>