<html>
<head>
<title>Laravel Sanctum Authentication for React App Using Breeze</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Breeze对React应用程序进行Laravel Sanctum身份验证</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/laravel-sanctum-authentication-for-react-app-using-breeze-93e2cafe450c?source=collection_archive---------2-----------------------#2022-03-18">https://javascript.plainenglish.io/laravel-sanctum-authentication-for-react-app-using-breeze-93e2cafe450c?source=collection_archive---------2-----------------------#2022-03-18</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="7215" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">使用Breeze API脚手架将Laravel Sanctum身份验证与React应用程序集成的步骤。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/d2b17d7a34057dd2638fa736b02e25de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5fotKzx_mWG6uHTrG43XUA.jpeg"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@franckinjapan?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Franck</a> on <a class="ae ks" href="https://unsplash.com/s/photos/security-system?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="09ab" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Laravel breeze是一个用于web和API的认证脚手架。Breeze由Laravel Sanctum提供认证系统，默认情况下，它包括CSRF保护、会话认证，因此我们不需要担心XSS攻击。</p><p id="da51" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在本文中，我们可以看到如何使用Breeze API脚手架来验证React应用程序。让我们整合。</p><h1 id="d3cc" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">Laravel后端设置</h1><p id="6154" class="pw-post-body-paragraph kt ku in kv b kw mh jo ky kz mi jr lb lc mj le lf lg mk li lj lk ml lm ln lo ig bi translated">使用以下命令创建Laravel应用程序并安装Laravel breeze API脚手架:</p><pre class="kd ke kf kg gt mm mn mo mp aw mq bi"><span id="e07a" class="mr lq in mn b gy ms mt l mu mv"># Create a laravel application<br/><strong class="mn io">composer create-project laravel/laravel react-backend</strong></span><span id="0dca" class="mr lq in mn b gy mw mt l mu mv"><strong class="mn io">cd react-backend</strong></span><span id="c8be" class="mr lq in mn b gy mw mt l mu mv"># Install Breeze<br/><strong class="mn io">composer require laravel/breeze</strong></span><span id="7e2c" class="mr lq in mn b gy mw mt l mu mv"><strong class="mn io">php artisan breeze:install api</strong></span></pre><p id="be48" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">运行上述命令后，将env中的<code class="fe mx my mz mn b">FRONTEND_URL</code> <em class="na"> </em>更新为<code class="fe mx my mz mn b">localhost:3000</code>，并使用<a class="ae ks" href="https://laravel.com/docs/9.x/sail#main-content" rel="noopener ugc nofollow" target="_blank"> Laravel Sail </a>或<code class="fe mx my mz mn b">php artisan serve</code>命令为应用程序提供服务。</p><p id="7462" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">要测试应用程序，在浏览器中点击<code class="fe mx my mz mn b">localhost:8000</code>，您可以获得应用程序版本响应，如下所示:</p><pre class="kd ke kf kg gt mm mn mo mp aw mq bi"><span id="b93f" class="mr lq in mn b gy ms mt l mu mv"><strong class="mn io">{<br/>  </strong>"Laravel": "8.77.1"<br/><strong class="mn io">}</strong></span></pre><p id="d586" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在，Laravel后端应用程序已经准备好处理来自React应用程序的请求。接下来，我们来设置react应用程序。</p><h1 id="7962" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">React应用程序设置</h1><p id="c5f7" class="pw-post-body-paragraph kt ku in kv b kw mh jo ky kz mi jr lb lc mj le lf lg mk li lj lk ml lm ln lo ig bi translated">我们将使用下面的命令创建React应用程序来设置React应用程序:</p><pre class="kd ke kf kg gt mm mn mo mp aw mq bi"><span id="d505" class="mr lq in mn b gy ms mt l mu mv"><strong class="mn io">npx create-react-app breeze-react</strong></span><span id="ae31" class="mr lq in mn b gy mw mt l mu mv"><strong class="mn io">cd breeze-react</strong></span><span id="a586" class="mr lq in mn b gy mw mt l mu mv"><strong class="mn io">yarn start</strong></span></pre><h2 id="87fb" class="mr lq in bd lr nb nc dn lv nd ne dp lz lc nf ng mb lg nh ni md lk nj nk mf nl bi translated">配置Axios</h2><p id="d056" class="pw-post-body-paragraph kt ku in kv b kw mh jo ky kz mi jr lb lc mj le lf lg mk li lj lk ml lm ln lo ig bi translated">为了处理API，我们将使用Axios。添加全局Axios客户端，如下所示:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="0f82" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">将<code class="fe mx my mz mn b">withCredentials</code>设置为true以启用跨站点cookie访问。<code class="fe mx my mz mn b">REACT_APP_BACKEND_URL</code>是<code class="fe mx my mz mn b">.env</code>文件中的<code class="fe mx my mz mn b">localhost:8000</code>，是之前创建的Laravel后端app。</p><h2 id="b335" class="mr lq in bd lr nb nc dn lv nd ne dp lz lc nf ng mb lg nh ni md lk nj nk mf nl bi translated">CSRF请求</h2><p id="5dad" class="pw-post-body-paragraph kt ku in kv b kw mh jo ky kz mi jr lb lc mj le lf lg mk li lj lk ml lm ln lo ig bi translated">Laravel breeze使用sanctum进行验证，因此要验证SPA。我们需要向<code class="fe mx my mz mn b">/sanctum/csrf-cookie</code>端点发出第一个请求。我们需要在所有未认证的路由上发出此请求。比如登录，注册忘记密码。</p><p id="f25c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在<code class="fe mx my mz mn b">hooks/auth.js</code>文件中创建一个自定义钩子，并添加以下代码来处理<code class="fe mx my mz mn b">csrf</code>请求:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nm nn l"/></div></figure><h2 id="d250" class="mr lq in bd lr nb nc dn lv nd ne dp lz lc nf ng mb lg nh ni md lk nj nk mf nl bi translated">集成登录API</h2><p id="bc47" class="pw-post-body-paragraph kt ku in kv b kw mh jo ky kz mi jr lb lc mj le lf lg mk li lj lk ml lm ln lo ig bi translated">在<strong class="kv io">使用权限</strong>挂钩中增加以下登录功能:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="18cf" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">当请求登录API时，首先请求CSRF API，如果成功，则请求登录API。同样，我们可以使用注册、忘记密码、重置密码API。现在，我们已经将React应用程序与Laravel breeze API脚手架集成在一起。</p><h1 id="686b" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">拉勒维尔微风反应</h1><p id="50d8" class="pw-post-body-paragraph kt ku in kv b kw mh jo ky kz mi jr lb lc mj le lf lg mk li lj lk ml lm ln lo ig bi translated"><a class="ae ks" href="https://github.com/Nilanth/laravel-breeze-react" rel="noopener ugc nofollow" target="_blank"> Laravel breeze react </a>是react的breeze认证样板的实现，可在GitHub中获得。它使用TailwindCSS和<a class="ae ks" href="https://create-react-app.dev/" rel="noopener ugc nofollow" target="_blank"> CRA </a>预配置了所有认证API、路由和基本UI。</p><h2 id="d1bb" class="mr lq in bd lr nb nc dn lv nd ne dp lz lc nf ng mb lg nh ni md lk nj nk mf nl bi translated">特征</h2><ol class=""><li id="51ef" class="no np in kv b kw mh kz mi lc nq lg nr lk ns lo nt nu nv nw bi translated">使用<a class="ae ks" href="https://tailwindcss.com/" rel="noopener ugc nofollow" target="_blank"> Tailwind </a> CSS预先构建登录、注册、忘记密码、重置密码和仪表板UI</li><li id="6c38" class="no np in kv b kw nx kz ny lc nz lg oa lk ob lo nt nu nv nw bi translated">使用<a class="ae ks" href="https://create-react-app.dev/" rel="noopener ugc nofollow" target="_blank">创建React应用程序</a> 5进行构建</li><li id="bea8" class="no np in kv b kw nx kz ny lc nz lg oa lk ob lo nt nu nv nw bi translated"><a class="ae ks" href="https://reactrouter.com/" rel="noopener ugc nofollow" target="_blank">反应路由器</a> 6进行路由</li><li id="82da" class="no np in kv b kw nx kz ny lc nz lg oa lk ob lo nt nu nv nw bi translated"><a class="ae ks" href="https://swr.vercel.app/" rel="noopener ugc nofollow" target="_blank"> SWR </a>用于重新验证用户数据</li><li id="1769" class="no np in kv b kw nx kz ny lc nz lg oa lk ob lo nt nu nv nw bi translated"><a class="ae ks" href="https://eslint.org/" rel="noopener ugc nofollow" target="_blank"> ESLint </a></li></ol><h2 id="75e8" class="mr lq in bd lr nb nc dn lv nd ne dp lz lc nf ng mb lg nh ni md lk nj nk mf nl bi translated">快速入门指南</h2><p id="4b10" class="pw-post-body-paragraph kt ku in kv b kw mh jo ky kz mi jr lb lc mj le lf lg mk li lj lk ml lm ln lo ig bi translated">克隆<a class="ae ks" href="https://github.com/Nilanth/laravel-breeze-react" rel="noopener ugc nofollow" target="_blank"> laravel-breeze-react </a>，使用<code class="fe mx my mz mn b">yarn install, </code>安装依赖项，然后将<code class="fe mx my mz mn b">.env.example</code>文件复制到<code class="fe mx my mz mn b">.env</code>，并添加您后端的URL，如下所示</p><pre class="kd ke kf kg gt mm mn mo mp aw mq bi"><span id="9036" class="mr lq in mn b gy ms mt l mu mv">REACT_APP_BACKEND_URL=http://localhost:8000</span></pre><p id="154d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">运行<code class="fe mx my mz mn b">yarn start</code>，现在您将在浏览器中看到以下屏幕:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oc"><img src="../Images/eb3a696d194eab6f08797dd42cbd3c03.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*la6B67GHpPizLheXjs78bg.png"/></div></div></figure><p id="09f7" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">laravel-breeze-react让您只关注业务逻辑，因为它负责验证层。</p><h1 id="0ad3" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">资源</h1><p id="8d8b" class="pw-post-body-paragraph kt ku in kv b kw mh jo ky kz mi jr lb lc mj le lf lg mk li lj lk ml lm ln lo ig bi translated"><a class="ae ks" href="https://laravel.com/docs/9.x/starter-kits#breeze-and-next" rel="noopener ugc nofollow" target="_blank"> Laravel Breeze Docs </a></p><p id="b705" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><a class="ae ks" href="https://github.com/Nilanth/laravel-breeze-react" rel="noopener ugc nofollow" target="_blank"> Laravel微风反应库</a></p><p id="8424" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><a class="ae ks" href="https://laravel.com/docs/9.x/sanctum" rel="noopener ugc nofollow" target="_blank">密室文件</a></p><h1 id="c11f" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">结论</h1><p id="4248" class="pw-post-body-paragraph kt ku in kv b kw mh jo ky kz mi jr lb lc mj le lf lg mk li lj lk ml lm ln lo ig bi translated">Laravel Breeze使SPA认证非常简单、安全，Laravel Breeze React使Laravel Breeze后端应用程序与React应用程序快速集成。</p><p id="d12e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">感谢您的阅读。</p><p id="49fb" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="na">更多内容请看</em><a class="ae ks" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="na">plain English . io</em></strong></a><em class="na">。报名参加我们的</em> <a class="ae ks" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="na">免费周报</em> </strong> </a> <em class="na">。关注我们关于</em><a class="ae ks" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="na">Twitter</em></strong></a><em class="na">和</em><strong class="kv io"><em class="na"/></strong><a class="ae ks" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="na">LinkedIn</em></strong></a><em class="na">。加入我们的</em> <a class="ae ks" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="na">社区</em> </strong> </a> <em class="na">。</em></p></div></div>    
</body>
</html>