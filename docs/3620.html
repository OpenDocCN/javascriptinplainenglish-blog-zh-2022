<html>
<head>
<title>Drag and Drop from Scratch with React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用React从头开始拖放</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/drag-and-drop-from-scratch-with-react-be2aa96cc210?source=collection_archive---------6-----------------------#2022-09-12">https://javascript.plainenglish.io/drag-and-drop-from-scratch-with-react-be2aa96cc210?source=collection_archive---------6-----------------------#2022-09-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="d5fe" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">关于如何创建一组React组件来处理拖放的教程</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/b89779b7b315e8156d18d2c591b6075a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ZDD9SCM69IQ-YWZ7.png"/></div></div></figure><p id="4d98" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">拖放是互联网的奥秘之一。在我们的开发生涯中，我们都曾经使用过它们，但是我们实际上从来没有想过它是如何工作的。今天，一切都将改变！</p><p id="fa60" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><em class="ln">这篇文章纯粹是信息性的。有很多用于所有框架的拖放库，我强烈推荐你使用其中的一个！</em></p></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><h1 id="51a9" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">谅解</h1><p id="eece" class="pw-post-body-paragraph kr ks iq kt b ku mn jr kw kx mo ju kz la mp lc ld le mq lg lh li mr lk ll lm ij bi translated">在开始任何编码之前，让我们试着多理解一点拖放是如何工作的。</p><p id="6493" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">拖拽<strong class="kt ir">主要由你的浏览器</strong>处理。为了允许元素可拖动，您所要做的就是将<code class="fe ms mt mu mv b">draggable="true"</code>属性添加到您的<code class="fe ms mt mu mv b">div</code>中</p><p id="1da3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">用容器<strong class="kt ir">系统</strong>进行悬垂和放下工作。一个容器将包含您的可拖动项目，您将拖放到另一个。</p><p id="ec10" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">还有一点工作是让容器<strong class="kt ir">准备好接受可拖动的项目</strong>。</p><p id="b4cd" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">最后，我们必须<strong class="kt ir">处理下降并更新我们的状态</strong>。</p><p id="e087" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">就这么简单！让我们看看它如何与React一起工作。</p></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><h1 id="13fb" class="lv lw iq bd lx ly lz ma mb mc md me mf jw mg jx mh jz mi ka mj kc mk kd ml mm bi translated">创建我们的组件</h1><p id="5c79" class="pw-post-body-paragraph kr ks iq kt b ku mn jr kw kx mo ju kz la mp lc ld le mq lg lh li mr lk ll lm ij bi translated">在开始拖放之前，我们将开始<strong class="kt ir">创建我们的组件</strong>以使我们的生活更容易。</p><p id="beef" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">首先，让我们创建我们的<strong class="kt ir">可拖动项目</strong>。这个项目将是一个简单的文本，以便我们可以拖动它。我们还会将属性<code class="fe ms mt mu mv b">draggable</code>设置为true。</p><pre class="kg kh ki kj gt mw mv mx my aw mz bi"><span id="7daf" class="na lw iq mv b gy nb nc l nd ne">const Draggable = () =&gt; {<br/>  return (<br/>    &lt;div draggable&gt;<br/>      Drag me<br/>    &lt;/div&gt;<br/>  )<br/>}<br/><br/>export default Draggable;</span></pre><p id="aba1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">接下来，让我们创建一个<strong class="kt ir">盒子组件</strong>。该组件将是一个容器，它将包含可拖动的项目:</p><pre class="kg kh ki kj gt mw mv mx my aw mz bi"><span id="8b64" class="na lw iq mv b gy nb nc l nd ne">import './App.css'<br/>import Draggable from "./Draggable";<br/><br/>const Box = ({ hasItem }) =&gt; {<br/>  return (<br/>  &lt;div className="box"&gt;<br/>    {hasItem &amp;&amp; &lt;Draggable/&gt;}<br/>  &lt;/div&gt;<br/>)<br/>}<br/><br/>export default Box;</span></pre><p id="9f86" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在我们的<code class="fe ms mt mu mv b">App.css</code>中，您还可以找到<code class="fe ms mt mu mv b">box</code>课程:</p><pre class="kg kh ki kj gt mw mv mx my aw mz bi"><span id="b1aa" class="na lw iq mv b gy nb nc l nd ne">.box {<br/>  display: flex;<br/>  width: 100px;<br/>  height: 100px;<br/>  border: 1px solid black;<br/>  justify-content: center;<br/>  align-items: center;<br/>}</span></pre><p id="f239" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">酷！接下来，我们将开始<strong class="kt ir">让我们的容器准备好与我们的可拖动组件</strong>交互。</p><h1 id="f581" class="lv lw iq bd lx ly nf ma mb mc ng me mf jw nh jx mh jz ni ka mj kc nj kd ml mm bi translated">处理事件</h1><p id="68dc" class="pw-post-body-paragraph kr ks iq kt b ku mn jr kw kx mo ju kz la mp lc ld le mq lg lh li mr lk ll lm ij bi translated">我们将依赖于3个事件:</p><ul class=""><li id="6848" class="nk nl iq kt b ku kv kx ky la nm le nn li no lm np nq nr ns bi translated"><strong class="kt ir">拖动回车</strong> ( <code class="fe ms mt mu mv b">dragenter</code>)</li><li id="3a8e" class="nk nl iq kt b ku nt kx nu la nv le nw li nx lm np nq nr ns bi translated"><strong class="kt ir">拖过</strong> ( <code class="fe ms mt mu mv b">dragover</code>)</li><li id="f0c5" class="nk nl iq kt b ku nt kx nu la nv le nw li nx lm np nq nr ns bi translated"><strong class="kt ir">下降</strong> ( <code class="fe ms mt mu mv b">drop</code>)</li></ul><p id="c198" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><em class="ln">在这里我们将把</em> <code class="fe ms mt mu mv b"><em class="ln">dragenter</em></code> <em class="ln">和</em> <code class="fe ms mt mu mv b"><em class="ln">dragover</em></code> <em class="ln">视为相同，但是</em> <strong class="kt ir"> <em class="ln">都需要使用。</em>T46】</strong></p><h2 id="9564" class="na lw iq bd lx ny nz dn mb oa ob dp mf la oc od mh le oe of mj li og oh ml oi bi translated">可拖动和容器之间的相互作用</h2><p id="59b9" class="pw-post-body-paragraph kr ks iq kt b ku mn jr kw kx mo ju kz la mp lc ld le mq lg lh li mr lk ll lm ij bi translated">我们的第一步是当<code class="fe ms mt mu mv b">dragenter</code>或<code class="fe ms mt mu mv b">dragover</code>触发时调用<code class="fe ms mt mu mv b">event.preventDefault()</code>,这样我们的可拖动项和容器就可以交互了。通过这样做，我们的容器将成为有效的目标:</p><pre class="kg kh ki kj gt mw mv mx my aw mz bi"><span id="e568" class="na lw iq mv b gy nb nc l nd ne">const Box = ({ hasItem }) =&gt; {<br/><br/>  const dragEnterOrOver = (e) =&gt; {<br/>    e.preventDefault();<br/>  }<br/><br/>  return (<br/>    &lt;div <br/>      onDragEnter={dragEnterOrOver} <br/>      onDragOver={dragEnterOrOver} <br/>      className="box"&gt;<br/>      {hasItem &amp;&amp; &lt;Draggable/&gt;}<br/>    &lt;/div&gt;<br/>  )<br/>}</span></pre><p id="5a36" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">此外，让我们在应用程序中使用我们的Box组件:</p><pre class="kg kh ki kj gt mw mv mx my aw mz bi"><span id="88f6" class="na lw iq mv b gy nb nc l nd ne">return (<br/>  &lt;div&gt;<br/>    &lt;Box hasItem/&gt;<br/>    &lt;Box/&gt;<br/>  &lt;/div&gt;<br/>);</span></pre><p id="4877" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">立即试用您的应用程序！如果您拖动<code class="fe ms mt mu mv b">drag me</code>并四处移动，您会在鼠标旁边看到这个图标:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oj"><img src="../Images/58c61425ef1c10ac9a1ba43d898f7083.png" data-original-src="https://miro.medium.com/v2/resize:fit:1132/format:webp/1*aGlJaew8o1WEKbvsbIWMEA.png"/></div></figure><blockquote class="ok ol om"><p id="b0bc" class="kr ks ln kt b ku kv jr kw kx ky ju kz on lb lc ld oo lf lg lh op lj lk ll lm ij bi translated">根据您的操作系统，它会显示有点不同，但你会认出它！</p></blockquote><p id="7599" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">您可能已经注意到，这个图标也显示在当前选择的图标上方。这不是我们想要的。</p><p id="edbf" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我们稍微修改一下代码，不要在初始框中显示这个图标:</p><pre class="kg kh ki kj gt mw mv mx my aw mz bi"><span id="c79e" class="na lw iq mv b gy nb nc l nd ne">const dragEnterOrOver = (e) =&gt; {<br/>  if (hasItem) return;<br/>  e.preventDefault();<br/>}</span></pre><h2 id="10a5" class="na lw iq bd lx ny nz dn mb oa ob dp mf la oc od mh le oe of mj li og oh ml oi bi translated">移动我们的拖车，保持状态</h2><p id="d1af" class="pw-post-body-paragraph kr ks iq kt b ku mn jr kw kx mo ju kz la mp lc ld le mq lg lh li mr lk ll lm ij bi translated">我们要做的第一件事是<strong class="kt ir">为选择添加一个状态</strong>(这里我们将使用positions)并且<strong class="kt ir">以编程方式呈现这个框</strong>:</p><pre class="kg kh ki kj gt mw mv mx my aw mz bi"><span id="9b82" class="na lw iq mv b gy nb nc l nd ne">const ITEMS = 3;<br/><br/>function App() {<br/>  const [position, setPosition] = useState(0);<br/><br/>  return (<br/>    &lt;div&gt;<br/>      {<br/>        <strong class="mv ir"><em class="ln">Array</em></strong>(ITEMS).fill(null).map((_, index) =&gt; {<br/>          return &lt;Box <br/>                   key={index} <br/>                   hasItem={index === position} <br/>                   onSelect={() =&gt; setPosition(index)}/&gt;<br/>        })<br/>      }<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><blockquote class="ok ol om"><p id="ccaa" class="kr ks ln kt b ku kv jr kw kx ky ju kz on lb lc ld oo lf lg lh op lj lk ll lm ij bi translated">我知道使用索引作为键是一种不好的做法，但是因为这个例子非常简单，所以我不能使用其他任何东西。</p></blockquote><p id="2424" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在box组件内部，让我们处理drop事件并调用<code class="fe ms mt mu mv b">onSelect</code>回调:</p><pre class="kg kh ki kj gt mw mv mx my aw mz bi"><span id="7b7d" class="na lw iq mv b gy nb nc l nd ne">const Box = ({hasItem, onSelect}) =&gt; {<br/><br/>  const dragEnterOrOver = (e) =&gt; {<br/>    if (hasItem) return;<br/>    e.preventDefault();<br/>  }<br/><br/>  return (<br/>    &lt;div<br/>      onDrop={onSelect}<br/>      onDragEnter={dragEnterOrOver}<br/>      onDragOver={dragEnterOrOver}<br/>      className="box"<br/>    &gt;<br/>      {hasItem &amp;&amp; &lt;Draggable/&gt;}<br/>    &lt;/div&gt;<br/>  )<br/>}</span></pre><p id="217d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">瞧啊。现在，再次尝试你的应用程序，你就可以将你的拖拽从一个容器移动到另一个容器了！</p></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><p id="4f1b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我希望这篇文章能帮助你更好地理解拖放是如何工作的！</p><p id="6790" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">不要犹豫留下掌声或跟随它！</p><p id="0f80" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">本文基于<a class="ae oq" href="https://www.javascripttutorial.net/web-apis/javascript-drag-and-drop/#:~:text=Introduction%20to%20JavaScript%20Drag%20and%20Drop%20API&amp;text=To%20drag%20an%20image%2C%20you,you%20would%20drag%20an%20image." rel="noopener ugc nofollow" target="_blank">本指南</a>。</p><div class="or os gp gr ot ou"><a rel="noopener  ugc nofollow" target="_blank" href="/zip-a-folder-with-node-js-5cd940c5c4fe"><div class="ov ab fo"><div class="ow ab ox cl cj oy"><h2 class="bd ir gy z fp oz fr fs pa fu fw ip bi translated">用Node.js压缩文件夹</h2><div class="pb l"><h3 class="bd b gy z fp oz fr fs pa fu fw dk translated">如何用Node.js将文件夹和文件压缩成ZIP</h3></div><div class="pc l"><p class="bd b dl z fp oz fr fs pa fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="pd l"><div class="pe l pf pg ph pd pi kp ou"/></div></div></a></div><div class="or os gp gr ot ou"><a rel="noopener  ugc nofollow" target="_blank" href="/unzip-a-file-with-nodejs-5f94b360f7df"><div class="ov ab fo"><div class="ow ab ox cl cj oy"><h2 class="bd ir gy z fp oz fr fs pa fu fw ip bi translated">如何用Node.js解压文件</h2><div class="pb l"><h3 class="bd b gy z fp oz fr fs pa fu fw dk translated">在FS能够实现的所有特性中，解压缩不是其中之一。让我们看看如何使用Node.js来实现这一点</h3></div><div class="pc l"><p class="bd b dl z fp oz fr fs pa fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="pd l"><div class="pj l pf pg ph pd pi kp ou"/></div></div></a></div><div class="or os gp gr ot ou"><a rel="noopener  ugc nofollow" target="_blank" href="/server-sent-events-with-nodejs-bbdc9a9584cb"><div class="ov ab fo"><div class="ow ab ox cl cj oy"><h2 class="bd ir gy z fp oz fr fs pa fu fw ip bi translated">使用Node.js的服务器发送的事件</h2><div class="pb l"><h3 class="bd b gy z fp oz fr fs pa fu fw dk translated">从您的后端接收定期更新，而不发送垃圾HTTP请求</h3></div><div class="pc l"><p class="bd b dl z fp oz fr fs pa fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="pd l"><div class="pk l pf pg ph pd pi kp ou"/></div></div></a></div></div><div class="ab cl lo lp hu lq" role="separator"><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt lu"/><span class="lr bw bk ls lt"/></div><div class="ij ik il im in"><p id="3cbc" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><em class="ln">更多内容请看</em><a class="ae oq" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kt ir"><em class="ln">plain English . io</em></strong></a><em class="ln">。报名参加我们的</em> <a class="ae oq" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir"> <em class="ln">免费周报</em> </strong> </a> <em class="ln">。关注我们关于</em><a class="ae oq" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="kt ir"><em class="ln">Twitter</em></strong></a><a class="ae oq" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kt ir"><em class="ln">LinkedIn</em></strong></a><em class="ln"/><a class="ae oq" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"><strong class="kt ir"><em class="ln">YouTube</em></strong></a><em class="ln"/><a class="ae oq" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"><strong class="kt ir"><em class="ln">不和</em> </strong> </a> <em class="ln">。对增长黑客感兴趣？检查</em> <a class="ae oq" href="https://circuit.ooo/" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir"> <em class="ln">电路</em> </strong> </a> <em class="ln">。</em></p></div></div>    
</body>
</html>