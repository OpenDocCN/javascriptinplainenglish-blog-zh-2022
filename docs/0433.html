<html>
<head>
<title>How to Retrieve Your API Data In React Using Axios</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Axios在React中检索API数据</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-retrieve-your-api-data-in-react-using-axios-e5ab5a0ffd0b?source=collection_archive---------5-----------------------#2022-01-25">https://javascript.plainenglish.io/how-to-retrieve-your-api-data-in-react-using-axios-e5ab5a0ffd0b?source=collection_archive---------5-----------------------#2022-01-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="bb26" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">5分钟内学会。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/74f904422528499fd403be0cb3325b92.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QdHef2rxsjkH86PP"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@lazizli?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Lala Azizli</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="eedd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我需要使用Axios来检索API数据并显示它。</p><p id="fe15" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是我发现写完整个代码真的很不方便，偶尔还会篡改一下。结果后来显示不准确。</p><p id="d544" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此外，如果您想了解如何从API显示数据，本教程将是有用的。</p><p id="2eb2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">那我们开始吧。</p><h1 id="5a51" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">API是否可操作？</h1><p id="1123" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">让我分享一个例子。</p><p id="a9ad" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当时我在一家初创公司工作。讲师给了我一些API代码，我可以将它们包含在代码库中。15分钟后，我发现API运行不正常。</p><p id="4da4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所以，首先也是最重要的，确定它是否可操作。</p><p id="bb5e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可以用三种方法来做这件事。</p><p id="749d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们看一个免费的假API的例子，即<a class="ae kv" href="https://jsonplaceholder.typicode.com/" rel="noopener ugc nofollow" target="_blank"> JSONPlaceholder </a>。</p><p id="7eb9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可以从这里得到各种各样的假API，比如<a class="ae kv" href="https://jsonplaceholder.typicode.com/posts" rel="noopener ugc nofollow" target="_blank">帖子数量</a>、<a class="ae kv" href="https://jsonplaceholder.typicode.com/users" rel="noopener ugc nofollow" target="_blank">用户数量</a>等等。</p><ol class=""><li id="8543" class="mp mq iq ky b kz la lc ld lf mr lj ms ln mt lr mu mv mw mx bi translated">第一种方法是直接点击链接或转到该网址。例如，当我点击<a class="ae kv" href="https://jsonplaceholder.typicode.com/posts" rel="noopener ugc nofollow" target="_blank">文章数量</a>时，它会显示类似下图的内容。</li></ol><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi my"><img src="../Images/b5ebb61af05a71aabaa65728a8b538ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*cfhwMmYhtx1_wSRM.png"/></div></div></figure><p id="9a5f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我有一个扩展，它为我提供了关于API中数据的更准确的信息。<a class="ae kv" href="https://chrome.google.com/webstore/detail/jsonview/chklaanhfefbnpoihckbnefhakgolnmc?hl=en" rel="noopener ugc nofollow" target="_blank"> JSONView </a>是扩展的名称。也可以在Chrome内部安装使用。</p><p id="d766" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果一个API是公开可用的，我们可以判断它是否是功能性的。您还可以更清楚地看到API内部的数据量。</p></div><div class="ab cl mz na hu nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="ij ik il im in"><p id="ceee" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">2.第二种方法是利用Postman(也可以使用迅雷客户端)。Postman让我们更容易使用API。只需输入API URL并单击transmit按钮来检索数据。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi my"><img src="../Images/bfa79744114a9442d605530c4f180ba9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*B_noT3_j8bH-JjNs.png"/></div></div></figure><p id="89a2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如你所见，我们也在这里得到数据。Postman可以连接到公共和私有API。私有API需要不记名令牌或其他类型的权限。</p><p id="661f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你想学习如何使用Postman使用API，<a class="ae kv" href="https://youtu.be/VywxIQ2ZXw4" rel="noopener ugc nofollow" target="_blank">看看这个视频</a>。</p></div><div class="ab cl mz na hu nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="ij ik il im in"><p id="329e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">3.第三种方法是从任何代码编辑器中使用<code class="fe ng nh ni nj b">console.log(response.data);</code>。这将在后面进一步讨论。</p></div><div class="ab cl mz na hu nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="ij ik il im in"><h1 id="14aa" class="ls lt iq bd lu lv nk lx ly lz nl mb mc jw nm jx me jz nn ka mg kc no kd mi mj bi translated">初始化React应用程序</h1><p id="e72d" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">首先，您必须使用初始化React应用程序，</p><pre class="kg kh ki kj gt np nj nq nr aw ns bi"><span id="efd7" class="nt lt iq nj b gy nu nv l nw nx">npx create-react-app my-app</span></pre><p id="a14f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">之后，使用以下命令安装Axios:</p><pre class="kg kh ki kj gt np nj nq nr aw ns bi"><span id="d56a" class="nt lt iq nj b gy nu nv l nw nx">npm i axios</span></pre></div><div class="ab cl mz na hu nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="ij ik il im in"><h1 id="8770" class="ls lt iq bd lu lv nk lx ly lz nl mb mc jw nm jx me jz nn ka mg kc no kd mi mj bi translated">创建功能组件</h1><p id="1816" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">根据需要在React项目中创建组件文件夹或文件。</p><p id="a42e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">Get.js是我的文件名。</p><p id="36ec" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在您的代码中创建一个如下所示的函数组件。</p><pre class="kg kh ki kj gt np nj nq nr aw ns bi"><span id="b606" class="nt lt iq nj b gy nu nv l nw nx">import React from 'react'function Get() {<br/>return (<br/>&lt;div&gt;&lt;/div&gt;<br/>)<br/>}<br/>export default Get;</span></pre><p id="1a24" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">导入我们现在将使用的依赖项。</p><pre class="kg kh ki kj gt np nj nq nr aw ns bi"><span id="237a" class="nt lt iq nj b gy nu nv l nw nx">import React from 'react'<br/>import { useState, useEffect } from "react";<br/>import axios from "axios"</span></pre><p id="066c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">并创建一个如下所示的useState挂钩，</p><pre class="kg kh ki kj gt np nj nq nr aw ns bi"><span id="247c" class="nt lt iq nj b gy nu nv l nw nx">const [data, setData] = useState(‘’);</span></pre><p id="6fa7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这里，我们将设置从API获得的数据。最初，不会有任何数据。</p></div><div class="ab cl mz na hu nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="ij ik il im in"><h1 id="116c" class="ls lt iq bd lu lv nk lx ly lz nl mb mc jw nm jx me jz nn ka mg kc no kd mi mj bi translated">使用Axios获取API数据</h1><p id="698f" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">目前为止，我们还没有和API合作过。让我们开始吧。</p><p id="df68" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先，用您喜欢的任何名称创建一个方法。</p><pre class="kg kh ki kj gt np nj nq nr aw ns bi"><span id="d005" class="nt lt iq nj b gy nu nv l nw nx">const getAllData = () =&gt; {</span><span id="47af" class="nt lt iq nj b gy ny nv l nw nx">axios.get(<br/>"https://jsonplaceholder.typicode.com/users").then((response) =&gt; {console.log(response.data);<br/>setData(response.data);}).catch((error) =&gt; {<br/>console.log(error);<br/>});<br/>};</span></pre><p id="b671" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们在这里使用Axios，并且在<code class="fe ng nh ni nj b">axios.get</code>中，我们指定我们想要的API数据的URL。然后我们会设置数据，如果有错误，它会打印出来。</p><p id="8c1a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们来看看；我们还使用<code class="fe ng nh ni nj b">console.log(response.data);</code>来确认我们正在从API获取数据。</p><p id="996a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是，因为我们还没有调用它，所以前面提到的技术会失败。</p><p id="7671" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所以我们将利用<code class="fe ng nh ni nj b">useEffect hook</code>来完成这个任务。</p><pre class="kg kh ki kj gt np nj nq nr aw ns bi"><span id="233f" class="nt lt iq nj b gy nu nv l nw nx">useEffect(() =&gt; {<br/> getAllData();<br/>}, []);</span></pre></div><div class="ab cl mz na hu nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="ij ik il im in"><h1 id="8087" class="ls lt iq bd lu lv nk lx ly lz nl mb mc jw nm jx me jz nn ka mg kc no kd mi mj bi translated">使用Axios显示数据</h1><p id="d333" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">现在我们也看不到数据。因为到目前为止我们还没有展示过。</p><p id="74a5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们展示它。</p><pre class="kg kh ki kj gt np nj nq nr aw ns bi"><span id="876e" class="nt lt iq nj b gy nu nv l nw nx">&lt;&gt;<br/>{data ? ( <br/>data.map(<br/>(data) =&gt; {return (<br/>&lt;div className="data" key={data.id}&gt;<br/>&lt;h3&gt;{data.name}&lt;/h3&gt;<br/>&lt;/div&gt;);<br/> })) : (&lt;h3&gt;No data yet&lt;/h3&gt;)}<br/>&lt;/&gt;</span></pre><p id="6fd3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里使用了三元运算符。我还添加了一个条件，如果有数据，只显示一个带有数据名的div，否则不打印任何数据。</p><p id="5b0e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">仅此而已。我们使用Axios从API获取数据并显示出来。</p><p id="dd9d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里有一个完整的代码为您提供帮助。</p><pre class="kg kh ki kj gt np nj nq nr aw ns bi"><span id="92dc" class="nt lt iq nj b gy nu nv l nw nx">import React from 'react'<br/>import { useState, useEffect } from "react";<br/>import axios from "axios"function Get() {<br/>    const [data, setData]  = useState('');<br/>    const getAllData = () =&gt; {<br/>        axios<br/>          .get("<a class="ae kv" href="https://jsonplaceholder.typicode.com/users" rel="noopener ugc nofollow" target="_blank">https://jsonplaceholder.typicode.com/users</a>")<br/>          .then((response) =&gt; {<br/>            console.log(response.data);<br/>            setData(response.data);<br/>          })<br/>          .catch((error) =&gt; {<br/>            console.log(error);<br/>          });<br/>    }<br/>    useEffect(() =&gt; {<br/>      getAllData();<br/>    },[]);</span><span id="974e" class="nt lt iq nj b gy ny nv l nw nx">return (<br/>        &lt;&gt;<br/>            {data ? <br/>                data.map(data =&gt; {<br/>                    return(<br/>                       &lt;div className="data" key={data.id}&gt;<br/>                         &lt;h3&gt;{data.name}&lt;/h3&gt;<br/>                       &lt;/div&gt;<br/>                    )<br/>                }) : &lt;h3&gt;No data yet&lt;/h3&gt; }<br/>        &lt;/&gt;<br/>    )<br/>}<br/>export default Get;</span></pre><p id="bdc4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当你在App.js中导入这个功能组件，它就可以工作了。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi my"><img src="../Images/1a8bbf2d356973ccb81b093d3d7639d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*gYtpjTLhgxF-gki0.png"/></div></div></figure><p id="c2ed" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里，我们正在获取数据，甚至在控制台选项卡中显示数据。</p><p id="1b44" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在你也可以说得更清楚了。您可以构造一个方法并调用它，而不是在return语句中添加逻辑，如下所示。</p><pre class="kg kh ki kj gt np nj nq nr aw ns bi"><span id="3c09" class="nt lt iq nj b gy nu nv l nw nx">import React from "react";<br/>import { useState, useEffect } from "react";<br/>import axios from "axios";function Get() {<br/>  const [data, setData] = useState("");<br/>  <br/>  const getAllData = () =&gt; {<br/>    axios<br/>      .get("<a class="ae kv" href="https://jsonplaceholder.typicode.com/users" rel="noopener ugc nofollow" target="_blank">https://jsonplaceholder.typicode.com/users</a>")<br/>      .then((response) =&gt; {<br/>        console.log(response.data);<br/>        setData(response.data);<br/>      })<br/>      .catch((error) =&gt; {<br/>        console.log(error);<br/>      });<br/>  };<br/>  <br/>  useEffect(() =&gt; {<br/>    getAllData();<br/>  }, []);</span><span id="a54e" class="nt lt iq nj b gy ny nv l nw nx"><strong class="nj ir">  const displayData = () =&gt; {<br/>    return data ? (<br/>      data.map((data) =&gt; {<br/>        return (<br/>          &lt;div className="data" key={data.id}&gt;<br/>            &lt;h3&gt;{data.name}&lt;/h3&gt;<br/>          &lt;/div&gt;<br/>        );<br/>      })<br/>    ) : (<br/>      &lt;h3&gt;No data yet&lt;/h3&gt;<br/>    );<br/>  }</strong>return (<br/>    &lt;&gt;<br/>      <strong class="nj ir">{displayData()}</strong><br/>    &lt;/&gt;<br/>  );<br/>}</span><span id="2aae" class="nt lt iq nj b gy ny nv l nw nx">export default Get;</span></pre><p id="83ba" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">就这样结束了。您已经在应用程序中显示了API数据。还学习了如何在react app中检索API数据。</p><p id="9a78" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">谢了。</p><p id="b513" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="nz">如果你喜欢我的工作，想要支持，可以</em> <a class="ae kv" href="https://www.buymeacoffee.com/nitinfab" rel="noopener ugc nofollow" target="_blank"> <em class="nz">请我喝杯咖啡！</em> </a></p><p id="6cef" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="nz">更多内容看</em> <a class="ae kv" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="nz">说白了。报名参加我们的</em> <a class="ae kv" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="nz">免费周报</em> </strong> </a> <em class="nz">。在我们的</em> <a class="ae kv" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="nz">社区不和谐</em> </strong> </a> <em class="nz">获得独家获取写作机会和建议。</em></strong></a></p></div></div>    
</body>
</html>