<html>
<head>
<title>Set Up TypeScript on Cypress in 4 Steps Easily</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在Cypress上轻松设置打字稿只需4个步骤</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/setup-typescript-in-cypress-in-4-steps-easily-78a6a8f60860?source=collection_archive---------1-----------------------#2022-01-11">https://javascript.plainenglish.io/setup-typescript-in-cypress-in-4-steps-easily-78a6a8f60860?source=collection_archive---------1-----------------------#2022-01-11</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div class="gh gi jk"><img src="../Images/7536b5d638a48341ff76c50da3c08549.png" data-original-src="https://miro.medium.com/v2/resize:fit:960/format:webp/1*bMB71PXANGQd0MV5Gx82Jw.jpeg"/></div><figcaption class="jr js gj gh gi jt ju bd b be z dk">Setup TypeScript in Cypress</figcaption></figure><p id="4bd7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">本文包括将js-cypress测试套件升级到TypeScript。如您所知，TypeScript在最近几年仍然非常受欢迎。此外，选择它是因为它为您提供了类型定义、静态类型检查，并且如果您已经在项目中使用了TypeScript，您可以轻松地在它们之间建立无缝连接。它们通常是不需要的，但是如果你需要webpack或bubble设置，它们是为你准备的。</p></div><div class="ab cl kt ku hr kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="ig ih ii ij ik"><p id="057a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"> <em class="la">第一步:下载打字稿</em> </strong></p><p id="8364" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如果你是新手，可以去<a class="ae lb" href="https://www.typescriptlang.org/" rel="noopener ugc nofollow" target="_blank">打字稿网页</a>那里有游乐场。你可以在浏览器里摆弄它，而不必下载任何东西。</p><p id="dbb9" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">当你<code class="fe lc ld le lf b">init</code>。您的Cypress your package.json文件将如下所示。在您的依赖项中，只有Cypress或您需要的东西，如mochawesome、cypress-iframe。这里我们需要做的是将TypeScript添加到您的依赖项中。</p><blockquote class="lg lh li"><p id="d05a" class="jv jw la jx b jy jz ka kb kc kd ke kf lj kh ki kj lk kl km kn ll kp kq kr ks ig bi translated">用npm或纱线，<code class="fe lc ld le lf b">npm install typescript --save-dev</code></p></blockquote><figure class="ln lo lp lq gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi lm"><img src="../Images/98fc922dd9935700043ab0f6e7158a6f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SkExiRJxSd6vTy-SGXuQrQ.png"/></div></div><figcaption class="jr js gj gh gi jt ju bd b be z dk">After initializing of cypress</figcaption></figure></div><div class="ab cl kt ku hr kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="ig ih ii ij ik"><p id="cffa" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"> <em class="la">第二步:创建一个tsconfig.json </em> </strong></p><figure class="ln lo lp lq gt jo gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/0aa886f6be8e3af2b5264e97208429c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1142/format:webp/1*6RMfbq_vZoiOFuZlqAkw2A.png"/></div></figure><p id="af0d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">您可以轻松地从<a class="ae lb" href="https://docs.cypress.io/guides/tooling/typescript-support#Set-up-your-dev-environment" rel="noopener ugc nofollow" target="_blank">文档</a>中复制粘贴。我已经把target和lib这样的东西从“es5”改成了“es6”。目标是JS特性将被降级，并且大多数现代浏览器支持“es6”。Lib是内置JavaScript API的默认类型脚本或类型定义集。这里有“dom ”,因为我们选择的是DOM元素。我们在类型中声明“cypress ”,因为我们从Cypress而不是Chai、jQuery或Mocha中获得类型定义。如你所知，你不需要下载那些来在Cypress中使用，它们已经是内置的了。我们在这里包括了一个部分。两个星号，一个前闪，一个星号。这意味着带有ts扩展名的文件名或模式将包含在这个项目中。您可以根据您的项目设置您的包含模式。</p></div><div class="ab cl kt ku hr kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="ig ih ii ij ik"><p id="4db1" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"> <em class="la">第三步:index.d.ts </em> </strong></p><p id="e69c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这是我创建index.d.ts最简单易懂的方法。命令有助于为Cypress创建自定义命令。它使你的代码更容易重用和理解。</p><p id="57b3" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在/ <your_project_name> /cypress/support中删除命令和index.js文件。命令有助于为Cypress创建自定义命令。并创建一个commands文件夹，在其中编写您的自定义命令。您的项目目录将如下所示:cypress &gt; support &gt;commands&gt; *。分时（同timesharing）</your_project_name></p><p id="5af0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"> <em class="la">创建自定义命令</em> </strong></p><figure class="ln lo lp lq gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi lw"><img src="../Images/830169e6a29a265864195fbbbf81ff98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SVkabakEtyiEZ1h33G6aQg.png"/></div></div><figcaption class="jr js gj gh gi jt ju bd b be z dk">creating a custom command</figcaption></figure><figure class="ln lo lp lq gt jo gh gi paragraph-image"><div class="gh gi lx"><img src="../Images/74d9507b371789464285297f4908737d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1366/format:webp/1*PDYmnb2rcOqe38BHpTFPtg.png"/></div><figcaption class="jr js gj gh gi jt ju bd b be z dk">index.d.ts</figcaption></figure><p id="c082" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这非常容易，但不幸的是，在我们的测试用例中使用这个命令来运行一个没有错误的测试是不够的。为此，我们需要扩展cy对象。你可以检查上述文件来完成它。我们需要在支持目录中创建一个扩展名为. d.ts的定义文件，并在这里声明我们的命令。简单地说，我们将fillForm命令添加到Cypress接口中。函数最后的“Void”表示函数不会传递任何东西。它是可选的。如果我们愿意，它可以返回某物。比如来自API调用的元素或响应。</p><figure class="ln lo lp lq gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi ly"><img src="../Images/174105f37baa99a9a2d3246e7608bf51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ev0J_vLDgJcUruyR2yBoPg.png"/></div></div><figcaption class="jr js gj gh gi jt ju bd b be z dk">declaring types in custom command file</figcaption></figure><p id="6f23" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">另一种实现方式是在自定义命令中声明您的定义。看起来是这样。在这里，我不使用. Add。我在index.ts文件中使用。我在互联网上看到了这种用法，我喜欢将所有的导入放在一个文件中。</p><figure class="ln lo lp lq gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi lz"><img src="../Images/e6370c20e0ad1e1963de0171490a97a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ybhDIColDgOcnBGaugCwhw.png"/></div></div><figcaption class="jr js gj gh gi jt ju bd b be z dk">support &gt; index.ts</figcaption></figure><p id="c415" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在测试用例中使用定制命令，而不需要导入命令，如下所示。</p><figure class="ln lo lp lq gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="lr ls di lt bf lu"><div class="gh gi ma"><img src="../Images/414e2185fca808beac71c14fb0bd27d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ozjElRMxIH-fiFA__LvktQ.png"/></div></div><figcaption class="jr js gj gh gi jt ju bd b be z dk">example of a test suite with ts and custom commands</figcaption></figure></div><div class="ab cl kt ku hr kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="ig ih ii ij ik"><p id="51eb" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"> <em class="la">第四步:外挂</em> </strong></p><p id="6d5d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">你可以查看<a class="ae lb" href="https://docs.cypress.io/guides/tooling/typescript-support#Types-for-custom-assertions" rel="noopener ugc nofollow" target="_blank">文档</a>——如何给你的Cypress项目添加插件。我可以在这里说，这和用JavaScript做加法没什么不同。但是最佳实践是不同地处理每个插件，因为有些插件需要“@ types/&lt;NPM-package-name&gt;”，有些插件不需要。它们中的一些需要不同于JavaScript的另一种依赖。举个例子你就会明白我的意思了。例如，你想使用“cypress-cumber-preprocessor”作为一个插件。在JavaScript中:</p><pre class="ln lo lp lq gt mb lf mc md aw me bi"><span id="a3b5" class="mf mg in lf b gy mh mi l mj mk">npm install --save-dev cypress-cucumber-preprocessor</span><span id="482b" class="mf mg in lf b gy ml mi l mj mk">// cypress/plugins/index.js</span><span id="895d" class="mf mg in lf b gy ml mi l mj mk">const cucumber = require('cypress-cucumber-preprocessor').default<br/><br/>module.exports = (on, config) =&gt; {<br/>  on('file:preprocessor', cucumber())<br/>}</span><span id="f4bf" class="mf mg in lf b gy ml mi l mj mk">after configuration you can use plugin in your project.</span></pre><p id="888b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">但是在TypeScript中，您需要额外下载“@ types/cypress-cucumber-preprocessor”和“@ cypress/browser ify-preprocessor”作为依赖项，它将如下所示:</p><pre class="ln lo lp lq gt mb lf mc md aw me bi"><span id="0738" class="mf mg in lf b gy mh mi l mj mk">// plugins/index.js<br/>const browserify = require('@cypress/browserify-preprocessor');<br/>const cucumber = require('cypress-cucumber-preprocessor').default;<br/>const resolve = require('resolve');</span><span id="8b2c" class="mf mg in lf b gy ml mi l mj mk">module.exports = (on, config) =&gt; {<br/>  const options = {<br/>    ...browserify.defaultOptions,<br/>    typescript: resolve.sync('typescript', { baseDir: config.projectRoot }),<br/>  };</span><span id="092b" class="mf mg in lf b gy ml mi l mj mk">  on('file:preprocessor', cucumber(options));<br/>};</span></pre></div><div class="ab cl kt ku hr kv" role="separator"><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky kz"/><span class="kw bw bk kx ky"/></div><div class="ig ih ii ij ik"><p id="d09e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">为了用TypeScript更改JavaScript文件，您只需要知道这些。我希望我是可以理解的。感谢阅读。</p><p id="cacd" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="la">更多内容看</em> <a class="ae lb" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io"> <em class="la">说白了就是io </em> </strong> </a> <em class="la">。报名参加我们的</em> <a class="ae lb" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io"> <em class="la">免费周报</em> </strong> </a> <em class="la">。在我们的</em> <a class="ae lb" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io"> <em class="la">社区获得独家访问写作机会和建议</em> </strong> </a> <em class="la">。</em></p></div></div>    
</body>
</html>