<html>
<head>
<title>How to Build a GraphQL eCommerce App from Scratch</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何从头开始构建一个GraphQL电子商务应用程序</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-build-a-graphql-ecommerce-app-from-scratch-46f8c6674bad?source=collection_archive---------8-----------------------#2022-11-01">https://javascript.plainenglish.io/how-to-build-a-graphql-ecommerce-app-from-scratch-46f8c6674bad?source=collection_archive---------8-----------------------#2022-11-01</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="61fe" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">使用WunderGraph、Next.js、Strapi和Snipcart将JAMstack设置为简单模式</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi kc"><img src="../Images/2877ae51d1557ba5f7813b05b29e9f6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:800/0*dbpXHUKaNVLXlVLs"/></div><figcaption class="kk kl gj gh gi km kn bd b be z dk">This is what you’ll be building!</figcaption></figure><p id="0887" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">埃森哲(n&gt;19个国家的20，000名消费者)在进行的一项调查发现，47%的网上购物者实际上会考虑支付更多——如果他们能获得超出预期的电子商务体验。</p><p id="1f88" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">如果你是电子零售商，这是个好消息，对吗？但是<em class="ll">买者自负</em>:同样比例的人还表示，如果他们的体验令人沮丧，他们会避免从零售商那里购买。</p><p id="cd09" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">为你的购物者提供快速、灵敏、直观的体验至关重要，因此<a class="ae lk" href="https://jamstack.org/" rel="noopener ugc nofollow" target="_blank">jam stack</a>——JavaScript、API、标记——已经证明在电子商务中很受欢迎。然而，这并不是你需要的全部。</p><p id="619d" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">这里的关键是解耦您的前端和后端，用GraphQL和内容呈现的智能管理来弥合差距…这就是为什么<a class="ae lk" href="https://wundergraph.com/" rel="noopener ugc nofollow" target="_blank">WunderGraph</a>——一个将REST、GraphQL和所有数据源整合到一个单一、安全、类型安全的端到端途径来实现所有用户体验的工具——非常有意义。</p><p id="764d" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">坚如磐石的技术，加上现代设计理念。</p><p id="dcec" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">因此，让我们来看看如何将这些JAMstack技术中的一些技术——<a class="ae lk" href="https://nextjs.org/" rel="noopener ugc nofollow" target="_blank">next . js</a>、<a class="ae lk" href="https://strapi.io/" rel="noopener ugc nofollow" target="_blank"> Strapi </a>、<a class="ae lk" href="https://graphql.org/" rel="noopener ugc nofollow" target="_blank"> GraphQL </a>和<a class="ae lk" href="https://snipcart.com/" rel="noopener ugc nofollow" target="_blank">Snipcart</a>——结合在一起，让您为您的用户构建您想要的确切购物体验，同时对开发人员体验没有任何影响。</p><h1 id="90d8" class="lm ln in bd lo lp lq lr ls lt lu lv lw jt lx ju ly jw lz jx ma jz mb ka mc md bi translated">30，000英尺的视野</h1><p id="e6bf" class="pw-post-body-paragraph ko kp in kq b kr me jo kt ku mf jr kw kx mg kz la lb mh ld le lf mi lh li lj ig bi translated">以下是本教程需要的内容:</p><ol class=""><li id="a56e" class="mj mk in kq b kr ks ku kv kx ml lb mm lf mn lj mo mp mq mr bi translated">Node.js &amp; NPM，和Python(用<code class="fe ms mt mu mv b">sqlite3</code>在本地测试Strapi需要的)。</li><li id="fbd2" class="mj mk in kq b kr mw ku mx kx my lb mz lf na lj mo mp mq mr bi translated">React/Next.js、TypeScript和CSS的中级知识(我在这里使用<a class="ae lk" href="https://tailwindcss.com/" rel="noopener ugc nofollow" target="_blank"> Tailwind </a>是因为我喜欢实用优先的CSS；但是Tailwind类可以很好地转换成几乎任何其他样式的解决方案，因为它实际上是编写普通CSS的不同方式。</li><li id="e7e0" class="mj mk in kq b kr mw ku mx kx my lb mz lf na lj mo mp mq mr bi translated">一个无头CMS来快速引导我们的后端(并添加GraphQL ),而不必处理庞大的第三方客户端，我们将不得不运送客户端。Strapi很棒，所以我们在这里用的就是它。</li><li id="4468" class="mj mk in kq b kr mw ku mx kx my lb mz lf na lj mo mp mq mr bi translated">一个Snipcart <a class="ae lk" href="https://app.snipcart.com/register" rel="noopener ugc nofollow" target="_blank">帐户</a>添加到我们的电子商务应用程序购物车管理系统(免费测试模式)。本教程使用Snipcart V3。</li></ol><p id="3f60" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">第二，这里有一个我们架构的快速图表，这样你就知道你要建造什么了。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi nb"><img src="../Images/100dcdae3e8d0c9faf2970b995d31ab4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ciV3HZsUWyWdqoGJ"/></div></div></figure><h2 id="45ee" class="ng ln in bd lo nh ni dn ls nj nk dp lw kx nl nm ly lb nn no ma lf np nq mc nr bi translated">后端— Strapi + GraphQL</h2><p id="ca97" class="pw-post-body-paragraph ko kp in kq b kr me jo kt ku mf jr kw kx mg kz la lb mh ld le lf mi lh li lj ig bi translated">虽然关系数据库本身可以满足大多数用例，但生产就绪型电子商务是您想要更多东西的地方。</p><p id="c86d" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">因此，我们将使用无头JAMstack CMS，Strapi，作为一个PIM——一个<strong class="kq io"> P </strong>产品<strong class="kq io"> I </strong>信息<strong class="kq io"> M </strong>管理解决方案——您的电子商务平台的唯一真实来源。这将是您的产品目录的中心，在这里您可以添加、修改、丰富和分发您的产品目录(通过一个易于安装的插件作为GraphQL)。</p><p id="883e" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">本教程使用<code class="fe ms mt mu mv b">sqlite3 </code>作为Strapi数据库，但是您可以在生产中很容易地用PostgreSQL——或者您选择的另一个——替换它。</p><h2 id="f98d" class="ng ln in bd lo nh ni dn ls nj nk dp lw kx nl nm ly lb nn no ma lf np nq mc nr bi translated">BFF —神童图</h2><p id="e3e3" class="pw-post-body-paragraph ko kp in kq b kr me jo kt ku mf jr kw kx mg kz la lb mh ld le lf mi lh li lj ig bi translated">神奇宝贝是这一切的关键。它位于我们的前端和后端之间，同时充当它们解耦的关键，并促进类型安全通信。</p><p id="8fba" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">它是一个BFF — <a class="ae lk" href="https://learn.microsoft.com/en-us/azure/architecture/patterns/backends-for-frontends" rel="noopener ugc nofollow" target="_blank">后端对前端</a> —一个服务层，或者API网关，不管你想叫它什么，它是你的前端可以看到的唯一“后端”。</p><p id="4b28" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">这是通过整合来自所有数据源(对于我们来说，这里是一个GraphQL端点)的数据，并使用您编写的GraphQL查询(通过安全的JSON-RPC)为您想要提供的每个单独的用户体验调整数据来实现的。</p><p id="ded3" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">您可以使用过滤器、连接、翻译等，同时在您的Next.js应用程序和您的Strapi + DB后端之间保持清晰的关注点分离，并将它们释放出来做自己的任务。</p><h2 id="2d75" class="ng ln in bd lo nh ni dn ls nj nk dp lw kx nl nm ly lb nn no ma lf np nq mc nr bi translated">前端— Next.js + TailwindCSS + Snipcart</h2><p id="1794" class="pw-post-body-paragraph ko kp in kq b kr me jo kt ku mf jr kw kx mg kz la lb mh ld le lf mi lh li lj ig bi translated">前端并不复杂，真的。WunderGraph为查询和修改数据生成了非常有用的现成钩子(同样基于您编写的GraphQL操作),因此对于Next.js，您可以直接使用它们。</p><p id="64fe" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">Snipcart是一个很好的方式，可以为任何webapp添加一个易于集成、外观非常棒的购物车管理系统，它会很好地为我们服务。</p><p id="6072" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">这种架构让你可以将你的电子商务体验作为一个极快的、模块化的、可扩展的界面，而不是很久以前的笨重的一体化客户端应用程序。</p><div class="kd ke kf kg gt ab cb"><figure class="ns kh nt nu nv nw nx paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><img src="../Images/61972105bae1dd05915c5a58308f38d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:514/format:webp/1*Bo4Nown1GgUIUjl7eW43mw.png"/></div></figure><figure class="ns kh ny nu nv nw nx paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><img src="../Images/6016b394cf979ee94fff686e81711668.png" data-original-src="https://miro.medium.com/v2/resize:fit:976/format:webp/1*p1sQQ4xLoIyrNCuWOLDNIQ.png"/></div></figure><figure class="ns kh nz nu nv nw nx paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><img src="../Images/a09c7baa2d856ab556d883a354756e7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:514/format:webp/1*s1xB-Md2_QlRpcjE5dxfvg.png"/></div><figcaption class="kk kl gj gh gi km kn bd b be z dk oa di ob oc">Here’s the finished product, at different screen sizes.</figcaption></figure></div><h1 id="88ac" class="lm ln in bd lo lp lq lr ls lt lu lv lw jt lx ju ly jw lz jx ma jz mb ka mc md bi translated">1.构建Strapi + GraphQL后端</h1><p id="fa7d" class="pw-post-body-paragraph ko kp in kq b kr me jo kt ku mf jr kw kx mg kz la lb mh ld le lf mi lh li lj ig bi translated">Strapi是一个开源的基于Node.js的headless CMS(内容管理系统),它使程序员能够快速创建自托管的、自适应的、有效的内容API(RESTful和GraphQL ),而无需编写任何代码。</p><p id="a18f" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io">第一步:脚手架a Strapi项目</strong></p><p id="3a59" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">创建一个新目录，放入cd，然后运行以下命令:</p><pre class="kd ke kf kg gt od mv oe of aw og bi"><span id="3a41" class="ng ln in mv b gy oh oi l oj ok">&gt; npx create-strapi-app@latest my-project — quickstart</span></pre><blockquote class="ol om on"><p id="43e4" class="ko kp ll kq b kr ks jo kt ku kv jr kw oo ky kz la op lc ld le oq lg lh li lj ig bi translated"><em class="in">💡</em>默认情况下，<code class="fe ms mt mu mv b"><em class="in">--quickstart</em></code>标志给你一个<a class="ae lk" href="https://www.sqlite.org/" rel="noopener ugc nofollow" target="_blank"> SQLite </a> 3数据库。如果你喜欢切换数据库，<a class="ae lk" href="https://strapi.gitee.io/documentation/3.0.0-beta.x/guides/databases.html" rel="noopener ugc nofollow" target="_blank">看这里</a>。</p></blockquote><p id="c525" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">您的Strapi应用程序现在已经启动并在<code class="fe ms mt mu mv b">localhost:1337</code>运行。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi or"><img src="../Images/7a5915ba9b86f032c6e1c7c454c86b61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9Coujv1Cu8nPsuhu"/></div></div></figure><p id="bdc1" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">继续为Strapi项目注册一个管理员。这完全是本地的开发和测试。你不必担心有效的电子邮件和强密码之类的东西…现在还不用。</p><p id="0bdf" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在，您应该可以访问位于<code class="fe ms mt mu mv b"><a class="ae lk" href="http://localhost:1337/admin." rel="noopener ugc nofollow" target="_blank">http://localhost:1337/admin</a></code>T13的Strapi仪表盘。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi or"><img src="../Images/e07e5e58f807cc60a0032884cecd78b9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6tOSlzbEr-TUZoE8"/></div></div></figure><p id="605d" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io">步骤2:为产品目录创建内容类型。</strong></p><p id="827f" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">Strapi admin dashboard允许您快速构建数据的模式，而不必摆弄实际的关系数据库。Strapi将这些模型称为内容类型。它们非常直观，您所要做的就是创建一个新的内容类型，并添加您的产品需要的字段。</p><p id="87d2" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">转到侧栏上的内容类型生成器部分，然后选择创建新的集合类型。将出现一个模式，您将输入product作为显示名称，然后单击Continue按钮。</p><p id="7d12" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">接下来就是忙活了。接下来，您必须添加您的实际数据(<strong class="kq io">内容管理器</strong> - &gt;选择一个<strong class="kq io">集合类型</strong> - &gt; <strong class="kq io">创建新条目，</strong>清洗并重复您目录中的每个产品)我正在播种来自<a class="ae lk" href="https://fakestoreapi.com/" rel="noopener ugc nofollow" target="_blank"> FakeStoreAPI </a>的示例数据，因此，这就是我的内容类型看起来的样子。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi os"><img src="../Images/f6783adb6b696437f721ac01305df584.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_Yb_zkByjyFDXnTM"/></div></div></figure><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi ot"><img src="../Images/88f1b45686756013741e621e156bb2b5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vUDxIxtCOtSLDbaE"/></div></div></figure><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi ou"><img src="../Images/884e07e5bfae917e2cdb00141f36e367.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Yyskp9tb0XnzMjYW"/></div></div><figcaption class="kk kl gj gh gi km kn bd b be z dk">Don’t forget to add the many-to-one relation between product and category!</figcaption></figure><p id="cb51" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">接下来，您需要授予<code class="fe ms mt mu mv b">find </code>和<code class="fe ms mt mu mv b">findOne</code>对这两种集合类型的读权限，这样它们就可以被公开，无需认证就可以被查询。</p><p id="b9cc" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">为此，请转到边栏上的设置，然后:</p><ul class=""><li id="6d65" class="mj mk in kq b kr ks ku kv kx ml lb mm lf mn lj ov mp mq mr bi translated">头<strong class="kq io">角色</strong>下<strong class="kq io">用户和权限。</strong></li><li id="e8d7" class="mj mk in kq b kr mw ku mx kx my lb mz lf na lj ov mp mq mr bi translated">点击<strong class="kq io">公共</strong>角色进行编辑。</li><li id="cab0" class="mj mk in kq b kr mw ku mx kx my lb mz lf na lj ov mp mq mr bi translated">点击<strong class="kq io">用户-权限</strong>下拉菜单，然后检查产品和类别的find和findone选项。</li></ul><p id="24aa" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在，单击屏幕右上角的Save按钮来更新角色。</p><p id="7d9c" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在，我们可以进行类似于<code class="fe ms mt mu mv b"><strong class="kq io">GET</strong> /products</code>和<code class="fe ms mt mu mv b"><strong class="kq io">GET</strong> /products/:id</code>的REST查询。但是当然，GraphQL会使所有这些<em class="ll">变得更加容易。所以接下来让我们完成它。</em></p><p id="1cbf" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io">第三步:添加GraphQL API </strong></p><p id="2934" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">要将我们的(目前是RESTful) API端点转换成一个GraphQL端点，我们必须通过在后端目录中运行以下命令来安装graphql插件:</p><pre class="kd ke kf kg gt od mv oe of aw og bi"><span id="6043" class="ng ln in mv b gy oh oi l oj ok">&gt; npm run strapi install graphql</span></pre><p id="7f97" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">全部完成后，现在使用以下命令(重新)启动Strapi服务器:</p><pre class="kd ke kf kg gt od mv oe of aw og bi"><span id="f037" class="ng ln in mv b gy oh oi l oj ok">&gt; npm run develop</span></pre><p id="c631" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">…并让它在本教程的剩余部分一直运行。现在您在<code class="fe ms mt mu mv b"><a class="ae lk" href="http://localhost:1337/graphql" rel="noopener ugc nofollow" target="_blank">localhost:1337/graphql</a></code>有了一个GraphQL端点，您可以在这里玩一会儿<strong class="kq io">，</strong>编写GraphQL查询来探索您的数据。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="nc nd di ne bf nf"><div class="gh gi or"><img src="../Images/ef7944ff3bfc8000a00241198a61b980.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*hOKm-nd5BunmprY1"/></div></div></figure><h1 id="22dc" class="lm ln in bd lo lp lq lr ls lt lu lv lw jt lx ju ly jw lz jx ma jz mb ka mc md bi translated">2.建立wunder graph——和我们的前端。</h1><p id="5f06" class="pw-post-body-paragraph ko kp in kq b kr me jo kt ku mf jr kw kx mg kz la lb mh ld le lf mi lh li lj ig bi translated">现在我们有了GraphQL数据源，是时候将WunderGraph设置为我们的BFF了。幸运的是，WunderGraph开发人员已经提供了一个<a class="ae lk" href="https://github.com/wundergraph/wundergraph/tree/main/examples/nextjs" rel="noopener ugc nofollow" target="_blank">启动模板</a>，我们可以用它同时启动和运行WunderGraph和一个样板Next.js应用程序。</p><h1 id="a651" class="lm ln in bd lo lp lq lr ls lt lu lv lw jt lx ju ly jw lz jx ma jz mb ka mc md bi translated">第一步:WunderGraph + Next.js快速入门</h1><p id="3bb6" class="pw-post-body-paragraph ko kp in kq b kr me jo kt ku mf jr kw kx mg kz la lb mh ld le lf mi lh li lj ig bi translated">CD进入项目根目录(在后端之外)，并键入:</p><pre class="kd ke kf kg gt od mv oe of aw og bi"><span id="149d" class="ng ln in mv b gy oh oi l oj ok">&gt; npx -y @wundergraph/wunderctl init — template nextjs-starter -o frontend</span></pre><p id="bfb2" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">然后，将CD放入项目目录:</p><pre class="kd ke kf kg gt od mv oe of aw og bi"><span id="a909" class="ng ln in mv b gy oh oi l oj ok">&gt; cd frontend</span></pre><p id="6993" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">安装依赖项，并启动:</p><pre class="kd ke kf kg gt od mv oe of aw og bi"><span id="ebad" class="ng ln in mv b gy oh oi l oj ok">&gt; npm i &amp;&amp; npm start</span></pre><p id="2c3e" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">这将启动WunderGraph <strong class="kq io">和</strong> Next.js服务器(利用<a class="ae lk" href="https://www.npmjs.com/package/npm-run-all" rel="noopener ugc nofollow" target="_blank"> npm-run-all </a>包)，在<code class="fe ms mt mu mv b">localhost:3000</code>给你一个带有示例查询的splash/intro页面(我相信是针对SpaceX火箭的)。如果你看到了，一切都正常。</p><p id="e1a7" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在实际配置WunderGraph来查看我们的Strapi数据，并为我们生成一个Next.js客户端——包括查询/变异挂钩，我们的前端可以使用和显示来自我们的Strapi产品目录的数据。</p><h1 id="e291" class="lm ln in bd lo lp lq lr ls lt lu lv lw jt lx ju ly jw lz jx ma jz mb ka mc md bi translated">第二步:奇迹101</h1><p id="b5b6" class="pw-post-body-paragraph ko kp in kq b kr me jo kt ku mf jr kw kx mg kz la lb mh ld le lf mi lh li lj ig bi translated">因此，WunderGraph的工作方式是，你告诉它你的应用程序依赖于哪些数据源，它将这些不同的数据源整合到一个单一的虚拟图形层中，然后你可以在其上定义数据操作(使用GraphQL)。通过强大的自省，WunderGraph可以将你能想到的几乎任何数据源转变成一个安全的、类型安全的JSON-over-RPC API；OpenAPI REST、GraphQL、PlanetScale、Fauna、MongoDB等等，以及任何Postgres/SQLite/MySQL数据库。</p><p id="549f" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">这对我们来说很好；我们已经有了一个工作的GraphQL数据源！</p><p id="49f7" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">所以让我们开门见山。在<code class="fe ms mt mu mv b">.wundergraph</code>目录中打开<code class="fe ms mt mu mv b">wundergraph.config.ts </code>，添加我们的Strapi + GraphQL端点作为我们的app所依赖的数据源，一个WunderGraph应该自省的数据源。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ow ox l"/></div><figcaption class="kk kl gj gh gi km kn bd b be z dk">Notice how every introspected datasource needs a namespace — as every one of them has to get consolidated into a single virtual graph.</figcaption></figure><p id="8433" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">一旦你运行了<code class="fe ms mt mu mv b">npm start</code>，WunderGraph会自动监控你的项目目录中的必要文件，所以只要点击这里的save就会让代码生成器运行，它会生成一个你可以检查的模式(如果你想的话)——在<code class="fe ms mt mu mv b">/.wundergraph/generated</code>中的<code class="fe ms mt mu mv b"> wundergraph.app.schema.graphql</code>文件。</p><h1 id="fb76" class="lm ln in bd lo lp lq lr ls lt lu lv lw jt lx ju ly jw lz jx ma jz mb ka mc md bi translated">步骤3:使用GraphQL定义操作</h1><p id="4785" class="pw-post-body-paragraph ko kp in kq b kr me jo kt ku mf jr kw kx mg kz la lb mh ld le lf mi lh li lj ig bi translated">这是我们在GraphQL中编写查询/变异来操作WunderGraph生成的虚拟图形层，并获得我们想要的数据的部分。</p><p id="972c" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">所以转到<code class="fe ms mt mu mv b"> ./wundergraph/operations</code>并创建一个新的GraphQL文件。我们就叫它<code class="fe ms mt mu mv b">AllProducts.graphql</code>。文件/查询名称无关紧要；它的内容和命名空间(以'<code class="fe ms mt mu mv b">namespace_collection</code>'格式)做。</p><p id="5b26" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">这是我们获取所有产品的查询。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ow ox l"/></div></figure><p id="244a" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">先别庆祝；下面是另一个操作，这次通过ID(或slug)获得一个产品。您的选择，但slug可能更适合SEO)。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ow ox l"/></div></figure><p id="ed56" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在这个过程中，每次你点击save，WunderGraph的代码生成都在后台工作(只要它的服务器在运行，它就会在后台工作)，为你动态地生成类型安全的、特定于客户端的数据获取React钩子。</p><p id="02fe" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">你可以在<code class="fe ms mt mu mv b">/components/nextjs.ts</code>里检查这些。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ow ox l"/></div><figcaption class="kk kl gj gh gi km kn bd b be z dk">Fine; you can probably celebrate a little now.</figcaption></figure><p id="0e45" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">正如你所看到的，WunderGraph给了你两个钩子供你使用，你可以在建立你的网站时使用— <code class="fe ms mt mu mv b">AllProducts</code>和<code class="fe ms mt mu mv b">ProductByID</code>。两者都接受输入；前者是一个分页限制，而后者是一个用来过滤的ID。</p><h1 id="b8a4" class="lm ln in bd lo lp lq lr ls lt lu lv lw jt lx ju ly jw lz jx ma jz mb ka mc md bi translated">3.构建Next.js前端</h1><p id="0b45" class="pw-post-body-paragraph ko kp in kq b kr me jo kt ku mf jr kw kx mg kz la lb mh ld le lf mi lh li lj ig bi translated">好消息；我们的大部分重活都做完了。从现在开始，我们完全生活在UI世界里。如果你熟悉Next.js，这应该轻而易举。我们要做的就是为我们的电子商务应用程序建立一个前端，使用在上一步中导出的2个钩子。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ow ox l"/></div></figure><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ow ox l"/></div></figure><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ow ox l"/></div></figure><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ow ox l"/></div><figcaption class="kk kl gj gh gi km kn bd b be z dk">/products/[id].tsx</figcaption></figure><h1 id="150a" class="lm ln in bd lo lp lq lr ls lt lu lv lw jt lx ju ly jw lz jx ma jz mb ka mc md bi translated">4.用Snipcart实现购物车管理</h1><p id="4f8f" class="pw-post-body-paragraph ko kp in kq b kr me jo kt ku mf jr kw kx mg kz la lb mh ld le lf mi lh li lj ig bi translated">Snipcart为任何webapp提供端到端的购物车管理和结账解决方案，以定制脚本和样式表的形式提供，使集成变得简单。</p><p id="71c6" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">一旦你注册了，仔细检查以确保你处于测试模式，并有你的公共API密匙(并存储在你的<code class="fe ms mt mu mv b">.env.local</code>文件中)，你就一切就绪了。</p><p id="da80" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">只有一个变化:不是手动添加Snipcart脚本(这里是的<a class="ae lk" href="https://docs.snipcart.com/v3/setup/installation" rel="noopener ugc nofollow" target="_blank">)到我们应用的<code class="fe ms mt mu mv b">&lt;body&gt; </code>标签，我们将为它们创建一个组件，并包含在我们的<code class="fe ms mt mu mv b">Index.tsx</code>中。</a></p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ow ox l"/></div></figure><p id="a229" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">一旦完成，我们所要做的就是添加Snipcart的必要属性来提供购物车元数据，只要我们有一个<code class="fe ms mt mu mv b">&lt;button&gt;</code>来添加一个商品到购物车。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ow ox l"/></div></figure><p id="e47d" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">全部完成！只要确保你已经<a class="ae lk" href="https://docs.snipcart.com/v3/" rel="noopener ugc nofollow" target="_blank">阅读了他们的文档</a>，因为这篇文章是<strong class="kq io">而不是【Snipcart的API的综合教程。</strong></p><h1 id="83c3" class="lm ln in bd lo lp lq lr ls lt lu lv lw jt lx ju ly jw lz jx ma jz mb ka mc md bi translated">总结一下</h1><p id="d36f" class="pw-post-body-paragraph ko kp in kq b kr me jo kt ku mf jr kw kx mg kz la lb mh ld le lf mi lh li lj ig bi translated">就这些了，伙计们！希望本教程能让您深入了解如何使用WunderGraph利用JAMstack的强大功能，超越仅使用JAMstack工具所能做到的。</p><p id="f71b" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">有意义地分离前端和后端——然后弥合它们之间的差距，并以安全的方式启动——可能是构建webapps时最常见的痛点。像JAMstack这样的新范例——在使web变得更简单、更快速的同时，对开发者和用户来说都是一样的，它有自己的一套<em class="ll">陷阱</em>和编写胶合代码的单调乏味。</p><p id="e08f" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">与JAMstack和GraphQL一起作为服务层/BFF使用，WunderGraph解决了大部分这些棘手问题，确保您只关心业务逻辑，并为您的客户构建和交付出色的东西。完整的端到端解决方案，没有任何额外的依赖性。</p></div></div>    
</body>
</html>