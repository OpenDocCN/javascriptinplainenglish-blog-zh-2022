<html>
<head>
<title>RSA Encryption in Node.js with Code Samples</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Node.js中的RSA加密及代码示例</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/rsa-encryption-in-nodejs-with-code-samples-86bb829718e0?source=collection_archive---------0-----------------------#2022-02-06">https://javascript.plainenglish.io/rsa-encryption-in-nodejs-with-code-samples-86bb829718e0?source=collection_archive---------0-----------------------#2022-02-06</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="758b" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">Node.js中的RSA加密指南及代码示例。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi kc"><img src="../Images/5f202884691e82864c4f8c6e7d7eff70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*SLQvF2B4cQQZ5TF9lbs0vg.png"/></div></figure><p id="addd" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">Node.js附带了一个“crypto”模块，可以帮助您创建公钥和私钥对来使用公钥加密。</p><h2 id="327c" class="lg lh in bd li lj lk dn ll lm ln dp lo kt lp lq lr kx ls lt lu lb lv lw lx ly bi translated">公钥密码学解释说:</h2><p id="5986" class="pw-post-body-paragraph kk kl in km b kn lz jo kp kq ma jr ks kt mb kv kw kx mc kz la lb md ld le lf ig bi translated">这是我看到的一篇很好的文章，很好地解释了这个问题:</p><div class="me mf gp gr mg mh"><a href="https://www.sohamkamani.com/nodejs/rsa-encryption/" rel="noopener  ugc nofollow" target="_blank"><div class="mi ab fo"><div class="mj ab mk cl cj ml"><h2 class="bd io gy z fp mm fr fs mn fu fw im bi translated">Node.js中的RSA加密、解密和签名(Javascript) -示例</h2><div class="mo l"><h3 class="bd b gy z fp mm fr fs mn fu fw dk translated">这篇文章将解释RSA算法，以及我们如何在Node.js中实现RSA加密、解密和签名…</h3></div><div class="mp l"><p class="bd b dl z fp mm fr fs mn fu fw dk translated">www.sohamkamani.com</p></div></div><div class="mq l"><div class="mr l ms mt mu mq mv ki mh"/></div></div></a></div><p id="0bc9" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated"><em class="mw">(请务必阅读这篇文章，因为我不会在帖子中涉及此事)</em></p><p id="872c" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">对我来说，崩溃的地方实际上是实现，因为创建的密钥是在内存中的，并且是短暂的。我用代码示例来写这篇文章，您可以运行到:</p><ol class=""><li id="f8b9" class="mx my in km b kn ko kq kr kt mz kx na lb nb lf nc nd ne nf bi translated">创建公钥/私钥对</li><li id="fd99" class="mx my in km b kn ng kq nh kt ni kx nj lb nk lf nc nd ne nf bi translated">将其导出，并写入您的文件系统(作为public.pem和private.pem文件)</li><li id="1c79" class="mx my in km b kn ng kq nh kt ni kx nj lb nk lf nc nd ne nf bi translated">创建一些样本数据进行加密(这是我们的秘密，我们不想让其他人知道)</li><li id="c5ae" class="mx my in km b kn ng kq nh kt ni kx nj lb nk lf nc nd ne nf bi translated">加密所说的数据，保存在一个文件中，这样我们就可以看到它看起来像什么</li><li id="d2e3" class="mx my in km b kn ng kq nh kt ni kx nj lb nk lf nc nd ne nf bi translated">解密这些加密数据得到我们的原始秘密数据</li></ol><p id="33c6" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated"><strong class="km io">这里是Github库:</strong></p><div class="me mf gp gr mg mh"><a href="https://github.com/nkhil/node-crypto" rel="noopener  ugc nofollow" target="_blank"><div class="mi ab fo"><div class="mj ab mk cl cj ml"><h2 class="bd io gy z fp mm fr fs mn fu fw im bi translated">GitHub - nkhil/node-crypto</h2><div class="mo l"><h3 class="bd b gy z fp mm fr fs mn fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="mp l"><p class="bd b dl z fp mm fr fs mn fu fw dk translated">github.com</p></div></div></div></a></div><p id="aea9" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">您不需要<code class="fe nl nm nn no b">npm i</code>，因为没有依赖关系，并且<code class="fe nl nm nn no b">crypto</code>模块与node一起提供。</p><ol class=""><li id="c109" class="mx my in km b kn ko kq kr kt mz kx na lb nb lf nc nd ne nf bi translated"><strong class="km io">要创建一些要加密的数据，运行这个命令</strong></li></ol><pre class="kd ke kf kg gt np no nq nr aw ns bi"><span id="5091" class="lg lh in no b gy nt nu l nv nw">npm run create-data</span></pre><p id="9a5f" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">你现在应该在项目根目录下有一个名为<code class="fe nl nm nn no b">data_to_encrypt.txt</code>的文件。这是一些使用Node.js的加密模块创建的任意数据。有兴趣的话可以看看这里:<a class="ae nx" href="https://github.com/nkhil/node-crypto/blob/master/src/rsa/create-data-to-encrypt.js" rel="noopener ugc nofollow" target="_blank">https://github . com/nkhil/node-crypto/blob/master/src/RSA/create-data-to-encrypt . js</a></p><p id="3c71" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">好了，现在我们有一些秘密数据要加密了🎉</p><p id="9534" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">为了加密它，我们需要首先创建我们的公钥-私钥对。在现实世界中，我们将公开我们的公钥，任何人都可以使用公钥加密数据，将其发送给我们，并且只有我们能够读取该数据(使用只有我们拥有的私钥)。</p><p id="ce74" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated"><strong class="km io">旁注</strong>:这是一个很棒的小漫画，解释了公共-私有密钥:</p><div class="me mf gp gr mg mh"><a href="https://howhttps.works/the-keys/" rel="noopener  ugc nofollow" target="_blank"><div class="mi ab fo"><div class="mj ab mk cl cj ml"><h2 class="bd io gy z fp mm fr fs mn fu fw im bi translated">HTTPS是如何运作的</h2><div class="mo l"><h3 class="bd b gy z fp mm fr fs mn fu fw dk translated">在这种情况下，只有一个密钥来加密和解密消息。在向BrowserBird发送消息之前，我…</h3></div><div class="mp l"><p class="bd b dl z fp mm fr fs mn fu fw dk translated">howhttps.works</p></div></div><div class="mq l"><div class="ny l ms mt mu mq mv ki mh"/></div></div></a></div><h2 id="ef9d" class="lg lh in bd li lj lk dn ll lm ln dp lo kt lp lq lr kx ls lt lu lb lv lw lx ly bi translated">创建我们的公钥-私钥对</h2><p id="ca37" class="pw-post-body-paragraph kk kl in km b kn lz jo kp kq ma jr ks kt mb kv kw kx mc kz la lb md ld le lf ig bi translated">下面是我们将如何创建我们的公钥-私钥对，导出它并将其写入文件。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="1b6a" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated"><strong class="km io"> 2。要创建公钥/私钥对，可以运行:</strong></p><pre class="kd ke kf kg gt np no nq nr aw ns bi"><span id="c316" class="lg lh in no b gy nt nu l nv nw">npm run create-keys</span></pre><p id="c3d0" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">注意我们把它写到项目根，命名为<code class="fe nl nm nn no b">private.pem</code>和<code class="fe nl nm nn no b">public.pem</code>。</p><h2 id="02a6" class="lg lh in bd li lj lk dn ll lm ln dp lo kt lp lq lr kx ls lt lu lb lv lw lx ly bi translated">加密一些数据</h2><p id="fad3" class="pw-post-body-paragraph kk kl in km b kn lz jo kp kq ma jr ks kt mb kv kw kx mc kz la lb md ld le lf ig bi translated">下面是我们将如何加密在步骤1中创建的名为<code class="fe nl nm nn no b">data_to_encrypt.txt</code>的文件中的数据(我只对您将使用的命令进行了编号)</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="42a6" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated"><strong class="km io"> 3。要加密</strong> <code class="fe nl nm nn no b"><strong class="km io">data_to_encrypt.txt</strong></code> <strong class="km io">(我们在上面的步骤1中创建的)中的数据，使用</strong></p><pre class="kd ke kf kg gt np no nq nr aw ns bi"><span id="64f8" class="lg lh in no b gy nt nu l nv nw">npm run encrypt-data</span></pre><p id="9c4a" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">一旦您运行这个^，您应该在您的项目根目录中有一个名为<code class="fe nl nm nn no b">encrypted_data.txt</code>的文件。请随意打开这个文件，这是我们数据的乱码版本。</p><h2 id="e996" class="lg lh in bd li lj lk dn ll lm ln dp lo kt lp lq lr kx ls lt lu lb lv lw lx ly bi translated">解密数据</h2><p id="7e88" class="pw-post-body-paragraph kk kl in km b kn lz jo kp kq ma jr ks kt mb kv kw kx mc kz la lb md ld le lf ig bi translated">这是解密数据的代码</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nz oa l"/></div></figure><p id="db0c" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">您的解密数据应该与文件<code class="fe nl nm nn no b">data_to_encrypt.txt</code>的内容相同。</p><p id="4687" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">恭喜您，您刚刚使用RSA加密使用公钥加密了一些数据，然后使用附带的私钥解密和读取这些信息。</p><h2 id="8dc6" class="lg lh in bd li lj lk dn ll lm ln dp lo kt lp lq lr kx ls lt lu lb lv lw lx ly bi translated">一些笔记</h2><p id="4421" class="pw-post-body-paragraph kk kl in km b kn lz jo kp kq ma jr ks kt mb kv kw kx mc kz la lb md ld le lf ig bi translated">请注意，在现实世界中，您可能不会将密钥作为文件，而是作为仅在您的应用程序中可用的安全环境变量。我使用文件作为能够更好地理解RSA加密的一种方式。</p><p id="344a" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">您需要确保您的私钥是安全的，因为任何能够访问您的私钥的人都可以读取所有的加密信息。</p><p id="5d46" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">我见过使用AWS S3存储桶(或GCP存储桶)这样的存储解决方案安全地保存私钥，并使其只有具有适当IAM角色的应用程序才能访问桶中的文件。这种资源创建通常由Terraform管理，但我们不会深入讨论。</p><p id="cf78" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">请注意，使用RSA加密可以加密的数据大小是有限制的。当我尝试加密一个128字节的字符串时，我得到以下错误:</p><pre class="kd ke kf kg gt np no nq nr aw ns bi"><span id="3fda" class="lg lh in no b gy nt nu l nv nw">Error: error:0409A06E:rsa routines:RSA_padding_add_PKCS1_OAEP_mgf1:data too large for key size</span></pre><p id="3818" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">请看<a class="ae nx" href="https://stackoverflow.com/questions/34124795/getting-error-data-too-large-for-key-size-with-crypto-node-js" rel="noopener ugc nofollow" target="_blank">这个栈溢出讨论</a>了解更多信息。</p><p id="2e1b" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated"><em class="mw">更多内容看</em> <a class="ae nx" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="km io"> <em class="mw">说白了。报名参加我们的</em> <a class="ae nx" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="km io"> <em class="mw">免费周报</em> </strong> </a> <em class="mw">。在我们的</em> <a class="ae nx" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="km io"> <em class="mw">社区不和谐</em> </strong> </a> <em class="mw">获得独家获取写作机会和建议。</em></strong></a></p></div></div>    
</body>
</html>