<html>
<head>
<title>Typesafe Environment Config in Angular</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Angular中的类型安全环境配置</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/typesafe-environment-config-in-angular-df1c02af65df?source=collection_archive---------7-----------------------#2022-03-22">https://javascript.plainenglish.io/typesafe-environment-config-in-angular-df1c02af65df?source=collection_archive---------7-----------------------#2022-03-22</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><div class=""><h2 id="13fb" class="pw-subtitle-paragraph jo iq ir bd b jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dk translated">如何在Angular中配置类型安全环境</h2></div><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj kg"><img src="../Images/20b5ab3c07b98bcd7f45a190069dcd62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*iwctX8Wrb6LBbtn1"/></div></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">Photo by <a class="ae kw" href="https://unsplash.com/@markusspiske?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Markus Spiske</a> on <a class="ae kw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="9436" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">Angular是关于好的实践，Angular是关于打字稿。自然，开发者喜欢大部分输入的东西。一个例外是<code class="fe lt lu lv lw b">environment.ts</code>文件。但是为什么它应该保持非类型化呢？让它变得可预测。</p><h1 id="18dd" class="lx ly ir bd lz ma mb mc md me mf mg mh jx mi jy mj ka mk kb ml kd mm ke mn mo bi translated">步骤1:界面</h1><p id="9a87" class="pw-post-body-paragraph kx ky ir kz b la mp js lc ld mq jv lf lg mr li lj lk ms lm ln lo mt lq lr ls ik bi translated">为环境配置创建接口。为了演示，我们有一个非常简单的界面。但是根据您的需要，您可以随意添加其他项目。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj mu"><img src="../Images/8c55f310ba2773ceb36867ea8ac5d33a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*33YIHDyCsB9zSBvjO7ZSLg.png"/></div></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">app-config.ts</figcaption></figure><p id="7c7e" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">转到您的环境文件并使用界面:</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj mv"><img src="../Images/e0352d4413deed0628c73d322770e393.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1F4lO8M6HbEpM579JphY3A.png"/></div></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">environment.ts</figcaption></figure><h1 id="31e4" class="lx ly ir bd lz ma mb mc md me mf mg mh jx mi jy mj ka mk kb ml kd mm ke mn mo bi translated">步骤2:注入令牌</h1><p id="59b8" class="pw-post-body-paragraph kx ky ir kz b la mp js lc ld mq jv lf lg mr li lj lk ms lm ln lo mt lq lr ls ik bi translated">为了注入<code class="fe lt lu lv lw b">AppConfig</code>值，我们需要创建一个令牌，Angular将利用它进行查找。您可以将此视为唯一标识符。这个令牌将告诉Angular提供什么。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj mw"><img src="../Images/fff5dfb086a7452c9b06aa66213d68d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cc5Azmi1jetLbsNgujCwuQ.png"/></div></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">app-config.ts</figcaption></figure><h1 id="d5ce" class="lx ly ir bd lz ma mb mc md me mf mg mh jx mi jy mj ka mk kb ml kd mm ke mn mo bi translated">第三步:供应商</h1><p id="cd8a" class="pw-post-body-paragraph kx ky ir kz b la mp js lc ld mq jv lf lg mr li lj lk ms lm ln lo mt lq lr ls ik bi translated">由于环境配置保证在非常初始的阶段注入，我们将在<code class="fe lt lu lv lw b">AppModule </code>提供值，它通常是应用程序的根模块。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj mx"><img src="../Images/27e5e3de593de1f1dcb7db1a93d3baae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k5jvDS7votTvzgTZhZJhGw.png"/></div></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">app.module.ts</figcaption></figure><h1 id="df7c" class="lx ly ir bd lz ma mb mc md me mf mg mh jx mi jy mj ka mk kb ml kd mm ke mn mo bi translated">步骤4:用法</h1><p id="6b2b" class="pw-post-body-paragraph kx ky ir kz b la mp js lc ld mq jv lf lg mr li lj lk ms lm ln lo mt lq lr ls ik bi translated">现在，您可以在任何需要的地方使用环境值。例如在休息服务中:</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj mx"><img src="../Images/508290f51a69f4c3dd70f333d8854e25.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7i3X0K-iwnAONEIXMSlDYg.png"/></div></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">asset.service.ts</figcaption></figure><p id="ca26" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">如果您在任何时候拼错了一个配置，或者从环境对象中删除了一个属性，您将得到IDE警告和其他预防性警告。酷！</p><h1 id="341a" class="lx ly ir bd lz ma mb mc md me mf mg mh jx mi jy mj ka mk kb ml kd mm ke mn mo bi translated">额外收获:在Angular中使用环境变量</h1><p id="e1da" class="pw-post-body-paragraph kx ky ir kz b la mp js lc ld mq jv lf lg mr li lj lk ms lm ln lo mt lq lr ls ik bi translated">您的前端应用程序可能包含许多秘密，如API端点URL、公钥、令牌等。在Angular中，你可以在环境文件中管理它们。这些配置可能因构建阶段而异，例如开发、测试和生产。Angular用相应阶段的特定文件替换它。相当直接！然而，您可能会发现自己不希望通过硬编码暴露这些秘密，而是从<code class="fe lt lu lv lw b">ENV_VARS.</code>中选择它们。另一种情况可能是您不喜欢将包含敏感信息的环境文件提交给版本控制(git)。</p><p id="55e8" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">在这种情况下，您可以使用一个小的Node.js脚本在构建时创建环境文件。</p><p id="168a" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">在项目的根目录下创建一个JavaScript文件<code class="fe lt lu lv lw b">make-env-file.js</code>:</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj mx"><img src="../Images/2b382caa811a18d5717bc8d6ca8dd30b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qkP_a99TRr_wEjUb9Gy-EQ.png"/></div></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">make-env-file.js</figcaption></figure><ul class=""><li id="c5c3" class="my mz ir kz b la lb ld le lg na lk nb lo nc ls nd ne nf ng bi translated">确保文件名正确，并且路径指向您想要的环境配置文件。</li><li id="68d8" class="my mz ir kz b la nh ld ni lg nj lk nk lo nl ls nd ne nf ng bi translated">修改<code class="fe lt lu lv lw b">getContent()</code>方法以包含所有配置。</li><li id="80e0" class="my mz ir kz b la nh ld ni lg nj lk nk lo nl ls nd ne nf ng bi translated">在构建生产角度工件之前，更新<code class="fe lt lu lv lw b">package.json</code>命令以利用创建的脚本。</li></ul><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj mx"><img src="../Images/bdbecb340e9c9a3702f86daa91277dc5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jLNZSGBa7kicFeM3QQTMrA.png"/></div></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">package.json</figcaption></figure><p id="d8ec" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">您必须确保环境变量对Node.js可用。通常您会通过docker设置或托管提供商的接口来提供它们。</p><p id="14bc" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">感谢阅读！</p><h2 id="0a6b" class="nm ly ir bd lz nn no dn md np nq dp mh lg nr ns mj lk nt nu ml lo nv nw mn nx bi translated">完整代码:</h2><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="ny nz l"/></div></figure><p id="a14f" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated"><em class="oa">更多内容请看</em><a class="ae kw" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kz is"><em class="oa">plain English . io</em></strong></a><em class="oa">。报名参加我们的</em> <a class="ae kw" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kz is"> <em class="oa">免费周报</em> </strong> </a> <em class="oa">。关注我们关于</em><a class="ae kw" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="kz is"><em class="oa">Twitter</em></strong></a><em class="oa">和</em><a class="ae kw" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kz is"><em class="oa">LinkedIn</em></strong></a><em class="oa">。加入我们的</em> <a class="ae kw" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kz is"> <em class="oa">社区不和谐</em> </strong> </a> <em class="oa">。</em></p></div></div>    
</body>
</html>