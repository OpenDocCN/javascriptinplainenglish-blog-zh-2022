<html>
<head>
<title>Improve Your Next.js App’s Performance in 10 Minutes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在10分钟内提高Next.js应用程序的性能</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/improve-your-nextjs-apps-performance-in-10-minutes-fb7c597be021?source=collection_archive---------4-----------------------#2022-12-07">https://javascript.plainenglish.io/improve-your-nextjs-apps-performance-in-10-minutes-fb7c597be021?source=collection_archive---------4-----------------------#2022-12-07</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/fb3d4e1df800f1147fd6587170cf526b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*frZGJBBWAwfxlTZ3.png"/></div></div></figure><h1 id="dec1" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">介绍</h1><p id="07df" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">我们都知道Next.ks是相当重量级的，尤其是相对于Svelte Kit或者Nuxt.js而言，优化并不是每个人都喜欢的东西。您的产品所有者可能不想在优化上浪费时间，而更喜欢运输功能。您的QA和测试人员可能不想回归测试所有可能受影响的特性。</p><p id="1679" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">这篇文章是一个关于Next.js优化的简单教程，所以你可以在最短的时间内获得更好的性能，灯塔得分</p><h1 id="1cb3" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">重新定位您的第三方脚本</h1><p id="c339" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">如果你的应用有谷歌分析，Hotjar，脸书像素…或任何第三方脚本。您可能希望将这些脚本重新定位到服务工作者和主线程之外。</p><p id="e699" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">我有一篇关于这个的文章<a class="ae lw" href="https://duckylele.medium.com/use-your-third-party-scripts-without-the-performance-hit-with-partytown-b2860cd27007" rel="noopener">就在这里</a></p><p id="8f2c" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">相信我，这不会花很长时间，结果可能会让你大吃一惊。</p><h1 id="cd79" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">使用动态导入</h1><p id="affb" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">Next.js支持用<code class="fe lx ly lz ma b">import()</code>惰性加载外部库，用<code class="fe lx ly lz ma b">next/dynamic</code>惰性加载组件。通过减少呈现页面所需的JavaScript数量，延迟加载有助于提高初始加载性能。组件或库仅在使用时被导入并包含在JavaScript包中。</p><p id="44f1" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated"><code class="fe lx ly lz ma b">next/dynamic</code>是<code class="fe lx ly lz ma b"><a class="ae lw" href="https://reactjs.org/docs/code-splitting.html#reactlazy" rel="noopener ugc nofollow" target="_blank">React.lazy</a></code>的延伸。当与<code class="fe lx ly lz ma b"><a class="ae lw" href="https://reactjs.org/docs/react-api.html#reactsuspense" rel="noopener ugc nofollow" target="_blank">Suspense</a></code>结合使用时，成分可以延迟水合作用，直到悬置边界被解决。</p><p id="3e17" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">例如，我的主页有4个大块，但在第一次加载时只显示其中一个，用户必须滚动才能看到其他块。所以我不想一开始就加载全部4个:</p><pre class="mb mc md me gt mf ma mg bn mh mi bi"><span id="8c7f" class="mj jw in ma b be mk ml l mm mn">const Overview = dynamic(() =&gt; import('./Overview'));<br/>const Project = dynamic(() =&gt; import('./Projects'));<br/>const Contact = dynamic(() =&gt; import('./Contact'));</span></pre><p id="84bf" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">现在让我们看看结果</p><p id="fa73" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">之前:</p><figure class="mb mc md me gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mo"><img src="../Images/0f386c8ffb04026674b0d5789a199ecc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QgsT6P77LYke5qoxvOad4A.png"/></div></div></figure><p id="15ad" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">之后:</p><figure class="mb mc md me gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mo"><img src="../Images/94015c13233613690faeb71427d35716.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZQWSCL5nB9Yl-l-iPeazoA.png"/></div></div></figure><p id="8a20" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">您可以看到第一个负载JS从115kb减少到100kb，不多，但它是诚实的工作</p><h1 id="1ce2" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">预先行动而不是反应</h1><p id="53c8" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">Next.js构建在react之上，但Preact是一个JavaScript库，被认为是React的轻量级3kb替代方案，具有相同的现代API和ECMA脚本支持。</p><p id="70b5" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">所以如果你的app只是一个普通的Next.js app，我看不出有什么理由不用Preact。它的缺点是缺乏社区支持。</p><p id="70e9" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">如何实施:</p><ul class=""><li id="667b" class="mp mq in kv b kw lr la ls le mr li ms lm mt lq mu mv mw mx bi translated">首先，您必须安装Preact</li><li id="78be" class="mp mq in kv b kw my la mz le na li nb lm nc lq mu mv mw mx bi translated">打开您的<code class="fe lx ly lz ma b">next.config.js</code>文件并重新分配react:</li></ul><pre class="mb mc md me gt mf ma mg bn mh mi bi"><span id="5778" class="mj jw in ma b be mk ml l mm mn"> webpack: (config, { dev, isServer }) =&gt; {<br/>    if (!dev &amp;&amp; !isServer) {<br/>      Object.assign(config.resolve.alias, {<br/>        react: 'preact/compat',<br/>        'react-dom/test-utils': 'preact/test-utils',<br/>        'react-dom': 'preact/compat',<br/>      });<br/>    }<br/>    return config;<br/>  },</span></pre><p id="6c0c" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">现在看看性能:</p><figure class="mb mc md me gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mo"><img src="../Images/f6f61b848ccf468456b46ab5b8b1802d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UcX0RlQHXnHsluXBXmy7og.png"/></div></div></figure><p id="568c" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">束的大小明显更小。</p><p id="398c" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">但不仅如此，让我们看看生产中的情况:</p><p id="9d10" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">以前</p><figure class="mb mc md me gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nd"><img src="../Images/80887fe592096ba74e0b2b783ada3453.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UDMTs3_l68IAND_L9Wu8dA.png"/></div></div></figure><p id="4342" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">在...之后</p><figure class="mb mc md me gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi ne"><img src="../Images/9db845a3adaf4ff783f7c9ee5b180d61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*shQxXwKDXGT6uL8rYeHR5g.png"/></div></div></figure><p id="b19c" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">你可以看到所有的JS文件都变小了。</p><h1 id="e781" class="jv jw in bd jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks bi translated">结论</h1><p id="a17f" class="pw-post-body-paragraph kt ku in kv b kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq ig bi translated">有许多其他方法可以提高你的应用程序性能，但是它们需要更多的工作和研究。</p><p id="89f5" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated">我希望上面的方法对你有用，如果没有，请在下面评论，我们会找到最好的方法！</p><p id="d6e5" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated"><em class="nf">报名参加我们的</em> <a class="ae lw" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="nf">免费周报</em> </strong> </a> <em class="nf">。关注我们关于</em><a class="ae lw" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="nf">Twitter</em></strong></a>，<a class="ae lw" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="nf">LinkedIn</em></strong></a><em class="nf">，</em><a class="ae lw" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="nf">YouTube</em></strong></a><em class="nf">，以及</em> <a class="ae lw" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="nf">不和</em> </strong> </a> <strong class="kv io"> <em class="nf">。</em>T41】</strong></p><p id="9f45" class="pw-post-body-paragraph kt ku in kv b kw lr ky kz la ls lc ld le lt lg lh li lu lk ll lm lv lo lp lq ig bi translated"><strong class="kv io"> <em class="nf">有兴趣缩放你的软件启动</em> </strong> <em class="nf">？检查</em> <a class="ae lw" href="https://circuit.ooo?utm=publication-post-cta" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="nf">电路</em> </strong> </a> <em class="nf">。</em></p></div></div>    
</body>
</html>