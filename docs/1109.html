<html>
<head>
<title>Use Virtual Backgrounds with the Agora React Native SDK</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过Agora React Native SDK使用虚拟背景</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/use-virtual-backgrounds-with-the-agora-react-native-sdk-63781c011dbf?source=collection_archive---------22-----------------------#2022-03-03">https://javascript.plainenglish.io/use-virtual-backgrounds-with-the-agora-react-native-sdk-63781c011dbf?source=collection_archive---------22-----------------------#2022-03-03</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/a026a1e7932eac93995900ee5ec28ab9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*97iFFzJPYsbjWQqW6ZV_sg.png"/></div></div></figure><p id="b829" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">Agora React Native SDK现在支持使用虚拟背景。你可以使用纯色或者选择一张图片作为背景。我们将了解如何将图像资源与React Native捆绑在一起，以及如何选择用户图像作为虚拟背景。</p><h1 id="b826" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">先决条件</h1><ul class=""><li id="6eec" class="lr ls in jx b jy lt kc lu kg lv kk lw ko lx ks ly lz ma mb bi translated">一个Agora开发者账号(免费！<a class="ae mc" href="https://sso.agora.io/en/signup?utm_source=medium&amp;utm_medium=blog&amp;utm_campaign=use-virtual-backgrounds-with-the-agora-react-native-sdk" rel="noopener ugc nofollow" target="_blank">在这里报名</a></li><li id="52a1" class="lr ls in jx b jy md kc me kg mf kk mg ko mh ks ly lz ma mb bi translated">对React Native的基本理解</li></ul><p id="1330" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">为了让我们快速了解基本的视频通话应用，让我们使用这个<a class="ae mc" href="https://github.com/EkaanshArora/Agora-RN-Quickstart" rel="noopener ugc nofollow" target="_blank">演示</a>。您可以按照自述文件中的说明让应用程序在您的设备上运行。我们将讨论使用虚拟背景的代码。你可以在<a class="ae mc" href="https://github.com/EkaanshArora/Agora-RN-VirtualBackground/" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上找到这个演示的源代码。</p><p id="e661" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们需要两个开源库:react-native-image-picker和react-native-fs。您可以通过执行<code class="fe mi mj mk ml b">npm i --save react-native-image-picker react-native-fs</code>将它们添加到项目中</p><h1 id="65fe" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">U <strong class="ak">唱虚拟背景</strong></h1><figure class="mm mn mo mp gt jo"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="0cf2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">Agora SDK让它变得非常简单:你只需要用你的配置调用<code class="fe mi mj mk ml b">engine</code>对象上的<code class="fe mi mj mk ml b">enableVirtualBackground</code>方法来启用这个特性。你不必担心分割或背景去除之类的事情。</p><p id="85d8" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们将在名为<code class="fe mi mj mk ml b">virtualSource</code>的<code class="fe mi mj mk ml b">App</code>类上定义一个属性来创建和存储我们的配置。我们将在状态中添加一个waiting boolean，这样我们就可以在执行异步代码时禁用start call按钮。</p><figure class="mm mn mo mp gt jo"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="fbed" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们可以定义一个函数<code class="fe mi mj mk ml b">useColor</code>，它使用<code class="fe mi mj mk ml b">Color</code>类构造函数来创建一个颜色对象，该对象使用传递的红色、绿色和蓝色值(颜色范围是<code class="fe mi mj mk ml b">0 — 255</code>)。然后我们可以更新<code class="fe mi mj mk ml b">virtualSource</code>属性和我们的状态。</p><h2 id="3f6b" class="ms ku in bd kv mt mu dn kz mv mw dp ld kg mx my lh kk mz na ll ko nb nc lp nd bi translated">使用背景模糊</h2><figure class="mm mn mo mp gt jo"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="c336" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">为了使用背景模糊，我正在创建一个函数<code class="fe mi mj mk ml b">useBlur</code>。我们可以将<code class="fe mi mj mk ml b">backgroundSourceType</code>设置为<code class="fe mi mj mk ml b">Blur</code>并将<code class="fe mi mj mk ml b">blur_degree</code>定义为所需的强度，我选择的是<code class="fe mi mj mk ml b">Medium</code>。</p><h2 id="21c7" class="ms ku in bd kv mt mu dn kz mv mw dp ld kg mx my lh kk mz na ll ko nb nc lp nd bi translated">捆绑资源以用作虚拟背景</h2><figure class="mm mn mo mp gt jo"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="7be9" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">要捆绑图像，可以将其复制到项目目录，并使用所需的语法引用它。在使用RNFS测试时，我们可以使用URI下载映像。然后，我们可以用图像的绝对路径更新配置的source属性。</p><h2 id="4346" class="ms ku in bd kv mt mu dn kz mv mw dp ld kg mx my lh kk mz na ll ko nb nc lp nd bi translated">使用用户图像作为虚拟背景</h2><figure class="mm mn mo mp gt jo"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="3ec3" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们可以使用<code class="fe mi mj mk ml b">react-native-image-picker</code>中的<code class="fe mi mj mk ml b">launchImageLibrary</code>来访问图像URI。我们处理基于操作系统的映像访问，并将映像的绝对路径传递给配置文件。</p><p id="cf49" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">最后，我们可以在加入频道之前更新我们的<code class="fe mi mj mk ml b">startCall</code>功能来启用虚拟背景:</p><figure class="mm mn mo mp gt jo"><div class="bz fp l di"><div class="mq mr l"/></div></figure><h1 id="2a0b" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">结论</h1><p id="8992" class="pw-post-body-paragraph jv jw in jx b jy lt ka kb kc lu ke kf kg ne ki kj kk nf km kn ko ng kq kr ks ig bi translated">借助Agora SDK和开源库，您可以非常轻松地为视频通话和直播添加虚拟背景。你可以在<a class="ae mc" href="https://docs.agora.io/en/Video/API%20Reference/react_native/index.html" rel="noopener ugc nofollow" target="_blank"> API参考</a>中找到其他很酷的特性。你可以在这里阅读如何用几行代码<a class="ae mc" href="https://www.agora.io/en/creating-a-react-native-video-chat-app-in-a-few-lines-of-code-using-agora-uikit/" rel="noopener ugc nofollow" target="_blank">构建一个视频通话应用。</a></p><p id="55d2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我邀请您<a class="ae mc" href="https://www.agora.io/en/join-slack/" rel="noopener ugc nofollow" target="_blank">加入Agora开发者Slack社区</a>。欢迎在<code class="fe mi mj mk ml b">#react-native-help-me</code>频道提出任何关于该项目的问题。</p><p id="d398" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="nh">更多内容看</em> <a class="ae mc" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io"> <em class="nh">说白了。报名参加我们的</em> <a class="ae mc" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io"> <em class="nh">免费周报</em> </strong> </a> <em class="nh">。关注我们关于</em><a class="ae mc" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="jx io"><em class="nh">Twitter</em></strong></a><em class="nh">和</em><a class="ae mc" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="jx io"><em class="nh">LinkedIn</em></strong></a><em class="nh">。加入我们的</em> <a class="ae mc" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io"> <em class="nh">社区不和谐</em> </strong> </a> <em class="nh">。</em></strong></a></p></div></div>    
</body>
</html>