<html>
<head>
<title>React Context Best Architecture Practices</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">反应上下文最佳架构实践</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/react-context-best-architecture-practice-c7988c82d539?source=collection_archive---------3-----------------------#2022-01-30">https://javascript.plainenglish.io/react-context-best-architecture-practice-c7988c82d539?source=collection_archive---------3-----------------------#2022-01-30</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/></div><div class="ab cl jn jo hu jp" role="separator"><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js"/></div><div class="ij ik il im in"><figure class="jv jw jx jy gt jz gh gi paragraph-image"><div role="button" tabindex="0" class="ka kb di kc bf kd"><div class="gh gi ju"><img src="../Images/ad3d5e5e063e272f54ecc9a098e68aab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RczSMPhNLC1AEt8Gg72LaQ.png"/></div></div><figcaption class="kg kh gj gh gi ki kj bd b be z dk">React Context — Made by <a class="ae kk" href="https://carbon.now.sh/" rel="noopener ugc nofollow" target="_blank">Carbon</a></figcaption></figure><blockquote class="kl km kn"><p id="7410" class="ko kp kq kr b ks kt ku kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">首先，我假设你已经对<a class="ae kk" href="https://beta.reactjs.org/learn/passing-data-deeply-with-context#step-1-create-the-context" rel="noopener ugc nofollow" target="_blank">反应上下文</a>有所了解</p></blockquote><p id="3916" class="pw-post-body-paragraph ko kp iq kr b ks kt ku kv kw kx ky kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated">过去几天一直在用React Context，所以总结了一个非常有用的通用架构。</p><p id="2b74" class="pw-post-body-paragraph ko kp iq kr b ks kt ku kv kw kx ky kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated">好吧，让我们开始吧！</p><h2 id="c69c" class="lq lr iq bd ls lt lu dn lv lw lx dp ly ln lz ma mb lo mc md me lp mf mg mh mi bi translated">准备</h2><ul class=""><li id="9309" class="mj mk iq kr b ks ml kw mm ln mn lo mo lp mp lm mq mr ms mt bi translated">我们将使用<a class="ae kk" href="https://www.typescriptlang.org/" rel="noopener ugc nofollow" target="_blank">打字稿</a>。</li><li id="e0bd" class="mj mk iq kr b ks mu kw mv ln mw lo mx lp my lm mq mr ms mt bi translated">基于<a class="ae kk" href="https://nextjs.org/docs/getting-started" rel="noopener ugc nofollow" target="_blank"> Next.js </a>创建项目结构。</li><li id="6ebb" class="mj mk iq kr b ks mu kw mv ln mw lo mx lp my lm mq mr ms mt bi translated">为了获得更好的可视化体验，我们建议您安装<a class="ae kk" href="https://chrome.google.com/webstore/detail/react-developer-tools/fmkadmapgofadopljbjfkapdkoienihi?utm_source=chrome-ntp-icon" rel="noopener ugc nofollow" target="_blank"> React-Dev-Tools </a>。</li></ul></div><div class="ab cl jn jo hu jp" role="separator"><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js"/></div><div class="ij ik il im in"><h2 id="02f3" class="lq lr iq bd ls lt lu dn lv lw lx dp ly ln lz ma mb lo mc md me lp mf mg mh mi bi translated">初始化项目</h2><ol class=""><li id="aeb6" class="mj mk iq kr b ks ml kw mm ln mn lo mo lp mp lm mz mr ms mt bi translated">在您的终端上输入<code class="fe na nb nc nd b">npx create-next-app@latest</code></li><li id="a027" class="mj mk iq kr b ks mu kw mv ln mw lo mx lp my lm mz mr ms mt bi translated">按照提示输入适当的选项</li><li id="005c" class="mj mk iq kr b ks mu kw mv ln mw lo mx lp my lm mz mr ms mt bi translated">正在等待安装依赖项</li></ol></div><div class="ab cl jn jo hu jp" role="separator"><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js"/></div><div class="ij ik il im in"><h2 id="5054" class="lq lr iq bd ls lt lu dn lv lw lx dp ly ln lz ma mb lo mc md me lp mf mg mh mi bi translated">改善项目结构</h2><ul class=""><li id="89e4" class="mj mk iq kr b ks ml kw mm ln mn lo mo lp mp lm mq mr ms mt bi translated">在根目录下创建一个名为<em class="kq"> contexts </em>的新文件夹</li><li id="3386" class="mj mk iq kr b ks mu kw mv ln mw lo mx lp my lm mq mr ms mt bi translated">然后，我们在contexts内部创建一个名为<em class="kq"> CounterContext </em>的新文件夹，并在contexts文件夹的同一层创建一个<em class="kq"> index.ts </em>文件(用于导出我们在工作中创建的所有上下文——也适用于其他业务模块)</li><li id="a850" class="mj mk iq kr b ks mu kw mv ln mw lo mx lp my lm mq mr ms mt bi translated">类似地，在CounterContext文件夹中创建一个名为<em class="kq"> index.ts </em>的新文件</li><li id="72c9" class="mj mk iq kr b ks mu kw mv ln mw lo mx lp my lm mq mr ms mt bi translated">好了，让我们在<em class="kq">count context</em>文件夹中创建另一个<em class="kq">count context . ts</em>文件、countReducer.ts、use count context . ts</li><li id="e573" class="mj mk iq kr b ks mu kw mv ln mw lo mx lp my lm mq mr ms mt bi translated">到目前为止，您的项目结构应该如下所示</li></ul><figure class="jv jw jx jy gt jz gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/6fc4d0dbac225b7f95c8515c8f5fc52b.png" data-original-src="https://miro.medium.com/v2/resize:fit:754/format:webp/1*tbON3pr-an1SReROYSRGkg.png"/></div><figcaption class="kg kh gj gh gi ki kj bd b be z dk">React context project structured</figcaption></figure></div><div class="ab cl jn jo hu jp" role="separator"><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js"/></div><div class="ij ik il im in"><h2 id="eaf2" class="lq lr iq bd ls lt lu dn lv lw lx dp ly ln lz ma mb lo mc md me lp mf mg mh mi bi translated">编码</h2><ul class=""><li id="ba14" class="mj mk iq kr b ks ml kw mm ln mn lo mo lp mp lm mq mr ms mt bi translated">在<em class="kq"> counterContext.ts、</em>中，我们定义了上下文所需的一些类型，值得注意的是，我们使用了<a class="ae kk" href="https://beta.reactjs.org/learn/extracting-state-logic-into-a-reducer#step-3-use-the-reducer-from-your-component" rel="noopener ugc nofollow" target="_blank"> useReducer </a>，因此这些类型看起来有点像redux，但不要担心，并没有那么复杂:</li></ul><figure class="jv jw jx jy gt jz"><div class="bz fp l di"><div class="nf ng l"/></div></figure><ul class=""><li id="8dd2" class="mj mk iq kr b ks kt kw kx ln nh lo ni lp nj lm mq mr ms mt bi translated">然后，这里我们使用useReducer作为触发上下文状态的函数，它可以让我们非常清楚地知道状态的变化:</li></ul><figure class="jv jw jx jy gt jz"><div class="bz fp l di"><div class="nf ng l"/></div></figure><ul class=""><li id="14a3" class="mj mk iq kr b ks kt kw kx ln nh lo ni lp nj lm mq mr ms mt bi translated">事实上，我们已经可以通过使用<code class="fe na nb nc nd b">CounterContext.Consumer</code>来使用这个反上下文(它也适用于类组件)，但是为了更好地使用钩子，我们可以包装它:</li></ul><figure class="jv jw jx jy gt jz"><div class="bz fp l di"><div class="nf ng l"/></div></figure></div><div class="ab cl jn jo hu jp" role="separator"><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js"/></div><div class="ij ik il im in"><h2 id="3267" class="lq lr iq bd ls lt lu dn lv lw lx dp ly ln lz ma mb lo mc md me lp mf mg mh mi bi translated">使用</h2><ul class=""><li id="e595" class="mj mk iq kr b ks ml kw mm ln mn lo mo lp mp lm mq mr ms mt bi translated">让我们在根目录下创建一个名为<em class="kq">组件</em>的新文件夹，并在其中创建一个名为<em class="kq">计数器</em>的新文件夹</li></ul><figure class="jv jw jx jy gt jz gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/e0d2d1b751575f695494b53cb88f6463.png" data-original-src="https://miro.medium.com/v2/resize:fit:808/format:webp/1*0othcjZ5VeFHRQj4Njwcjw.png"/></div><figcaption class="kg kh gj gh gi ki kj bd b be z dk">Context Folder E.G</figcaption></figure><ul class=""><li id="6666" class="mj mk iq kr b ks kt kw kx ln nh lo ni lp nj lm mq mr ms mt bi translated">在<em class="kq"> CounterProvider.tsx，</em>中，我们使用useReducer作为提供者包装反上下文(你也可以把它放在入口文件中)，顺便说一下，我们在useReducer中传入了两个通用参数，看看发生了什么，传入的类型是我们之前正式定义的，这让我们非常清楚谁在使用它，这对维护一个大中型项目至关重要。</li></ul><figure class="jv jw jx jy gt jz"><div class="bz fp l di"><div class="nf ng l"/></div></figure><ul class=""><li id="c51d" class="mj mk iq kr b ks kt kw kx ln nh lo ni lp nj lm mq mr ms mt bi translated">在<em class="kq"> Counter/index.tsx，</em>中，我们使用<code class="fe na nb nc nd b">dispatchCount</code>触发了对上下文状态的更新，此时我们打开了浏览器，看到它成功运行了！🎉 🎉 🎉</li></ul><figure class="jv jw jx jy gt jz"><div class="bz fp l di"><div class="nf ng l"/></div></figure></div><div class="ab cl jn jo hu jp" role="separator"><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js"/></div><div class="ij ik il im in"><h2 id="76d2" class="lq lr iq bd ls lt lu dn lv lw lx dp ly ln lz ma mb lo mc md me lp mf mg mh mi bi translated">结论</h2><p id="7f97" class="pw-post-body-paragraph ko kp iq kr b ks ml ku kv kw mm ky kz ln nl lc ld lo nm lg lh lp nn lk ll lm ij bi translated">在本文中，我们基于Next.js创建了一个项目，并使用Context、useReducer、TypeScript来维护我们的代码，并标准化一个包含<em class="kq">上下文</em>的目录来管理React上下文。</p><p id="5d2a" class="pw-post-body-paragraph ko kp iq kr b ks kt ku kv kw kx ky kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated">好了，我希望这篇文章能帮助你，如果你有任何问题，你可以联系我，谢谢你的阅读！</p><p id="0cba" class="pw-post-body-paragraph ko kp iq kr b ks kt ku kv kw kx ky kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated">以上代码可以在<a class="ae kk" href="https://github.com/iseekTo/react-context-demo" rel="noopener ugc nofollow" target="_blank"> my GitHub </a>上找到</p></div><div class="ab cl jn jo hu jp" role="separator"><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js jt"/><span class="jq bw bk jr js"/></div><div class="ij ik il im in"><h2 id="fd47" class="lq lr iq bd ls lt lu dn lv lw lx dp ly ln lz ma mb lo mc md me lp mf mg mh mi bi translated">了解更多信息</h2><div class="no np gp gr nq nr"><a href="https://beta.reactjs.org/" rel="noopener  ugc nofollow" target="_blank"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd ir gy z fp nw fr fs nx fu fw ip bi translated">反应文档测试版</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">我们重写了React文档，但有一些不同:所有的解释都是用钩子写的，而不是…</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">beta.reactjs.org</p></div></div><div class="oa l"><div class="ob l oc od oe oa of ke nr"/></div></div></a></div><div class="no np gp gr nq nr"><a href="https://github.com/iseekTo/react-context-demo" rel="noopener  ugc nofollow" target="_blank"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd ir gy z fp nw fr fs nx fu fw ip bi translated">GitHub-iseekTo/React-Context-demo:React上下文最佳架构实践</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">github.com</p></div></div><div class="oa l"><div class="og l oc od oe oa of ke nr"/></div></div></a></div><p id="4c37" class="pw-post-body-paragraph ko kp iq kr b ks kt ku kv kw kx ky kz ln lb lc ld lo lf lg lh lp lj lk ll lm ij bi translated"><em class="kq">更多内容看</em> <a class="ae kk" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kr ir"> <em class="kq">说白了。报名参加我们的</em> <a class="ae kk" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kr ir"> <em class="kq">免费周报</em> </strong> </a> <em class="kq">。在我们的</em> <a class="ae kk" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kr ir"> <em class="kq">社区不和谐</em> </strong> </a> <em class="kq">获得独家获取写作机会和建议。</em></strong></a></p></div></div>    
</body>
</html>