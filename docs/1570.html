<html>
<head>
<title>Event.isTrusted, Safeguard Your Site from Bots</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Event.isTrusted，保护您的网站免受僵尸程序攻击</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/event-istrusted-safeguard-your-site-from-bots-cf10eca6e604?source=collection_archive---------5-----------------------#2022-04-03">https://javascript.plainenglish.io/event-istrusted-safeguard-your-site-from-bots-cf10eca6e604?source=collection_archive---------5-----------------------#2022-04-03</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="a24f" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">检查事件是由人还是由脚本触发的。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi kc"><img src="../Images/e63d1d39a4766e2460699d06ae9126f6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1272/format:webp/1*skRzPRNICXtDTAv4LSy6-A.png"/></div></figure><p id="dd3a" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">因此，我一个多月来一直试图购买一双Air Jordan 1，但它们会在进货的前30秒内售罄。老实说，如果这是一场公平的比赛，我会接受它，但然后通过社交媒体，看到经销商和黄牛弯曲他们只是觉得他们有优势。这让我想到，他们怎么能这么快就拿到这些东西？机器人是显而易见的答案，但让我更好奇的是它们是如何工作的？</p><p id="d5fb" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">为了弄清楚它们是如何工作的，我必须做一个(<em class="lg">免责声明*我不支持机器人</em>)。这比我想象的要简单得多，主要是:</p><pre class="kd ke kf kg gt lh li lj lk aw ll bi"><span id="00d7" class="lm ln in li b gy lo lp l lq lr">// not a recipe to generate bot scripts<br/>document.getElementById('buy').triggerEvent()<br/>//wait for some changes<br/>document.getElementById('cart').triggerEvent()<br/>//wait for some change and do the next action required</span></pre></div><div class="ab cl ls lt hr lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ig ih ii ij ik"><h2 id="b122" class="lm ln in bd lz ma mb dn mc md me dp mf kt mg mh mi kx mj mk ml lb mm mn mo mp bi translated">试图防范机器人</h2><p id="5d43" class="pw-post-body-paragraph kk kl in km b kn mq jo kp kq mr jr ks kt ms kv kw kx mt kz la lb mu ld le lf ig bi translated">在构建了这个机器人之后，我想了解的是我们如何保护应用程序免受这些机器人的攻击？</p><p id="ce5d" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">因此，最常见的策略是检查每个被触发事件之间的时间差，这有助于区分自动操作和用户生成的操作。一些大公司利用这一点来阻止用户id，但从长远来看，这并没有帮助，因为创建一个新的id比购买这些限量版的项目更容易。但是如果我们作为开发人员可以帮助区分用户/脚本生成的事件呢？</p><p id="4d64" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">这就是作为事件接口一部分的<strong class="km io">被信任的</strong>属性发挥作用的地方。根据MDN:</p><p id="6530" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated"><em class="lg"/><code class="fe mv mw mx li b"><a class="ae my" href="https://developer.mozilla.org/en-US/docs/Web/API/Event" rel="noopener ugc nofollow" target="_blank"><em class="lg">Event</em></a></code><em class="lg">接口的</em> <code class="fe mv mw mx li b"><em class="lg">isTrusted</em></code> <em class="lg">只读属性是一个布尔值，当事件由用户动作生成时为</em> <code class="fe mv mw mx li b"><em class="lg">true</em></code> <em class="lg">，当事件由脚本创建或修改或通过</em> <code class="fe mv mw mx li b"><a class="ae my" href="https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/dispatchEvent" rel="noopener ugc nofollow" target="_blank"><em class="lg">EventTarget.dispatchEvent()</em></a></code> <em class="lg">调度时为</em> <code class="fe mv mw mx li b"><em class="lg">false</em></code> <em class="lg">。</em></p><p id="914b" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">我们可以用它来检查我们需要(或者需要)用户生成动作的事件，比如登录或者在上面的例子中购买一双限量运动鞋。</p><p id="6274" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">让我们看一个例子:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mz na l"/></div></figure><p id="6eac" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">输出:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi nb"><img src="../Images/0b83089fc529caf1ea056a429f2bc12c.png" data-original-src="https://miro.medium.com/v2/resize:fit:654/format:webp/1*bt2KnjlECxPAElfFIr-4eQ.png"/></div><figcaption class="nc nd gj gh gi ne nf bd b be z dk">when setTimeout function gets invoked</figcaption></figure><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/ced8746832738bae5685557086338629.png" data-original-src="https://miro.medium.com/v2/resize:fit:566/format:webp/1*BsR-71gKP83FImmVPSe1OA.png"/></div><figcaption class="nc nd gj gh gi ne nf bd b be z dk">when user clicks on button</figcaption></figure></div><div class="ab cl ls lt hr lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ig ih ii ij ik"><p id="ecf8" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">这种基本检查有助于提高安全性，并帮助您区分人工事件和脚本生成的事件。这些信息可以帮助我们创建更加人性化的用户界面。</p><p id="23c1" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">老实说，我很惊讶为什么大多数公司不增加这项检查，但我猜重点是不同的。</p><p id="d0ba" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated">这个题目到此为止。感谢您的阅读。</p><p id="17ab" class="pw-post-body-paragraph kk kl in km b kn ko jo kp kq kr jr ks kt ku kv kw kx ky kz la lb lc ld le lf ig bi translated"><em class="lg">更多内容请看</em><a class="ae my" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="km io"><em class="lg">plain English . io</em></strong></a><em class="lg">。报名参加我们的</em> <a class="ae my" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="km io"> <em class="lg">免费周报</em> </strong> </a> <em class="lg">。关注我们关于</em><a class="ae my" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="km io"><em class="lg">Twitter</em></strong></a><em class="lg">和</em><a class="ae my" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="km io"><em class="lg">LinkedIn</em></strong></a><em class="lg">。加入我们的</em> <a class="ae my" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="km io"> <em class="lg">社区不和谐</em> </strong> </a> <em class="lg">。</em></p></div></div>    
</body>
</html>