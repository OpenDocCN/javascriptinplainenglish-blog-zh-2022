<html>
<head>
<title>The Huge Difference Between ES6 import and ES5 require in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ES6导入和ES5在JavaScript中要求巨大差异</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/the-huge-difference-between-es6-import-and-es5-require-in-javascript-3242c9eae48c?source=collection_archive---------3-----------------------#2022-04-26">https://javascript.plainenglish.io/the-huge-difference-between-es6-import-and-es5-require-in-javascript-3242c9eae48c?source=collection_archive---------3-----------------------#2022-04-26</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="68d6" class="pw-subtitle-paragraph jr ip iq bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">你还在你的代码库中使用<code class="fe jn jo jp jq b">require</code>吗？让我们尽快让您升级到现代JavaScript <code class="fe jn jo jp jq b">import</code>语法。以下是你需要知道的，以及为什么它很重要。</h2></div><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/f1f157c59cbdf108b5c2a0365a57c9c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*hraXHjuj2Q0DVODa"/></div></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk">These dogs are named `require` and `import` (Photo by <a class="ae kz" href="https://unsplash.com/@chelsea777?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Kojirou Sasaki</a> on <a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a>)</figcaption></figure><p id="efb3" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">想象一下这个场景:你得到一个关于<a class="ae kz" href="https://github.com/typescript-eslint/typescript-eslint/blob/main/packages/eslint-plugin/docs/rules/no-var-requires.md" rel="noopener ugc nofollow" target="_blank">“no var requires”</a>的<a class="ae kz" href="https://betterprogramming.pub/how-to-set-up-vs-code-like-a-pro-in-just-5-minutes-65aaa5788c0d" rel="noopener ugc nofollow" target="_blank"> ESLint </a>警告，并开始写下一行注释禁用它:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi lw"><img src="../Images/1086066cc144c68ad0f16d629e08de57.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cPT7mMYfEscODq7bG9OIRQ.png"/></div></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk">\<a class="ae kz" href="https://gist.github.com/DoctorDerek/30c4eb5560f26dd5b412f5a5972e7118" rel="noopener ugc nofollow" target="_blank">View the raw code</a> as a GitHub Gist</figcaption></figure><p id="d447" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">但是等等——您应该禁用ESLint警告吗？如果你使用的是<a class="ae kz" rel="noopener ugc nofollow" target="_blank" href="/how-to-sort-imports-in-typescript-automatically-in-vs-code-f4fe4e499bb1">类型脚本</a>，下面是你应该使用的语法:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi lx"><img src="../Images/925ad0c224f9d19454f6851859f1ba42.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IaxK53eRsejG2ZCtOMI2Lg.png"/></div></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk"><a class="ae kz" href="https://gist.github.com/DoctorDerek/fe70965f937936cbf9f25c45005c1b56" rel="noopener ugc nofollow" target="_blank">View the raw code</a> as a GitHub Gist</figcaption></figure><p id="c212" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">你知道<code class="fe jn jo jp jq b"><a class="ae kz" href="https://developer.mozilla.org/en-US/docs/Learn/Server-side/Express_Nodejs/Introduction#helloworld_express" rel="noopener ugc nofollow" target="_blank">require</a></code>和<code class="fe jn jo jp jq b"><a class="ae kz" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import" rel="noopener ugc nofollow" target="_blank">import</a></code>的区别吗？如果你是高级开发人员，什么时候可以使用旧的T4语法？</p></div><div class="ab cl ly lz hu ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ij ik il im in"><h1 id="fba4" class="mf mg iq bd mh mi mj mk ml mm mn mo mp ka mq kb mr kd ms ke mt kg mu kh mv mw bi translated">发生了什么事需要陈述，爷爷？👴</h1><p id="b192" class="pw-post-body-paragraph la lb iq lc b ld mx jv lf lg my jy li lj mz ll lm ln na lp lq lr nb lt lu lv ij bi translated">虽然我习惯于避免使用<code class="fe jn jo jp jq b">require</code>语句，但在我尝试为它们找到MDN页面之前，我从未真正想过要写这个话题。</p><p id="2eef" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">没有了。<a class="ae kz" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import" rel="noopener ugc nofollow" target="_blank">针对</a> <code class="fe jn jo jp jq b"><a class="ae kz" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import" rel="noopener ugc nofollow" target="_blank">import</a></code> <a class="ae kz" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import" rel="noopener ugc nofollow" target="_blank">语句</a>的Mozilla文档已经完全删除了对<code class="fe jn jo jp jq b">require</code>的所有引用，转而支持ES6语法。</p><p id="e8e4" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">虽然我们都喜欢像Object.is() 这样的ES6语法，但我认为文档中的变化非常极端，直到我开始思考这个问题。</p><p id="51d5" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated"><code class="fe jn jo jp jq b">require</code>语法比较老(2015年之前，意思是ES6之前)，在“现代JavaScript”中不常用——这是有原因的！</p><p id="f3e0" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">当您调用<code class="fe jn jo jp jq b">require</code>时，您正在请求JavaScript <a class="ae kz" href="https://developer.mozilla.org/en-US/docs/Glossary/Main_thread" rel="noopener ugc nofollow" target="_blank">主线程</a>(CPU)读入并执行整个包。没有优化。</p><p id="eb81" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">另一方面，通过使用<code class="fe jn jo jp jq b">import</code>，你有机会让类似Webpack的东西(Next.js <a class="ae kz" href="https://nextjs.org/docs/api-reference/next.config.js/custom-webpack-config" rel="noopener ugc nofollow" target="_blank">依赖于</a>)自动帮你解决问题。</p></div><div class="ab cl ly lz hu ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ij ik il im in"><h1 id="ce0c" class="mf mg iq bd mh mi mj mk ml mm mn mo mp ka mq kb mr kd ms ke mt kg mu kh mv mw bi translated">是的，这是埃斯林规则</h1><p id="00a1" class="pw-post-body-paragraph la lb iq lc b ld mx jv lf lg my jy li lj mz ll lm ln na lp lq lr nb lt lu lv ij bi translated">我认为在你的所有项目中保持下面的<a class="ae kz" href="https://eslint.org/docs/rules/" rel="noopener ugc nofollow" target="_blank"> ESLint规则</a>是一个好主意——因为你应该尽可能地使用<code class="fe jn jo jp jq b">import</code>。</p><blockquote class="nc nd ne"><p id="3764" class="la lb nf lc b ld le jv lf lg lh jy li ng lk ll lm nh lo lp lq ni ls lt lu lv ij bi translated"><code class="fe jn jo jp jq b"><em class="iq">no-var-requires</em></code> ( <a class="ae kz" href="https://github.com/typescript-eslint/typescript-eslint/blob/main/packages/eslint-plugin/docs/rules/no-var-requires.md" rel="noopener ugc nofollow" target="_blank">诚信通文档</a>)</p><p id="dac0" class="la lb nf lc b ld le jv lf lg lh jy li ng lk ll lm nh lo lp lq ni ls lt lu lv ij bi translated">”换句话说，使用像<code class="fe jn jo jp jq b">var foo = require("foo")</code>这样的形式是被禁止的。请改用ES6风格导入或<code class="fe jn jo jp jq b">import foo = require("foo")</code>导入。</p></blockquote><p id="9ee9" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">如果你还没有安装ESLint，我会等着你阅读我广受欢迎的<em class="nf"> Better Programming </em>文章，它会帮你解决这个问题:</p><div class="nj nk gp gr nl nm"><a href="https://betterprogramming.pub/how-to-set-up-vs-code-like-a-pro-in-just-5-minutes-65aaa5788c0d" rel="noopener  ugc nofollow" target="_blank"><div class="nn ab fo"><div class="no ab np cl cj nq"><h2 class="bd ir gy z fp nr fr fs ns fu fw ip bi translated">如何在短短5分钟内像专业人士一样设置VS代码</h2><div class="nt l"><h3 class="bd b gy z fp nr fr fs ns fu fw dk translated">初学者指南</h3></div><div class="nu l"><p class="bd b dl z fp nr fr fs ns fu fw dk translated">better编程. pub</p></div></div><div class="nv l"><div class="nw l nx ny nz nv oa kt nm"/></div></div></a></div></div><div class="ab cl ly lz hu ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ij ik il im in"><h1 id="88a2" class="mf mg iq bd mh mi mj mk ml mm mn mo mp ka mq kb mr kd ms ke mt kg mu kh mv mw bi translated">什么时候可以忽略这个规则？</h1><p id="16b7" class="pw-post-body-paragraph la lb iq lc b ld mx jv lf lg my jy li lj mz ll lm ln na lp lq lr nb lt lu lv ij bi translated">一般来说，如果你发现自己因为某种原因需要忽略这条规则，你可能做错了。</p><p id="b3e9" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">您可能应该找到一个使用正确的ES6导出语法的不同的npm包，以便您可以导入而不是需要它。</p><p id="1289" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">但是，如果你不使用<a class="ae kz" rel="noopener ugc nofollow" target="_blank" href="/how-to-sort-imports-in-typescript-automatically-in-vs-code-f4fe4e499bb1"> TypeScript imports </a>并且不打算执行<a class="ae kz" href="https://developer.mozilla.org/en-US/docs/Glossary/Tree_shaking" rel="noopener ugc nofollow" target="_blank">树摇动</a>来减少你的JavaScript包大小，你可以使用require。</p><blockquote class="nc nd ne"><p id="e704" class="la lb nf lc b ld le jv lf lg lh jy li ng lk ll lm nh lo lp lq ni ls lt lu lv ij bi translated"><code class="fe jn jo jp jq b"><em class="iq">no-var-requires</em></code> ( <a class="ae kz" href="https://github.com/typescript-eslint/typescript-eslint/blob/main/packages/eslint-plugin/docs/rules/no-var-requires.md" rel="noopener ugc nofollow" target="_blank">诚信通文档</a>)</p><p id="1eee" class="la lb nf lc b ld le jv lf lg lh jy li ng lk ll lm nh lo lp lq ni ls lt lu lv ij bi translated"><strong class="lc ir">何时不用:</strong>“如果你不在乎TypeScript模块语法，那么你就不需要这个规则。”</p></blockquote><p id="76e8" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">除了编写一些基本的代码演示或一次性的技巧(<a class="ae kz" href="https://levelup.gitconnected.com/how-to-load-external-javascript-files-from-the-browser-console-8eb97f7db778" rel="noopener ugc nofollow" target="_blank">比如从浏览器控制台</a>加载外部JavaScript文件)，避免<code class="fe jn jo jp jq b">require</code>。</p><p id="0817" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">当然，当你想在RunKit 上尝试一个包<a class="ae kz" href="https://npm.runkit.com/lodash.clonedeep" rel="noopener ugc nofollow" target="_blank">的快速演示时，这很好，但是</a><a class="ae kz" rel="noopener ugc nofollow" target="_blank" href="/the-10-next-11-0-0-features-you-need-to-know-about-from-next-js-conf-ac31d795accd">一个基于NextJS </a>构建的现代JavaScript应用不应该使用<code class="fe jn jo jp jq b">require</code>。</p><p id="d567" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">这里有一个使用<code class="fe jn jo jp jq b">require</code>的例子，我们将<a class="ae kz" href="https://www.yourdictionary.com/refactor" rel="noopener ugc nofollow" target="_blank">使用现代JavaScript语法(ES6 <code class="fe jn jo jp jq b">import</code>语法)重构</a>以提高性能。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi ob"><img src="../Images/e5436af707de0d502312411f7deb1391.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H2tmg1zp1gcIC6MyItvIww.png"/></div></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk"><a class="ae kz" href="https://gist.github.com/DoctorDerek/a1f5aeaa7f2d5665ecf6523d232e7f67" rel="noopener ugc nofollow" target="_blank">View the raw code</a> as a GitHub Gist, then run the code at <a class="ae kz" href="https://npm.runkit.com/lodash.clonedeep" rel="noopener ugc nofollow" target="_blank">https://npm.runkit.com/lodash.clonedeep</a></figcaption></figure><p id="dc58" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">如果您需要解释上面使用<code class="fe jn jo jp jq b">require</code>的例子中发生了什么，请阅读我关于JavaScript深度复制的文章。</p><div class="nj nk gp gr nl nm"><a rel="noopener  ugc nofollow" target="_blank" href="/how-to-deep-copy-objects-and-arrays-in-javascript-7c911359b089"><div class="nn ab fo"><div class="no ab np cl cj nq"><h2 class="bd ir gy z fp nr fr fs ns fu fw ip bi translated">如何在JavaScript中深度复制对象和数组</h2><div class="nt l"><h3 class="bd b gy z fp nr fr fs ns fu fw dk translated">复制对象或数组的常用方法只能进行浅层复制，所以深度嵌套的引用是个问题…</h3></div><div class="nu l"><p class="bd b dl z fp nr fr fs ns fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="nv l"><div class="oc l nx ny nz nv oa kt nm"/></div></div></a></div><p id="f5d6" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">现在，让我们看看在Next.js应用程序中使用<code class="fe jn jo jp jq b">import</code>的同一段代码，该应用程序设置为通过React函数组件呈现相同的数组:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi od"><img src="../Images/13a51ece77c90f1daed754e73b4c13f7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*28YArvG-9Cl-YT5vb34UPg.png"/></div></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk"><a class="ae kz" href="https://codesandbox.io/s/import-vs-require-in-javascript-xp842b?file=/pages/index.js" rel="noopener ugc nofollow" target="_blank">https://codesandbox.io/s/import-vs-require-in-javascript-xp842b?file=/pages/index.js</a></figcaption></figure><p id="b947" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">是的，你可以使用<code class="fe jn jo jp jq b">require </code>——但是性能会很差，因为每次React渲染组件时你都要重新加载包。</p><div class="nj nk gp gr nl nm"><a href="https://bettermarketing.pub/googles-pass-fail-core-web-vitals-make-performance-matter-for-seo-b8490a5ca5ec" rel="noopener  ugc nofollow" target="_blank"><div class="nn ab fo"><div class="no ab np cl cj nq"><h2 class="bd ir gy z fp nr fr fs ns fu fw ip bi translated">谷歌的“通过/失败”核心网站要害使性能对搜索引擎优化至关重要</h2><div class="nt l"><h3 class="bd b gy z fp nr fr fs ns fu fw dk translated">谷歌即将处罚慢速网站。如果你关心搜索引擎优化(SEO)和你的排名…</h3></div><div class="nu l"><p class="bd b dl z fp nr fr fs ns fu fw dk translated">bettermarketing.pub</p></div></div><div class="nv l"><div class="oe l nx ny nz nv oa kt nm"/></div></div></a></div><p id="b319" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">性能很重要，这就是为什么你想使用<code class="fe jn jo jp jq b">import</code>而不是<code class="fe jn jo jp jq b">require</code>。每次用<code class="fe jn jo jp jq b">require</code>，一只小狗就开始哭。</p><p id="74a5" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">等等，这不太对。每次你使用<code class="fe jn jo jp jq b">require</code>，JavaScript引擎(也称为<a class="ae kz" href="https://v8.dev/" rel="noopener ugc nofollow" target="_blank"> the node.js V8编译器</a>)就开始溅射。</p><p id="062b" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">也不完全是这样，但更接近了。使用<code class="fe jn jo jp jq b">require</code>意味着1)读取代码，2)运行代码，3)将所有代码存储在一个变量中。</p><p id="f62e" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">你见过谷歌灯塔报告抱怨你的页面上有“未使用的JavaScript”吗？如果你曾经运行过Lighthouse，那么你几乎肯定看到过这样的警告。</p><p id="6d9e" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">导致未使用JavaScript的一个原因是使用了<code class="fe jn jo jp jq b">require</code>，加上<a class="ae kz" href="https://medium.com/@francesco_rizzi/javascript-main-thread-dissected-43c85fce7e23" rel="noopener">阻塞了该死的主线程</a>，所以不要这样做，<a class="ae kz" href="https://www.urbandictionary.com/define.php?term=mmkay" rel="noopener ugc nofollow" target="_blank"> Mmkay？</a></p></div><div class="ab cl ly lz hu ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ij ik il im in"><h1 id="0fbb" class="mf mg iq bd mh mi mj mk ml mm mn mo mp ka mq kb mr kd ms ke mt kg mu kh mv mw bi translated">使用TypeScript实现最大的类型安全性</h1><p id="2a75" class="pw-post-body-paragraph la lb iq lc b ld mx jv lf lg my jy li lj mz ll lm ln na lp lq lr nb lt lu lv ij bi translated">在TypeScript中，前面的例子看起来像下面的代码，其中我添加了一个<code class="fe jn jo jp jq b">Arr</code>类型。还是一个简单的Next.js (React) app:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi of"><img src="../Images/3d551e9df676dd8d2b8e65e5744bd4de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*znSXSFEw6ii7OlfvMSDl2w.png"/></div></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk"><a class="ae kz" href="https://codesandbox.io/s/import-vs-require-in-typescript-lodash-8gk5ee?file=/pages/index.tsx" rel="noopener ugc nofollow" target="_blank">https://codesandbox.io/s/import-vs-require-in-typescript-zstnrv?file=/pages/index.tsx</a></figcaption></figure></div><div class="ab cl ly lz hu ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ij ik il im in"><h1 id="7443" class="mf mg iq bd mh mi mj mk ml mm mn mo mp ka mq kb mr kd ms ke mt kg mu kh mv mw bi translated">说真的，我想我需要忽略这条规则</h1><p id="fb7a" class="pw-post-body-paragraph la lb iq lc b ld mx jv lf lg my jy li lj mz ll lm ln na lp lq lr nb lt lu lv ij bi translated">好吧，我对你有点太严格了。我最近提交了禁用这个ESLint规则的代码到我项目中的<code class="fe jn jo jp jq b"><a class="ae kz" href="https://nextjs.org/docs/api-reference/next.config.js/introduction" rel="noopener ugc nofollow" target="_blank">next.config.js</a></code>文件中。</p><p id="52ee" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">您能猜到为什么我需要忽略以文件扩展名<code class="fe jn jo jp jq b">.js</code>结尾的特定Next.js配置文件中的这个TypeScript规则吗？</p><p id="4bc5" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">是的，你说得对。在服务器加载之前，Next.js配置文件就被读取了——在Webpack(和<a class="ae kz" href="https://nextjs.org/docs/advanced-features/compiler" rel="noopener ugc nofollow" target="_blank">next . js SWC编译器</a>)可以运行之前。</p><p id="c70f" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">任何时候，如果你不使用某些东西来处理<code class="fe jn jo jp jq b">import</code>语句，不管是<a class="ae kz" href="https://npm.runkit.com/lodash.clonedeep" rel="noopener ugc nofollow" target="_blank">一段RunKit代码</a>、<a class="ae kz" href="https://levelup.gitconnected.com/5-ways-to-log-an-object-to-the-console-in-javascript-7b995c56af5a" rel="noopener ugc nofollow" target="_blank">浏览器控制台</a>，还是<a class="ae kz" href="https://nextjs.org/docs/api-reference/next.config.js/introduction" rel="noopener ugc nofollow" target="_blank">下一个配置文件</a> *，你可能会发现自己在使用<code class="fe jn jo jp jq b">require</code>。没关系！</p><p id="062c" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated"><em class="nf">(*注意:如果你喜欢模块语法，你可以使用next.config.mjs文件。我大概应该这么做，而不是用</em> <code class="fe jn jo jp jq b"><em class="nf">require</em></code> <em class="nf">。哎呦！🥳) </em></p><p id="76b2" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">但是，任何其他时候你想使用<code class="fe jn jo jp jq b">require</code>，记住小狗，更喜欢<code class="fe jn jo jp jq b">import</code>——它会对你的应用程序的性能更好。</p></div><div class="ab cl ly lz hu ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ij ik il im in"><h1 id="c1da" class="mf mg iq bd mh mi mj mk ml mm mn mo mp ka mq kb mr kd ms ke mt kg mu kh mv mw bi translated">为什么不直接从Lodash进口？</h1><p id="1549" class="pw-post-body-paragraph la lb iq lc b ld mx jv lf lg my jy li lj mz ll lm ln na lp lq lr nb lt lu lv ij bi translated">最后，我想指出，你可能期望我写<code class="fe jn jo jp jq b">import lodashClonedeep from "lodash/cloneDeep"</code>，但我没有。</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi of"><img src="../Images/ac8cb6dcd6a0c6ca253dc72c635326ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qw_B_2_bCiM6KUFGtINK7g.png"/></div></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk"><a class="ae kz" href="https://codesandbox.io/s/import-vs-require-in-typescript-lodash-8gk5ee?file=/pages/index.tsx" rel="noopener ugc nofollow" target="_blank">https://codesandbox.io/s/import-vs-require-in-typescript-lodash-8gk5ee?file=/pages/index.tsx</a></figcaption></figure><p id="8430" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">我只导入了<code class="fe jn jo jp jq b"><a class="ae kz" href="https://www.npmjs.com/package/lodash.clonedeep" rel="noopener ugc nofollow" target="_blank">lodash.clonedeep</a></code>而没有从已安装的<code class="fe jn jo jp jq b">"lodash"</code>包中导入<code class="fe jn jo jp jq b">lodash/clonedeep</code>(意思是<code class="fe jn jo jp jq b">clonedeep</code>)的原因是，我不想安装整个庞大的<code class="fe jn jo jp jq b">lodash</code>包，即使<a class="ae kz" href="https://webpack.js.org/guides/tree-shaking/" rel="noopener ugc nofollow" target="_blank">我相信Webpack能够正确地自我抖动</a>。</p><p id="dadc" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">为什么不呢？嗯，我最近在查看一个<code class="fe jn jo jp jq b">yarn.lock</code>文件，看到了几十个lodash的独立副本，它们有不同的包依赖关系，每个包使用不同的版本。这导致了您所说的<a class="ae kz" href="https://bundlephobia.com/package/lodash" rel="noopener ugc nofollow" target="_blank">包大小膨胀</a>:</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi og"><img src="../Images/6cb6b4439109b9dc5b0636c8d0125335.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*c6z19vE7XoE6eNnbK5wmdg.png"/></div></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk"><a class="ae kz" href="https://bundlephobia.com/package/lodash" rel="noopener ugc nofollow" target="_blank">https://bundlephobia.com/package/lodash</a> vs. <a class="ae kz" href="https://bundlephobia.com/package/lodash.clonedeep" rel="noopener ugc nofollow" target="_blank">https://bundlephobia.com/package/lodash.clonedeep</a></figcaption></figure><p id="1017" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">因此，即使我相信Webpack、TypeScript、Next.js和我的工具的其余部分实际上只给了我<code class="fe jn jo jp jq b">clonedeep</code>函数，仍然可能存在使用各种不同版本的包依赖。</p><p id="2d64" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">另外，我仍然会犯一个在团队环境中很重要的关键错误——不去想下一个开发人员。</p><p id="ec58" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">如果我已经将<code class="fe jn jo jp jq b">lodash</code>作为一个依赖项添加到项目中，为什么我不能将它用于所有的事情呢？如果我什么都用<code class="fe jn jo jp jq b">lodash</code>，难道我不应该只使用<code class="fe jn jo jp jq b">import _ from "lodash"</code>并拥有<code class="fe jn jo jp jq b">lodash</code>的所有功能吗？</p></div><div class="ab cl ly lz hu ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ij ik il im in"><h1 id="43a5" class="mf mg iq bd mh mi mj mk ml mm mn mo mp ka mq kb mr kd ms ke mt kg mu kh mv mw bi translated">为什么我导入<code class="fe jn jo jp jq b">lodash.clonedeep</code>而不是Lodash</h1><p id="26a0" class="pw-post-body-paragraph la lb iq lc b ld mx jv lf lg my jy li lj mz ll lm ln na lp lq lr nb lt lu lv ij bi translated">你可以猜到我的回答会是——不，谢谢你，先生。我想要的只是方便的<code class="fe jn jo jp jq b">clonedeep</code>功能，所以我使用了模块化的<code class="fe jn jo jp jq b">lodash.clonedeep</code>。当然，<em class="nf">你</em>可能需要更多的<code class="fe jn jo jp jq b">lodash</code>；您的里程可能会有所不同。</p><p id="ff31" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">原因如下。我不想鼓励我团队中的下一个开发人员随意地使用<code class="fe jn jo jp jq b">import _ from "lodash"</code>，因为我将<code class="fe jn jo jp jq b">lodash</code>添加到了<code class="fe jn jo jp jq b">package.json</code>文件中，其中包含了我们项目的所有依赖项。Nuh-uh 。</p><p id="a69c" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">同时，我也绝对不希望那个开发者使用<code class="fe jn jo jp jq b">require</code>，所以我希望他们能像你一样花时间阅读这篇文章。谢谢大家！🙏</p><p id="24f2" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">如果你喜欢这篇文章，你可能会喜欢我的另一篇文章:</p><div class="nj nk gp gr nl nm"><a href="https://medium.com/swlh/how-to-round-to-a-certain-number-of-decimal-places-in-javascript-ed74c471c1b8" rel="noopener follow" target="_blank"><div class="nn ab fo"><div class="no ab np cl cj nq"><h2 class="bd ir gy z fp nr fr fs ns fu fw ip bi translated">如何在JavaScript中舍入到特定的小数位数</h2><div class="nt l"><h3 class="bd b gy z fp nr fr fs ns fu fw dk translated">内置的Math.round()函数不允许您指定舍入小数的精度。以下是如何…</h3></div><div class="nu l"><p class="bd b dl z fp nr fr fs ns fu fw dk translated">medium.com</p></div></div><div class="nv l"><div class="oh l nx ny nz nv oa kt nm"/></div></div></a></div><p id="a7c6" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated"><strong class="lc ir">编码快乐！</strong> 🥳🙂😉😘😄</p><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi oi"><img src="../Images/36a1e3471717a526b75cf913b4a94918.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ffvnrNCMhqtOVBgG"/></div></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk">That’s a good boy, `import` (Photo by <a class="ae kz" href="https://unsplash.com/@karsten116?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Karsten Winegeart</a> on <a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a>)</figcaption></figure></div><div class="ab cl ly lz hu ma" role="separator"><span class="mb bw bk mc md me"/><span class="mb bw bk mc md me"/><span class="mb bw bk mc md"/></div><div class="ij ik il im in"><p id="2324" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated"><a class="ae kz" href="https://www.linkedin.com/in/derek-austin/" rel="noopener ugc nofollow" target="_blank">德里克·奥斯丁</a>博士是《职业编程:如何在6个月内成为6位数的成功程序员 一书的作者，该书现已在亚马逊上出售。</p></div></div>    
</body>
</html>