<html>
<head>
<title>2 Useful React Hooks: useReducer and useContext</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">2个有用的React挂钩:useReducer和useContext</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/2-useful-react-hooks-usereducer-and-usecontext-2fbb6461a5c?source=collection_archive---------11-----------------------#2022-11-01">https://javascript.plainenglish.io/2-useful-react-hooks-usereducer-and-usecontext-2fbb6461a5c?source=collection_archive---------11-----------------------#2022-11-01</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="e25c" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">React中两个有用的钩子</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/9be195ca153170cc03640228a1ed44df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*vmCQhpuM5ix_Kpbp"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@flowforfrank?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Ferenc Almasi</a> on <a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="4301" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">useReducer 和<a class="ae ks" href="https://reactjs.org/docs/hooks-reference.html#usecontext" rel="noopener ugc nofollow" target="_blank"> useContext </a>是React中管理本地和全局状态的两个有用的钩子。</p><p id="665e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">使用useContext，您可以操纵全局状态，并从不同组件访问它，而无需钻取，将状态传递到多个层。</p><p id="c22f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">下面的示例展示了实际使用的useReducer，将action关键字作为一个参数，将当前状态作为另一个参数。</p><p id="262b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">要更新状态，最好创建现有状态的副本，然后用更新的值覆盖它。使用对象析构是使用Reacts useReducer钩子的方法，但是有一些库可以使它更简单，比如useImmer。</p><pre class="kd ke kf kg gt lp lq lr ls aw lt bi"><span id="c3ca" class="lu lv in lq b gy lw lx l ly lz">function reducer(state, action) {</span><span id="dc90" class="lu lv in lq b gy ma lx l ly lz">    const prevState = { ...state };</span><span id="f0c4" class="lu lv in lq b gy ma lx l ly lz">    console.log(state, action);</span><span id="3fce" class="lu lv in lq b gy ma lx l ly lz">    switch (action.type) {</span><span id="620a" class="lu lv in lq b gy ma lx l ly lz">        case 'increment':</span><span id="88c4" class="lu lv in lq b gy ma lx l ly lz">            return { ...state, count: prevState.count + 1 };</span><span id="5c56" class="lu lv in lq b gy ma lx l ly lz">        case 'decrease':</span><span id="26d7" class="lu lv in lq b gy ma lx l ly lz">            return { ...state, count: prevState.count - 1 };</span><span id="815e" class="lu lv in lq b gy ma lx l ly lz">        default:</span><span id="42b7" class="lu lv in lq b gy ma lx l ly lz">            return { ...state };</span><span id="8cd1" class="lu lv in lq b gy ma lx l ly lz">    }</span><span id="1eab" class="lu lv in lq b gy ma lx l ly lz">}</span></pre><p id="2971" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">为了访问状态并更新它，useContext是一个很好的钩子，它可以很好地与useReducer钩子协同工作。</p><p id="de3f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">初始状态存储在对象中，可以使用reducer进行更新。更新后的状态将被传递给useReducer钩子。</p><pre class="kd ke kf kg gt lp lq lr ls aw lt bi"><span id="ad03" class="lu lv in lq b gy lw lx l ly lz">const initialState = {</span><span id="5de6" class="lu lv in lq b gy ma lx l ly lz">title: 'Hello',</span><span id="8a35" class="lu lv in lq b gy ma lx l ly lz">count: 1,</span><span id="8a01" class="lu lv in lq b gy ma lx l ly lz">loggedIn: false,</span><span id="a485" class="lu lv in lq b gy ma lx l ly lz">};</span></pre><p id="1d20" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在下面的示例中，StateContext用于存储当前状态，DispatchContext用于更新全局状态。</p><pre class="kd ke kf kg gt lp lq lr ls aw lt bi"><span id="fe51" class="lu lv in lq b gy lw lx l ly lz">const [state, dispatch] = useReducer(reducer, initialState);</span></pre><p id="03ae" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">状态值是StateContext的当前值，调度用于更新这些值。</p><pre class="kd ke kf kg gt lp lq lr ls aw lt bi"><span id="335c" class="lu lv in lq b gy lw lx l ly lz">return (</span><span id="f2d9" class="lu lv in lq b gy ma lx l ly lz">&lt;StateContext.Provider value={state}&gt;</span><span id="8afc" class="lu lv in lq b gy ma lx l ly lz">&lt;DispatchContext.Provider value={dispatch}&gt;</span><span id="0354" class="lu lv in lq b gy ma lx l ly lz">&lt;h1&gt;App.js Count: {state.count}&lt;/h1&gt;</span><span id="d598" class="lu lv in lq b gy ma lx l ly lz">&lt;p&gt;Start editing to see some magic happen!! :)&lt;/p&gt;</span><span id="236a" class="lu lv in lq b gy ma lx l ly lz">&lt;Test /&gt;</span><span id="e1aa" class="lu lv in lq b gy ma lx l ly lz">&lt;/DispatchContext.Provider&gt;</span><span id="0c3d" class="lu lv in lq b gy ma lx l ly lz">&lt;/StateContext.Provider&gt;</span><span id="da70" class="lu lv in lq b gy ma lx l ly lz">);</span></pre><p id="08a7" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">要访问测试组件中的全局状态，首先要导入上下文提供者。</p><pre class="kd ke kf kg gt lp lq lr ls aw lt bi"><span id="7f6f" class="lu lv in lq b gy lw lx l ly lz">import DispatchContext from '../DispatchContext';</span><span id="bc9a" class="lu lv in lq b gy ma lx l ly lz">import StateContext from '../StateContext';</span></pre><p id="94f4" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">要访问状态，请使用挂钩useContext:</p><pre class="kd ke kf kg gt lp lq lr ls aw lt bi"><span id="5a70" class="lu lv in lq b gy lw lx l ly lz">const appState = useContext(StateContext);</span></pre><p id="a3a2" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">要访问调度方法，请执行以下操作:</p><pre class="kd ke kf kg gt lp lq lr ls aw lt bi"><span id="faa3" class="lu lv in lq b gy lw lx l ly lz">const appDispatch = useContext(DispatchContext);</span></pre><p id="f77f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">要更新全局状态中的计数值:</p><pre class="kd ke kf kg gt lp lq lr ls aw lt bi"><span id="44ed" class="lu lv in lq b gy lw lx l ly lz">function decrease() {</span><span id="8474" class="lu lv in lq b gy ma lx l ly lz">    appDispatch({ type: 'decrease' });</span><span id="7760" class="lu lv in lq b gy ma lx l ly lz">}</span></pre><p id="42f3" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">App.js中的reducer方法将被通知来自Test.js的调度事件，并更新状态。</p><h1 id="ec09" class="mb lv in bd mc md me mf mg mh mi mj mk jt ml ju mm jw mn jx mo jz mp ka mq mr bi translated">源代码</h1><p id="0059" class="pw-post-body-paragraph kt ku in kv b kw ms jo ky kz mt jr lb lc mu le lf lg mv li lj lk mw lm ln lo ig bi translated">【https://stackblitz.com/edit/react-fdyiu8?file=src/App.js T4】</p><h1 id="b6f4" class="mb lv in bd mc md me mf mg mh mi mj mk jt ml ju mm jw mn jx mo jz mp ka mq mr bi translated">试映</h1><p id="1606" class="pw-post-body-paragraph kt ku in kv b kw ms jo ky kz mt jr lb lc mu le lf lg mv li lj lk mw lm ln lo ig bi translated"><a class="ae ks" href="https://react-fdyiu8.stackblitz.io" rel="noopener ugc nofollow" target="_blank">https://react-FDY iu8 . stack blitz . io</a></p></div><div class="ab cl mx my hr mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ig ih ii ij ik"><p id="ce7c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="ne">更多内容请看</em><a class="ae ks" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="ne">plain English . io</em></strong></a><em class="ne">。报名参加我们的</em> <a class="ae ks" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="ne">免费周报</em> </strong> </a> <em class="ne">。关注我们关于</em><a class="ae ks" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="ne">Twitter</em></strong></a><a class="ae ks" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="ne">LinkedIn</em></strong></a><em class="ne"/><a class="ae ks" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="ne">YouTube</em></strong></a><em class="ne"/><a class="ae ks" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="ne">不和</em> </strong> </a> <em class="ne">。对增长黑客感兴趣？检查</em> <a class="ae ks" href="https://circuit.ooo/" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="ne">电路</em> </strong> </a> <em class="ne">。</em></p></div></div>    
</body>
</html>