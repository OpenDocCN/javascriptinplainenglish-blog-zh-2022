<html>
<head>
<title>10 Best Practices for REST API Designs</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">REST API设计的10个最佳实践</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/10-best-practices-for-rest-api-designs-176d39a0dae6?source=collection_archive---------7-----------------------#2022-07-28">https://javascript.plainenglish.io/10-best-practices-for-rest-api-designs-176d39a0dae6?source=collection_archive---------7-----------------------#2022-07-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="caf3" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">设计REST APIs以确保最佳性能的最佳实践。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/1ed6da5351481ca52e5fd619c47e1d82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*1NCBivEOlOl0PHR1"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Source: <a class="ae kv" href="https://www.contents.digitallab.jp/" rel="noopener ugc nofollow" target="_blank">https://www.contents.digitallab.jp/</a></figcaption></figure><p id="027c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">REST API是表述性状态转移的首字母缩写，是分布式超媒体系统的一种架构风格。这是一种按照某种协议设计API的灵活方法。</p><p id="ac58" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">REST API使客户端能够通过传输主要存储在数据库中的数据状态来与服务器通信。因为客户机和服务器是独立工作的，所以我们需要一些接口来促进它们之间的通信。客户端通过API向服务器发送请求，服务器以标准化的格式返回响应，如<a class="ae kv" href="https://www.json.org/" rel="noopener ugc nofollow" target="_blank"> JSON </a>或<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/XML/XML_introduction" rel="noopener ugc nofollow" target="_blank"> XML </a>。</p><p id="1fd6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">REST APIs在促进服务器中的通信方面起着至关重要的作用，因此对于开发人员来说，深入了解如何使用它们是至关重要的。容易出错的API会给客户端带来巨大的功能问题，并使软件整体吸引力下降。</p><p id="6b5b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本文中，我们将深入探讨设计REST APIs的最佳实践，以确保尽可能好的性能。</p><h1 id="1637" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">优化REST API的最佳实践</h1><h1 id="f807" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">1.使用JSON发送和接收数据</h1><p id="5a95" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">一个设计良好的REST API应该总是接受和接收JSON格式的数据。</p><p id="ceef" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">JSON是一种轻量级数据交换格式，已经成为许多开发人员的标准。它可以在许多技术中使用，并且由于它的轻量级特性，使服务器端的编码和解码变得快速和容易。此外，JSON可读性强，易于解释。</p><p id="4bda" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">JSON的替代方案XML并不被很多框架所支持。此外，与JSON相比，XML数据操作可能很麻烦，因为它冗长且难以编写。</p><p id="4b13" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了确保REST API使用JSON格式，总是将响应头中的<code class="fe mp mq mr ms b"><a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Type" rel="noopener ugc nofollow" target="_blank">Content-Type</a></code>设置为<code class="fe mp mq mr ms b">application/JSON</code>。大多数后端框架都有内置函数来自动将数据解析为JSON格式。</p><h1 id="a41f" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">2.用名词代替动词</h1><p id="bd01" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">REST APIs的命名约定很重要，可以避免很多混乱。</p><p id="26f4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们不应该在API端点中使用像<code class="fe mp mq mr ms b">DELETE</code>、<code class="fe mp mq mr ms b">PUT</code>或<code class="fe mp mq mr ms b">GET</code>这样的动词，因为它们类似于标准的HTTP请求方法。此外，用于API的名词已经完美地描述了被操作的实体。</p><p id="f786" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而，当我们要引用动词时，我们大多会引用HTTP方法，如<code class="fe mp mq mr ms b">GET</code>、<code class="fe mp mq mr ms b">POST</code>、<code class="fe mp mq mr ms b">PUT</code>、<code class="fe mp mq mr ms b">DELETE</code>。这些类似于发生在数据库层的CRUD操作，我们不想将它直接集成到API命名中。</p><p id="2c9c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">假设我们必须检索用户列表。我们将该API命名如下:</p><pre class="kg kh ki kj gt mt ms mu mv aw mw bi"><span id="40ca" class="mx lt iq ms b gy my mz l na nb">const express = require('express');<br/>const bodyParser = require('body-parser');</span><span id="d253" class="mx lt iq ms b gy nc mz l na nb">const app = express();</span><span id="96e1" class="mx lt iq ms b gy nc mz l na nb">app.use(bodyParser.json());</span><span id="c639" class="mx lt iq ms b gy nc mz l na nb">app.get('/user’, (req, res) =&gt; {<br/>  const user’= [];<br/>  res.json(user);<br/>});<br/></span><span id="5a04" class="mx lt iq ms b gy nc mz l na nb">//Avoid this.<br/>aap.get(‘getUser’, req,res)=&gt;{<br/>  const user’= [];<br/>  res.json(user);<br/>});</span></pre><h1 id="c7c5" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">3.集合使用复数</h1><p id="e5da" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">从数据库中检索数据通常需要批量进行，而不是从单个对象中检索，因为大多数操作都是基于列表的。因此，我们应该在API中对端点使用复数。这使得我们的API和数据库之间保持简单和一致。</p><p id="e58a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">例如，如果您正在设计一个API来检索数据库中的所有用户，那么您的端点应该如下所示:</p><pre class="kg kh ki kj gt mt ms mu mv aw mw bi"><span id="f33b" class="mx lt iq ms b gy my mz l na nb">// (List of users)<br/>https://api.abc.com/users</span></pre><p id="7427" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不正确的端点如下所示:</p><pre class="kg kh ki kj gt mt ms mu mv aw mw bi"><span id="afe4" class="mx lt iq ms b gy my mz l na nb"><a class="ae kv" href="https://api.abc.com/user" rel="noopener ugc nofollow" target="_blank">https://api.abc.com/user</a></span></pre><h1 id="2a82" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">4.不要忽略错误处理</h1><p id="e47a" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">每个应用程序都容易出错，这就是错误处理如此重要的原因。一个好的API应该总是返回正确的HTTP错误代码，正确地解释发生的特定错误的性质。</p><p id="966c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">假设我们想要为一个错误的请求返回一个错误。下面的代码示例是用用户的电子邮件地址注册用户:</p><pre class="kg kh ki kj gt mt ms mu mv aw mw bi"><span id="77c9" class="mx lt iq ms b gy my mz l na nb">const express = require('express');<br/>const bodyParser = require('body-parser');</span><span id="6edb" class="mx lt iq ms b gy nc mz l na nb">const app = express();</span><span id="89a1" class="mx lt iq ms b gy nc mz l na nb">// existing users<br/>const users = [<br/>  { email: 'king@hello.com' }<br/>]</span><span id="e83f" class="mx lt iq ms b gy nc mz l na nb">app.use(bodyParser.json());</span><span id="89a0" class="mx lt iq ms b gy nc mz l na nb">app.post('/users', (req, res) =&gt; {<br/>  const { email } = req.body;<br/>  const user= users.find(u =&gt; u.email === email);<br/>  if (user) {<br/>    return res.status(400).json({ error: 'User already exists' })<br/>  }<br/>  res.json(req.body);<br/>});<br/>app.listen(3000, () =&gt; console.log('server started'));</span></pre><p id="4843" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们增加了一个功能，在输入的电子邮件已经被使用的情况下返回一个错误。错误400用于错误的请求，通知客户端输入不同的电子邮件地址。详细说明问题的错误消息使得调试更加容易，这也是REST APIs广受欢迎的另一个原因。</p><h1 id="9e7f" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">5.过滤数据</h1><p id="1d38" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">任何有经验的开发人员都知道，数据库可能会变得非常大，当它们变得非常大时，就很难管理了。当请求到来时，我们必须只检索我们需要的数据，而不是返回数据库中的所有数据。</p><p id="f6e9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为此，我们必须使用过滤器。这只会返回完成请求所需的数据，从而提高性能，并在客户端节省大量带宽。随着数据库规模的增长，过滤器变得更加重要。</p><h1 id="c28b" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">6.保持严密的安全</h1><p id="11e9" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">数据库安全应该是每个API开发者最关心的问题之一；一个<a class="ae kv" href="https://www.cybintsolutions.com/4-damaging-after-effects-of-a-data-breach/" rel="noopener ugc nofollow" target="_blank">安全漏洞</a>会给公司带来数百万美元的损失。</p><p id="13b5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由于数据有时包含敏感信息，如信用卡信息，我们必须保持服务器和客户端之间的通信完全保密。SSL/TLS安全是确保每个请求和响应都在通道上加密的一种常见且经济的方法。</p><p id="5413" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此外，用户不应该能够访问超过需要的数据。例如，用户A访问用户B的数据会造成巨大的隐私和安全威胁。解决这个问题的一个方法是为管理员提供他们自己的特权，并分别为用户分配角色。</p><h1 id="d176" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">7.自动缓存</h1><p id="62d6" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">重复请求和响应相同的数据会消耗资源，并且是有缺陷的设计的标志。要解决这个问题，请将从API获取的数据存储在服务器上，并从那里提供服务。</p><p id="7a53" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而，可能出现的一个问题是数据可能会过时。为此，有几个行业标准的缓存解决方案可以在每次更改后缓存数据，如<a class="ae kv" href="https://redis.io/" rel="noopener ugc nofollow" target="_blank"> Redis </a>和<a class="ae kv" href="https://aws.amazon.com/elasticache/" rel="noopener ugc nofollow" target="_blank">亚马逊ElasticCache </a>。</p><h1 id="27a5" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">8.分配正确的API版本</h1><p id="b5e4" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">如果您计划对您的API进行更改，请始终确保分配正确的版本，以便客户端不会中断。您应该为客户端提供选项，要么继续使用以前的版本，要么尝试新版本。</p><p id="d1a8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">目标是通过保持更新对客户端是可选的来提供最好的用户体验。通常的做法是在端点前添加一个版本，如下所示:</p><pre class="kg kh ki kj gt mt ms mu mv aw mw bi"><span id="e213" class="mx lt iq ms b gy my mz l na nb"><a class="ae kv" href="https://api.abc.com/v1/users" rel="noopener ugc nofollow" target="_blank">https://api.abc.com/v1/users</a><br/>https://api.abc.com/v2/users</span></pre><h1 id="0b6e" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">9.使用嵌套来显示关系</h1><p id="a341" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">将相关的端点放在一起创建一个层次结构称为API嵌套。例如，如果用户有任何活动订单，那么在<code class="fe mp mq mr ms b">/users/:id</code>之后嵌套<code class="fe mp mq mr ms b">/order</code>是管理API的一个好方法:</p><pre class="kg kh ki kj gt mt ms mu mv aw mw bi"><span id="33e5" class="mx lt iq ms b gy my mz l na nb"><a class="ae kv" href="https://api.abc.com/users" rel="noopener ugc nofollow" target="_blank">https://api.abc.com/users</a> (list of users)<br/>https://api.abc.com/users/321 (specific user by using filters)<br/>https://api.abc.com/users/321/order (list of the order of the specific user)</span></pre><p id="f70c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">建议使用较少的嵌套层次，以防止应用程序过于复杂；您可以使用筛选来减少嵌套层数。两级嵌套通常使API更简单并完成工作。</p><h1 id="1c90" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">10.提供API文档</h1><p id="6d1e" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">提供完整的文档对于任何API都是至关重要的。没有清晰的文档，客户就不可能正确使用API。我们必须确保API文档使用简单的语言，并随着新版本不断更新。</p><p id="b4c2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">固体API文件应包括以下特征:</p><ul class=""><li id="1d7d" class="nd ne iq ky b kz la lc ld lf nf lj ng ln nh lr ni nj nk nl bi translated">简单的措辞和语言</li><li id="825a" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">每个端点的请求解释、示例和示例响应</li><li id="71c5" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">用不同的编程语言实现API(如果适用)</li><li id="af84" class="nd ne iq ky b kz nm lc nn lf no lj np ln nq lr ni nj nk nl bi translated">可能的错误消息已登记</li></ul><h1 id="1b9c" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">结论</h1><p id="bc03" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">随着互联网流量的增加，每天获取的数据越来越多。一个好的API是任何系统保持平稳运行的支柱。如果我们在设计API时遵循上述实践，结果将是高度功能化和高性能的应用程序。</p></div><div class="ab cl nr ns hu nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="ij ik il im in"><p id="2204" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ny">更多内容请看</em><a class="ae kv" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="ny">plain English . io</em></strong></a><em class="ny">。报名参加我们的</em> <a class="ae kv" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="ny">免费周报</em> </strong> </a> <em class="ny">。关注我们关于</em><a class="ae kv" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="ny">Twitter</em></strong></a><strong class="ky ir"><em class="ny"/></strong><em class="ny">和</em><a class="ae kv" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="ny">LinkedIn</em></strong></a><em class="ny">。查看我们的</em> <a class="ae kv" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="ny">社区不和谐</em> </strong> </a> <em class="ny">加入我们的</em> <a class="ae kv" href="https://inplainenglish.pallet.com/talent/welcome" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="ny">人才集体</em> </strong> </a> <em class="ny">。</em></p></div></div>    
</body>
</html>