<html>
<head>
<title>Using Node.js and GitHub Action to Find a House on the Web</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用Node.js和GitHub Action在网上找房子</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/using-node-js-and-github-action-to-find-a-house-on-the-web-ae03ed64670a?source=collection_archive---------5-----------------------#2022-03-12">https://javascript.plainenglish.io/using-node-js-and-github-action-to-find-a-house-on-the-web-ae03ed64670a?source=collection_archive---------5-----------------------#2022-03-12</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="05b9" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">一个关于创建脚本的指南，该脚本每30分钟自动运行一次，以检查新房子并将其发送到Telegram。</h2></div><p id="2a6f" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果你想在荷兰租房或买房，你最好做好准备，因为这不是一件容易的事情，尤其是如果你在阿姆斯特丹找房子的话。</p><p id="dab5" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">申请租房或竞拍房子就像工作面试，或获得另一个国家的签证。你需要提供你的付款单，工作合同，以前房东的推荐，等等。</p><p id="914e" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">不仅如此，很多时候你甚至没有机会申请，因为他们已经有很多人申请了，他们不再接受申请。有时，在房子在Funda.nl 上挂牌后的两天内，他们已经不预订看房了。</p><p id="d311" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果你至少能预订看房，你会看到房子里有很多其他人，有时甚至会排队。</p><p id="6819" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">正因为如此，我不得不经常打开Funda.nl查看新房子，所以只要有新房子，我就可以预订看房。</p><figure class="la lb lc ld gt le gh gi paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="gh gi kz"><img src="../Images/26361295246d2bc2ffc24e3f3f49c0ba.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*XjJaqxmBpD54N1P6.png"/></div></div></figure><h1 id="9b89" class="ll lm in bd ln lo lp lq lr ls lt lu lv jt lw ju lx jw ly jx lz jz ma ka mb mc bi translated">让我们自动化它</h1><p id="c12f" class="pw-post-body-paragraph kc kd in ke b kf md jo kh ki me jr kk kl mf kn ko kp mg kr ks kt mh kv kw kx ig bi translated">Funda.nl的好处是，他们有各种各样的过滤器供您搜索，这些过滤器保存在URL中。万岁！</p><p id="a5ae" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">例如，<a class="ae ky" href="https://www.funda.nl/en/huur/amsterdam/beschikbaar/0-2000/40+woonopp/2+slaapkamers/1-dag/" rel="noopener ugc nofollow" target="_blank">此链接</a>将列出1天前以来列出的所有房子，有两个卧室，至少40米，最多€2000。</p><p id="d5ea" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这个页面上的结果在一个带有类<code class="fe mi mj mk ml b">search-result</code>的HTML <code class="fe mi mj mk ml b">li</code>元素中列出，所以我可以通过查询<code class="fe mi mj mk ml b">document.querySelectorAll('.search-result')</code>获得所有元素，在每个元素中，我可以获得带有<code class="fe mi mj mk ml b">element.querySelectorAll('a').[0].href</code>的房子的链接。</p><p id="67ca" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">有了<code class="fe mi mj mk ml b">puppeteer.js</code>,我可以自动进入那个网址，检查是否有新房子出现，并把它保存到一个文件中。由于这是一个Node.js脚本，我将使用<code class="fe mi mj mk ml b">jsdom</code>来处理DOM元素。</p><figure class="la lb lc ld gt le"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="8c91" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在我可以简单地运行<code class="fe mi mj mk ml b">node script.js</code>，我将所有的URL放在一个<code class="fe mi mj mk ml b">urls.json</code>文件中。</p><h1 id="1a80" class="ll lm in bd ln lo lp lq lr ls lt lu lv jt lw ju lx jw ly jx lz jz ma ka mb mc bi translated">向电报发送新的URL</h1><p id="fa50" class="pw-post-body-paragraph kc kd in ke b kf md jo kh ki me jr kk kl mf kn ko kp mg kr ks kt mh kv kw kx ig bi translated">我不想将URL保存到一个<code class="fe mi mj mk ml b">urls.json</code>文件中，而是想使用一个电报机器人将这些URL发送到一个电报组，为此，我需要使用<code class="fe mi mj mk ml b">node-fetch</code>。</p><figure class="la lb lc ld gt le"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="82a8" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这很好，但不是很有用，因为我不想手动运行脚本，我将在下一步修复它。</p><h1 id="0270" class="ll lm in bd ln lo lp lq lr ls lt lu lv jt lw ju lx jw ly jx lz jz ma ka mb mc bi translated">使用GitHub动作</h1><p id="5164" class="pw-post-body-paragraph kc kd in ke b kf md jo kh ki me jr kk kl mf kn ko kp mg kr ks kt mh kv kw kx ig bi translated">GitHub Actions很棒，我一直用它来完成测试和建立我的博客等任务，但是你也可以使用<code class="fe mi mj mk ml b">cron</code>让<a class="ae ky" href="https://docs.github.com/en/actions/using-workflows/events-that-trigger-workflows#schedule" rel="noopener ugc nofollow" target="_blank">脚本按照</a>的时间表运行。</p><p id="aa65" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">对于这个脚本，我需要使用<a class="ae ky" href="https://github.com/actions/checkout" rel="noopener ugc nofollow" target="_blank"> actions/checkout </a>来检查我的代码，并使用<a class="ae ky" href="https://github.com/stefanzweifel/git-auto-commit-action" rel="noopener ugc nofollow" target="_blank">stefanzweifel/git-auto-commit-action</a>来保存已经发送到Telegram的URL列表。</p><figure class="la lb lc ld gt le"><div class="bz fp l di"><div class="mm mn l"/></div></figure><p id="8559" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">就是这样！现在，每当我的网址上列出了一栋新房子，我都会收到一条电报消息🎉。</p><h1 id="9153" class="ll lm in bd ln lo lp lq lr ls lt lu lv jt lw ju lx jw ly jx lz jz ma ka mb mc bi translated">奖金</h1><figure class="la lb lc ld gt le gh gi paragraph-image"><div class="gh gi mo"><img src="../Images/63fbb603555d748ef31c8795e6cbd270.png" data-original-src="https://miro.medium.com/v2/resize:fit:1094/format:webp/0*f9dpRIbob0p0Lxvz.png"/></div></figure><p id="2863" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">有一个非常好的<a class="ae ky" href="https://github.com/nikitaindik/funda-neighbourhoods" rel="noopener ugc nofollow" target="_blank">开源Chrome扩展</a>，它向Funda.nl添加了许多关于房子的新数据，所以我复制了一些代码，向houses send to Telegram添加额外的信息。</p><p id="2b2c" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">你可以<a class="ae ky" href="https://github.com/blopa/funda-scraper" rel="noopener ugc nofollow" target="_blank">在GitHub </a>上克隆这个项目，添加自己的Funda.nl网址列表，脚本会每30分钟自动运行一次，检查有没有新房子，并发送给Telegram。</p><p id="8925" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">下一集再见！</p></div><div class="ab cl mp mq hr mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ig ih ii ij ik"><p id="ea2a" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="mw">最初发布于</em><a class="ae ky" href="https://pablo.gg/en/blog/coding/using-nodejs-and-github-action-to-find-a-house-on-fundanl/" rel="noopener ugc nofollow" target="_blank"><em class="mw">https://pablo . gg</em></a><em class="mw">。</em></p><p id="6268" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="mw">更多内容看</em> <a class="ae ky" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io"> <em class="mw">说白了就是</em> </strong> </a> <em class="mw">。报名参加我们的</em> <a class="ae ky" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io"> <em class="mw">免费每周简讯</em> </strong> </a> <em class="mw">。关注我们关于</em><a class="ae ky" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="ke io"><em class="mw">Twitter</em></strong></a><em class="mw">和</em><strong class="ke io"><em class="mw"/></strong><a class="ae ky" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="ke io"><em class="mw">LinkedIn</em></strong></a><em class="mw">。加入我们的</em> <a class="ae ky" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io"> <em class="mw">社区不和谐</em> </strong> </a> <em class="mw">。</em></p></div></div>    
</body>
</html>