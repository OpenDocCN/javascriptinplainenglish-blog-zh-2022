<html>
<head>
<title>How to listen to Formik onChange event in React?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在React中收听Formik onChange事件？</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-listen-to-formik-onchange-event-in-react-df00c4d09be?source=collection_archive---------0-----------------------#2022-02-05">https://javascript.plainenglish.io/how-to-listen-to-formik-onchange-event-in-react-df00c4d09be?source=collection_archive---------0-----------------------#2022-02-05</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/c2607ddd06e3ed2998e6c6aa2af33c2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*o3QCdPL0t9AD4JFreVyFmg.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Image license obtained from Envato Elements (license code: XNGDU3EF8T)</figcaption></figure><p id="c1c8" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">最近这个问题被问了好几次:</p><ul class=""><li id="28b7" class="kx ky in kb b kc kd kg kh kk kz ko la ks lb kw lc ld le lf bi translated">我在我的<code class="fe lg lh li lj b">React</code>项目中使用了<code class="fe lg lh li lj b">Formik</code></li><li id="39a3" class="kx ky in kb b kc lk kg ll kk lm ko ln ks lo kw lc ld le lf bi translated">我想观察(或倾听)表单值的变化</li><li id="97a9" class="kx ky in kb b kc lk kg ll kk lm ko ln ks lo kw lc ld le lf bi translated">但是<code class="fe lg lh li lj b">&lt;Formik&gt;</code>没有为<code class="fe lg lh li lj b">onChange</code>回调提供道具</li></ul><p id="a14f" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">我该怎么做？</p><p id="9fc6" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">我想分享两个选择:</p><ul class=""><li id="f16f" class="kx ky in kb b kc kd kg kh kk kz ko la ks lb kw lc ld le lf bi translated">#1在<code class="fe lg lh li lj b">&lt;form&gt;</code>元素/组件上附加回调函数</li><li id="89e3" class="kx ky in kb b kc lk kg ll kk lm ko ln ks lo kw lc ld le lf bi translated">#2用<code class="fe lg lh li lj b">useFormikContext</code>创建一个监听器/观察器组件</li></ul></div><div class="ab cl lp lq hr lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ig ih ii ij ik"><h1 id="a7e6" class="lw lx in bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">解决方案1:在<form>上附加回调</form></h1><p id="bed0" class="pw-post-body-paragraph jz ka in kb b kc mu ke kf kg mv ki kj kk mw km kn ko mx kq kr ks my ku kv kw ig bi translated"><code class="fe lg lh li lj b">Formik</code>没有提供<code class="fe lg lh li lj b">onChange</code> prop，但是<code class="fe lg lh li lj b">&lt;form&gt;</code>(或者<code class="fe lg lh li lj b">&lt;Form&gt;</code>如果使用包装器版本)提供了。</p><p id="4412" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">所以，你可以像这样定义一个<code class="fe lg lh li lj b">handleOnChange</code>回调函数:</p><pre class="mz na nb nc gt nd lj ne nf aw ng bi"><span id="e4a6" class="nh lx in lj b gy ni nj l nk nl">const handleOnChange = (event: FormEvent) =&gt; {<br/>    console.log("Form::onChange", event);<br/>};</span></pre><p id="dd2f" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">…并将其直接传递给<code class="fe lg lh li lj b">&lt;Form&gt;</code>:</p><pre class="mz na nb nc gt nd lj ne nf aw ng bi"><span id="093c" class="nh lx in lj b gy ni nj l nk nl">&lt;Form <strong class="lj io">onChange={handleOnChange}</strong>&gt;<br/>    {/* ... */}<br/>&lt;/Form&gt;</span></pre><p id="0af6" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">回调将接收一个合成DOM事件，您可以通过<code class="fe lg lh li lj b">event.target</code>访问触发变化的输入元素</p><figure class="mz na nb nc gt jo gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/de06970ff99f732ad7b5aba20023f312.png" data-original-src="https://miro.medium.com/v2/resize:fit:1370/format:webp/1*2HsfKIGfrPHoeoCQnfLqEw.png"/></div></figure><h1 id="c057" class="lw lx in bd ly lz nn mb mc md no mf mg mh np mj mk ml nq mn mo mp nr mr ms mt bi translated">解决方案2:创建一个观察者组件</h1><p id="0c4e" class="pw-post-body-paragraph jz ka in kb b kc mu ke kf kg mv ki kj kk mw km kn ko mx kq kr ks my ku kv kw ig bi translated">让我们不要局限在DOM的世界里，也从<a class="ae ns" href="https://reactjs.org/docs/forms.html#controlled-components" rel="noopener ugc nofollow" target="_blank">受控组件</a>的角度来思考一下——表单<code class="fe lg lh li lj b">Formik</code>中的输入元素是由<code class="fe lg lh li lj b">React</code>中的状态控制的，它们的状态可以通过<code class="fe lg lh li lj b">FormikContext</code>来访问和操作。</p><p id="247f" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">也就是说，您可以使用<code class="fe lg lh li lj b">useEffect</code>钩子创建一个组件来观察(或监听)<code class="fe lg lh li lj b">FormikContext</code>中<code class="fe lg lh li lj b">values</code>的变化:</p><pre class="mz na nb nc gt nd lj ne nf aw ng bi"><span id="dbad" class="nh lx in lj b gy ni nj l nk nl">const FormObserver: React.FC = () =&gt; {<br/>  const { values } = useFormikContext();</span><span id="27f1" class="nh lx in lj b gy nt nj l nk nl">  useEffect(() =&gt; {<br/>    console.log("FormObserver::values", values);<br/>  }, [values]);</span><span id="2749" class="nh lx in lj b gy nt nj l nk nl">  return null;<br/>};</span></pre><p id="3cb5" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">…然后简单地把它当成<code class="fe lg lh li lj b">&lt;Form&gt;</code>的孩子:</p><pre class="mz na nb nc gt nd lj ne nf aw ng bi"><span id="7a2a" class="nh lx in lj b gy ni nj l nk nl">&lt;Form&gt;<br/>  {/* ... */}<br/>  <strong class="lj io">&lt;FormObserver /&gt;</strong><br/>  {/* ... */}<br/>&lt;/Form&gt;</span></pre><p id="2bf4" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">然后，您可以看到表单值更改时的效果运行:</p><figure class="mz na nb nc gt jo gh gi paragraph-image"><div class="gh gi nu"><img src="../Images/cc030638d3e70189c94ac15dc121e28d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1090/format:webp/1*c44ynoMxt40nGLcvQu4A8Q.png"/></div></figure><h1 id="841f" class="lw lx in bd ly lz nn mb mc md no mf mg mh np mj mk ml nq mn mo mp nr mr ms mt bi translated">演示/游乐场</h1><p id="0350" class="pw-post-body-paragraph jz ka in kb b kc mu ke kf kg mv ki kj kk mw km kn ko mx kq kr ks my ku kv kw ig bi translated">我在代码沙盒上创建了一个演示/游乐场，欢迎您来试试:</p><figure class="mz na nb nc gt jo"><div class="bz fp l di"><div class="nv nw l"/></div></figure><h1 id="fc7b" class="lw lx in bd ly lz nn mb mc md no mf mg mh np mj mk ml nq mn mo mp nr mr ms mt bi translated">思想</h1><p id="64b1" class="pw-post-body-paragraph jz ka in kb b kc mu ke kf kg mv ki kj kk mw km kn ko mx kq kr ks my ku kv kw ig bi translated">虽然这两种解决方案都可行，但思维方式是不同的。</p><p id="50f0" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">解决方案1:您正在监听一个DOM事件，您需要访问DOM来获取信息，这倾向于<a class="ae ns" href="https://reactjs.org/docs/uncontrolled-components.html" rel="noopener ugc nofollow" target="_blank">不受控制的组件模式</a>。</p><p id="9cf9" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">解决方案2:您在不接触DOM的情况下监听状态变化，这倾向于<a class="ae ns" href="https://reactjs.org/docs/forms.html#controlled-components" rel="noopener ugc nofollow" target="_blank">受控组件模式</a>。</p><p id="c13f" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">我认为Formik是一个强调<a class="ae ns" href="https://reactjs.org/docs/forms.html#controlled-components" rel="noopener ugc nofollow" target="_blank">受控组件模式</a>的库，所以我推荐解决方案#2，在使用这个库时保持心态一致。</p><p id="f4cc" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><em class="nx">更多内容看</em> <a class="ae ns" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kb io"> <em class="nx">说白了。报名参加我们的</em> <a class="ae ns" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kb io"> <em class="nx">免费周报</em> </strong> </a> <em class="nx">。在我们的</em> <a class="ae ns" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kb io"> <em class="nx">社区获得独家访问写作机会和建议</em> </strong> </a> <em class="nx">。</em></strong></a></p></div></div>    
</body>
</html>