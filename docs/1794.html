<html>
<head>
<title>How to Set Up Next.js with TypeScript to Get a 100% Score in Google Lighthouse and Vercel Analytics</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用TypeScript设置Next.js在Google Lighthouse和Vercel Analytics中获得100分</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-set-up-next-js-with-typescript-to-get-a-100-score-in-google-lighthouse-and-vercel-analytics-6f97501a91c7?source=collection_archive---------0-----------------------#2022-04-20">https://javascript.plainenglish.io/how-to-set-up-next-js-with-typescript-to-get-a-100-score-in-google-lighthouse-and-vercel-analytics-6f97501a91c7?source=collection_archive---------0-----------------------#2022-04-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="9f83" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">建立一个PWA来获得Google Lighthouse、Vercel Analytics和Webpagetest.org安全公司的许可</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/e8e164d1703f87a66df7f65f5b5c7ebc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C6S4ih_mXxA-BkNAoOin5A.png"/></div></div></figure><h1 id="7bd5" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">介绍</h1><p id="262f" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">本文介绍了如何使用Next.js构建渐进式Web应用程序，以在Google Lighthouse和Vercel Analytics中获得100%的分数。</p><p id="d9e3" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">在这里，我们将经历优化一个全新的Next.js项目的整个过程。也可以将其视为以下文章的更新组合:</p><div class="mk ml gp gr mm mn"><a href="https://rockyli.medium.com/build-a-pwa-with-next-js-to-achieve-100-lighthouse-score-8bbb86598ed4" rel="noopener follow" target="_blank"><div class="mo ab fo"><div class="mp ab mq cl cj mr"><h2 class="bd ir gy z fp ms fr fs mt fu fw ip bi translated">用Next.js构建PWA，实现100% lighthouse评分</h2><div class="mu l"><h3 class="bd b gy z fp ms fr fs mt fu fw dk translated">这篇文章讲述了我们如何用Next.js (React.js)构建一个渐进的Web应用程序，并获得100%的分数…</h3></div><div class="mv l"><p class="bd b dl z fp ms fr fs mt fu fw dk translated">rockyli.medium.com</p></div></div><div class="mw l"><div class="mx l my mz na mw nb kp mn"/></div></div></a></div><div class="mk ml gp gr mm mn"><a rel="noopener  ugc nofollow" target="_blank" href="/build-a-pwa-with-next-js-to-achieve-100-in-google-lighthouse-and-next-js-analytics-ab695765c48"><div class="mo ab fo"><div class="mp ab mq cl cj mr"><h2 class="bd ir gy z fp ms fr fs mt fu fw ip bi translated">用Next.js建立一个PWA，在Google Lighthouse和Next.js Analytics中实现100%</h2><div class="mu l"><h3 class="bd b gy z fp ms fr fs mt fu fw dk translated">在Google light house+next . js Analytics+Webpagetest.org中获得最高排名</h3></div><div class="mv l"><p class="bd b dl z fp ms fr fs mt fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="mw l"><div class="nc l my mz na mw nb kp mn"/></div></div></a></div><p id="bd19" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">另外，该项目将使用TypeScript编写。</p><p id="6fad" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">当我创建<a class="ae nd" href="https://github.com/rockyliyanlok/nextjs-100" rel="noopener ugc nofollow" target="_blank"> nextjs-100 </a>时，我的大部分项目仍然是用JavaScript编写的，并带有用于类型检查的PropTypes。渐渐地，越来越多的项目转向了TypeScript，我开始意识到用TypeScript构建项目的更多好处。一项<a class="ae nd" href="https://earlbarr.com/publications/typestudy.pdf" rel="noopener ugc nofollow" target="_blank">研究</a>发现15%的JavaScript bugs可以通过使用TypeScript检测出来。</p><p id="377e" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">尤其是，当我们在一个有许多贡献者的项目上工作时。使用TypeScript，我们可以更容易地重构代码，而不会严重破坏代码。</p><p id="4ab2" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">因此，是时候在TypeScript 中构建我们的<a class="ae nd" href="https://github.com/rockyliyanlok/nextjs-100-ts" rel="noopener ugc nofollow" target="_blank"> nextjs-100了！</a></p><h1 id="4ff9" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">带有TypeScript的Next.js</h1><p id="ce34" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">首先，我们从创建一个新的Next.js应用程序开始。</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="d77e" class="nj ks iq nf b gy nk nl l nm nn">$ yarn create next-app — typescript</span></pre><p id="c9fd" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">正如我们在TypeScript Next.js项目中看到的，名为<code class="fe no np nq nf b">next-env.d.ts</code>和<code class="fe no np nq nf b">tsconfig.json</code>的文件将在项目的根目录下创建。文件<code class="fe no np nq nf b">next-env.d.ts</code>是为了确保Next.js类型被TypeScript编译器选中。我们不应该删除或编辑它。</p><p id="377b" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">另一个文件<code class="fe no np nq nf b">tsconfig.json</code>是TypeScript编译器的定制配置。如果我们需要额外的类型，在根中创建一个<code class="fe no np nq nf b">*.d.ts</code>，并在<code class="fe no np nq nf b">tsconfig.json</code>的包含数组中引用。</p><p id="cf11" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">我们可以在官方文件中找到更多信息:<a class="ae nd" href="https://nextjs.org/docs/basic-features/typescript" rel="noopener ugc nofollow" target="_blank">https://nextjs.org/docs/basic-features/typescript</a></p><h1 id="26f8" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">添加图标资产</h1><p id="cb45" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">让我们清理并添加一些项目签名。例如，删除不必要的组件并添加应用程序图标。favicon.io工具是一个非常有用的工具，可以生成web应用程序图标资产。</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="3c8a" class="nj ks iq nf b gy nk nl l nm nn">public/<br/>├── android-chrome-192x192.png<br/>├── android-chrome-512x512.png<br/>├── apple-touch-icon.png<br/>├── favicon-16x16.png<br/>├── favicon-32x32.png<br/>├── favicon.ico<br/>└── site.webmanifest</span></pre><p id="5cf4" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">这些图标资产应该放在<strong class="ll ir"> <em class="nr">公共</em> </strong>文件夹中。我们还需要给<code class="fe no np nq nf b">site.webmanifest</code>添加一些属性，使其完整并满足渐进式web应用程序的需求。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ns nt l"/></div><figcaption class="nu nv gj gh gi nw nx bd b be z dk">./public/site.webmanifest</figcaption></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ns nt l"/></div><figcaption class="nu nv gj gh gi nw nx bd b be z dk">./pages/_document.tsx</figcaption></figure><p id="a30c" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">一旦我们准备好资产，在<code class="fe no np nq nf b">_document.tsx</code>的<code class="fe no np nq nf b">&lt;head&gt;</code>元素中添加meta标签。</p><h2 id="9490" class="nj ks iq bd kt ny nz dn kx oa ob dp lb ls oc od ld lw oe of lf ma og oh lh oi bi translated">manifest . JSON vs site . web manifest</h2><p id="7554" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">根据w3.org T21的说法，开发者可以选择使用不同的扩展，比如T3和T4。然而，IANA注册的清单文件扩展名是<code class="fe no np nq nf b">.webmanifest</code>。我们将在这个库中使用<code class="fe no np nq nf b">site.webmanifest</code>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/2b8591e106f39a8247e3a77e6720e316.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0oJroErIs2nAIhNKkQklpQ.png"/></div></div><figcaption class="nu nv gj gh gi nw nx bd b be z dk"><strong class="bd ok">Figure 1</strong> Performance report from Lighthouse — dev build</figcaption></figure><p id="6c0b" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">生产版本是应用程序的优化版本。<strong class="ll ir">中生成的代码<em class="nr">。接下来编译并缩小</em>和</strong>。通常，为了优化性能，我们会将生产版本推送到现场。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/d9f8708fc88e04faed0ad5b771a5c794.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VZqqFDlH8VWZW35d2RFEvg.png"/></div></div><figcaption class="nu nv gj gh gi nw nx bd b be z dk"><strong class="bd ok">Figure 2</strong> Performance report from Lighthouse — prod build</figcaption></figure><p id="924b" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">让我们继续让报告全是绿色的。</p><h1 id="9930" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">添加元标签标题描述</h1><p id="a9f0" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">根据Lighthouse的报告，添加标题和描述元素可以提高可访问性和SEO指标。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/58b31dfc2dc0e54f1b5b500e3b8d1ca8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EVjkzQizgwOO1aJ_HgA6Vw.png"/></div></div><figcaption class="nu nv gj gh gi nw nx bd b be z dk"><strong class="bd ok">Figure 3</strong> Diagnostics from Lighthouse — title element</figcaption></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/67196f2fd483caae6ab47603c1b79c83.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9vZfPsFBdf9Er8tZ0rVNIA.png"/></div></div><figcaption class="nu nv gj gh gi nw nx bd b be z dk"><strong class="bd ok">Figure 4</strong> Diagnostics from Lighthouse — title element and meta description</figcaption></figure><p id="edb3" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">在Next.js中，我们可以将描述元标签放在<code class="fe no np nq nf b">_document.tsx</code>文件中。然而，<code class="fe no np nq nf b">&lt;title&gt;</code>元素应该放在每一页上。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ns nt l"/></div><figcaption class="nu nv gj gh gi nw nx bd b be z dk">./pages/_document.tsx</figcaption></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ns nt l"/></div><figcaption class="nu nv gj gh gi nw nx bd b be z dk">./pages/index.tsx</figcaption></figure><h1 id="b6c0" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">向HTML元素添加lang属性</h1><p id="79a4" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">从v10开始Next.js支持国际化路由。Next.js会根据用户访问的语言自动添加<code class="fe no np nq nf b">lang</code>属性。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ns nt l"/></div><figcaption class="nu nv gj gh gi nw nx bd b be z dk">./next.config.js</figcaption></figure><p id="5948" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">在<code class="fe no np nq nf b">next.config.js</code>中添加i18n配置以指定支持的语言。然后，我们可以发现自动检测的lang属性被添加到HTML元素中。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/0324b86fad3756729950bec4c8ffa8be.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_kULhkbNYj2ykDLYl-GXIQ.png"/></div></div><figcaption class="nu nv gj gh gi nw nx bd b be z dk"><strong class="bd ok">Figure 5 </strong>Performance report from Lighthouse — all green</figcaption></figure><p id="1ccc" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">太好了！我们成功了！</p><p id="b1a4" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">在Lighthouse报告中，所有四个指标都是绿色100。即便如此，你可能会注意到PWA圈还是一个负号。</p><h1 id="595b" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">渐进式Web应用程序</h1><p id="c4f0" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">通过添加<code class="fe no np nq nf b">next-pwa</code>包，使Next.js应用程序成为一个渐进式web应用程序是非常方便的。</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="4cf7" class="nj ks iq nf b gy nk nl l nm nn">$ yarn add next-pwa</span></pre><p id="b4f6" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">导入<code class="fe no np nq nf b">next.config.js</code>中的<code class="fe no np nq nf b">next-pwa</code>包并添加配置。我们通常不希望服务人员在开发期间运行。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ns nt l"/></div><figcaption class="nu nv gj gh gi nw nx bd b be z dk">./next.config.js</figcaption></figure><p id="f1a9" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">对于PWA设置来说,<code class="fe no np nq nf b">theme-color</code>和<code class="fe no np nq nf b">referrer</code> meta标签也是必需的。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ns nt l"/></div><figcaption class="nu nv gj gh gi nw nx bd b be z dk">./pages/_document.tsx</figcaption></figure><h2 id="9589" class="nj ks iq bd kt ny nz dn kx oa ob dp lb ls oc od ld lw oe of lf ma og oh lh oi bi translated">manifest.json的预缓存问题</h2><p id="3ac0" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">在<a class="ae nd" href="https://github.com/shadowwalker/next-pwa/issues/295#issuecomment-971219218" rel="noopener ugc nofollow" target="_blank">这个线程</a>中提到了一个预缓存问题，这个问题会在部署到Vercel后发生。因此，在下一个pwa构建中，运行时缓存被添加，而<code class="fe no np nq nf b">middleware-manifest.json</code>被排除。</p><p id="83c0" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">做了上面的修改后，灯塔报告中的PWA圈神奇地变成了绿色的勾号。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/4ad1881ac0b371a3e3f1dfa16dc2a4f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ee_1Ry1a7tFm_Y7fRuWzzw.png"/></div></div><figcaption class="nu nv gj gh gi nw nx bd b be z dk"><strong class="bd ok">Figure 6</strong> Performance report from Lighthouse — all green and PWA passed</figcaption></figure><h1 id="b699" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">检查安全性</h1><p id="d5b0" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">虽然我们在灯塔报告中做到了100%，但这不应该是这个故事的结尾。安全性总是很重要，因此让我们检查一下安全性得分。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ol"><img src="../Images/d4d3ebe6eb0b2b54bb0006c24ed424a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f_Tvr3N8sVd6PK5-g13dYw.png"/></div></div><figcaption class="nu nv gj gh gi nw nx bd b be z dk"><strong class="bd ok">Figure 7</strong> Security report from Webpagetest.org — Security score E</figcaption></figure><p id="2227" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">参考<a class="ae nd" href="https://webpagetest.org/" rel="noopener ugc nofollow" target="_blank">webpagetest.org</a>安全评分在<strong class="ll ir"> E </strong>带，有一堆问题需要我们解决。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/78c31d6e43bf4db9bf04bfb2b375352b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*N9DUKbhkytYxrjkbIxAFFA.png"/></div></div><figcaption class="nu nv gj gh gi nw nx bd b be z dk"><strong class="bd ok">Figure 8</strong> Diagnostics from Webpagetest.org — X Content Type Options</figcaption></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/7c05ce751db0ded9a42760d6a04ed470.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*vjPL11x3VGJ77YmiDclDGA.png"/></div></div><figcaption class="nu nv gj gh gi nw nx bd b be z dk"><strong class="bd ok">Figure 9 </strong>Diagnostics from Webpagetest.org — X Frame Options</figcaption></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi om"><img src="../Images/ac1b81d9451ee586896a0a0622bd00c3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YsVQpdo9T22L0R04uuQeoQ.png"/></div></div><figcaption class="nu nv gj gh gi nw nx bd b be z dk"><strong class="bd ok">Figure 10 </strong>Diagnostics from Webpagetest.org — X XSS Protection</figcaption></figure><h2 id="5eef" class="nj ks iq bd kt ny nz dn kx oa ob dp lb ls oc od ld lw oe of lf ma og oh lh oi bi translated">添加安全标题</h2><p id="81bf" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">我们可以通过在<code class="fe no np nq nf b">next.config.js</code>中添加安全头来解决这些问题。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ns nt l"/></div><figcaption class="nu nv gj gh gi nw nx bd b be z dk">./next.config.js</figcaption></figure><h2 id="4647" class="nj ks iq bd kt ny nz dn kx oa ob dp lb ls oc od ld lw oe of lf ma og oh lh oi bi translated">添加内容安全策略</h2><p id="e84b" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">对于内容安全策略，我们还为Vercel Analytics添加了<strong class="ll ir"><em class="nr">vitals.vercel-insights.com</em></strong>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ns nt l"/></div><figcaption class="nu nv gj gh gi nw nx bd b be z dk">./next.config.js</figcaption></figure><p id="dcea" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">是时候再次尝试在<a class="ae nd" href="https://webpagetest.org/" rel="noopener ugc nofollow" target="_blank">webpagetest.org</a>获得更好的安全分数了。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ol"><img src="../Images/e454c531a26b008ce76a7e6957ae7605.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*qhUkhETPHOtXrK_kaezJXw.png"/></div></div><figcaption class="nu nv gj gh gi nw nx bd b be z dk"><strong class="bd ok">Figure 11</strong> Security report from Webpagetest.org — Security score A+</figcaption></figure><p id="82aa" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">干得好！最后我们在安全级别上得到了band <strong class="ll ir"> A+ </strong>。</p><h1 id="d239" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">韦尔塞尔分析公司</h1><p id="996a" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">谷歌灯塔几乎是一个标准的工具，检查核心网站的生命体征评分。然而，这是单个数据点的分数。如果我们想从真实的体验得分中评估网站的重要指标，Vercel analytics允许我们通过收集访问者访问页面时的指标来衡量网站的性能。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi on"><img src="../Images/2dce3c02024a61a51f27c7f0a0654f51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Aayz88t1xw9ykEbxNHewhg.png"/></div></div><figcaption class="nu nv gj gh gi nw nx bd b be z dk"><strong class="bd ok">Figure 12</strong> Enable Vercel Analytics</figcaption></figure><p id="be82" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">在Vercel上设置Vercel Analytics非常容易，我们只需在目标项目的Analytics选项卡中启用它。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oo"><img src="../Images/f5da51f3cb47617651f9c1c8a7799ada.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*T5S_-P0mwq8gG313Nzg1qA.png"/></div></div><figcaption class="nu nv gj gh gi nw nx bd b be z dk"><strong class="bd ok">Figure 13</strong> Performance report from Vercel Analytics</figcaption></figure><p id="c181" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">由于Vercel Analytics从访问者的访问中收集性能分数，我们需要访问页面几次，数据才会出现在仪表板中。</p><h1 id="ed40" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">结论</h1><p id="e9e7" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">在这个故事中，我们经历了使用Next.js创建渐进式Web应用程序的整个过程，以在Google Lighthouse、Next.js Analytics和webpagetest.org的band A+ security中获得100%的分数。我希望这能成为你惊人项目的一个好的开始！</p><p id="a4f0" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">源代码可以在<a class="ae nd" href="https://github.com/rockyliyanlok/nextjs-100-ts" rel="noopener ugc nofollow" target="_blank">这个库</a>中找到。你可以随意派生存储库或者开始你的Next.js项目。</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="7090" class="nj ks iq nf b gy nk nl l nm nn">$ yarn create next-app -e <a class="ae nd" href="https://github.com/rockyliyanlok/nextjs-100-ts" rel="noopener ugc nofollow" target="_blank">https://github.com/rockyliyanlok/nextjs-100-ts</a></span></pre><p id="e5d7" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">编码快乐！💻</p><p id="3e84" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated"><em class="nr">更多内容请看</em><a class="ae nd" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="ll ir"><em class="nr">plain English . io</em></strong></a><em class="nr">。报名参加我们的</em> <a class="ae nd" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ll ir"> <em class="nr">免费周报</em> </strong> </a> <em class="nr">。关注我们关于</em><a class="ae nd" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="ll ir"><em class="nr">Twitter</em></strong></a><em class="nr">和</em><a class="ae nd" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="ll ir"><em class="nr">LinkedIn</em></strong></a><em class="nr">。加入我们的</em> <a class="ae nd" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="ll ir"> <em class="nr">社区不和谐</em> </strong> </a> <em class="nr">。</em></p><h2 id="abef" class="nj ks iq bd kt ny nz dn kx oa ob dp lb ls oc od ld lw oe of lf ma og oh lh oi bi translated">进一步阅读</h2><div class="mk ml gp gr mm mn"><a rel="noopener  ugc nofollow" target="_blank" href="/typescript-made-easy-a-guide-to-your-first-type-safe-app-with-next-js-wundergraph-and-prisma-e197a59e2b30"><div class="mo ab fo"><div class="mp ab mq cl cj mr"><h2 class="bd ir gy z fp ms fr fs mt fu fw ip bi translated">轻松编写类型脚本:使用Next.js、WunderGraph和Prisma编写第一个类型安全应用程序的指南</h2><div class="mu l"><h3 class="bd b gy z fp ms fr fs mt fu fw dk translated">是时候抛开恐惧，学习TypeScript了。让我们给你第一次“发现！”瞬间通过建立一个完整的…</h3></div><div class="mv l"><p class="bd b dl z fp ms fr fs mt fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="mw l"><div class="op l my mz na mw nb kp mn"/></div></div></a></div></div></div>    
</body>
</html>