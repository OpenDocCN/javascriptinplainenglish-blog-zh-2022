<html>
<head>
<title>Use AdminJS to Quickly Build an Administration Web App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用AdminJS快速构建管理Web应用程序</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/use-adminjs-to-quickly-build-an-administration-web-app-1a6421fe7864?source=collection_archive---------1-----------------------#2022-01-28">https://javascript.plainenglish.io/use-adminjs-to-quickly-build-an-administration-web-app-1a6421fe7864?source=collection_archive---------1-----------------------#2022-01-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="4c5e" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">图书馆能为我们节省时间</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/f13546106f8f57c55202b44f6ddabda1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*a67LRHr9V-cZ1x04"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@clark_fransa?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Arnold Francisca</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h2 id="b2a9" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">介绍</h2><p id="7d28" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma lf mb mc md lj me mf mg ln mh mi mj mk ij bi translated">在web项目中，除了前台——用户界面，我们还有后台——管理员界面。这是我们执行CRUD操作的地方。这个页面主要由数据表和编辑表单组成，通常由“有经验的用户”使用。此外，项目中分配给它的时间也少于前台页面。因此，一个明显的需要是一个工具，<strong class="lu ir">减少时间和精力</strong>来建立管理页面。</p><p id="ce3a" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">在本文中，我将使用<a class="ae kv" href="https://adminjs.co/" rel="noopener ugc nofollow" target="_blank"> AdminJS </a>构建一个管理web应用程序。我就拿招聘管理应用来介绍一下图书馆的一些概念。该应用程序具有以下特性:</p><ul class=""><li id="8502" class="mq mr iq lu b lv ml ly mm lf ms lj mt ln mu mk mv mw mx my bi translated">管理未结职位</li><li id="d4fc" class="mq mr iq lu b lv mz ly na lf nb lj nc ln nd mk mv mw mx my bi translated">管理电子邮件模板并向候选人发送电子邮件</li><li id="9df7" class="mq mr iq lu b lv mz ly na lf nb lj nc ln nd mk mv mw mx my bi translated">管理候选人和面试</li></ul><p id="05a3" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">我们将实施一个简单的招聘流程，包括3个步骤:检查简历，面试，并提供。它是一个CRUD+应用程序，90%的特性都是CRUD。“plus”部分是执行招聘流程逻辑，并向候选人发送电子邮件。到本文结束时，您将理解一些关键概念，并能够使用AdminJS来加速您的项目。除了AdminJS，这个应用程序还使用了web开发中的一些流行技术:<strong class="lu ir"> Node.js、Express、React、MongoDB。</strong>这里是应用程序的一些页面。我们会在最后得到它们。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ne"><img src="../Images/d1e16c353b83f38d4be058a767e52604.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TJsqiSMJ9Vd1IX8Plu40ng.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">List of candidates screen.</figcaption></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/e883e7f55db649bc4389e9b997d808c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Uhbr013nmlqWV3LhmfckVg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Edit candidate screen.</figcaption></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ng"><img src="../Images/8657741631e352e542e62cf21811e288.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*grDB-zHyI-cL3aFrErOang.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Prepare for interview schedule and email.</figcaption></figure><p id="6f4c" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">你准备好了吗？我们走吧！</p><h2 id="d463" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">入门—设置项目</h2><p id="562c" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma lf mb mc md lj me mf mg ln mh mi mj mk ij bi translated">除了上面列出的一些库，我们还有AdminJS团队推荐的用于解析传入请求的<code class="fe nh ni nj nk b">express-formidable</code>。我们还使用<code class="fe nh ni nj nk b">dotenv</code>来管理环境变量，<code class="fe nh ni nj nk b">nodemailer</code>来发送电子邮件，<code class="fe nh ni nj nk b">nodemon</code>来根据变化自动重新加载应用程序。</p><pre class="kg kh ki kj gt nl nk nm nn aw no bi"><span id="d2e4" class="kw kx iq nk b gy np nq l nr ns">mkdir hiring-adminjs</span><span id="4145" class="kw kx iq nk b gy nt nq l nr ns">cd hiring-adminjs</span><span id="03b9" class="kw kx iq nk b gy nt nq l nr ns">npm init -y</span><span id="1325" class="kw kx iq nk b gy nt nq l nr ns">npm i --save express mongoose adminjs @adminjs/express @adminjs/mongoose express-formidable dotenv nodemailer nodemon</span></pre><p id="6042" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">说到文件夹架构，<a class="ae kv" href="https://github.com/goldbergyoni/nodebestpractices/blob/master/sections/projectstructre/breakintcomponents.md" rel="noopener ugc nofollow" target="_blank">我们就按组件来组织</a>。在顶层，我们用<strong class="lu ir"> app.js </strong>来运行服务器，用<strong class="lu ir"> config.js </strong>来管理应用程序的配置。</p><pre class="kg kh ki kj gt nl nk nm nn aw no bi"><span id="a7cf" class="kw kx iq nk b gy np nq l nr ns">hiring-adminjs<br/>-app.js<br/>-config.js<br/>-.env</span></pre><p id="60da" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">在<strong class="lu ir"> config.js </strong>文件中，我们读取环境变量和导出，因此项目中的每个文件都可以使用它们。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="3be8" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">在<strong class="lu ir"> app.js </strong>文件中，除了经典的Express样板代码之外，我们还需要AdminJS相关的库(第4–7行)，然后初始化AdminJS实例(第13行)并将AdminJS路由挂载到Express应用程序(第21行)。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="495b" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">通过键入<code class="fe nh ni nj nk b">nodemon app.js</code>运行应用程序，然后转到<code class="fe nh ni nj nk b">localhost:8080/admin</code>，您将看到AdminJS的默认屏幕。</p><p id="2967" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated"><strong class="lu ir">恭喜恭喜</strong>！您只需设置应用程序的主干并运行它。让我们转到下一部分，在那里我们将添加功能。</p><h2 id="da11" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">功能1 —管理未结头寸—管理基础知识</h2><p id="0ea4" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma lf mb mc md lj me mf mg ln mh mi mj mk ij bi translated">对于实体<code class="fe nh ni nj nk b">Position</code>，我们需要基本的CRUD操作。AdminJS帮助我们在不到5分钟的时间内完成这项工作。</p><pre class="kg kh ki kj gt nl nk nm nn aw no bi"><span id="624d" class="kw kx iq nk b gy np nq l nr ns">mkdir position<br/>touch position/position.model.js<br/>touch position/position.options.js</span></pre><p id="672f" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">在文件<strong class="lu ir"> position.model.js </strong>中，我们将实体<code class="fe nh ni nj nk b">Position</code>的模式定义为普通应用。PositionSchema只包含<code class="fe nh ni nj nk b">name</code>字段。例如，我们可以有初级Web开发人员、项目经理等…</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="11a7" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">在文件<strong class="lu ir"> position.options.js </strong>中，我们为实体<code class="fe nh ni nj nk b">Position</code>定义了选项，AdminJS将使用该文件中的选项来渲染界面。在最简单的形式中，选项只有一个字段<code class="fe nh ni nj nk b">resource</code>,指向我们上面定义的模型。所以我们在界面中看到和操作的数据会来自并保存到相应的集合中。AdminJS允许我们定制资源，我们会在需要的时候做。目前，下面的代码已经足够了。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="37b9" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">在主文件<strong class="lu ir"> app.js </strong>中，我们需要<strong class="lu ir"> position.options.js </strong>文件，然后将<code class="fe nh ni nj nk b">PositionResourceOptions</code>添加到AdminJS的资源选项中。</p><pre class="kg kh ki kj gt nl nk nm nn aw no bi"><span id="b5bb" class="kw kx iq nk b gy np nq l nr ns">....<br/>const { PositionResourceOptions } = require("./position/position.options");<br/>....<br/>const adminJS = new AdminJS({<br/>  databases: [],<br/>  rootPath: '/admin',<br/>  resources: [PositionResourceOptions]<br/>});<br/>...</span></pre><p id="3560" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">重新加载应用程序并刷新页面，您将在左侧菜单中看到条目<code class="fe nh ni nj nk b">Position</code>。点击你看到的那一行<code class="fe nh ni nj nk b">Position</code>列表。目前，它是空的。您可以开始添加新条目，然后查看单个条目，编辑并删除它。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nw"><img src="../Images/84c01bd3a583186c9ae6f836d646057f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CvILAlhOe3RKO2dT4FXroQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">The listing screen has been done by AdminJS.</figcaption></figure><p id="f135" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">我们刚刚用几个代码完成了“管理未结头寸”功能！CRUD API和接口都是AdminJS做的。</p><h2 id="03c6" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">功能2 —管理并向候选人发送电子邮件—向AdminJS添加自定义代码</h2><p id="35be" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma lf mb mc md lj me mf mg ln mh mi mj mk ij bi translated">此功能帮助我们定义一些电子邮件模板，并在以下情况下向候选人发送电子邮件:</p><ul class=""><li id="5fcb" class="mq mr iq lu b lv ml ly mm lf ms lj mt ln mu mk mv mw mx my bi translated">候选人的简历很好，我们邀请候选人面试。</li><li id="8dc7" class="mq mr iq lu b lv mz ly na lf nb lj nc ln nd mk mv mw mx my bi translated">候选人的简历不合适。我们通知候选人。</li><li id="a000" class="mq mr iq lu b lv mz ly na lf nb lj nc ln nd mk mv mw mx my bi translated">面试进行得很顺利。我们联系候选人进行进一步的交流。</li><li id="14a5" class="mq mr iq lu b lv mz ly na lf nb lj nc ln nd mk mv mw mx my bi translated">面试不好。我们通知候选人。</li></ul><p id="8a9c" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated"><strong class="lu ir">管理电子邮件模板</strong></p><p id="428b" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">我们为特征创建文件夹和必要的文件。每个文件的作用都在注释中</p><pre class="kg kh ki kj gt nl nk nm nn aw no bi"><span id="66b2" class="kw kx iq nk b gy np nq l nr ns">mkdir email<br/>touch email/email.model.js # The schema of email entity<br/>touch email/email.options.js # Used by AdminJS to render the GUI<br/>touch email/email.sender.js # Reponsible for sending email<br/>touch email/email.route.js # Expose the API to be called by the frontend</span></pre><p id="7c76" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">电子邮件模式将包含模板名称、主题和电子邮件正文。</p><pre class="kg kh ki kj gt nl nk nm nn aw no bi"><span id="eb0f" class="kw kx iq nk b gy np nq l nr ns">const mongoose = require('mongoose');<br/>const EmailSchema = new mongoose.Schema({<br/>  name: { type: String },<br/>  subject: { type: String },<br/>  body: { type: String },<br/>});<br/>const Email = mongoose.model('Email', EmailSchema);</span><span id="c985" class="kw kx iq nk b gy nt nq l nr ns">module.exports = {<br/>  EmailSchema,<br/>  Email<br/>}</span></pre><p id="d90c" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">我们对<strong class="lu ir"> email.options.js </strong>使用了前面特性中的相同代码。唯一的区别是对邮件正文使用类型<code class="fe nh ni nj nk b">richtext</code>。AdminJS将对这种类型的字段使用WYSIWYG编辑器。</p><pre class="kg kh ki kj gt nl nk nm nn aw no bi"><span id="2925" class="kw kx iq nk b gy np nq l nr ns">const { Email } = require("./email.model");<br/>const EmailResourceOptions = {<br/>  resource: Email,<br/>  options: {<br/>    properties: {<br/>      body: {<br/>       type: "richtext",<br/>      }<br/>    }<br/>  },<br/>}</span><span id="0d24" class="kw kx iq nk b gy nt nq l nr ns">module.exports = {<br/>  EmailResourceOptions<br/>}</span></pre><p id="e6ba" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">和上面一样，我们需要将<code class="fe nh ni nj nk b">EmailResourceOptions</code>添加到<strong class="lu ir"> app.js </strong>中AdminJS的<code class="fe nh ni nj nk b">resources</code>属性中。重新加载应用程序，您现在可以通过单击左侧菜单中的新条目来查看电子邮件模板列表。在这个屏幕上，您可以创建和编辑我们上面提到的4个模板。这是编辑邀请候选人面试的电子邮件模板的屏幕。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/1042ebce8272289d758ecb7d9fb7e5cd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CAVkO9_FIV7Vkuufw3v4rQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Edit email template screen.</figcaption></figure><p id="d705" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated"><strong class="lu ir">实现API发送邮件</strong></p><p id="736e" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">创建完所有模板后，现在我们需要准备发送电子邮件的API。API接受3个参数:<code class="fe nh ni nj nk b">receivers</code>、<code class="fe nh ni nj nk b">subject</code>和<code class="fe nh ni nj nk b">body</code>，分别用于发送邮件的地址、主题和邮件内容。下面是文件<strong class="lu ir"> email.route.js </strong>中的代码。</p><pre class="kg kh ki kj gt nl nk nm nn aw no bi"><span id="2444" class="kw kx iq nk b gy np nq l nr ns">const express = require("express");<br/>const router = express.Router();<br/>const sender = require("./email.sender");</span><span id="5a9a" class="kw kx iq nk b gy nt nq l nr ns">router.post("/sendEmail", function (req, res, next) {</span><span id="d319" class="kw kx iq nk b gy nt nq l nr ns">  try {<br/>    const sendEmailRequest = {<br/>      receivers: req.body.receivers,<br/>      subject: req.body.subject,<br/>      body: req.body.body,<br/>  }</span><span id="cacf" class="kw kx iq nk b gy nt nq l nr ns">  sender.sendEmail(sendEmailRequest);<br/>  res.json({ success: true });</span><span id="bbe9" class="kw kx iq nk b gy nt nq l nr ns">  } catch (error) {</span><span id="732b" class="kw kx iq nk b gy nt nq l nr ns">   next(error);<br/>  }<br/>});</span><span id="c464" class="kw kx iq nk b gy nt nq l nr ns">module.exports = router;</span></pre><p id="60f8" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">在<strong class="lu ir"> email.sender.js </strong>文件中，我们使用库<code class="fe nh ni nj nk b">nodemailer</code>。我们需要为传输实例配置主机、端口、地址和用于发送电子邮件的帐户密码。比如Gmail账号会使用<code class="fe nh ni nj nk b">smtp.gmail.com</code>作为主机，端口为<code class="fe nh ni nj nk b">587</code>。</p><pre class="kg kh ki kj gt nl nk nm nn aw no bi"><span id="990d" class="kw kx iq nk b gy np nq l nr ns">const nodemailer = require("nodemailer");<br/>const config = require("../config");<br/>const transporter = nodemailer.createTransport({<br/>  host: config.SENDER_HOST,<br/>  port: config.SENDER_PORT,<br/>  secure: false, // true for 465, false for other ports<br/>  auth: {<br/>    user: config.SENDER_ADDRESS,<br/>    pass: config.SENDER_PASSWORD<br/>  }<br/>});</span><span id="a962" class="kw kx iq nk b gy nt nq l nr ns">module.exports = {</span><span id="6c72" class="kw kx iq nk b gy nt nq l nr ns">  sendEmail: function (params) {<br/>     let { receivers, subject, body } = params;<br/>     const mailOptions = {<br/>       from:{<br/>        name: config.SENDER_NAME,<br/>        address: config.SENDER_ADDRESS,<br/>       },<br/>       to: receivers,<br/>       subject: subject,<br/>       html: body<br/>     };</span><span id="5be6" class="kw kx iq nk b gy nt nq l nr ns">     transporter.sendMail(mailOptions)<br/>       .then(() =&gt; {<br/>          console.log("Email sent");<br/>       })<br/>       .catch(error =&gt; {<br/>          console.log(`Error when send email : ${error.message}`);<br/>          throw error;<br/>       });<br/>   },<br/>};</span></pre><p id="e305" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">最后，在<strong class="lu ir"> app.js </strong>文件中，我们需要路径并挂载到应用程序。AdminJS路由和我们的自定义路由在Express服务器中共存。如果您熟悉Express内置解析器，您可以在AdminJS路由之后使用它们，如下所示。如果没有，您可以使用<code class="fe nh ni nj nk b">req.fields</code>而不是<code class="fe nh ni nj nk b">req.body</code>来访问数据，如<a class="ae kv" href="https://www.npmjs.com/package/express-formidable" rel="noopener ugc nofollow" target="_blank">express-harvardable NPM页面</a>中所述。</p><pre class="kg kh ki kj gt nl nk nm nn aw no bi"><span id="e801" class="kw kx iq nk b gy np nq l nr ns">...<br/>app.use(adminJS.options.rootPath, adminJSRouter);</span><span id="685a" class="kw kx iq nk b gy nt nq l nr ns">// custom route<br/>const emailRoute = require("./email/email.route");<br/>app.use(express.json()); // after mounting adminJS route to avoid conflict</span><span id="3c8b" class="kw kx iq nk b gy nt nq l nr ns">app.use("/emails", emailRoute);</span><span id="f561" class="kw kx iq nk b gy nt nq l nr ns">// error handler<br/>app.use(function (err, req, res, next) {</span><span id="fa82" class="kw kx iq nk b gy nt nq l nr ns">   console.error(err.stack);<br/>   res.status(500).json({ success: false, message: "INTERNAL_ERROR" });</span><span id="4deb" class="kw kx iq nk b gy nt nq l nr ns">});<br/>app.listen(8080, () =&gt; console.log('AdminJS is under localhost:8080/admin'));</span></pre><p id="9612" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">您现在可以重新加载应用程序，并通过Postman测试API。确保所有的邮件都正常。它们将在下一个功能中使用。</p><h2 id="b6c5" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">功能3 —管理候选人和面试—在AdminJS中自定义资源和操作</h2><p id="1db1" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma lf mb mc md lj me mf mg ln mh mi mj mk ij bi translated"><strong class="lu ir"> CRUD操作—定制资源</strong></p><p id="ab95" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">至此，我们已经定义了职位和电子邮件实体。它们是主要候选实体的卫星。为了简洁起见，我不会张贴重复的代码，因为您已经熟悉它了。</p><p id="bb82" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">在候选图式中，我们有<code class="fe nh ni nj nk b">name</code>、<code class="fe nh ni nj nk b">email</code>、<code class="fe nh ni nj nk b">phoneNumber</code>、<code class="fe nh ni nj nk b">position,</code>、<code class="fe nh ni nj nk b">note</code>。<code class="fe nh ni nj nk b">position</code>字段指向位置集合。</p><p id="d005" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">关于选项，我们可以自定义资源，以拥有友好的界面。</p><ul class=""><li id="67a5" class="mq mr iq lu b lv ml ly mm lf ms lj mt ln mu mk mv mw mx my bi translated">将<code class="fe nh ni nj nk b">isVisible</code>字段设置为false，隐藏所有屏幕中的字段。比如我不想看到field _id，因为它没有意义，占用空间很大。</li></ul><pre class="kg kh ki kj gt nl nk nm nn aw no bi"><span id="76d3" class="kw kx iq nk b gy np nq l nr ns">options: {<br/>  properties: {<br/>   _id: {<br/>      isVisible: false<br/>   },<br/>   ....<br/>}</span></pre><ul class=""><li id="f7ee" class="mq mr iq lu b lv ml ly mm lf ms lj mt ln mu mk mv mw mx my bi translated">对于候选人，电子邮件是必需的，并且必须是有效的。为此，我们可以使用props，就像我们将属性传递给HTML输入字段一样。</li></ul><pre class="kg kh ki kj gt nl nk nm nn aw no bi"><span id="bee5" class="kw kx iq nk b gy np nq l nr ns">options: {<br/>  properties: {<br/>   ...<br/>   email: {<br/>      props: {required: true, type : "email"}<br/>   },<br/>   ....<br/>}</span></pre><ul class=""><li id="8a40" class="mq mr iq lu b lv ml ly mm lf ms lj mt ln mu mk mv mw mx my bi translated">字段<code class="fe nh ni nj nk b">currentStage</code>定义了候选人在招聘流程中的位置。如上所述，我们的流程有3个阶段:检查简历、面试和录用。该字段有预定义值，可使用<code class="fe nh ni nj nk b">availableValues</code>列出。</li></ul><pre class="kg kh ki kj gt nl nk nm nn aw no bi"><span id="831a" class="kw kx iq nk b gy np nq l nr ns">options: {<br/>  properties: {<br/>   ...<br/>   currentStage: {<br/>       availableValues: [<br/>       { value: "CHECK_CV", label: "Application" },<br/>       { value: "CV_REJECTED", label: "CV Rejected" },<br/>       { value: "INTERVIEW", label: "Interview" },<br/>       { value: "INTERVIEW_REJECTED", label: "Interview Rejected" },<br/>       { value: "OFFER", label: "Offer" },<br/>       { value: "HIRED", label: "Hired" },<br/>   ]<br/>},<br/>   ....<br/>}</span></pre><p id="5cf3" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">正如您所猜测的，AdminJS将使用一个选择输入来呈现这个字段。这比默认输入文本更方便。显示<code class="fe nh ni nj nk b">label</code>,同时将<code class="fe nh ni nj nk b">value</code>保存到数据库中。</p><ul class=""><li id="d3be" class="mq mr iq lu b lv ml ly mm lf ms lj mt ln mu mk mv mw mx my bi translated">对于引用字段，我们需要告诉AdminJS它指向哪个集合。</li></ul><pre class="kg kh ki kj gt nl nk nm nn aw no bi"><span id="1498" class="kw kx iq nk b gy np nq l nr ns">options: {<br/>  properties: {<br/>   ...<br/>   position: {<br/>      reference: "Position"<br/>   },<br/>   ....<br/>}</span></pre><p id="2ceb" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">AdminJS将使用选择输入来呈现该字段。我们定义的所有位置都会列出来。这有助于我们避免人为错误。</p><p id="8df9" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">您可以在<a class="ae kv" href="https://docs.adminjs.co/tutorial-customizing-resources.html" rel="noopener ugc nofollow" target="_blank">文档页面</a>上看到更多选项，并根据您的需求进一步定制资源。</p><p id="96ff" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated"><strong class="lu ir">管理面试</strong></p><p id="1887" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">在实施招聘流程之前，我们需要创建实体面试。如果候选人有适合这个职位的简历，我们会安排一次面试。</p><p id="84f4" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">在面试模式中，我们有两个字段:<code class="fe nh ni nj nk b">candidateId</code>指向候选人集合，还有<code class="fe nh ni nj nk b">date</code>。因为<code class="fe nh ni nj nk b">candidateId</code>是一个参考字段，不要忘记在选项文件中定制这个字段。</p><p id="f5f1" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">向文件<strong class="lu ir"> app.js </strong>中的AdminJS选项添加2个新资源。我们在界面上有了新的屏幕。</p><p id="3ecf" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">深呼吸，我们继续这个功能的第二部分——实施招聘流程。</p><p id="af4e" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated"><strong class="lu ir">实施招聘流程—定制行动</strong></p><p id="cef4" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">AdminJS有7个预定义的动作:列表、搜索、新建、显示、编辑、删除和批量删除。对于候选人，我们将添加4个操作:拒绝简历、通过面试、面试后拒绝和面试后接受。以下是“通过面试”操作的说明。</p><p id="eaa9" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated"><strong class="lu ir">动作</strong>:通过面试</p><p id="8030" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated"><strong class="lu ir">当</strong>时:如果<code class="fe nh ni nj nk b">currentStage</code>是CV_CHECKING</p><p id="6b1d" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated"><strong class="lu ir">行为</strong>:</p><ul class=""><li id="0704" class="mq mr iq lu b lv ml ly mm lf ms lj mt ln mu mk mv mw mx my bi translated">将显示一个新屏幕，允许用户选择面试日期。</li><li id="7a0d" class="mq mr iq lu b lv mz ly na lf nb lj nc ln nd mk mv mw mx my bi translated">确认后，<code class="fe nh ni nj nk b">currentStage</code>变为面试。相应的电子邮件会在选定的日期发送到候选人的地址。</li></ul><p id="0be9" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">为了定义资源的一个动作，我们添加动作名作为<code class="fe nh ni nj nk b">actions</code>属性的一个键。该操作具有一些属性:</p><ul class=""><li id="0ff9" class="mq mr iq lu b lv ml ly mm lf ms lj mt ln mu mk mv mw mx my bi translated"><strong class="lu ir">动作类型</strong>:可以是<code class="fe nh ni nj nk b">resource</code>、<code class="fe nh ni nj nk b">record</code>或<code class="fe nh ni nj nk b">bulk</code>类型。这是行动的目标。根据该值，操作将分别触及整个集合、单个记录或一些记录。</li><li id="1768" class="mq mr iq lu b lv mz ly na lf nb lj nc ln nd mk mv mw mx my bi translated"><strong class="lu ir"> isVisible </strong>:可以是布尔值，也可以是返回布尔值的函数。我们可以用它来指定动作可能发生的条件。</li><li id="0131" class="mq mr iq lu b lv mz ly na lf nb lj nc ln nd mk mv mw mx my bi translated"><strong class="lu ir">处理器</strong>:为React组件准备数据的函数。从这个函数返回的数据可以从组件的props中访问。</li><li id="15b8" class="mq mr iq lu b lv mz ly na lf nb lj nc ln nd mk mv mw mx my bi translated"><strong class="lu ir">组件</strong>:指向React文件渲染界面。</li></ul><p id="51e0" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">对于“通过面试”活动，根据上述说明，我们有:</p><pre class="kg kh ki kj gt nl nk nm nn aw no bi"><span id="e58b" class="kw kx iq nk b gy np nq l nr ns">const isCheckingCV = ({ record }) =&gt; {<br/>  return record.params.currentStage === "CHECK_CV";<br/>}</span><span id="7872" class="kw kx iq nk b gy nt nq l nr ns">const cvResponseHandler = (request, response, context) =&gt; {<br/>   const candidate = context.record;<br/>   return {<br/>     record: candidate.toJSON(),<br/>   }<br/>};</span><span id="ed6c" class="kw kx iq nk b gy nt nq l nr ns">.....</span><span id="3e36" class="kw kx iq nk b gy nt nq l nr ns">options: {<br/>  properties: {<br/>   ....<br/>  },<br/>  actions: {<br/>    PassToInterview: {<br/>      actionType: 'record',<br/>      isVisible: isCheckingCV,<br/>      handler: cvResponseHandler,<br/>      component: AdminJS.bundle('../public/pages/cv-response'),<br/>    },<br/>}</span></pre><p id="ec74" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">因为“通过面试”和“拒绝简历”的动作非常接近。我们对他们使用相同的文件。在该文件中，我们将获得当前动作并相应地显示元素。我们需要创建一个文件夹来存储React文件。</p><pre class="kg kh ki kj gt nl nk nm nn aw no bi"><span id="8d22" class="kw kx iq nk b gy np nq l nr ns">mkdir -p public/pages<br/>touch public/pages/cv-response.jsx</span></pre><p id="7270" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">在<strong class="lu ir"> cv-response.jsx </strong>文件中，我们必须:</p><ul class=""><li id="9b16" class="mq mr iq lu b lv ml ly mm lf ms lj mt ln mu mk mv mw mx my bi translated">从props获取候选人数据</li><li id="fc1b" class="mq mr iq lu b lv mz ly na lf nb lj nc ln nd mk mv mw mx my bi translated">加载正确的电子邮件内容，并根据操作显示元素。如果简历通过，我们需要一个字段来选择面试日期。</li></ul><p id="1297" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">下面是<strong class="lu ir"> cv-response.jsx </strong>文件的概要:</p><pre class="kg kh ki kj gt nl nk nm nn aw no bi"><span id="e542" class="kw kx iq nk b gy np nq l nr ns">import ...</span><span id="8d58" class="kw kx iq nk b gy nt nq l nr ns">const CVResponse = (props) =&gt; {<br/>  const isCVAccepted = props.action.name === "PassToInterview";</span><span id="69fe" class="kw kx iq nk b gy nt nq l nr ns">  const candidate = props.record.params;<br/>  <br/>  const [subject, setSubject] = useState("");<br/>  const [body, setBody] = useState("");<br/>  const [date, setDate] = useState(new Date());</span><span id="8a34" class="kw kx iq nk b gy nt nq l nr ns">  // based on isCVAccepted value, get the right email content<br/>  function getEmailContent() {}</span><span id="a73f" class="kw kx iq nk b gy nt nq l nr ns">// utility functions<br/>  async function sendRequestCreateInterview() {}<br/>  async function sendRequestUpdateCandidate({ stage }) {}<br/>  async function sendRequestSendEmail() {}<br/>  function displayMessage() {}</span><span id="19e0" class="kw kx iq nk b gy nt nq l nr ns">  useEffect(() =&gt; getEmailContent(), []);</span><span id="271d" class="kw kx iq nk b gy nt nq l nr ns">  async function createInterview() {<br/>     try {<br/>        sendRequestCreateInterview();<br/>        await sendRequestUpdateCandidate({ stage: "INTERVIEW" });<br/>        await sendRequestSendEmail();<br/>        displayMessage("success");<br/>     } catch (error) {<br/>        displayMessage("error");<br/>     }<br/>  }</span><span id="c770" class="kw kx iq nk b gy nt nq l nr ns">  async function rejectCandidate() {<br/>     try {<br/>        await sendRequestUpdateCandidate({ stage: "CV_REJECTED" });<br/>        await sendRequestSendEmail();<br/>        displayMessage("success");<br/>     } catch (error) {<br/>        displayMessage("error");<br/>     }<br/>  }</span><span id="b8cf" class="kw kx iq nk b gy nt nq l nr ns">return (<br/>      &lt;div&gt;<br/>          {/* Display candidate info */}<br/>          {/* If isCVAccepted, display the datepicker to select     interview date */}<br/>          {/* Display email content, placeholders are filled by candidate information */}<br/>          {/* The button to confirm action  */}<br/>          {/* Other elements: message to display when action has  been done successfully or there is an error */}<br/>      &lt;/div&gt;<br/>  );<br/>}<br/>export default CVResponse;</span></pre><p id="7b54" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">重新加载应用程序，并选择一个<code class="fe nh ni nj nk b">currentStage</code>为CHECKING_CV的候选人，您将在右上角看到新的操作显示。点击按钮，显示页面<code class="fe nh ni nj nk b">cv-response.jsx</code>。</p><p id="ed89" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">其他两个动作:拒绝和面试后接受遵循相同的逻辑。您需要更改到<code class="fe nh ni nj nk b">isVisible</code>条件，并为它们创建一个新的React文件。</p><p id="6127" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">至此，您已经完成了招聘流程！虽然有很多我们可以改进的地方，但我的教程在技术上已经完成了。您可以使用上面的概念进一步定制和开发应用程序。完整代码可以参考我的Github页面<a class="ae kv" href="https://github.com/ddkhoa/hiring-adminjs" rel="noopener ugc nofollow" target="_blank">这里</a>。</p><h2 id="3b08" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">我对管理的思考</h2><ul class=""><li id="35bb" class="mq mr iq lu b lv lw ly lz lf ny lj nz ln oa mk mv mw mx my bi translated">这个库确实<strong class="lu ir">在构建后台页面方面节省了很多时间&amp;精力</strong>。一些必须做的工作已经为我们做了:基本的CRUD APIs，数据表，过滤器，编辑表单…</li><li id="16b6" class="mq mr iq lu b lv mz ly na lf nb lj nc ln nd mk mv mw mx my bi translated">如果我们将其与<a class="ae kv" href="https://themeforest.net/category/site-templates/admin-templates" rel="noopener ugc nofollow" target="_blank">市场</a>中的一些管理模板进行比较，我们会发现:<br/> +它是免费的！<br/> +它不仅提供了UI系统，还提供了后端部分。构建定制页面时，UI系统帮了我很大的忙。它很容易学习和使用。<br/>——尽管如此，AdminJS UI系统并不像模板那样丰富。例如，我必须定制消息组件，而不是使用我在使用模板时熟悉的Toastr。这是可以理解的，因为这个库不仅仅关注UI端。但我觉得如果团队能增加更多UI组件就更好了。</li><li id="cb94" class="mq mr iq lu b lv mz ly na lf nb lj nc ln nd mk mv mw mx my bi translated">整合很顺利。AdminJS代码可以与我们的代码共存。这使得无限的定制能力成为可能。</li><li id="8d7a" class="mq mr iq lu b lv mz ly na lf nb lj nc ln nd mk mv mw mx my bi translated">第一次处理资源选项，对我来说还是挺迷茫的。它们用于定义页面的外观，但位于“后端”部分。感觉后端和前端混在一起了。如果我想改变UI中的图标，我需要重启服务器。每次重启服务器时，应用程序都需要重新绑定代码。这需要一些时间。</li></ul><h2 id="97af" class="kw kx iq bd ky kz la dn lb lc ld dp le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">包裹</h2><p id="f7c3" class="pw-post-body-paragraph ls lt iq lu b lv lw jr lx ly lz ju ma lf mb mc md lj me mf mg ln mh mi mj mk ij bi translated">在本文中，我通过一个简单而现实的应用程序介绍了AdminJS库的一些基本概念。我还提到了一些优点和AdminJS可以改进的地方。我希望你能有一个额外的选择来加快你未来的项目。作为一名对管理仪表板感兴趣的开发人员，我要感谢AdminJS团队提供了一个很棒的库。我希望他们将来会增加更多很酷的功能。</p></div><div class="ab cl ob oc hu od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="ij ik il im in"><p id="6157" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated">感谢您阅读我的文章。我写关于软件工程的文章，包括附带项目、专业经验等等…目标是通过分享我所学到的东西来帮助其他开发人员。在这个列表中，你可以阅读我的其他故事:</p><p id="c15f" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated"><a class="ae kv" href="https://medium.com/@ddkhoa.blogging/list/growth-as-a-developer-68c8ff278615" rel="noopener">https://medium . com/@ DDK Hoa . blogging/list/growth-as-a-a-developer-68 c8 ff 278615</a></p><p id="32f6" class="pw-post-body-paragraph ls lt iq lu b lv ml jr lx ly mm ju ma lf mn mc md lj mo mf mg ln mp mi mj mk ij bi translated"><em class="oi">更多内容请看</em><a class="ae kv" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="lu ir"><em class="oi">plain English . io</em></strong></a><em class="oi">。报名参加我们的</em> <a class="ae kv" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="lu ir"> <em class="oi">免费周报</em> </strong> </a> <em class="oi">。在我们的</em> <a class="ae kv" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="lu ir"> <em class="oi">社区</em> </strong> </a> <em class="oi">获得独家获得写作机会和建议。</em></p></div></div>    
</body>
</html>