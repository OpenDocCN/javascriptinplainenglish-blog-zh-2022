# å¦‚ä½•ä½¿ç”¨ Redis åœ¨ NestJS ä¸­é«˜æ•ˆå®ç°ç¼“å­˜

> åŸæ–‡ï¼š<https://javascript.plainenglish.io/caching-efficiently-in-nestjs-using-redis-b3fa0c70384a?source=collection_archive---------4----------------------->

![](img/b76d4c6ae134edf43d55a21aeadac4f3.png)

ç‰¹åˆ«æ˜¯ï¼Œç¼“å­˜æœ‰åŠ©äºæé«˜åº”ç”¨ç¨‹åºçš„æ€§èƒ½ï¼Œæå¤§åœ°å¢å¼ºå…¶æœ‰æ•ˆæ€§ã€‚

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†çœ‹çœ‹å¦‚ä½•ä½¿ç”¨ Redis ä¸º NestJS é¡¹ç›®æä¾›ç¼“å­˜åŠŸèƒ½ã€‚æˆ‘ä»¬å°†è®¨è®º Redisï¼Œä»€ä¹ˆæ˜¯ç¼“å­˜ï¼Œä»¥åŠå®ç°è¿‡ç¨‹ã€‚

# ä»€ä¹ˆæ˜¯ç¼“å­˜ï¼Ÿ

ç¼“å­˜æ˜¯è®¡ç®—ä¸­é‡å¤æ•°æ®çš„ä¸´æ—¶ã€ç»å¸¸è¢«è®¿é—®çš„å­˜å‚¨åº“ã€‚ä¸ºäº†å‡å°‘å»¶è¿Ÿï¼Œæ•°æ®å­˜å‚¨åœ¨ä¸€ä¸ªå®¹æ˜“æ‰¾åˆ°çš„åœ°æ–¹ã€‚

# å’Œ Redisâ€¦

ä½œä¸ºä¸€ä¸ªæ•°æ®åº“ç¼“å­˜ï¼ŒRedis æ˜¯ä¸€ä¸ªå¼€æºçš„å†…å­˜æ•°æ®ç»“æ„å­˜å‚¨ã€‚å®ƒæ”¯æŒå„ç§æ•°æ®ç»“æ„ï¼ŒåŒ…æ‹¬åˆ—è¡¨ã€é›†åˆã€å¸¦æœ‰èŒƒå›´æŸ¥è¯¢çš„æ’åºé›†åˆã€æ•£åˆ—ç­‰ç­‰ã€‚

é€šè¿‡é™ä½ç”Ÿæˆå†…å®¹æ‰€éœ€çš„å·¥ä½œé‡ï¼Œç¼“å­˜å¯ä»¥æ˜¾è‘—æé«˜åº”ç”¨ç¨‹åºçš„é€Ÿåº¦å’Œå¯ä¼¸ç¼©æ€§ã€‚åœ¨è¿è¡Œæˆ‘ä»¬çš„æœåŠ¡å™¨åº”ç”¨ç¨‹åºçš„ä¸åŒæœåŠ¡å™¨ä¹‹é—´åˆ†å‘ Redis ç¼“å­˜å¾ˆç®€å•ã€‚

ä»‹ç»åˆ°æ­¤ç»“æŸâ€¦è®©æˆ‘ä»¬æ·±å…¥ç ”ç©¶ä½¿ç”¨ Redis çš„ NestJS ç¼“å­˜å§ï¼:)

## è®¾ç½® NestJS åº”ç”¨ç¨‹åº

è®©æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªç®€å•çš„ NestJs åº”ç”¨ç¨‹åºã€‚

```
$ npm i -g @nestjs/cli
$ nest new nest-cache
```

![](img/935d7d9e5fd07df30ebf761d9ba7dc86.png)

ç°åœ¨æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºå·²ç»åˆ›å»ºå¥½äº†ï¼Œè®©æˆ‘ä»¬æ·»åŠ ä¸€ä¸ª Todo æ¨¡å—ï¼

```
$ nest g resource todo
```

æ­¤æ—¶ï¼Œå°†æ·»åŠ ä¸€ä¸ª todo æ§åˆ¶å™¨ã€æœåŠ¡ã€dto å’Œå®ä½“ã€‚ä½†æ˜¯è°åœ¨ä¹å‘¢ï¼Ÿé‚£ä¸æ˜¯æœ¬æ–‡çš„é‡ç‚¹ï¼ğŸ˜Š

## è¿™å°±æ˜¯ä½ ä¸€ç›´åœ¨ç­‰å¾…çš„ï¼Œç¼“å­˜ï¼

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ç¼“å­˜ç®¡ç†å™¨ã€‚å‘ bryandonovan å–Šå‡ºè¿™ä¸ªä»¤äººæ•¬ç•çš„åŒ…ï¼

> *Cache-Manager æ˜¯ nodejs çš„ä¸€ä¸ªç¼“å­˜æ¨¡å—ï¼Œå…è®¸åœ¨ç¼“å­˜ã€åˆ†å±‚ç¼“å­˜å’Œä¸€è‡´çš„æ¥å£ä¸­è½»æ¾åŒ…è£…åŠŸèƒ½ã€‚â€” Bryandonovan*

è¦å®‰è£…ç¼“å­˜ç®¡ç†å™¨ï¼Œè¯·è¿è¡Œ:

```
$ npm install cache-manager cache-manager-redis-store
```

ä½œä¸ºå¥–åŠ±ï¼Œæˆ‘ä»¬å°†æ·»åŠ  ConfigModule æ¥ä»æ–‡ä»¶ä¸­æå–`.env`å¸¸é‡ã€‚

```
$ npm install @nestjs/config
```

æˆ‘å°†æ·»åŠ ä¸€ä¸ªæ–°æ¨¡å—`redis-cache`ï¼Œå®ƒå°†å¤„ç†æ‰€æœ‰ redis-abstracted æ“ä½œ(è¿™ä¸æ˜¯å¼ºåˆ¶æ€§çš„ï¼Œåªæ˜¯åå¥½)ã€‚

ç”¨`redis-cache.service.ts`å’Œ`redis-cache.module.ts`åœ¨æºæ–‡ä»¶å¤¹ä¸­æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹`redis-cache`ã€‚

æ­¤æ—¶ï¼Œæ‚¨åº”è¯¥æœ‰ä¸€ä¸ªç±»ä¼¼å¦‚ä¸‹çš„æ–‡ä»¶ç»“æ„:

![](img/600576f3acc80958b42f3e4a02f142d6.png)

å°†ä¸‹é¢è¿™æ®µä»£ç æ·»åŠ åˆ°æ‚¨çš„`todo.module.ts`ä¸­ï¼Œå¹¶å°†`Redis-cache`æ¨¡å—æ³¨å…¥`todo.service.ts`

å·®ä¸å¤šå°±æ˜¯è¿™æ ·ï¼Œæ˜¯çš„ï¼Œä½ åšåˆ°äº†ï¼Œæˆ‘ä»¬æœ€å–œæ¬¢çš„ç¼“å­˜å¤§å¸ˆ:)ï¼

å¯åŠ¨åº”ç”¨ç¨‹åºã€‚

```
$ npm start
```

å®Œæ•´çš„æºä»£ç å¯åœ¨[è¿™é‡Œ](https://github.com/airscholar/nest-cache)è·å¾—ã€‚

æ„Ÿè°¢æ‚¨çš„é˜…è¯»ğŸ™ğŸ»ã€‚

å¦‚æœä½ æƒ³äº†è§£ NestJSã€DynamoDB å’Œ Serverlessï¼Œ[æŸ¥çœ‹è¿™ç¯‡æ–‡ç« ](https://medium.com/@airscholar/nestjs-application-with-dynamodb-and-serverless-framework-on-aws-a-step-by-step-guide-c4a3413f731d)ã€‚

*æ›´å¤šå†…å®¹è¯·çœ‹*[***plain English . io***](https://plainenglish.io/)*ã€‚*

*æŠ¥åå‚åŠ æˆ‘ä»¬çš„* [***å…è´¹æ¯å‘¨ç®€è®¯***](http://newsletter.plainenglish.io/) *ã€‚å…³æ³¨æˆ‘ä»¬å…³äº* [***æ¨ç‰¹***](https://twitter.com/inPlainEngHQ)[***LinkedIn***](https://www.linkedin.com/company/inplainenglish/)*[***YouTube***](https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw)*[***ä¸å’Œ***](https://discord.gg/GtDtUAvyhW) ***ã€‚*****

*****å¯¹ç¼©æ”¾æ‚¨çš„è½¯ä»¶å¯åŠ¨æ„Ÿå…´è¶£*** *ï¼Ÿæ£€æŸ¥* [***ç”µè·¯***](https://circuit.ooo?utm=publication-post-cta) *ã€‚***