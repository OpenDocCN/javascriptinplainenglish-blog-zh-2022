<html>
<head>
<title>Everything You Need to Know About Web Push on iOS/macOS</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">关于iOS/macOS上的网络推送，您需要了解的一切</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/everything-you-need-to-know-about-web-push-on-ios-macos-5a4b3b715b24?source=collection_archive---------4-----------------------#2022-06-08">https://javascript.plainenglish.io/everything-you-need-to-know-about-web-push-on-ios-macos-5a4b3b715b24?source=collection_archive---------4-----------------------#2022-06-08</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/56be7a0ff1258ea6df3a7856784f3fa8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xF_Qx7V2zBt1zgGEtUj6mQ.jpeg"/></div></div></figure><blockquote class="jv jw jx"><p id="c5e8" class="jy jz ka kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">凯文·巴塞特(Kevin Basset)是Progressier(T1)的创始人，这是一个软件工具包，被5000多个应用程序用来将自己从应用程序商店中解放出来。</p></blockquote><p id="0ce4" class="pw-post-body-paragraph jy jz in kb b kc kd ke kf kg kh ki kj ky kl km kn kz kp kq kr la kt ku kv kw ig bi translated">苹果<a class="ae kx" href="https://twitter.com/jensimmons/status/1533893843799748610" rel="noopener ugc nofollow" target="_blank">在WWDC22 </a>上宣布网页推送终于要来Safari了。macOS上的Safari 16 Beta已经有了。明年，它也将登陆iOS和iPadOS。</p><figure class="lb lc ld le gt jo"><div class="bz fp l di"><div class="lf lg l"/></div></figure><p id="837f" class="pw-post-body-paragraph jy jz in kb b kc kd ke kf kg kh ki kj ky kl km kn kz kp kq kr la kt ku kv kw ig bi translated">万岁！在<a class="ae kx" href="https://progressier.com?ref=wwdc22" rel="noopener ugc nofollow" target="_blank"> Progressier </a>，iOS推送通知是迄今为止最受欢迎的功能。这是有充分理由的——pwa是标准Google Play/App Store应用范例的日益可行的替代方案:</p><ul class=""><li id="0d54" class="lh li in kb b kc kd kg kh ky lj kz lk la ll kw lm ln lo lp bi translated">PWA只需要一个代码库</li><li id="c74e" class="lh li in kb b kc lq kg lr ky ls kz lt la lu kw lm ln lo lp bi translated">更新不需要批准。</li><li id="1ae9" class="lh li in kb b kc lq kg lr ky ls kz lt la lu kw lm ln lo lp bi translated">应用内购买没有高额佣金</li><li id="6042" class="lh li in kb b kc lq kg lr ky ls kz lt la lu kw lm ln lo lp bi translated">PWAs可以通过编程方式<a class="ae kx" href="https://progressier.com/features/programmatic-pwa-creation" rel="noopener ugc nofollow" target="_blank">创建</a></li><li id="c361" class="lh li in kb b kc lq kg lr ky ls kz lt la lu kw lm ln lo lp bi translated">没有人能禁止你的PWA。它生活在免费网络上。</li></ul><p id="f114" class="pw-post-body-paragraph jy jz in kb b kc kd ke kf kg kh ki kj ky kl km kn kz kp kq kr la kt ku kv kw ig bi translated">推送通知是一个瓶颈。以前只能在Android、Windows和macOS上使用(通过Chrome)，在iOS上缺乏支持意味着整个平台根本不可能发送通知。</p><p id="861a" class="pw-post-body-paragraph jy jz in kb b kc kd ke kf kg kh ki kj ky kl km kn kz kp kq kr la kt ku kv kw ig bi translated">有了苹果对网络推送的支持，你可以说没有什么可以用本地应用做的事情是PWA做不到的。</p><h1 id="fb7e" class="lv lw in bd lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms bi translated">Safari什么时候可以使用Web Push？</h1><p id="092c" class="pw-post-body-paragraph jy jz in kb b kc mt ke kf kg mu ki kj ky mv km kn kz mw kq kr la mx ku kv kw ig bi translated">我们不知道开发者什么时候能够提示普通大众允许Safari上的通知。但我们知道的是:</p><ul class=""><li id="cd83" class="lh li in kb b kc kd kg kh ky lj kz lk la ll kw lm ln lo lp bi translated">macOS Ventura上的<a class="ae kx" href="https://webkit.org/blog/12824/news-from-wwdc-webkit-features-in-safari-16-beta/" rel="noopener ugc nofollow" target="_blank"> Safari 16 Beta </a>中提供网页推送。测试版今天可以下载。</li><li id="9227" class="lh li in kb b kc lq kg lr ky ls kz lt la lu kw lm ln lo lp bi translated">网页推送将于2023年<a class="ae kx" href="https://twitter.com/jensimmons/status/1533908770853638147" rel="noopener ugc nofollow" target="_blank">来到iOS 16</a>。</li></ul><p id="ac00" class="pw-post-body-paragraph jy jz in kb b kc kd ke kf kg kh ki kj ky kl km kn kz kp kq kr la kt ku kv kw ig bi translated">由此，我们可以对一般可用性进行一些有根据的猜测。</p><ul class=""><li id="1a67" class="lh li in kb b kc kd kg kh ky lj kz lk la ll kw lm ln lo lp bi translated">Safari 15于2021年9月20日发布。</li><li id="cdc0" class="lh li in kb b kc lq kg lr ky ls kz lt la lu kw lm ln lo lp bi translated">Safari 14于2020年9月16日发布。</li><li id="1f18" class="lh li in kb b kc lq kg lr ky ls kz lt la lu kw lm ln lo lp bi translated">Safari 13于2019年9月19日发布。</li></ul><p id="da96" class="pw-post-body-paragraph jy jz in kb b kc kd ke kf kg kh ki kj ky kl km kn kz kp kq kr la kt ku kv kw ig bi translated">可以肯定的是，Safari 16将在2022年9月15日至9月25日期间公开发布。</p><p id="078a" class="pw-post-body-paragraph jy jz in kb b kc kd ke kf kg kh ki kj ky kl km kn kz kp kq kr la kt ku kv kw ig bi translated">此外，到目前为止，只宣布了macOS Ventura上Safari的网络推送。Maximiliano Firtman问当Safari 16发布时，macOS Monterey或更老的macOS版本是否也可以使用该功能。T2的回应似乎是否定的——至少目前是这样。</p><p id="6aa8" class="pw-post-body-paragraph jy jz in kb b kc kd ke kf kg kh ki kj ky kl km kn kz kp kq kr la kt ku kv kw ig bi translated">那么macOS Ventura什么时候发布呢？</p><ul class=""><li id="2306" class="lh li in kb b kc kd kg kh ky lj kz lk la ll kw lm ln lo lp bi translated">2021年10月25日，马科斯·蒙特利上映。</li><li id="d44a" class="lh li in kb b kc lq kg lr ky ls kz lt la lu kw lm ln lo lp bi translated">macOS Big Sur于2020年11月12日发布。</li><li id="68d3" class="lh li in kb b kc lq kg lr ky ls kz lt la lu kw lm ln lo lp bi translated">macOS Catalina于2019年10月7日发布。</li></ul><p id="b536" class="pw-post-body-paragraph jy jz in kb b kc kd ke kf kg kh ki kj ky kl km kn kz kp kq kr la kt ku kv kw ig bi translated">因此，保守估计，一旦macOS Ventura和Safari 16都可用，Web Push在macOS上的全面可用时间大约是2022年11月15日。</p><p id="e4f8" class="pw-post-body-paragraph jy jz in kb b kc kd ke kf kg kh ki kj ky kl km kn kz kp kq kr la kt ku kv kw ig bi translated">iOS 16很可能会在2022年9月和Safari 16一起发布。然而，苹果<a class="ae kx" href="https://twitter.com/jensimmons/status/1533908770853638147" rel="noopener ugc nofollow" target="_blank">明确表示</a>iOS上的网络推送将是以后更新的一部分(不是16.0)。通常每月都会有<a class="ae kx" href="https://en.wikipedia.org/wiki/IOS_version_history#iOS_16_/_iPadOS_16" rel="noopener ugc nofollow" target="_blank">到两月一次的iOS更新</a>。我们不知道哪个会包含推送通知功能。但它会在2023年的某个时候到来。我的钱是2023年3/4月底的。</p><h1 id="3f0a" class="lv lw in bd lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms bi translated">在iOS上实现Web推送需要做什么？</h1><p id="2a08" class="pw-post-body-paragraph jy jz in kb b kc mt ke kf kg mu ki kj ky mv km kn kz mw kq kr la mx ku kv kw ig bi translated">这一次，苹果似乎遵循了W3C的规范。因此不需要像以前一样<a class="ae kx" href="https://twitter.com/kvnbsst/status/1533991902973861888" rel="noopener ugc nofollow" target="_blank">实现. P12证书</a>。使用推送通知也不一定要成为Apple Developer Program会员。</p><p id="257e" class="pw-post-body-paragraph jy jz in kb b kc kd ke kf kg kh ki kj ky kl km kn kz kp kq kr la kt ku kv kw ig bi translated">对于开发人员来说，让他们的应用程序兼容iOS、iPadOS和macOS上的Web Push应该不需要太多工作。</p><p id="bda3" class="pw-post-body-paragraph jy jz in kb b kc kd ke kf kg kh ki kj ky kl km kn kz kp kq kr la kt ku kv kw ig bi translated">然而，如果您的推送实现先前通过浏览器检测排除了Safari，您将需要切换到功能检测来使其工作。下面是一个JavaScript函数的示例，它告诉您当前浏览器是否与推送通知兼容:</p><figure class="lb lc ld le gt jo"><div class="bz fp l di"><div class="my lg l"/></div></figure><p id="fa2a" class="pw-post-body-paragraph jy jz in kb b kc kd ke kf kg kh ki kj ky kl km kn kz kp kq kr la kt ku kv kw ig bi translated">以上目前在Safari上返回<strong class="kb io"> false </strong>，在Safari 16上应该会返回<strong class="kb io"> true </strong>。</p><p id="7e4f" class="pw-post-body-paragraph jy jz in kb b kc kd ke kf kg kh ki kj ky kl km kn kz kp kq kr la kt ku kv kw ig bi translated">其次，如果你在你的服务器上管理推送端点，你也必须允许来自<strong class="kb io">push.apple.com</strong>的任何子域的URL。</p><div class="mz na gp gr nb nc"><a href="https://developer.apple.com/videos/play/wwdc2022/10098" rel="noopener  ugc nofollow" target="_blank"><div class="nd ab fo"><div class="ne ab nf cl cj ng"><h2 class="bd io gy z fp nh fr fs ni fu fw im bi translated">满足Safari的Web推送- WWDC22 -视频-苹果开发者</h2><div class="nj l"><h3 class="bd b gy z fp nh fr fs ni fu fw dk translated">通过web Push，在macOS上的Safari中为您的网站和Web应用程序带来更好的通知。我们将向您展示如何…</h3></div><div class="nk l"><p class="bd b dl z fp nh fr fs ni fu fw dk translated">developer.apple.com</p></div></div></div></a></div><h1 id="3115" class="lv lw in bd lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms bi translated">PWAs会被允许在iOS上使用Web Push吗？</h1><p id="b258" class="pw-post-body-paragraph jy jz in kb b kc mt ke kf kg mu ki kj ky mv km kn kz mw kq kr la mx ku kv kw ig bi translated">正如Arye Shalev 指出的那样，在iOS上，pwa是Safari一旦添加到主屏幕后的孤立实例。他们还能访问Web推送API吗？我们还不知道。但如果答案最终是“不”，将会有一些值得注意的后果:</p><ol class=""><li id="a9c5" class="lh li in kb b kc kd kg kh ky lj kz lk la ll kw nl ln lo lp bi translated">开发者将不得不实现一个新的流程，他们要求用户在安装PWA之前允许通知——因为一旦应用程序安装完毕，就不可能再要求他们了。</li><li id="230f" class="lh li in kb b kc lq kg lr ky ls kz lt la lu kw nl ln lo lp bi translated">当用户点击推送通知时，它将打开Safari而不是已安装的PWA。</li></ol><h1 id="c27d" class="lv lw in bd lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms bi translated">哪些推送服务可以在iOS上使用Web Push？</h1><p id="45ee" class="pw-post-body-paragraph jy jz in kb b kc mt ke kf kg mu ki kj ky mv km kn kz mw kq kr la mx ku kv kw ig bi translated"><a class="ae kx" href="https://progressier.com?ref=wwdc22a" rel="noopener ugc nofollow" target="_blank"> Progressier </a>已经兼容。在Safari 16和iOS 16全面上市之前，其他推送服务，如<a class="ae kx" href="https://onesignal.com/" rel="noopener ugc nofollow" target="_blank"> OneSignal </a>、<a class="ae kx" href="https://firebase.google.com/products/in-app-messaging/" rel="noopener ugc nofollow" target="_blank"> Firebase应用内消息</a>和<a class="ae kx" href="https://pushalert.co/" rel="noopener ugc nofollow" target="_blank"> PushAlert </a>很可能也会提供支持。</p><p id="17ff" class="pw-post-body-paragraph jy jz in kb b kc kd ke kf kg kh ki kj ky kl km kn kz kp kq kr la kt ku kv kw ig bi translated">换句话说，如果你使用的是第三方服务(而且<a class="ae kx" rel="noopener ugc nofollow" target="_blank" href="/building-a-push-service-that-scales-to-1m-subscribers-with-firebase-958b502a2a3d">你可能应该</a>)，那你就没什么可做的了。但是你很快就会有一批新的iOS和macOS用户——这不是很好吗？</p></div><div class="ab cl nm nn hr no" role="separator"><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr ns"/><span class="np bw bk nq nr"/></div><div class="ig ih ii ij ik"><p id="e9ef" class="pw-post-body-paragraph jy jz in kb b kc kd ke kf kg kh ki kj ky kl km kn kz kp kq kr la kt ku kv kw ig bi translated">关于iOS/macOS上即将到来的Web Push更新，您有什么问题或反馈吗？请在评论中告诉我。</p><p id="822c" class="pw-post-body-paragraph jy jz in kb b kc kd ke kf kg kh ki kj ky kl km kn kz kp kq kr la kt ku kv kw ig bi translated"><em class="ka">更内容于</em> <a class="ae kx" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kb io"> <em class="ka">普通英语</em> </strong> </a> <em class="ka">。报名参加我们的</em> <a class="ae kx" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kb io"> <em class="ka">免费周报</em> </strong> </a> <em class="ka">。</em> <a class="ae kx" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"> <strong class="kb io"> <em class="ka">推特</em> </strong> </a> <em class="ka">和</em><a class="ae kx" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kb io"><em class="ka">LinkedIn</em></strong></a><em class="ka">追随我们。查看我们的</em> <a class="ae kx" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kb io"> <em class="ka">社区不和</em> </strong> </a> <em class="ka">并加入我们的</em> <a class="ae kx" href="https://inplainenglish.pallet.com/talent/welcome" rel="noopener ugc nofollow" target="_blank"> <strong class="kb io"> <em class="ka">人才集体</em> </strong> </a> <em class="ka">。</em></p></div></div>    
</body>
</html>