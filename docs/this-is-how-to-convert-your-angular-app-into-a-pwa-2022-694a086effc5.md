# å¦‚ä½•å°†æ‚¨çš„ Angular åº”ç”¨ç¨‹åºè½¬æ¢ä¸º PWA (2022)

> åŸæ–‡ï¼š<https://javascript.plainenglish.io/this-is-how-to-convert-your-angular-app-into-a-pwa-2022-694a086effc5?source=collection_archive---------5----------------------->

## å…³äºå¦‚ä½•å°† Angular åº”ç”¨ç¨‹åºè½¬æ¢ä¸ºæ¸è¿›å¼ web åº”ç”¨ç¨‹åº(PWA)çš„æ•™ç¨‹ã€‚

ä½ å¬è¯´è¿‡ PWA çš„æˆåŠŸæ•…äº‹å—ï¼Ÿ

ä¾‹å¦‚ï¼Œå½“æ˜Ÿå·´å…‹ä» iOS åº”ç”¨ç¨‹åºè½¬æ¢åˆ° PWA æ—¶ï¼Œä»–ä»¬èƒ½å¤Ÿå°†åº”ç”¨ç¨‹åºçš„å¤§å°å‡å°‘ 99.84%ã€‚æ‚¨å¯ä»¥åœ¨æ­¤é˜…è¯»è¯¦ç»†çš„æ¡ˆä¾‹ç ”ç©¶[ã€‚](https://formidable.com/work/starbucks-progressive-web-app/)

Pinterest çš„å¹¿å‘Šæ”¶å…¥å¢é•¿äº† 44%ã€‚

æ›´ä¸ç”¨è¯´ Spotifyã€ä¼˜æ­¥ã€Twitter å’Œå…¶ä»–å·²ç»åœ¨æ¸è¿›å¼ç½‘ç»œåº”ç”¨ä¸Šå–å¾—å·¨å¤§æˆåŠŸçš„å…¬å¸äº†ã€‚

![](img/6f60cfb033808dbf7174d5ce00ccf999.png)

ä½†å³ä½¿æœ‰è¿™äº›è¯±äººçš„æˆåŠŸæ•…äº‹ï¼Œæˆ‘ä»ç„¶é‡åˆ°ä¸€äº›å…¬å¸æ­£åœ¨ä½¿ç”¨ Angularï¼Œä½†æ²¡æœ‰å°†ä»–ä»¬çš„ Angular åº”ç”¨ç¨‹åºè½¬æ¢ä¸º PWAâ€”â€”å³ä½¿åªéœ€è¦ 5 åˆ†é’Ÿæˆ–æ›´å°‘ã€‚ğŸ˜²

ä¾‹å¦‚ï¼Œæˆ‘æœ€è¿‘ä¸ºä¸¹éº¦ä¸€å®¶åä¸º [Relion](https://relion.dk) çš„åˆåˆ›å…¬å¸åšäº†ä¸€äº›[è§’åº¦å’¨è¯¢](https://danielk.tech/consulting)ã€‚ä»–ä»¬é‡åˆ°äº†è¿è¡Œæ—¶æ€§èƒ½é—®é¢˜ï¼Œæ‰“ç”µè¯ç»™æˆ‘æ¥å¸®åŠ©ä»–ä»¬ã€‚æœ‰ä¸€æ¬¡ï¼Œæˆ‘ä¸ç»æ„åœ°æåˆ°è€ƒè™‘ä½¿ç”¨ PWA æ¥æé«˜ä»–ä»¬çš„åŠ è½½æ—¶æ€§èƒ½ï¼Œå¹¶æƒŠè®¶åœ°å‘ç°ä»–ä»¬å¯¹ Angular çš„æ¸è¿›å¼ web åº”ç”¨ç¨‹åºåŠŸèƒ½äº†è§£ä¸å¤šã€‚

![](img/5d4057014a36602dc50e00a6beaee89a.png)

æ‰€ä»¥â€¦

ä»Šå¤©ï¼Œæˆ‘ä»¬å°†è®¨è®ºä½¿ç”¨ Angular service workers æ¥åˆ›å»º PWA(æ¸è¿›å¼ web åº”ç”¨ç¨‹åº)ã€‚

å‡†å¤‡å¥½äº†å—ï¼Ÿ

è®©æˆ‘ä»¬æ·±å…¥ç ”ç©¶ä¸€ä¸‹ï¼Œä»ä¼˜åŠ¿å¼€å§‹ã€‚

# æœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ

ä»¥ä¸‹æ˜¯å°† Angular åº”ç”¨ç¨‹åºè½¬æ¢æˆæ¸è¿›å¼ web åº”ç”¨ç¨‹åºçš„ä¸€äº›å¥½å¤„ã€‚

*   ç–¯ç‹‚çš„è´Ÿè½½é€Ÿåº¦æ€§èƒ½(å¦‚æœåšå¾—å¥½)ã€‚
*   ä¸€ä¸ªç±»ä¼¼åŸç”Ÿçš„åº”ç”¨ç¨‹åºï¼Œå¯ä»¥é€šè¿‡ç§»åŠ¨æµè§ˆå™¨æˆ–è°·æ­Œ Play å•†åº—(å¦‚æœä½ çŸ¥é“æ€ä¹ˆåšï¼Œè¿˜æœ‰è‹¹æœå•†åº—)è®¿é—®ã€‚
*   App store ç‹¬ç«‹æ€§ã€‚
*   èƒ½å¤Ÿç¦»çº¿æ“ä½œ(æ„Ÿè°¢æœåŠ¡äººå‘˜)ã€‚
*   é€šè¿‡æœåŠ¡äººå‘˜å‘é€æ¨é€é€šçŸ¥çš„èƒ½åŠ›ã€‚
*   æœ‰ä¸€ä¸ªè‡ªå®šä¹‰é—ªå±(åœ¨ Angular ä¸­ä¹Ÿç§°ä¸º[åº”ç”¨å¤–å£³)](https://danielk.tech/home/angular-app-shell-ultimate-guide)
*   ä»¤äººæ•¬ç•çš„æœç´¢å¼•æ“ä¼˜åŒ–å¾—åˆ†â€”â€”ä½œä¸ºå¿«é€Ÿå“åº”çš„ç½‘é¡µï¼ŒPWAs çš„å¹³å‡æœç´¢å¼•æ“ä¼˜åŒ–å¾—åˆ†ä¸º 85 åˆ†ã€‚
*   æ›´å°çš„æ–‡ä»¶å¤§å°(æœ¬åœ°åº”ç”¨æ¯” PWA éœ€è¦æ›´å¤šçš„æ•°æ®æ¥ä¸‹è½½)ã€‚
*   æ— ç—›æ›´æ–°(æœåŠ¡äººå‘˜ä¼šåœ¨åå°è‡ªåŠ¨æ›´æ–°åº”ç”¨ï¼Œæ— éœ€ç”¨æˆ·åšä»»ä½•äº‹æƒ…)ã€‚

# ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ

ç¼ºç‚¹ï¼Ÿ

å¦ç‡åœ°è¯´ï¼Œæˆ‘çŸ¥é“çš„ç¼ºç‚¹å¾ˆå°‘ã€‚

æˆ‘æ‰€çŸ¥é“çš„æœ€å¤§çš„ç¼ºç‚¹æ˜¯è‹¹æœå•†åº—çš„æ”¿ç­–ä¸å…è®¸å¼€å‘è€…å°†ä»–ä»¬çš„æ¸è¿›å¼ç½‘ç»œåº”ç”¨ç¨‹åºä½œä¸ºä¸€ä¸ªåº”ç”¨ç¨‹åºæ¥éƒ¨ç½²ã€‚

ä½ çš„åº”ç”¨åº”è¯¥åŒ…æ‹¬åŠŸèƒ½ã€å†…å®¹å’Œç”¨æˆ·ç•Œé¢ï¼Œä½¿å…¶è¶…è¶Šä¸€ä¸ªé‡æ–°åŒ…è£…çš„ç½‘ç«™ã€‚å¦‚æœä½ çš„åº”ç”¨ä¸æ˜¯ç‰¹åˆ«æœ‰ç”¨ã€ç‹¬ç‰¹æˆ–â€œåƒåº”ç”¨ä¸€æ ·â€ï¼Œå®ƒå°±ä¸å±äºåº”ç”¨å•†åº—ã€‚â€” è‹¹æœåº”ç”¨å•†åº—

å¦‚æœä½ çŸ¥é“ä»»ä½•å…¶ä»–çªå‡ºçš„ç¼ºç‚¹ï¼Œé‚£ä¹ˆè¯·åœ¨è¿™ç¯‡æ–‡ç« çš„åº•éƒ¨ç•™ä¸‹è¯„è®ºã€‚ğŸ‘‡

# æ€ä¹ˆåšï¼Ÿ

ç¬¬ä¸€æ­¥æ˜¯[ä½¿ç”¨ Angular CLI](https://danielk.tech/home/how-to-install-and-use-the-angular-cli) å®‰è£… [@angular/pwa](https://npmjs.com/@angular/pwa) åŒ…ã€‚

```
ng add @angular/pwa
```

è¿‡å»ï¼Œä¸“å®¶ä»¬éœ€è¦å‡ ä¸ªå°æ—¶ç”šè‡³å‡ å¤©æ¥åˆ›å»ºä¸€ä¸ª PWAâ€”â€”ç°åœ¨ï¼Œä¸€ä¸ª 3 å²çš„å‰ƒé¡»åˆ€å¯ä»¥åœ¨ä½ é˜»æ­¢ä»–ä¹‹å‰å®‰è£…è¿™ä¸ªã€‚

åˆšåˆšå‘ç”Ÿäº†ä»€ä¹ˆï¼Ÿ

![](img/f0b164ff7a6b502d766b0b57f0a40a0a.png)

`@angular/pwa`åŒ…æ˜¯ä¸€ä¸ª Angular ç¤ºæ„å›¾ï¼Œå®ƒå°†[æ¸è¿›å¼ Web åº”ç”¨](https://web.dev/progressive-web-apps)æ”¯æŒæ·»åŠ åˆ° Angular åº”ç”¨ä¸­ã€‚ç®€è€Œè¨€ä¹‹ï¼Œè¿™é‡Œæœ‰ä¸€äº›ä½ åº”è¯¥çŸ¥é“çš„äº‹æƒ…:

*   åœ¨ app æ¨¡å—ä¸­è‡ªåŠ¨å¯¼å…¥å¹¶æ³¨å†ŒæœåŠ¡äººå‘˜ã€‚
*   æ›´æ–°`index.html`ä»¥åŒ…å«`manifest.json`æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶åŒ…å«å…³äºæ¸è¿›å¼ web åº”ç”¨ç¨‹åºçš„è¯¦ç»†ä¿¡æ¯ã€‚
*   åˆ›å»ºå›¾æ ‡æ–‡ä»¶ä»¥æ”¯æŒ PWAã€‚è¿™äº›éƒ½æ”¾åœ¨`src/assets/icons`æ–‡ä»¶å¤¹ä¸­ï¼Œåº”è¯¥ç”¨åº”ç”¨ç¨‹åºçš„å›¾æ ‡è¿›è¡Œæ›´æ–°ï¼Œä»¥ä¾¿è¿›è¡Œå“ç‰Œæ¨å¹¿ã€‚
*   åˆ›é€ äº†`src/ngsw-config.json`ã€‚è¯¥æ–‡ä»¶ç”¨äºé…ç½®æœåŠ¡äººå‘˜ã€‚

è¿™å°±æ˜¯å¦‚ä½•å°†ä½ çš„ Angular åº”ç”¨ç¨‹åºè½¬æ¢æˆ PWAã€‚

å¦‚æœæ‚¨å¯¹å¦‚ä½•é…ç½®ç¼“å­˜è¡Œä¸ºæœ‰ç–‘é—®ï¼Œè¯·æŸ¥çœ‹ Angular æ–‡æ¡£ä¸­çš„[é¡µé¢ã€‚](https://angular.io/guide/service-worker-config)

# æœ‰è§’åº¦çš„ PWA æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼Ÿ

å¦‚æœä½ æ­£åœ¨åŠªåŠ›ç†è§£æ­£åœ¨å‘ç”Ÿçš„ä¸€åˆ‡ï¼Œè®©æˆ‘èŠ±ç‚¹æ—¶é—´æ¥è§£é‡Šä¸€ä¸‹ã€‚

é¦–å…ˆï¼Œæ¸è¿›å¼ web åº”ç”¨ç¨‹åºåªä¸è¿‡æ˜¯ä¸€ä¸ªç¾åŒ–äº†çš„ç½‘é¡µï¼Œå®ƒä½¿ç”¨[æœåŠ¡å·¥ä½œè€…](https://en.wikipedia.org/wiki/Progressive_web_application#Service_workers)æ¥ç¼“å­˜èµ„äº§å’Œæ•°æ®ä»¥ä¾›ç¦»çº¿ä½¿ç”¨æˆ–åŠ å¿«åŠ è½½é€Ÿåº¦ã€‚

æˆ‘ä»¬åˆšåˆšåšçš„æ˜¯ä½¿ç”¨`@angular/pwa` schematics åŒ…åˆ›å»ºä¸€ä¸ªæœåŠ¡å·¥ä½œå™¨ï¼Œå®ƒå°†ç¼“å­˜æˆ‘ä»¬é…ç½®çš„ä»»ä½•å†…å®¹ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒæœåŠ¡äººå‘˜å°†è‡ªåŠ¨ç¼“å­˜ä»¥ä¸‹æ–‡ä»¶ã€‚

*   `favicon.ico`
*   æ‰€æœ‰çš„æ„å»ºå·¥ä»¶(JavaScript å’Œ CSS åŒ…)ã€‚
*   ä½äºèµ„äº§æ–‡ä»¶å¤¹ä¸­çš„ä»»ä½•æ–‡ä»¶ã€‚
*   é…ç½®çš„`outputPath`æˆ–`resourcesOutputPath`æ­£ä¸‹æ–¹çš„å›¾åƒå’Œå­—ä½“ã€‚

ç°åœ¨ï¼Œå½“æˆ‘ä»¬éƒ¨ç½²æˆ‘ä»¬çš„ Angular åº”ç”¨ç¨‹åºæ—¶ï¼ŒæœåŠ¡äººå‘˜å°†ä¸å®ƒä¸€èµ·éƒ¨ç½²ï¼Œå¹¶å°†ç¼“å­˜ä¸Šé¢çš„èµ„äº§ã€‚ä¸‹æ¬¡ç”¨æˆ·åŠ è½½æ‚¨çš„ web åº”ç”¨ç¨‹åºæ—¶ï¼Œå®ƒä¼šåŠ è½½å¾—æ›´å¿«ï¼Œå› ä¸ºæ‚¨çš„ CSSã€JavaScript å’Œå…¶ä»–èµ„äº§å·²ç»è¢«æœåŠ¡äººå‘˜ç¼“å­˜äº†ã€‚

æƒ…å†µè¶Šæ¥è¶Šå¥½ã€‚

å½“æ‚¨éƒ¨ç½²æ–°ç‰ˆæœ¬æ—¶ï¼ŒæœåŠ¡äººå‘˜å°†æ£€æµ‹åˆ°è¿™äº›æ›´æ”¹ï¼Œå¹¶åœ¨åå°é™é»˜æ›´æ–°ç¼“å­˜ï¼Œä»¥ä¾¿ä¸‹æ¬¡é‡æ–°åŠ è½½æ‚¨çš„åº”ç”¨æ—¶ï¼Œç”¨æˆ·å°†è¿è¡Œæœ€æ–°ç‰ˆæœ¬ã€‚

å¦‚æœæ‚¨æƒ³è®¢é˜…è¿™äº›æ›´æ–°ï¼Œå¹¶åœ¨ç¼“å­˜æ›´æ–°åæç¤ºç”¨æˆ·é‡æ–°åŠ è½½ï¼Œé‚£ä¹ˆä¸‹é¢æ˜¯å¦‚ä½•åšçš„ã€‚

```
import { Component, OnInit } from '@angular/core';
import { SwUpdate } from '@angular/service-worker';

@Component({
  selector: 'app-root',
  templateUrl: './app.component.html',
  styleUrls: ['./app.component.css']
})
export class AppComponent implements OnInit{

  constructor( private swUpdate: SwUpdate) {}

    ngOnInit() {
      if (this.swUpdate.isEnabled) {
        this.swUpdate.available.subscribe(() => {
          if(confirm("You're using an old version of the control panel. Want to update?")) {
            window.location.reload();
          }
        });
      }
    }
}
```

# ä½ å®Œäº†ï¼

ç°åœ¨æˆ‘æƒ³å¬å¬ä½ çš„æ„è§:

ä½ æ‰“ç®—æŠŠä½ çš„ Angular é¡¹ç›®è½¬æ¢æˆä¸€ä¸ªæ¸è¿›å¼çš„ web åº”ç”¨ç¨‹åºå—ï¼Ÿ

åˆæˆ–è®¸ä½ è§‰å¾—ä¸å€¼å¾—ï¼Ÿ

è¯·åœ¨ä¸‹é¢çš„è¯„è®ºåŒºå‘Šè¯‰æˆ‘ã€‚

**å…³æ³¨æˆ‘:** [GitHub](https://github.com/dkreider) ï¼Œ[ä¸­å‹](https://dkreider.medium.com/)ï¼Œ[ä¸ªäººåšå®¢](https://danielk.tech/)

![](img/95331bea99429ddad97fd233e334b403.png)

*æœ€åˆå‘å¸ƒäº*[*https://danielk . tech*](https://danielk.tech/home/angular-pwa)*ã€‚*

*æ›´å¤šå†…å®¹çœ‹* [***è¯´ç™½äº†ã€‚æŠ¥åå‚åŠ æˆ‘ä»¬çš„***](https://plainenglish.io/)***[***å…è´¹æ¯å‘¨ç®€è®¯***](http://newsletter.plainenglish.io/) *ã€‚å…³æ³¨æˆ‘ä»¬* [***æ¨ç‰¹***](https://twitter.com/inPlainEngHQ) *å’Œ*[***LinkedIn***](https://www.linkedin.com/company/inplainenglish/)*ã€‚æŸ¥çœ‹æˆ‘ä»¬çš„* [***ç¤¾åŒºä¸å’Œè°***](https://discord.gg/GtDtUAvyhW) *åŠ å…¥æˆ‘ä»¬çš„* [***äººæ‰é›†ä½“***](https://inplainenglish.pallet.com/talent/welcome) *ã€‚****