<html>
<head>
<title>How to Retry Requests Using Axios</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Axios重试请求</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-retry-requests-using-axios-64c2da8340a7?source=collection_archive---------0-----------------------#2022-07-27">https://javascript.plainenglish.io/how-to-retry-requests-using-axios-64c2da8340a7?source=collection_archive---------0-----------------------#2022-07-27</a></blockquote><div><div class="fc ic id ie if ig"/><div class="ih ii ij ik il"><div class=""/><div class=""><h2 id="1650" class="pw-subtitle-paragraph jl in io bd b jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc dk translated">关于使用Axios拦截器重试请求的教程。</h2></div><figure class="ke kf kg kh gu ki gi gj paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gi gj kd"><img src="../Images/cbed691ed4896f7a751e0dd4089624a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MNC4-Tu-oM5X42REbNEuRA.png"/></div></div><figcaption class="kp kq gk gi gj kr ks bd b be z dk">Retry Axios request</figcaption></figure><h1 id="dd66" class="kt ku io bd kv kw kx ky kz la lb lc ld ju le jv lf jx lg jy lh ka li kb lj lk bi translated">前言</h1><p id="0584" class="pw-post-body-paragraph ll lm io ln b lo lp jp lq lr ls js lt lu lv lw lx ly lz ma mb mc md me mf mg ih bi translated">当用户访问我们的web应用程序时，HTTP请求可能会由于网络不稳定而失败，例如超时或网络异常。在这种情况下，通常会有一个异常页面通知用户，他们可以稍后重新进入web应用程序。如果我们重试这些失败的HTTP请求，用户可能不需要退出并重新进入我们的web应用程序，体验会更好。</p><p id="5429" class="pw-post-body-paragraph ll lm io ln b lo mh jp lq lr mi js lt lu mj lw lx ly mk ma mb mc ml me mf mg ih bi translated">我们将首先了解如果<a class="ae mm" href="https://axios-http.com/" rel="noopener ugc nofollow" target="_blank"> Axios </a>请求失败可能发生的所有异常，然后使用Axios的拦截器重试HTTP请求。</p><h1 id="61dc" class="kt ku io bd kv kw kx ky kz la lb lc ld ju le jv lf jx lg jy lh ka li kb lj lk bi translated">Axios请求的例外</h1><p id="f02d" class="pw-post-body-paragraph ll lm io ln b lo lp jp lq lr ls js lt lu lv lw lx ly lz ma mb mc md me mf mg ih bi translated">如果你观察过Axios的异常，可以发现所有异常的名字都是<code class="fe mn mo mp mq b">AxiosError</code>。从<code class="fe mn mo mp mq b">Error</code>继承的Axios自定义处理异常<code class="fe mn mo mp mq b"><a class="ae mm" href="https://github.com/axios/axios/blob/v1.x/lib/core/AxiosError.js" rel="noopener ugc nofollow" target="_blank">AxiosError</a></code>类。所以我们可以通过搜索AxiosError的源代码来找到所有的异常。</p><figure class="ke kf kg kh gu ki gi gj paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gi gj mr"><img src="../Images/3b6c3f8b6d557af568acd62d80f8038c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EuvtE-MJqpd0zDdPIu_SAg.png"/></div></div></figure><p id="64a6" class="pw-post-body-paragraph ll lm io ln b lo mh jp lq lr mi js lt lu mj lw lx ly mk ma mb mc ml me mf mg ih bi translated">你可以搜索超过20个使用它的地方，但是我们只需要注意请求过程中的异常。</p><p id="a7fe" class="pw-post-body-paragraph ll lm io ln b lo mh jp lq lr mi js lt lu mj lw lx ly mk ma mb mc ml me mf mg ih bi translated">主要的例外是:</p><ol class=""><li id="93ce" class="ms mt io ln b lo mh lr mi lu mu ly mv mc mw mg mx my mz na bi translated">请求中止</li><li id="dc10" class="ms mt io ln b lo nb lr nc lu nd ly ne mc nf mg mx my mz na bi translated">网络错误</li><li id="2586" class="ms mt io ln b lo nb lr nc lu nd ly ne mc nf mg mx my mz na bi translated">网络超时</li><li id="1ead" class="ms mt io ln b lo nb lr nc lu nd ly ne mc nf mg mx my mz na bi translated">不支持的协议</li></ol><p id="6a32" class="pw-post-body-paragraph ll lm io ln b lo mh jp lq lr mi js lt lu mj lw lx ly mk ma mb mc ml me mf mg ih bi translated"><code class="fe mn mo mp mq b">Request aborted</code>的异常可能是由用户取消请求引起的，我们可能不会重试该请求。而<code class="fe mn mo mp mq b">Unsupported protocol</code>的异常不需要重试，因为它会再次失败。因此，我们可以在<code class="fe mn mo mp mq b">Network error</code>或<code class="fe mn mo mp mq b">Network timeout</code>请求失败时重试请求。</p><h1 id="7780" class="kt ku io bd kv kw kx ky kz la lb lc ld ju le jv lf jx lg jy lh ka li kb lj lk bi translated">失败时重试请求</h1><figure class="ke kf kg kh gu ki gi gj paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gi gj ng"><img src="../Images/9b5204878fd0859e34abeb029788a76f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bX_Gr7VMi4IerGXDjnElmA.png"/></div></div><figcaption class="kp kq gk gi gj kr ks bd b be z dk">Using interceptor to retry request</figcaption></figure><p id="75a5" class="pw-post-body-paragraph ll lm io ln b lo mh jp lq lr mi js lt lu mj lw lx ly mk ma mb mc ml me mf mg ih bi translated">在使用Axios时，我们可以使用拦截器，它可以在请求和响应被<code class="fe mn mo mp mq b">then</code>或<code class="fe mn mo mp mq b">catch</code>处理之前拦截它们。拦截器接受两个参数，完成的回调和拒绝的回调。当请求失败时，它将执行被拒绝的回调。</p><figure class="ke kf kg kh gu ki"><div class="bz fq l di"><div class="nh ni l"/></div></figure><p id="45d3" class="pw-post-body-paragraph ll lm io ln b lo mh jp lq lr mi js lt lu mj lw lx ly mk ma mb mc ml me mf mg ih bi translated">我在<a class="ae mm" href="https://codepen.io/bitbug/pen/wvmreeY" rel="noopener ugc nofollow" target="_blank"> copen.io </a>上创建了一个演示，为了测试这个特性，我们可以用Devtools阻止请求URL。</p><figure class="ke kf kg kh gu ki gi gj paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gi gj nj"><img src="../Images/181d407796b9bd76a4f7b2b1164285e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Y_T76Gx6jVQl0iIhEk0pJg.png"/></div></div></figure><p id="25bb" class="pw-post-body-paragraph ll lm io ln b lo mh jp lq lr mi js lt lu mj lw lx ly mk ma mb mc ml me mf mg ih bi translated">然后我们可以模拟一下<code class="fe mn mo mp mq b">Network Error</code>:</p><figure class="ke kf kg kh gu ki gi gj paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gi gj nk"><img src="../Images/b9e3a3ccc982c531cc96abe3a57b62e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LYUSXf4LAgk1QxvRIndl9Q.png"/></div></div></figure><h1 id="f046" class="kt ku io bd kv kw kx ky kz la lb lc ld ju le jv lf jx lg jy lh ka li kb lj lk bi translated">结论</h1><p id="6066" class="pw-post-body-paragraph ll lm io ln b lo lp jp lq lr ls js lt lu lv lw lx ly lz ma mb mc md me mf mg ih bi translated">通过使用Axios的拦截器拦截响应，如果出现<code class="fe mn mo mp mq b">Network timeout</code>或<code class="fe mn mo mp mq b">Network error</code>，尝试再次发送请求。我们可以通过设置<code class="fe mn mo mp mq b">retry</code>和<code class="fe mn mo mp mq b">retryDelay</code>来控制重试请求的次数和每次请求的间隔。</p><p id="3c86" class="pw-post-body-paragraph ll lm io ln b lo mh jp lq lr mi js lt lu mj lw lx ly mk ma mb mc ml me mf mg ih bi translated">希望它能帮助你，我期待你<strong class="ln ip">跟随</strong>我学习更多实用技巧，成为一名更好的开发者。</p><p id="0514" class="pw-post-body-paragraph ll lm io ln b lo mh jp lq lr mi js lt lu mj lw lx ly mk ma mb mc ml me mf mg ih bi translated">您可以了解有关Axios的更多信息:</p><div class="nl nm gq gs nn no"><a rel="noopener  ugc nofollow" target="_blank" href="/why-i-prefer-axios-in-web-app-9a78d655fd1d"><div class="np ab fp"><div class="nq ab nr cl cj ns"><h2 class="bd ip gz z fq nt fs ft nu fv fx in bi translated">为什么我更喜欢在Web应用程序中使用Axios</h2><div class="nv l"><h3 class="bd b gz z fq nt fs ft nu fv fx dk translated">同构和基于承诺的代码使开发更加高效</h3></div><div class="nw l"><p class="bd b dl z fq nt fs ft nu fv fx dk translated">javascript.plainenglish.io</p></div></div><div class="nx l"><div class="ny l nz oa ob nx oc kn no"/></div></div></a></div><div class="nl nm gq gs nn no"><a rel="noopener  ugc nofollow" target="_blank" href="/why-axios-can-be-used-both-in-browser-and-node-js-5b88206f70f"><div class="np ab fp"><div class="nq ab nr cl cj ns"><h2 class="bd ip gz z fq nt fs ft nu fv fx in bi translated">为什么Axios可以在浏览器和Node.js中同时使用</h2><div class="nv l"><h3 class="bd b gz z fq nt fs ft nu fv fx dk translated">axios如何兼容两种不同的请求方法</h3></div><div class="nw l"><p class="bd b dl z fq nt fs ft nu fv fx dk translated">javascript.plainenglish.io</p></div></div><div class="nx l"><div class="od l nz oa ob nx oc kn no"/></div></div></a></div><div class="nl nm gq gs nn no"><a rel="noopener  ugc nofollow" target="_blank" href="/how-to-implement-a-request-interceptor-like-axios-896a1431304a"><div class="np ab fp"><div class="nq ab nr cl cj ns"><h2 class="bd ip gz z fq nt fs ft nu fv fx in bi translated">如何实现像Axios这样的请求拦截器</h2><div class="nv l"><h3 class="bd b gz z fq nt fs ft nu fv fx dk translated">在处理请求或响应之前拦截它们</h3></div><div class="nw l"><p class="bd b dl z fq nt fs ft nu fv fx dk translated">javascript.plainenglish.io</p></div></div><div class="nx l"><div class="oe l nz oa ob nx oc kn no"/></div></div></a></div></div><div class="ab cl of og hs oh" role="separator"><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok ol"/><span class="oi bw bk oj ok"/></div><div class="ih ii ij ik il"><p id="9a59" class="pw-post-body-paragraph ll lm io ln b lo mh jp lq lr mi js lt lu mj lw lx ly mk ma mb mc ml me mf mg ih bi translated"><em class="om">更多内容看</em> <a class="ae mm" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ln ip"> <em class="om">说白了。报名参加我们的</em> <a class="ae mm" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ln ip"> <em class="om">免费周报</em> </strong> </a> <em class="om">。关注我们关于</em> <a class="ae mm" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"> <strong class="ln ip"> <em class="om">推特</em></strong></a><strong class="ln ip"><em class="om"/></strong><em class="om">和</em><a class="ae mm" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="ln ip"><em class="om">LinkedIn</em></strong></a><em class="om">。查看我们的</em> <a class="ae mm" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="ln ip"> <em class="om">社区不和谐</em> </strong> </a> <em class="om">加入我们的</em> <a class="ae mm" href="https://inplainenglish.pallet.com/talent/welcome" rel="noopener ugc nofollow" target="_blank"> <strong class="ln ip"> <em class="om">人才集体</em> </strong> </a> <em class="om">。</em></strong></a></p></div></div>    
</body>
</html>