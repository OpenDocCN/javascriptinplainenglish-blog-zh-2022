<html>
<head>
<title>4 Ways to Lazy Load Images</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">4种延迟加载图像的方法</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/4-ways-to-lazy-load-images-fe2e4bc9211d?source=collection_archive---------13-----------------------#2022-09-20">https://javascript.plainenglish.io/4-ways-to-lazy-load-images-fe2e4bc9211d?source=collection_archive---------13-----------------------#2022-09-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="dc54" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">哪个最值得推荐？</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/33aa7223e9362a452bd76d0c4741e9ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*V_gqhh7Hd1DknXiw"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@kstonematheson?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Kate Stone Matheson</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="0a7f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在web开发中，您的页面可能在折叠上方加载了太多的图像，这导致了更长的加载时间。图像优化可能是web性能优化中最有效的项目，那么图像的延迟加载通常是一个解决方案。</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="e67d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">懒加载就是延迟那些用户还没看过的图片，只滚动到相应的位置再加载。实现这一点有两个步骤:第一步删除<code class="fe lz ma mb mc b">img</code>元素的<code class="fe lz ma mb mc b">src</code>属性，第二步确定用户的视窗是否已经滚动到图像。</p><p id="43a2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对第一步更详细的解释是:由于<code class="fe lz ma mb mc b">src</code>属性是在HTML规范中定义的，所以它在功能上是有意义的，一旦为<code class="fe lz ma mb mc b">img</code>元素设置了，它就会在页面加载时加载，不管它在页面的什么位置。所以我们需要将其移除，并为相应的<code class="fe lz ma mb mc b">img</code>设置另一个属性，通常是<code class="fe lz ma mb mc b">data-src</code>属性。它只是一组无限的<code class="fe lz ma mb mc b">data-*</code>属性中的一个，这些属性没有明确的含义，但是可以用来在元素中包含不可见的数据。</p><p id="2df0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在第二步中，我们可以用两种方式来判断，它们是:</p><h2 id="6e6d" class="md me iq bd mf mg mh dn mi mj mk dp ml lf mm mn mo lj mp mq mr ln ms mt mu mv bi translated">方式1</h2><p id="46f7" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">向<code class="fe lz ma mb mc b">document</code>添加一个<code class="fe lz ma mb mc b">scroll</code>事件，使用clientHeight、scrollTop和offsetTop来确定元素是否出现在视图中。</p><h2 id="9ab6" class="md me iq bd mf mg mh dn mi mj mk dp ml lf mm mn mo lj mp mq mr ln ms mt mu mv bi translated">方式2</h2><p id="97a4" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">给<code class="fe lz ma mb mc b">document</code>添加一个<code class="fe lz ma mb mc b">scroll</code>事件，使用<code class="fe lz ma mb mc b">getBoundingClientRect</code>来确定元素是否出现在视图中。</p><p id="c2ea" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这两种方法的代码是相似的，唯一不同的是判断条件:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="986c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">注意我这里用<code class="fe lz ma mb mc b">throttle</code>，主要是为了减少高频触发可能带来的性能问题。检查:</p><div class="nd ne gp gr nf ng"><a rel="noopener  ugc nofollow" target="_blank" href="/what-are-debounce-and-throttle-8908dc7c5a62"><div class="nh ab fo"><div class="ni ab nj cl cj nk"><h2 class="bd ir gy z fp nl fr fs nm fu fw ip bi translated">什么是去抖和节流？</h2><div class="nn l"><h3 class="bd b gy z fp nl fr fs nm fu fw dk translated">如何在TypeScript中编码去抖和节流</h3></div><div class="no l"><p class="bd b dl z fp nl fr fs nm fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="np l"><div class="nq l nr ns nt np nu kp ng"/></div></div></a></div><h2 id="e047" class="md me iq bd mf mg mh dn mi mj mk dp ml lf mm mn mo lj mp mq mr ln ms mt mu mv bi translated">方式3</h2><p id="a29e" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">第三种方法是使用<code class="fe lz ma mb mc b"><a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API" rel="noopener ugc nofollow" target="_blank">IntersectionObserver</a></code>，它提供了一种异步观察目标元素与祖先元素或顶层文档的viewport的交集变化的方法。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nb nc l"/></div></figure><p id="5f5c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这3种方法中，更推荐第三种。因为它是异步微任务，所以不需要额外的节流，性能会更好。</p><h2 id="f773" class="md me iq bd mf mg mh dn mi mj mk dp ml lf mm mn mo lj mp mq mr ln ms mt mu mv bi translated">方式4</h2><p id="7eb0" class="pw-post-body-paragraph kw kx iq ky b kz mw jr lb lc mx ju le lf my lh li lj mz ll lm ln na lp lq lr ij bi translated">除此之外，第四种方法是现代浏览器增加的新功能— <code class="fe lz ma mb mc b">Lazy loading via attribute for images &amp; iframes</code>。</p><p id="4bed" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">它的使用非常简单:</p><pre class="kg kh ki kj gt nv mc nw nx aw ny bi"><span id="5011" class="md me iq mc b gy nz oa l ob oc">&lt;img<br/>    src=""<br/>    <strong class="mc ir">loading="lazy"</strong><br/>    alt=""<br/>/&gt;</span></pre><p id="b554" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">只需将<code class="fe lz ma mb mc b"><a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/HTML/Element/img#attr-loading" rel="noopener ugc nofollow" target="_blank">loading="lazy"</a></code>添加到<code class="fe lz ma mb mc b">img</code>标签中。</p><p id="5662" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">正如您所料，它还不太兼容:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi od"><img src="../Images/9304f1959645a92bb1a26bdfde317d62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mBYzi7io5vwsUiB52N-kcw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">image by <a class="ae kv" href="https://caniuse.com/loading-lazy-attr" rel="noopener ugc nofollow" target="_blank">caniuse</a></figcaption></figure><p id="c17a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因此，如果您的目标用户使用支持这一属性的现代浏览器，那么使用<code class="fe lz ma mb mc b">loading="lazy"</code>就可以了。如果你想兼容大多数浏览器，那么<code class="fe lz ma mb mc b">IntersectionObserver</code>是个不错的选择。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oe"><img src="../Images/20149aec887a3a7936b6787da6125539.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tWZn8hjZmVY8G0ffYxYMuA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">image by <a class="ae kv" href="https://caniuse.com/?search=IntersectionObserver" rel="noopener ugc nofollow" target="_blank">caniuse</a></figcaption></figure><p id="3881" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">今天就到这里，感谢阅读！</p><p id="c014" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="of">不是中等会员？</em> <a class="ae kv" href="https://medium.com/@hibrandonevans/membership" rel="noopener"> <em class="of">支持我在这里</em> </a> <em class="of">合二为一。</em></p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="07d3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="of">更多内容请看</em> <a class="ae kv" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="of">说白了。报名参加我们的</em> <a class="ae kv" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="of">免费周报</em> </strong> </a> <em class="of">。关注我们</em> <a class="ae kv" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="of">推特</em> </strong> </a>，<a class="ae kv" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="of">LinkedIn</em></strong></a><em class="of">，</em><a class="ae kv" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="of">YouTube</em></strong></a><em class="of">，以及</em> <a class="ae kv" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="of">不和</em> </strong> </a> <em class="of">。对增长黑客感兴趣？检查出</em> <a class="ae kv" href="https://circuit.ooo/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="of">电路</em> </strong> </a> <em class="of">。</em></strong></a></p></div></div>    
</body>
</html>