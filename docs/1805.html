<html>
<head>
<title>How to Create Reusable Components in Angular</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Angular中创建可重用组件</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/creating-reusable-configurable-angular-components-b7fcba2f5f38?source=collection_archive---------2-----------------------#2022-04-21">https://javascript.plainenglish.io/creating-reusable-configurable-angular-components-b7fcba2f5f38?source=collection_archive---------2-----------------------#2022-04-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><h2 id="a666" class="io ip iq bd b dl ir is it iu iv iw dk ix translated" aria-label="kicker paragraph">角形|可重复使用的组件</h2><div class=""/><div class=""><h2 id="9ce5" class="pw-subtitle-paragraph jw iz iq bd b jx jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn dk translated">使用NgTemplateOutlet和NgComponentOutlet指令创建可重复使用的角度组件。</h2></div><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ko"><img src="../Images/686d7d2b8218c6434d84868a2a40fdc3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*bZkWktEsNP-tttkutTzeFw.jpeg"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk">Photo by <a class="ae le" href="https://www.istockphoto.com/portfolio/Kwangmoozaa" rel="noopener ugc nofollow" target="_blank">Kwangmoozaa</a></figcaption></figure><p id="975a" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我喜欢Angular的一点是它基于组件的特性。组件是可重用的结构块，用于构建可伸缩的web应用程序。然而，有时仅有组件是不够的。</p><p id="15b0" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在本文中，我们将探索在Angular  中创建<strong class="lh ja"> <em class="mb">可重用组件的两种方法，它们也是可配置的。</em></strong></p><p id="3362" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">所以，振作起来，让我们开始吧！</p></div><div class="ab cl mc md hu me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="ij ik il im in"><h1 id="33d7" class="mj mk iq bd ml mm mn mo mp mq mr ms mt kf mu kg mv ki mw kj mx kl my km mz na bi translated">问题是</h1><p id="cb99" class="pw-post-body-paragraph lf lg iq lh b li nb ka lk ll nc kd ln lo nd lq lr ls ne lu lv lw nf ly lz ma ij bi translated">想象一下，我们已经为我们最喜欢的动物大熊猫建立了一个选择列表！</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi ng"><img src="../Images/b73439270e567e634ff362f24db68644.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jbOe6x8qmgwVRhROjNc6ig.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk">Selection list for our beloved pandas</figcaption></figure><p id="a03f" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">该列表允许我们选择一只或多只熊猫来参观。它显示每只熊猫的信息，如名字、性别、出生日期和当前位置。</p><p id="132e" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">然后我们改变了主意，决定用这个列表来看我们最喜欢的电影。</p><figure class="kp kq kr ks gt kt gh gi paragraph-image"><div role="button" tabindex="0" class="ku kv di kw bf kx"><div class="gh gi nh"><img src="../Images/2a931b36005cdf7a7cd2e82a94f44374.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GzS_WzI-oasyr51WvI8Bvw.png"/></div></div><figcaption class="la lb gj gh gi lc ld bd b be z dk">Selection list for our favorite movies</figcaption></figure><p id="09f1" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">该列表允许我们选择一部或多部电影稍后观看。它显示每部电影的几条信息，如电影名称、上映年份、持续时间、星级和简短描述。</p><p id="c602" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">现在，如果我们可以定制选择列表来包含前面的两种情况，不是很好吗？但是电影当然有和熊猫不一样的特点。那么，我们该怎么办？</p><p id="3e0e" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja">我们是否修改现有列表以涵盖不同的情况？</strong>我们将最终得到一个不必要的复杂组件，它的代码看起来像一团乱麻。</p><p id="a2b9" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja">我们要创建一个新列表吗？复制粘贴选择列表的代码会导致代码重复，这肯定不是一个好主意。</strong></p><p id="70d4" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">更糟糕的是，如果我们将来要将列表用于其他事情，该怎么办？上述解决方案都无法扩展。</p><p id="e32b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">真扫兴。现在怎么办？</p><h1 id="9757" class="mj mk iq bd ml mm ni mo mp mq nj ms mt kf nk kg mv ki nl kj mx kl nm km mz na bi translated">NgTemplateOutlet方式</h1><p id="1d04" class="pw-post-body-paragraph lf lg iq lh b li nb ka lk ll nc kd ln lo nd lq lr ls ne lu lv lw nf ly lz ma ij bi translated">指令来救援了！</p><p id="4e31" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们使用一个<code class="fe nn no np nq b">ng-container</code>作为占位符，而不是有一个显式定义其项目组件的选择列表。占位符有一个接收模板引用的<code class="fe nn no np nq b">ngTemplateOutlet</code>，<code class="fe nn no np nq b">itemTemplateRef</code>。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="f0b8" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们使用<code class="fe nn no np nq b">ngTemplateOutletContext</code>将上下文传递给这个模板。在我们的例子中，我们传递每一项的上下文，以便模板知道它每次显示哪个项。</p><p id="4233" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">接下来，我们定义将替换占位符的模板。在我们的例子中，模板只包含一个panda组件。我们将这个模板的引用命名为<code class="fe nn no np nq b">itemTemplate</code>。我们从模板中提供<code class="fe nn no np nq b">item</code>的上下文作为<code class="fe nn no np nq b">PandaComponent</code>的输入。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nr ns l"/></div></figure><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="3427" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">最后，我们需要获取<code class="fe nn no np nq b">itemTemplate</code>引用，将其传递给<code class="fe nn no np nq b">ngTemplateOutlet</code>指令。我们通过使用<code class="fe nn no np nq b">@ContentChild</code>装饰器来做到这一点。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="8e0d" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">就是这样！我们的选择列表准备好了！我们可以重用该组件来显示和选择熊猫、电影或任何我们喜欢的东西。</p><p id="d5d1" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">你可以在下面的StackBlitz找到一个工作演示。你可能也想<a class="ae le" href="https://vkagklis.medium.com/subscribe" rel="noopener">订阅我的时事通讯</a>来关注更多类似的内容！</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nt ns l"/></div></figure><h1 id="005e" class="mj mk iq bd ml mm ni mo mp mq nj ms mt kf nk kg mv ki nl kj mx kl nm km mz na bi translated">NgComponentOutlet方式</h1><p id="22a5" class="pw-post-body-paragraph lf lg iq lh b li nb ka lk ll nc kd ln lo nd lq lr ls ne lu lv lw nf ly lz ma ij bi translated">实现相同结果的第二种方法是<code class="fe nn no np nq b">ngComponentOutlet</code>指令。</p><p id="f81b" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><strong class="lh ja">来自Angular的官方文档:“</strong> <em class="mb">实例化一个</em> <code class="fe nn no np nq b"><a class="ae le" href="https://angular.io/api/core/Component" rel="noopener ugc nofollow" target="_blank"><em class="mb">Component</em></a></code> <em class="mb">类型，并将其宿主视图插入当前视图。</em> <code class="fe nn no np nq b"><a class="ae le" href="https://angular.io/api/common/NgComponentOutlet" rel="noopener ugc nofollow" target="_blank"><em class="mb">NgComponentOutlet</em></a></code> <em class="mb">为动态组件创建提供了一种声明式的方法</em></p><p id="534f" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">像第一个解决方案一样，我们使用一个<code class="fe nn no np nq b">ng-container</code>作为指令的占位符。<code class="fe nn no np nq b">ngComponentOutlet</code>需要将要实例化的组件类型。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="5301" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><code class="fe nn no np nq b">ngComponentOutletInjector</code>需要一个作为依赖项传递给实例化组件的注入器。我们可以使用这个注入器将数据传递给那个组件。我们还使用两个<a class="ae le" rel="noopener ugc nofollow" target="_blank" href="/custom-pipes-in-angular-the-ultimate-guide-e54bb400e3ce">定制管道</a> <code class="fe nn no np nq b">itemComponent</code>和<code class="fe nn no np nq b">itemInjector</code>将每一项转换成期望的输入。</p><p id="91db" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><code class="fe nn no np nq b">itemComponent</code>管道将项目转换成组件类型。它通过使用地图服务来实现这一点。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="af0e" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><code class="fe nn no np nq b">ComponentMappingService</code>包含项目类型和组件类型之间的预定义映射。基于给定的项目类型，返回相应的组件类型用于实例化。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="9827" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">这里唯一的缺点是项目的类型必须包含在它的属性中。这是在运行时获取项目类型的最安全的方式。</p><p id="c6a8" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在我们的例子中，我们使用一个枚举和一个接口来简化事情。使用<code class="fe nn no np nq b">ModelType</code>,我们强类型化可用的项目类型。然后我们可以用我们希望拥有<code class="fe nn no np nq b">type</code>属性的接口来扩展<code class="fe nn no np nq b">TypeOwner</code>。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="5bbf" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">第二个管道<code class="fe nn no np nq b">itemInjector</code>接收一个项目并返回一个注入器。注入器用作将项目注入实例化组件的手段。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="69ed" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">最后，我们创建一个<code class="fe nn no np nq b">DynamicComponent</code>，它有一个<code class="fe nn no np nq b">item</code>变量，并接收注射器作为它的依赖项。在构造函数中，我们用通过注入器提供的项目来设置组件的项目。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="4096" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">我们想要映射到特定项目类型的组件必须扩展<code class="fe nn no np nq b">DynamicComponent</code>。这样，我们就不必在每个组件中包含注射器依赖关系。此外，这个项目有一个<code class="fe nn no np nq b">@Input</code>装饰器，以防我们想在这个实现的范围之外使用子组件。</p><p id="3cb5" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">然后按如下方式重构<code class="fe nn no np nq b">PandaComponent</code>。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="57e8" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">你可以在下面的StackBlitz找到一个工作演示。</p><figure class="kp kq kr ks gt kt"><div class="bz fp l di"><div class="nt ns l"/></div></figure><h1 id="f50b" class="mj mk iq bd ml mm ni mo mp mq nj ms mt kf nk kg mv ki nl kj mx kl nm km mz na bi translated">比较实现</h1><p id="e2a9" class="pw-post-body-paragraph lf lg iq lh b li nb ka lk ll nc kd ln lo nd lq lr ls ne lu lv lw nf ly lz ma ij bi translated">前面的两种实现并不完全等同。</p><p id="3e14" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在<code class="fe nn no np nq b">ngTemplateOutlet</code>实现中，我们指定了哪个组件将用于列表中的所有项目。列表可以包含我们想要的任何类型的条目，但是显示组件对所有条目都是相同的类型。</p><p id="2136" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">在<code class="fe nn no np nq b">ngComponentOutlet</code>实现中，我们在每个项目上使用了<code class="fe nn no np nq b">itemComponent</code>管道，而不是传递静态组件类型。因此，每个项目可以使用基于预定义映射的不同类型的显示组件。</p></div><div class="ab cl mc md hu me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="ij ik il im in"><h1 id="5259" class="mj mk iq bd ml mm mn mo mp mq mr ms mt kf mu kg mv ki mw kj mx kl my km mz na bi translated">结论</h1><p id="3c27" class="pw-post-body-paragraph lf lg iq lh b li nb ka lk ll nc kd ln lo nd lq lr ls ne lu lv lw nf ly lz ma ij bi translated">在本文中，我们研究了创建可重用角度组件的两种方法。这两种解决方案都是可扩展的，并且消除了代码重复。然后，可以重用生成的组件来容纳我们想要的任何类型的项目。</p></div><div class="ab cl mc md hu me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="ij ik il im in"><p id="0b2c" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated">感谢您的阅读。我希望你喜欢这篇文章，并且你学到了一些新的东西。如果有，请考虑通过我的推荐链接注册Medium:</p><div class="nu nv gp gr nw nx"><a href="https://kagklis.medium.com/membership" rel="noopener follow" target="_blank"><div class="ny ab fo"><div class="nz ab oa cl cj ob"><h2 class="bd ja gy z fp oc fr fs od fu fw iz bi translated">通过我的推荐链接加入Medium—kakk lis Vasileios</h2><div class="oe l"><h3 class="bd b gy z fp oc fr fs od fu fw dk translated">阅读Kagklis Vasileios(以及媒体上成千上万的其他作家)的每一个故事。您的会员费直接…</h3></div><div class="of l"><p class="bd b dl z fp oc fr fs od fu fw dk translated">kagklis.medium.com</p></div></div><div class="og l"><div class="oh l oi oj ok og ol ky nx"/></div></div></a></div></div><div class="ab cl mc md hu me" role="separator"><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh mi"/><span class="mf bw bk mg mh"/></div><div class="ij ik il im in"><p id="696a" class="pw-post-body-paragraph lf lg iq lh b li lj ka lk ll lm kd ln lo lp lq lr ls lt lu lv lw lx ly lz ma ij bi translated"><em class="mb">更多内容请看</em><a class="ae le" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="lh ja"><em class="mb">plain English . io</em></strong></a><em class="mb">。报名参加我们的</em> <a class="ae le" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="lh ja"> <em class="mb">免费周报</em> </strong> </a> <em class="mb">。关注我们关于</em><a class="ae le" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="lh ja"><em class="mb">Twitter</em></strong></a><a class="ae le" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="lh ja"><em class="mb">LinkedIn</em></strong></a><strong class="lh ja"><em class="mb"/></strong><a class="ae le" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"><strong class="lh ja"><em class="mb">YouTube</em></strong></a><strong class="lh ja"><em class="mb">，以及</em></strong><em class="mb"/><a class="ae le" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"><strong class="lh ja"><em class="mb">不和</em> </strong> </a>  <em class="mb">对成长黑客感兴趣？检查</em> <a class="ae le" href="https://circuit.ooo/" rel="noopener ugc nofollow" target="_blank"> <strong class="lh ja"> <em class="mb">电路</em> </strong> </a> <strong class="lh ja"> <em class="mb">。</em> </strong></p></div></div>    
</body>
</html>