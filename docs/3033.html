<html>
<head>
<title>How to Implement a File Upload Server with Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Node.js实现文件上传服务器</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-implement-a-file-upload-server-with-node-js-83043bc180fc?source=collection_archive---------2-----------------------#2022-07-25">https://javascript.plainenglish.io/how-to-implement-a-file-upload-server-with-node-js-83043bc180fc?source=collection_archive---------2-----------------------#2022-07-25</a></blockquote><div><div class="fc ic id ie if ig"/><div class="ih ii ij ik il"><div class=""/><div class=""><h2 id="2d82" class="pw-subtitle-paragraph jl in io bd b jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc dk translated">使用busboy模块解析表单数据。</h2></div><figure class="ke kf kg kh gu ki gi gj paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gi gj kd"><img src="../Images/33d8f02cf50ef42ec8ee462d11c399fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H9Wo6KJvntqjBhGPzzeRRg.png"/></div></div></figure><h1 id="6f5b" class="kp kq io bd kr ks kt ku kv kw kx ky kz ju la jv lb jx lc jy ld ka le kb lf lg bi translated">前言</h1><p id="87f5" class="pw-post-body-paragraph lh li io lj b lk ll jp lm ln lo js lp lq lr ls lt lu lv lw lx ly lz ma mb mc ih bi translated">无论我们看什么网站，都会有图片，比如Medium，Twitter等。在介质上书写时，支持上传图片。它将图片发布到<code class="fe md me mf mg b"><a class="ae mh" href="https://medium.com/_/upload?source=6" rel="noopener">https://medium.com/_/upload?source=6</a></code>，响应包含图片的已保存的<code class="fe md me mf mg b">fileId</code>，可用于生成CDN URL。</p><figure class="ke kf kg kh gu ki gi gj paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gi gj mi"><img src="../Images/7a835e9ba1a6391df2a7146e69d71ccb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iBmU_wqlVLSccMwI7wqNpw.png"/></div></div></figure><p id="490d" class="pw-post-body-paragraph lh li io lj b lk mj jp lm ln mk js lp lq ml ls lt lu mm lw lx ly mn ma mb mc ih bi translated">虽然不知道Medium用哪种编程语言来实现上传服务器，但是我们可以用Node.js来实现文件上传服务器。</p><p id="7dd1" class="pw-post-body-paragraph lh li io lj b lk mj jp lm ln mk js lp lq ml ls lt lu mm lw lx ly mn ma mb mc ih bi translated">在本文中，我们将看看如何用Node.js中的<code class="fe md me mf mg b"><a class="ae mh" href="https://github.com/mscdex/busboy" rel="noopener ugc nofollow" target="_blank">busboy</a></code>模块实现文件上传服务器</p><h1 id="20d9" class="kp kq io bd kr ks kt ku kv kw kx ky kz ju la jv lb jx lc jy ld ka le kb lf lg bi translated">用Node.js创建HTTP服务器</h1><p id="9259" class="pw-post-body-paragraph lh li io lj b lk ll jp lm ln lo js lp lq lr ls lt lu lv lw lx ly lz ma mb mc ih bi translated">Nodejs提供了HTTP模块，可以很容易的用来创建服务器，当然如果使用<a class="ae mh" href="https://koajs.com/" rel="noopener ugc nofollow" target="_blank"> Koa </a>或者<a class="ae mh" href="http://expressjs.com/" rel="noopener ugc nofollow" target="_blank"> Express </a>会更容易。虽然使用原生模块效率不高，但是可以帮助我们更好的掌握Node.js .但是建议在生产环境中使用<a class="ae mh" href="https://koajs.com/" rel="noopener ugc nofollow" target="_blank"> Koa </a>或者<a class="ae mh" href="http://expressjs.com/" rel="noopener ugc nofollow" target="_blank"> Express </a>。</p><p id="6321" class="pw-post-body-paragraph lh li io lj b lk mj jp lm ln mk js lp lq ml ls lt lu mm lw lx ly mn ma mb mc ih bi translated">在创建HTTP服务器时，我们只需要使用HTTP模块提供的<code class="fe md me mf mg b">createServer</code> API，同时绑定一个端口。</p><pre class="ke kf kg kh gu mo mg mp mq aw mr bi"><span id="0d00" class="ms kq io mg b gz mt mu l mv mw">const http = require('http');<br/>http.createServer((req, res) =&gt; {<br/>  res.end('hello world');<br/>}).listen(4000);</span></pre><p id="1077" class="pw-post-body-paragraph lh li io lj b lk mj jp lm ln mk js lp lq ml ls lt lu mm lw lx ly mn ma mb mc ih bi translated">然后我们可以测试它并参观<code class="fe md me mf mg b">http://localhost:4000</code>:</p><figure class="ke kf kg kh gu ki gi gj paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gi gj mx"><img src="../Images/0131f6db94702435f9a2c480d58c1c8d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wEsOLlRJpFFsCWMsTm6YQw.png"/></div></div><figcaption class="my mz gk gi gj na nb bd b be z dk">Test for Nodejs server</figcaption></figure><h1 id="ae86" class="kp kq io bd kr ks kt ku kv kw kx ky kz ju la jv lb jx lc jy ld ka le kb lf lg bi translated">上传文件并保存在服务器上</h1><p id="5613" class="pw-post-body-paragraph lh li io lj b lk ll jp lm ln lo js lp lq lr ls lt lu lv lw lx ly lz ma mb mc ih bi translated">我们可以使用HTML表单上传文件，在Node.js服务器中，我们可以使用<a class="ae mh" href="https://www.npmjs.com/package/busboy" rel="noopener ugc nofollow" target="_blank"> busboy </a>包解析传入的HTML表单数据。如果要在生产环境中实现文件上传服务器，建议使用<a class="ae mh" href="https://www.npmjs.com/package/multer" rel="noopener ugc nofollow" target="_blank"> Multer </a>(依靠busboy解析表单数据)或者<a class="ae mh" href="https://www.npmjs.com/package/formidable" rel="noopener ugc nofollow" target="_blank">Harvard</a>。</p><p id="ffcd" class="pw-post-body-paragraph lh li io lj b lk mj jp lm ln mk js lp lq ml ls lt lu mm lw lx ly mn ma mb mc ih bi translated">我们需要优化Node.js代码，在访问根路径时响应一个HTML表单，用<code class="fe md me mf mg b">/upload</code>路径上传文件。</p><figure class="ke kf kg kh gu ki"><div class="bz fq l di"><div class="nc nd l"/></div></figure><p id="f5f4" class="pw-post-body-paragraph lh li io lj b lk mj jp lm ln mk js lp lq ml ls lt lu mm lw lx ly mn ma mb mc ih bi translated">在Node.js服务器中，当接收到客户端上传的文件时，使用busboy模块解析并保存到当前目录。</p><figure class="ke kf kg kh gu ki gi gj paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gi gj ne"><img src="../Images/2f09b818daa2e187c49b202eeb78ab61.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4eWqsoDHMqrOujaMQpt9cA.png"/></div></div></figure><h1 id="8a3d" class="kp kq io bd kr ks kt ku kv kw kx ky kz ju la jv lb jx lc jy ld ka le kb lf lg bi translated">结论</h1><p id="6481" class="pw-post-body-paragraph lh li io lj b lk ll jp lm ln lo js lp lq lr ls lt lu lv lw lx ly lz ma mb mc ih bi translated">在本文中，我们学习了如何使用Node.js实现一个非常简单的文件上传服务器。使用<a class="ae mh" href="https://www.npmjs.com/package/busboy" rel="noopener ugc nofollow" target="_blank"> busboy </a>模块，我们可以轻松地处理传入的HTML表单数据。但是推荐使用<a class="ae mh" href="https://www.npmjs.com/package/multer" rel="noopener ugc nofollow" target="_blank"> Multer </a>(依靠卫生员解析表单数据)或者<a class="ae mh" href="https://www.npmjs.com/package/formidable" rel="noopener ugc nofollow" target="_blank">威猛</a>。</p><p id="9afb" class="pw-post-body-paragraph lh li io lj b lk mj jp lm ln mk js lp lq ml ls lt lu mm lw lx ly mn ma mb mc ih bi translated">你想学习如何不使用任何npm模块解析HTML表单数据吗？你可以跟着我，我会在以后的文章中分享如何做。</p></div><div class="ab cl nf ng hs nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="ih ii ij ik il"><p id="7530" class="pw-post-body-paragraph lh li io lj b lk mj jp lm ln mk js lp lq ml ls lt lu mm lw lx ly mn ma mb mc ih bi translated"><em class="nm">更多内容看</em> <a class="ae mh" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="lj ip"> <em class="nm">说白了就是io </em> </strong> </a> <em class="nm">。报名参加我们的</em> <a class="ae mh" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="lj ip"> <em class="nm">免费周报</em> </strong> </a> <em class="nm">。关注我们关于</em><a class="ae mh" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="lj ip"><em class="nm">Twitter</em></strong></a><strong class="lj ip"><em class="nm"/></strong><em class="nm">和</em><a class="ae mh" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="lj ip"><em class="nm">LinkedIn</em></strong></a><em class="nm">。查看我们的</em> <a class="ae mh" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="lj ip"> <em class="nm">社区不和谐</em> </strong> </a> <em class="nm">加入我们的</em> <a class="ae mh" href="https://inplainenglish.pallet.com/talent/welcome" rel="noopener ugc nofollow" target="_blank"> <strong class="lj ip"> <em class="nm">人才集体</em> </strong> </a> <em class="nm">。</em></p></div></div>    
</body>
</html>