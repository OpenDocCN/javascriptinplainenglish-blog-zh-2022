<html>
<head>
<title>useImmutableRefValue to Help You Code Better in TypeScript + React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">ä½¿ç”¨ImmutableRefValueå¸®åŠ©æ‚¨åœ¨TypeScript + Reactä¸­æ›´å¥½åœ°ç¼–ç </h1>
<blockquote>åŸæ–‡ï¼š<a href="https://javascript.plainenglish.io/useimmutablerefvalue-to-help-you-code-better-in-typescript-react-d3767d20d79d?source=collection_archive---------8-----------------------#2022-11-29">https://javascript.plainenglish.io/useimmutablerefvalue-to-help-you-code-better-in-typescript-react-d3767d20d79d?source=collection_archive---------8-----------------------#2022-11-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="9383" class="pw-subtitle-paragraph jr ip iq bd b js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki dk translated">å¦ä¸€ä¸ªæŠ½è±¡å±‚æ¬¡<code class="fe jn jo jp jq b">useRef</code></h2></div><figure class="kk kl km kn gt ko gh gi paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gh gi kj"><img src="../Images/cc7bef6e2ab8aca2324683b84dc2e8e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XAt0XEtfDm3YJCVT"/></div></div><figcaption class="kv kw gj gh gi kx ky bd b be z dk">Photo by <a class="ae kz" href="https://unsplash.com/@marinajune?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">marina</a> on <a class="ae kz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="21c0" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">åœ¨Reactä¸­ï¼Œä½ å¯èƒ½ç»å¸¸ä½¿ç”¨<code class="fe jn jo jp jq b">useRef</code>ï¼Œå®ƒå…è®¸ä½ å¼•ç”¨æ¸²æŸ“ä¸éœ€è¦çš„å€¼ã€‚è¿™å¾ˆé‡è¦ï¼Œä¾‹å¦‚ï¼Œåœ¨ä¸€ä¸ªç»„ä»¶ä¸­åˆ›å»ºä¸€ä¸ªå”¯ä¸€çš„<code class="fe jn jo jp jq b">VideoPlayer</code>ã€‚</p><pre class="kk kl km kn gt lw jq lx bn ly lz bi"><span id="2528" class="ma mb iq jq b be mc md l me mf">function Component() {<br/>  const playerRef = useRef(new VideoPlayer());<br/>  // ...</span></pre><p id="4b8c" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">ä½†æ˜¯è¯·è®°ä½ï¼Œ<code class="fe jn jo jp jq b">useRef</code>ä¿å­˜åˆå§‹çš„<code class="fe jn jo jp jq b">ref</code>å€¼ä¸€æ¬¡ï¼Œå¹¶åœ¨ä¸‹æ¬¡æ¸²æŸ“æ—¶å¿½ç•¥å®ƒã€‚</p><p id="490e" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">å¯¹äºä¸Šé¢çš„ä¾‹å­ï¼Œç»„ä»¶åˆå§‹åŒ–æ—¶è°ƒç”¨<code class="fe jn jo jp jq b">new VideoPlayer()</code>çš„ç»“æœä¼šè¢«å­˜å‚¨åœ¨<code class="fe jn jo jp jq b">ref</code>ä¸­ï¼Œè¿™æ²¡é—®é¢˜ï¼Œä½†æ˜¯æ³¨æ„ä¸‹æ¬¡æ¸²æŸ“æ—¶<code class="fe jn jo jp jq b">new VideoPlayer()</code>è¿˜æ˜¯ä¼šè¢«å†æ¬¡è°ƒç”¨ï¼Œåªæ˜¯å…¶è°ƒç”¨çš„ç»“æœä¸å†è¢«<code class="fe jn jo jp jq b">useRef</code>æ¥æ”¶ã€‚è¿™æ„å‘³ç€è¿™æ˜¯æ— æ•ˆçš„æµªè´¹ï¼Œå¦‚æœæ‚¨æ­£åœ¨åˆ›å»ºæ˜‚è´µçš„å¯¹è±¡ï¼Œè¿™å¾ˆå¯èƒ½ä¼šå½±å“æ‚¨çš„åº”ç”¨ç¨‹åºçš„æ€§èƒ½ã€‚</p><p id="565a" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">å€¼å¾—ä¸€æçš„æ˜¯ï¼Œ<code class="fe jn jo jp jq b">useState</code>é’©å­ä¹Ÿæœ‰è¿™ç§æƒ…å†µï¼Œä½†æ˜¯å®ƒå¯ä»¥æ¥æ”¶ä¸€ä¸ª<em class="mg">åˆå§‹åŒ–å™¨</em>å‡½æ•°ï¼Œå¹¶ä¸”åœ¨ä¸‹ä¸€æ¬¡æ¸²æŸ“ä¸­ä¸å†è°ƒç”¨å®ƒï¼Œå°±åƒè¿™æ ·:<code class="fe jn jo jp jq b">const [player] = useState(() = &gt; new VideoPlayer());</code>ï¼Œä½†æ˜¯è¿™é‡Œ<code class="fe jn jo jp jq b">player</code>ä¸æ˜¯æ¸²æŸ“æ‰€éœ€è¦çš„å€¼ï¼Œæ‰€ä»¥è¿˜æ˜¯ç”¨<code class="fe jn jo jp jq b">useRef</code>æ¯”è¾ƒå¥½ã€‚</p><p id="0be7" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">æ‰€ä»¥ä¸ºäº†å¤„ç†è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦åœ¨æ¯ä¸ªç»„ä»¶æ¸²æŸ“ä¸­åšå‡ºåˆ¤æ–­:</p><pre class="kk kl km kn gt lw jq lx bn ly lz bi"><span id="f3fc" class="ma mb iq jq b be mc md l me mf">function Component() {<br/>  const playerRef = useRef(null);<br/>  if (playerRef.current === null) {<br/>    playerRef.current = new VideoPlayer();<br/>  }<br/>  // ...</span></pre><p id="c6ec" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">çœ‹èµ·æ¥ä¸é”™ï¼Œè¿™ä¸ªç»„ä»¶å°†åªè°ƒç”¨<code class="fe jn jo jp jq b">new VideoPlayer()</code>ä¸€æ¬¡ï¼Œå¹¶ç”Ÿæˆä¸€ä¸ªæƒŸä¸€çš„å®ä¾‹å­˜å‚¨åœ¨<code class="fe jn jo jp jq b">playerRef</code>ä¸­ã€‚ä½†æ˜¯å¦‚æœæ‚¨æ­£åœ¨ä½¿ç”¨TypeScriptï¼Œé‚£ä¹ˆåœ¨è®¿é—®<code class="fe jn jo jp jq b">playerRef</code>æ—¶æ‚¨å°†éœ€è¦ä¸€ä¸ªéç©ºæ£€æŸ¥:</p><pre class="kk kl km kn gt lw jq lx bn ly lz bi"><span id="25bf" class="ma mb iq jq b be mc md l me mf">function Component() {<br/>  const playerRef = useRef&lt;VideoPlayer | null&gt;(null);<br/>  if (playerRef.current === null) {<br/>    playerRef.current = new VideoPlayer();<br/>  }<br/><br/>  const onClick = () =&gt; {<br/>    // Error: Object is possibly 'null'.<br/>    playerRef.current.play();<br/>  };<br/>}</span></pre><p id="d04a" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">æ‚¨å½“ç„¶å¯ä»¥ç®€å•åœ°é€šè¿‡ä½¿ç”¨å¯é€‰çš„é“¾æ¥æ“ä½œç¬¦<code class="fe jn jo jp jq b">?.</code>æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå°±åƒè¿™æ ·:<code class="fe jn jo jp jq b">playerRef.current?.play();</code>ã€‚å¦‚æœæ˜¯ä¸€ä¸ªæˆ–è€…ä¸¤ä¸ªä¹Ÿæ²¡é—®é¢˜ï¼Œä½†æ˜¯å¦‚æœ<code class="fe jn jo jp jq b">player</code>æœ‰å¾ˆå¤šå¯è®¿é—®çš„å±æ€§å’Œæ–¹æ³•ï¼Œè¿™å°±éœ€è¦ä½ æŠŠå®ƒæ·»åŠ åˆ°ä½ ä½¿ç”¨çš„æ¯ä¸€ä¸ªåœ°æ–¹ï¼Œè¿™æ˜¯å¤šä½™çš„ã€‚</p><p id="74d5" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªç®€å•çš„å‡½æ•°æ¥è§„é¿è¿™ä¸ªé—®é¢˜:</p><pre class="kk kl km kn gt lw jq lx bn ly lz bi"><span id="b3b7" class="ma mb iq jq b be mc md l me mf">const getPlayer = () =&gt; {<br/>  if (!playerRef.current) {<br/>    playerRef.current = new VideoPlayer();<br/>  }<br/><br/>  return playerRef.current;<br/>};<br/><br/><br/>getPlayer().play();</span></pre><p id="c45d" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">å®ƒå·¥ä½œå¾—å¾ˆå¥½ï¼Œä½†æ˜¯å¦‚æœæ‚¨çš„Reactåº”ç”¨ç¨‹åºä¸­æœ‰å¾ˆå¤šåœ°æ–¹éœ€è¦è¿™æ ·å¤„ç†ï¼Œé‚£ä¹ˆæœ€å¥½æŠ½è±¡æˆä¸€ä¸ªè‡ªå®šä¹‰é’©å­:</p><figure class="kk kl km kn gt ko"><div class="bz fp l di"><div class="mh mi l"/></div></figure><p id="7d70" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">ä½¿ç”¨å®ƒå¯ä»¥åœ¨ç±»ä¼¼çš„é€»è¾‘ä¸­è·å¾—å”¯ä¸€çš„ä¸å¯å˜å‚è€ƒå€¼:</p><pre class="kk kl km kn gt lw jq lx bn ly lz bi"><span id="e37d" class="ma mb iq jq b be mc md l me mf">function Component() {<br/>  const player = useImmutableRefValue(() =&gt; new VideoPlayer());<br/><br/>  const onClick = () =&gt; {<br/>    player.play();<br/>  };<br/>}</span></pre><p id="2121" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">ç©å¾—å¼€å¿ƒï¼æ„Ÿè°¢é˜…è¯»ï¼Œä¸‹æ¬¡å†è§ï¼Œå¹²æ¯ğŸ»</p><p id="6217" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated"><em class="mg">ä¸æ˜¯ä¸­ç­‰ä¼šå‘˜ï¼Ÿ</em> <a class="ae kz" href="https://medium.com/@hellostephanie2022/membership" rel="noopener"> <em class="mg">æ”¯æŒæˆ‘åœ¨è¿™é‡Œæˆä¸ºä¸€ä¸ª</em> </a> <em class="mg">ã€‚</em></p><p id="46d0" class="pw-post-body-paragraph la lb iq lc b ld le jv lf lg lh jy li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated"><em class="mg">æ›´å¤šå†…å®¹è¯·çœ‹</em><a class="ae kz" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="lc ir"><em class="mg">plain English . io</em></strong></a><em class="mg">ã€‚æŠ¥åå‚åŠ æˆ‘ä»¬çš„</em> <a class="ae kz" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="lc ir"> <em class="mg">å…è´¹å‘¨æŠ¥</em> </strong> </a> <em class="mg">ã€‚å…³æ³¨æˆ‘ä»¬å…³äº</em><a class="ae kz" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="lc ir"><em class="mg">Twitter</em></strong></a><a class="ae kz" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="lc ir"><em class="mg">LinkedIn</em></strong></a><em class="mg"/><a class="ae kz" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"><strong class="lc ir"><em class="mg">YouTube</em></strong></a><em class="mg"/><a class="ae kz" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"><strong class="lc ir"><em class="mg">ä¸å’Œ</em> </strong> </a> <em class="mg">ã€‚å¯¹å¢é•¿é»‘å®¢æ„Ÿå…´è¶£ï¼Ÿæ£€æŸ¥</em> <a class="ae kz" href="https://circuit.ooo/" rel="noopener ugc nofollow" target="_blank"> <strong class="lc ir"> <em class="mg">ç”µè·¯</em> </strong> </a> <em class="mg">ã€‚</em></p></div></div>    
</body>
</html>