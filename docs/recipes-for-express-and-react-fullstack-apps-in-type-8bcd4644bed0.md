# TypeScript ä¸­ Express & React å…¨æ ˆåº”ç”¨ç¨‹åºçš„é…æ–¹

> åŸæ–‡ï¼š<https://javascript.plainenglish.io/recipes-for-express-and-react-fullstack-apps-in-type-8bcd4644bed0?source=collection_archive---------8----------------------->

## å¦‚ä½•ä½¿ç”¨ TypeScript åœ¨ Express ä¸­æ„å»ºä¼˜é›…çš„å…¨æ ˆåº”ç”¨

![](img/2d9f978b1d215b98fd68919b9a38df3c.png)

Photo by [Chris Liverani](https://unsplash.com/@chrisliverani?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) on [Unsplash](https://unsplash.com/s/photos/fast?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)

æˆ‘ç”¨ Flask ç”¨ Python å†™äº†ä¸å°‘åº”ç”¨åç«¯ï¼Œæ‰€ä»¥æƒ³è¯•è¯•å®ƒçš„ JavaScript è¡¨äº² Expressã€‚

æˆ‘æ‰¾åˆ°äº†ä¸€äº›å…³äºå¦‚ä½•åœ¨å…¨æ ˆåº”ç”¨ä¸­åšåˆ°è¿™ä¸€ç‚¹çš„æ•™ç¨‹ã€‚ç„¶è€Œï¼Œå®ƒä»¬ä¼¼ä¹éƒ½ä¸å¤ªè¯¦ç»†ã€‚æˆ‘æ„Ÿå…´è¶£çš„æ˜¯å¦‚ä½•ç¼–å†™ä¸€äº›å¯ä»¥å¾ˆå¥½åœ°æ‰©å±•ä»¥åŒ…æ‹¬è®¸å¤šè·¯ç”±ï¼Œå®¹æ˜“ä¸å‰ç«¯é›†æˆï¼Œä»¥åŠå¦‚ä½•å°†å…¶å…¨éƒ¨å®¹å™¨åŒ–çš„ä¸œè¥¿ã€‚

è¿™å°±æ˜¯è¿™ç¯‡æ–‡ç« çš„å†…å®¹ğŸ˜å¦‚æœä½ æƒ³ç›´æ¥è·³åˆ°ä»£ç ï¼Œç‚¹å‡»[è¿™é‡Œ](https://github.com/osintalex/express-react-poc)ã€‚(æ²¡æœ‰åˆ¤æ–­ï¼Œæˆ‘åœ¨çœ‹æ–‡ç« çš„æ—¶å€™ä¸€ç›´éƒ½æ˜¯è¿™æ ·ğŸ˜‰).

## æ¦‚è§‚

é¦–å…ˆï¼Œè¿™é‡Œæ˜¯æˆ‘æƒ³é€šè¿‡è¿™ä¸ªæ¦‚å¿µéªŒè¯è§£å†³çš„æ‰€æœ‰é—®é¢˜:

1.  æ‹¥æœ‰è¶…çº§æ¨¡å—åŒ–çš„åº”ç”¨é…ç½®æ–¹å¼ï¼Œå³è½»æ¾å…è®¸ä¸åŒçš„å¼€å‘ã€ç”Ÿäº§å’Œæµ‹è¯•å€¼ï¼›
2.  é‡‡ç”¨æ¨¡å—åŒ–æ–¹å¼å¤„ç†ç”³è¯·è·¯çº¿ï¼›
3.  æœ‰ä¸€ç§å¤„ç†æ•°æ®åº“æ“ä½œçš„æ–¹æ³•ï¼Œæ„‰å¿«åœ°æ³¨å…¥æ•°æ®åº“ä¾èµ–å…³ç³»ï¼Œæœ€å¥½è¿™æ ·å®ƒä»¬å¯ä»¥åœ¨æµ‹è¯•ä¸­å¾ˆå®¹æ˜“åœ°æ¨¡æ‹Ÿå‡ºæ¥ï¼›
4.  å°† React åº”ç”¨ç¨‹åºä¸ express åº”ç”¨ç¨‹åºæ†ç»‘åœ¨ä¸€èµ·çš„éå¸¸ç®€å•çš„æ–¹æ³•ï¼›
5.  ä¸€ä¸ªå®¹å™¨åŒ–åº”ç”¨çš„æœ€ç»ˆäº¤ä»˜ç‰©ï¼›
6.  å…·æœ‰é¢„æäº¤æŒ‚é’©çš„è‰¯å¥½ä»£ç æ—æŒºï¼›
7.  æ‰€æœ‰ä¸œè¥¿éƒ½æ˜¯æ‰“å­—ç¨¿ï¼

é¦–å…ˆï¼Œè¿™æ˜¯æˆ‘çš„åº”ç”¨ç¨‹åºå¸ƒå±€çš„æ ·å­:

```
backend/
--package.json
--tsconfig.json
--yarn.lock
--src/
  --index.ts //entrypoint
  --configs/
  --controllers/
  --db/
  --models/
  --tests/frontend/
  --package.json
  --tsconfig.json
  --yarn.lock
  --src/
    --index.tsx //entrypoint
    --App.tsx
```

æ­£å¦‚ä½ ä»ä¸Šé¢çœ‹åˆ°çš„ï¼Œæˆ‘åœ¨ååº”éƒ¨åˆ†æ²¡æœ‰åšä»»ä½•å·¥ä½œã€‚æˆ‘åˆšåˆšç¡®ä¿æ‚¨å¯ä»¥è½»æ¾é›†æˆ React åº”ç”¨ç¨‹åºï¼Œè¿™æ„å‘³ç€æ‚¨çš„åº”ç”¨ç¨‹åºæœ‰ä¸€ä¸ªå¾ˆå¥½çš„å‰ç«¯ï¼Œæ‚¨å¯ä»¥å¯¹åç«¯è¿›è¡Œ API è°ƒç”¨ï¼Œè€Œä¸ä¼šå‡ºç°ä»»ä½•é—®é¢˜ã€‚

## æ¨¡å—åŒ–é…ç½®

æˆ‘çœŸçš„å¾ˆå–œæ¬¢åœ¨ Python ä¸­è¿™æ ·åšçš„å…¸å‹æ–¹å¼ï¼Œå› ä¸ºå®ƒä½¿å¾—åœ¨ä¸åŒé…ç½®ä¹‹é—´åˆ‡æ¢å˜å¾—å¦‚æ­¤å®¹æ˜“ã€‚ä¸‹é¢æ˜¯åœ¨ä¸€ä¸ª`backend/src/configs/config.ts`æ–‡ä»¶ä¸­çš„ TypeScript ä¸­çš„æ ·å­ã€‚

æˆ‘è®¤ä¸ºè¿™å¾ˆé…·çš„åŸå› æ˜¯ï¼Œä½ å¯ä»¥åœ¨åº”ç”¨ç¨‹åºçš„ä»»ä½•åœ°æ–¹åšè¿™æ ·çš„äº‹æƒ…:

```
import { configByEnvironment, environmentName, ConfigType } from "./configs/config";const configuration: *ConfigType* = configByEnvironment(environmentName);
const { port } = configuration;app.use(morgan(configuration.morganFormat));
```

æ‰€ä»¥ä½ åªéœ€è¦ä¿®æ”¹`config.ts`æ–‡ä»¶ä¸­çš„å†…å®¹å°±å¯ä»¥äº†â€”â€”å¾ˆç®€å•ã€‚

## æ¨¡å—åŒ–è·¯çº¿

è¿™éå¸¸ç®€å•ï¼Œä½†æˆ‘èŠ±äº†ä¸€æ®µæ—¶é—´æ‰ä»ç½‘ä¸Šé˜…è¯»çš„ææ–™ä¸­å¼„æ˜ç™½ï¼Œæ‰€ä»¥ä¸‹é¢æ˜¯æˆ‘å¦‚ä½•åšçš„ï¼Œä»¥é˜²å…¶ä»–äººå‘ç°å®ƒæœ‰ç”¨:

åœ¨`controllers/`å†…è¿™æ ·å®šä¹‰è·¯çº¿:

ç„¶åä½ å¯ä»¥åƒè¿™æ ·åœ¨`index.ts`ä¸­æ³¨å†Œå®ƒä»¬:

```
import example from "./controllers/example";
import express, { Express} from "express";const app: *Express* = express();
app.use("/example", example);
```

## æ•°æ®åº“ä¾èµ–æ€§

æˆ‘å‘ç°æœ€ç®€æ´çš„æ–¹æ³•æ˜¯ä½¿ç”¨`typeorm`å¹¶åœ¨æˆ‘çš„`db`ç›®å½•ä¸­å®šä¹‰ä¸€ä¸ªè¿™æ ·çš„æ•°æ®åº“è¯»å–æ“ä½œæ¨¡å—:

ç¬¬ 28 è¡Œéå¸¸å…³é”®â€”â€”è¿™ä½¿å¾—åœ¨æµ‹è¯•ä¸­æ¨¡æ‹Ÿæ•°æ®åº“æ“ä½œå˜å¾—éå¸¸å®¹æ˜“ï¼Œå¹¶ä¸”å¾ˆå®¹æ˜“å°†è¯»å–æŠ¥å‘Šæ”¾åˆ°è§†å›¾ä¸­ã€‚å›å¤´çœ‹çœ‹ä¸Šé¢æ§åˆ¶å™¨ä¸­çš„`example.ts`æ–‡ä»¶ï¼Œæ˜ç™½æˆ‘çš„æ„æ€ã€‚

ä¸ºäº†æµ‹è¯•ï¼Œæˆ‘å‘ç°å¾ˆå®¹æ˜“ç”¨ sinon æ¥æ¨¡æ‹Ÿè¿™ä¸€ç‚¹:

..è¿™æ ·ä½ å°±ä¸å¿…åšä»»ä½•å¥‡æ€ªçš„äº‹æƒ…ï¼Œä»`typeorm`åº“æˆ–è€…ä½ æ­£åœ¨ä½¿ç”¨çš„ä»»ä½•å…¶ä»– ORM ä¸­æ¨¡ä»¿æ›´å¤§èŒƒå›´çš„æ–¹æ³•ã€‚

## ä¸ React æ†ç»‘

è¿™åœ¨ä½ çš„`index.ts`é‡Œå¾ˆå®¹æ˜“åšåˆ°ã€‚ä½ æ‰€è¦åšçš„å°±æ˜¯:

```
app.get("*", (*_req*: *Request*, *res*: *Response*): *void* => {*res*.sendFile(configuration.frontendStaticFilesPath, "index.html");});
```

å…¶ä¸­`frontendStaticFilesPath`æŒ‡å‘è¿è¡Œ`react-scripts build`äº§ç”Ÿçš„æ„å»ºè¾“å‡ºã€‚æˆ‘è®¤ä¸ºè¿™éå¸¸å¥½ï¼Œå› ä¸ºå®ƒé¿å…äº†æ‚¨åœ¨å…¨æ ˆå·¥ä½œæ—¶ç»å¸¸é‡åˆ°çš„ä¸€äº›å…¶ä»–é—®é¢˜:

*   æ— éœ€è¿›è¡Œä»»ä½• CORS é…ç½®ğŸ˜ã€‚ä½ çš„å‰ç«¯å®é™…ä¸Šå’Œä½ çš„åç«¯åœ¨åŒä¸€ä¸ªåŸç‚¹ä¸Šï¼
*   æ‚¨å¯ä»¥éå¸¸è½»æ¾åœ°åœ¨ä¸€ä¸ªå®¹å™¨ä¸­è¿è¡Œæ‰€æœ‰å†…å®¹ï¼Œæ— éœ€åˆ†ç¦»å‰ç«¯æˆ–åç«¯æœåŠ¡ã€‚å½“ç„¶ï¼Œä½ å¯èƒ½ä¼šå› ä¸ºå…¶ä»–åŸå› æƒ³è¿™ä¹ˆåšï¼Œæ¯”å¦‚ç¼©æ”¾ç­‰ç­‰ï¼Œä½†æ˜¯å¯¹äºä¸€ä¸ªå¿«é€ŸåŸå‹ï¼Œæˆ‘è®¤ä¸ºè¿™æ˜¯ğŸ†’

è¿™ä½¿æˆ‘æƒ³åˆ°â€¦

## å°†æ‚¨çš„åº”ç”¨å®¹å™¨åŒ–

ç”±äºä¸€åˆ‡éƒ½åœ¨ä¸€ä¸ªæœåŠ¡ä¸­è¿è¡Œï¼Œå¹¶ä¸”å› ä¸ºæ‚¨çš„ TypeScript æ­£åœ¨ç¼–è¯‘ä¸º JavaScriptï¼Œæ‰€ä»¥æ‚¨å¯ä»¥é€šè¿‡å¦‚ä¸‹ä¸‰é˜¶æ®µæ„å»ºå°†ä¸€åˆ‡å·§å¦™åœ°ç»“åˆåœ¨ä¸€èµ·:

è¿™å°†äº§ç”Ÿä¸€ä¸ªè¶…çº§è½»é‡çº§çš„æœ€ç»ˆæ˜ åƒï¼Œå®ƒä½œä¸ºéæ ¹ç”¨æˆ·èŠ‚ç‚¹è¿è¡Œï¼Œå¹¶åˆ©ç”¨äº†`pm2`ã€‚å¦‚æœä½ å¯¹æˆ‘åœ¨è¿™é‡Œåšå‡ºçš„ä¸€äº›é€‰æ‹©æ„Ÿåˆ°å¥½å¥‡ï¼Œåœ¨ Docker [è¿™é‡Œ](/build-a-production-ready-node-express-api-with-docker-9a45443427a0)æœ‰ä¸€ç¯‡å…³äºå‘å¸ƒå¿«é€’åº”ç”¨çš„å¾ˆå¥½çš„æ–‡ç« ã€‚

## ä»£ç æ—æŒº

æœ‰å¾ˆå¤šæ–¹æ³•å¯ä»¥è®¾ç½® ESLintï¼Œæ‰€ä»¥æˆ‘å°±ä¸æ·±ç©¶äº†ã€‚æˆ‘å»ºè®®é˜…è¯»ä¸€äº›å…³äºå¦‚ä½•åšåˆ°è¿™ä¸€ç‚¹çš„å…·ä½“å¸–å­ï¼Œæˆ–è€…å¦‚æœä½ ä¸ä»‹æ„ï¼Œé‚£ä¹ˆå°±ä½¿ç”¨`npx eslint init`æˆ–å®ƒçš„ç­‰æ•ˆç‰©`yarn eslint init`ã€‚

ä¸€æ—¦è¿™æ ·åšäº†ï¼Œå°½ç®¡å°† husky æ·»åŠ åˆ°å…¨æ ˆåº”ç”¨ç¨‹åºè®¾ç½®ä¸­æœ‰ç‚¹éº»çƒ¦ï¼Œä¾‹å¦‚ï¼Œå¸¦æœ‰ 2 ä¸ª`package.json`æ–‡ä»¶çš„ repoã€‚

æˆ‘æ˜¯è¿™æ ·åšçš„:

```
// Add this to package.json scripts in backend
"prepare": "cd .. && husky install backend/.husky"
// Add this in frontend
"prepare": "cd .. && husky install frontend/.husky"
```

ç„¶ååœ¨å‰ç«¯ç›®å½•ä¸­ï¼Œä½ å¯ä»¥ç‚¹å‡»`yarn prepare`ç„¶å`yarn husky add .husky/pre-commit "cd frontend && <lint command goes here>"`ï¼Œç„¶åå¯¹åç«¯åšå®Œå…¨ç›¸åŒçš„äº‹æƒ…ã€‚

è¿™å°±å¯¹äº†ã€‚å¸Œæœ›è¿™æœ‰å¸®åŠ©ã€‚ğŸ˜…

*æ›´å¤šå†…å®¹è¯·çœ‹*[***plain English . io***](https://plainenglish.io/)*ã€‚æŠ¥åå‚åŠ æˆ‘ä»¬çš„* [***å…è´¹å‘¨æŠ¥***](http://newsletter.plainenglish.io/) *ã€‚å…³æ³¨æˆ‘ä»¬å…³äº*[***Twitter***](https://twitter.com/inPlainEngHQ)*å’Œ*[***LinkedIn***](https://www.linkedin.com/company/inplainenglish/)*ã€‚æŸ¥çœ‹æˆ‘ä»¬çš„* [***ç¤¾åŒºä¸å’Œè°***](https://discord.gg/GtDtUAvyhW) *åŠ å…¥æˆ‘ä»¬çš„* [***äººæ‰é›†ä½“***](https://inplainenglish.pallet.com/talent/welcome) *ã€‚*