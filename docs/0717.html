<html>
<head>
<title>Refactor a React Component from 165 Lines to 30 Lines</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将React组件从165行重构为30行</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/refactor-a-react-component-from-165-lines-to-30-lines-1689b15ebfe0?source=collection_archive---------3-----------------------#2022-02-09">https://javascript.plainenglish.io/refactor-a-react-component-from-165-lines-to-30-lines-1689b15ebfe0?source=collection_archive---------3-----------------------#2022-02-09</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><div class=""><h2 id="c291" class="pw-subtitle-paragraph jo iq ir bd b jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dk translated">使用React挂钩形式和材质UI清理React组件</h2></div><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj kg"><img src="../Images/a4b70c90463a004090fec8869a0d7e4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s6n2AVhQn1_vkOjoCruDZQ.jpeg"/></div></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">Photo by <a class="ae kw" href="https://unsplash.com/@cgower?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Christopher Gower</a> on <a class="ae kw" href="https://unsplash.com/s/photos/technology?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="988a" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">React Hook Form是React生态系统中最流行的处理表单输入的库之一。</p><p id="5302" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">但是，如果您使用任何类型的组件库，让它正确集成可能有点棘手。</p><p id="aaf0" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">今天，我将向您展示如何使用React Hook表单集成Material UI的各种组件。</p><p id="2ae4" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">让我们开始吧。</p><h1 id="e561" class="lt lu ir bd lv lw lx ly lz ma mb mc md jx me jy mf ka mg kb mh kd mi ke mj mk bi translated">先决条件</h1><p id="495e" class="pw-post-body-paragraph kx ky ir kz b la ml js lc ld mm jv lf lg mn li lj lk mo lm ln lo mp lq lr ls ik bi translated">关于如何使用<code class="fe mq mr ms mt b">react-hook-form</code>，我就不多赘述了。如果你还不知道如何使用<code class="fe mq mr ms mt b">react-hook-form</code>，我强烈建议你先看看这篇文章</p><div class="mu mv gq gs mw mx"><a rel="noopener  ugc nofollow" target="_blank" href="/how-to-use-react-hook-form-with-typescript-2cf597c0c45f"><div class="my ab fp"><div class="mz ab na cl cj nb"><h2 class="bd is gz z fq nc fs ft nd fv fx iq bi translated">如何在TypeScript中使用React Hook表单</h2><div class="ne l"><h3 class="bd b gz z fq nc fs ft nd fv fx dk translated">为您的应用程序构建高性能、简洁的表单</h3></div><div class="nf l"><p class="bd b dl z fq nc fs ft nd fv fx dk translated">javascript.plainenglish.io</p></div></div><div class="ng l"><div class="nh l ni nj nk ng nl kq mx"/></div></div></a></div><p id="c871" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">我只能说，你不会后悔学习这个图书馆。</p><h1 id="89f8" class="lt lu ir bd lv lw lx ly lz ma mb mc md jx me jy mf ka mg kb mh kd mi ke mj mk bi translated">起始代码</h1><p id="e233" class="pw-post-body-paragraph kx ky ir kz b la ml js lc ld mm jv lf lg mn li lj lk mo lm ln lo mp lq lr ls ik bi translated">让我们看看我们将要开始的代码。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="nm nn l"/></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">FormBadDemo.tsx</figcaption></figure><p id="5a14" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">这是一个非常标准的表格。我们使用了一些最常见的表单输入。但是这个组件有些问题。</p><ul class=""><li id="1dc7" class="no np ir kz b la lb ld le lg nq lk nr lo ns ls nt nu nv nw bi translated"><code class="fe mq mr ms mt b">onChange</code>经手人重复。如果我们有多个文本输入，我们需要管理这些个人，这是非常令人沮丧的。</li><li id="0f2d" class="no np ir kz b la nx ld ny lg nz lk oa lo ob ls nt nu nv nw bi translated">如果我们想要处理错误，那么它们的大小和复杂性将会爆炸。</li></ul><h1 id="9c7d" class="lt lu ir bd lv lw lx ly lz ma mb mc md jx me jy mf ka mg kb mh kd mi ke mj mk bi translated">主要思想</h1><p id="1dff" class="pw-post-body-paragraph kx ky ir kz b la ml js lc ld mm jv lf lg mn li lj lk mo lm ln lo mp lq lr ls ik bi translated">如你所知，<code class="fe mq mr ms mt b">react-hook-form</code>与HTML的默认输入组件配合得非常好。但如果我们使用各种组件库，如Material-UI或Ant design或任何其他组件库，情况就不一样了。</p><p id="1849" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">为了处理这些情况，<code class="fe mq mr ms mt b">react-hook-form</code>所做的是导出一个名为<code class="fe mq mr ms mt b"><strong class="kz is">Contrtoller</strong></code> <strong class="kz is">的特殊包装组件。如果你知道这个特殊的组件是如何工作的，那么将它与任何其他库集成将是小菜一碟。</strong></p><p id="71ff" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">控制器组件的框架如下所示。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="nm nn l"/></div></figure><p id="9e04" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">如果您已经完成了基本的表单处理(我确信您已经完成了)，那么您应该知道两个字段对于任何输入组件都是重要的。一个是<code class="fe mq mr ms mt b">value</code>，另一个是<code class="fe mq mr ms mt b">onChange</code>。</p><p id="209b" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">因此，我们的<code class="fe mq mr ms mt b">Controller</code>组件将这两个属性以及<code class="fe mq mr ms mt b">react-hook-form</code>的所有其他魔力注入到组件中。</p><p id="d976" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">其他一切都像魔咒一样管用！让我们看看它的实际效果。</p><h1 id="c12f" class="lt lu ir bd lv lw lx ly lz ma mb mc md jx me jy mf ka mg kb mh kd mi ke mj mk bi translated">表单输入道具</h1><p id="0fbb" class="pw-post-body-paragraph kx ky ir kz b la ml js lc ld mm jv lf lg mn li lj lk mo lm ln lo mp lq lr ls ik bi translated">每个表单输入都需要两个基本属性。分别是<code class="fe mq mr ms mt b">name</code>和<code class="fe mq mr ms mt b">value</code>。这两个属性控制所有功能的功能。</p><p id="c3f3" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">所以，为此添加一个类型。如果你使用javascript，你不需要这个。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="nm nn l"/></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">FormInputProps.ts</figcaption></figure><h1 id="9bd6" class="lt lu ir bd lv lw lx ly lz ma mb mc md jx me jy mf ka mg kb mh kd mi ke mj mk bi translated">文本输入</h1><p id="7ab6" class="pw-post-body-paragraph kx ky ir kz b la ml js lc ld mm jv lf lg mn li lj lk mo lm ln lo mp lq lr ls ik bi translated">这是我们首先需要处理的最基本的组件。下面是一个用material UI构建的独立文本输入组件。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="nm nn l"/></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">FormInputText.tsx</figcaption></figure><p id="603a" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">在这个组件中，我们使用了<code class="fe mq mr ms mt b">control</code>属性表单<code class="fe mq mr ms mt b">react-hook-form</code>。我们已经知道这是从<code class="fe mq mr ms mt b">useForm()</code>库的钩子上导出的。</p><p id="26dc" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">我们还展示了如何显示错误。对于其余的组件，为了简洁起见，我们将跳过这一步。</p><h1 id="9fd3" class="lt lu ir bd lv lw lx ly lz ma mb mc md jx me jy mf ka mg kb mh kd mi ke mj mk bi translated">无线电信号输入</h1><p id="90b7" class="pw-post-body-paragraph kx ky ir kz b la ml js lc ld mm jv lf lg mn li lj lk mo lm ln lo mp lq lr ls ik bi translated">我们第二常见的输入组件是<code class="fe mq mr ms mt b">Radio</code>。与<code class="fe mq mr ms mt b">material-ui</code>整合的代码如下。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="nm nn l"/></div></figure><p id="9d86" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">我们需要一个<code class="fe mq mr ms mt b">options</code>数组，在其中我们需要传递该组件的可用选项。</p><p id="4336" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">如果你仔细观察，你会发现这两个组件在用法上非常相似。</p><h1 id="2ca3" class="lt lu ir bd lv lw lx ly lz ma mb mc md jx me jy mf ka mg kb mh kd mi ke mj mk bi translated">下拉输入</h1><p id="978f" class="pw-post-body-paragraph kx ky ir kz b la ml js lc ld mm jv lf lg mn li lj lk mo lm ln lo mp lq lr ls ik bi translated">我们的下一个组件是下拉菜单。几乎任何形式都需要某种下拉菜单。组件的代码如下所示</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="nm nn l"/></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">FormInputDropdown.tsx</figcaption></figure><p id="9d10" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">在此组件中，我们已经删除了显示标签的错误。它就像无线电组件一样</p><h1 id="9b71" class="lt lu ir bd lv lw lx ly lz ma mb mc md jx me jy mf ka mg kb mh kd mi ke mj mk bi translated">日期输入</h1><p id="6cdc" class="pw-post-body-paragraph kx ky ir kz b la ml js lc ld mm jv lf lg mn li lj lk mo lm ln lo mp lq lr ls ik bi translated">这是一个普通而特殊的组件。在材质界面中，我们没有任何开箱即用的<code class="fe mq mr ms mt b">Date</code>组件。我们需要一些助手库。</p><p id="90e3" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">首先，安装那些依赖项</p><pre class="kh ki kj kk gu oc mt od oe aw of bi"><span id="3fff" class="og lu ir mt b gz oh oi l oj ok">yarn add @date-io/date-fns@1.3.13 @material-ui/pickers@3.3.10 date-fns@2.22.1</span></pre><p id="38bb" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">小心版本。否则，可能会出现一些奇怪的问题。我们还需要用特殊的包装器包装我们的数据输入组件。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="nm nn l"/></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">FormInputDate.tsx</figcaption></figure><p id="b215" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">我选了<code class="fe mq mr ms mt b">date-fns</code>。可以像<code class="fe mq mr ms mt b">moment</code>一样挑别人。</p><h1 id="d72e" class="lt lu ir bd lv lw lx ly lz ma mb mc md jx me jy mf ka mg kb mh kd mi ke mj mk bi translated">复选框输入</h1><p id="59bf" class="pw-post-body-paragraph kx ky ir kz b la ml js lc ld mm jv lf lg mn li lj lk mo lm ln lo mp lq lr ls ik bi translated">这是最棘手的部分。没有明确的例子说明如何使用这个组件和<code class="fe mq mr ms mt b">react-hook-form</code>。为了处理输入，我们必须做一些手工劳动。</p><p id="3940" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">我们在这里控制选定的状态，以正确处理输入。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="nm nn l"/></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">FormInputCheckbox.tsx</figcaption></figure><p id="33d4" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">现在你只需给它一个选项列表，一切都会变得非常好！</p><h1 id="7de2" class="lt lu ir bd lv lw lx ly lz ma mb mc md jx me jy mf ka mg kb mh kd mi ke mj mk bi translated">滑块输入</h1><p id="bbd7" class="pw-post-body-paragraph kx ky ir kz b la ml js lc ld mm jv lf lg mn li lj lk mo lm ln lo mp lq lr ls ik bi translated">我们的最后一个组件是一个<code class="fe mq mr ms mt b">Slider</code>组件。这是一个相当常见的组件。代码很容易理解</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="nm nn l"/></div></figure><p id="a913" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">您可以自定义<code class="fe mq mr ms mt b">handleChange</code>函数，使其成为两端滑块组件(对时间范围有用)。将<code class="fe mq mr ms mt b">number</code>改为<code class="fe mq mr ms mt b">number[]</code>即可</p><h1 id="af94" class="lt lu ir bd lv lw lx ly lz ma mb mc md jx me jy mf ka mg kb mh kd mi ke mj mk bi translated">把所有东西都钩在一起</h1><p id="6ef8" class="pw-post-body-paragraph kx ky ir kz b la ml js lc ld mm jv lf lg mn li lj lk mo lm ln lo mp lq lr ls ik bi translated">现在让我们在最终表单中使用所有这些组件。这将利用我们刚刚制作的可重复使用的组件。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="nm nn l"/></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">FormDemo.tsx</figcaption></figure><p id="93ae" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">最后，我们的表单看起来像这样。是不是很棒？</p><p id="ec29" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">我希望你今天学到了一些东西。祝您愉快！</p><p id="9518" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated"><strong class="kz is">有话要说？通过</strong><a class="ae kw" href="https://www.linkedin.com/in/56faisal/" rel="noopener ugc nofollow" target="_blank"><strong class="kz is">LinkedIn</strong></a>联系我</p><h2 id="0104" class="og lu ir bd lv ol om dn lz on oo dp md lg op oq mf lk or os mh lo ot ou mj ov bi translated">资源:</h2><ul class=""><li id="7bdc" class="no np ir kz b la ml ld mm lg ow lk ox lo oy ls nt nu nv nw bi translated"><strong class="kz is">视频格式:</strong>【https://www.youtube.com/watch?v=aaj6YCil1p4 T2】</li><li id="8300" class="no np ir kz b la nx ld ny lg nz lk oa lo ob ls nt nu nv nw bi translated"><strong class="kz is">Github Repo:</strong><a class="ae kw" href="https://github.com/Mohammad-Faisal/react-hook-form-material-ui" rel="noopener ugc nofollow" target="_blank">https://Github . com/Mohammad-fais al/react-hook-form-material-ui</a></li></ul><p id="98ac" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated"><em class="oz">更多内容看</em> <a class="ae kw" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kz is"> <em class="oz">说白了。报名参加我们的</em> <a class="ae kw" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kz is"> <em class="oz">免费周报</em> </strong> </a> <em class="oz">。在我们的</em> <a class="ae kw" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kz is"> <em class="oz">社区不和谐</em> </strong> </a> <em class="oz">获得独家获取写作机会和建议。</em></strong></a></p><div class="mu mv gq gs mw mx"><a rel="noopener  ugc nofollow" target="_blank" href="/story-of-a-failed-react-project-f32177479bdf"><div class="my ab fp"><div class="mz ab na cl cj nb"><h2 class="bd is gz z fq nc fs ft nd fv fx iq bi translated">React项目失败的故事</h2><div class="ne l"><h3 class="bd b gz z fq nc fs ft nd fv fx dk translated">这给我们的创业带来了灾难。</h3></div><div class="nf l"><p class="bd b dl z fq nc fs ft nd fv fx dk translated">javascript.plainenglish.io</p></div></div><div class="ng l"><div class="pa l ni nj nk ng nl kq mx"/></div></div></a></div><div class="mu mv gq gs mw mx"><a rel="noopener  ugc nofollow" target="_blank" href="/45-npm-packages-to-solve-16-react-problems-a9ab18946224"><div class="my ab fp"><div class="mz ab na cl cj nb"><h2 class="bd is gz z fq nc fs ft nd fv fx iq bi translated">45个NPM软件包解决16个React问题</h2><div class="ne l"><h3 class="bd b gz z fq nc fs ft nd fv fx dk translated">关于如何选择完美的npm包的深入指导</h3></div><div class="nf l"><p class="bd b dl z fq nc fs ft nd fv fx dk translated">javascript.plainenglish.io</p></div></div><div class="ng l"><div class="pb l ni nj nk ng nl kq mx"/></div></div></a></div></div></div>    
</body>
</html>