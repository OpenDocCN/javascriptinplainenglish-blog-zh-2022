<html>
<head>
<title>How to Trigger a Component to Re-render with Hooks in React?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在React中触发一个组件用钩子重新渲染？</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-trigger-a-component-to-re-render-with-hooks-in-react-b78061c6be54?source=collection_archive---------1-----------------------#2022-02-12">https://javascript.plainenglish.io/how-to-trigger-a-component-to-re-render-with-hooks-in-react-b78061c6be54?source=collection_archive---------1-----------------------#2022-02-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/ec07b6ad2c4c1897e20a67c109a42092.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BX3Rcz1naYay47_0"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@pbernardon?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Pascal Bernardon</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="a065" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有时，我们可能希望触发一个组件，在用React钩子创建的组件中重新呈现。</p><p id="8aa5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将研究如何触发一个组件在用钩子创建的React组件中重新呈现。</p><h1 id="ac53" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">更新道具或状态</h1><p id="a110" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">如果属性或状态值改变，组件将重新呈现。</p><p id="0763" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，我们可以在更新属性或状态值时触发组件的重新呈现。</p><p id="55d2" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了更新状态，我们调用状态设置函数。</p><p id="81d0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="38f1" class="mn lc iq mj b gy mo mp l mq mr">import React, { useState } from "react";</span><span id="ffe1" class="mn lc iq mj b gy ms mp l mq mr">export default function App() {<br/>  const [count, setCount] = useState(0);</span><span id="5ae9" class="mn lc iq mj b gy ms mp l mq mr">  return (<br/>    &lt;div className="App"&gt;<br/>      &lt;button onClick={() =&gt; setCount((c) =&gt; c + 1)}&gt;increment&lt;/button&gt;<br/>      &lt;p&gt;{count}&lt;/p&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><p id="633f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">添加一个调用<code class="fe mt mu mv mj b">setCount</code>来更新<code class="fe mt mu mv mj b">count</code>状态的按钮。</p><p id="7a6f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们知道<code class="fe mt mu mv mj b">App</code>组件被重新渲染了，因为当我们点击增量按钮时<code class="fe mt mu mv mj b">count</code>的最新值显示在它的下面。</p><p id="11fb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">同样，我们可以更新一个适当值来触发组件的重新呈现。</p><p id="ddd1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="6c04" class="mn lc iq mj b gy mo mp l mq mr">import React, { useState } from "react";</span><span id="ac87" class="mn lc iq mj b gy ms mp l mq mr">const Count = ({ count }) =&gt; &lt;p&gt;{count}&lt;/p&gt;;</span><span id="4a68" class="mn lc iq mj b gy ms mp l mq mr">export default function App() {<br/>  const [count, setCount] = useState(0);</span><span id="afaa" class="mn lc iq mj b gy ms mp l mq mr">  return (<br/>    &lt;div className="App"&gt;<br/>      &lt;button onClick={() =&gt; setCount((c) =&gt; c + 1)}&gt;increment&lt;/button&gt;<br/>      &lt;Count count={count} /&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><p id="e1e5" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有接受<code class="fe mt mu mv mj b">count</code>道具并呈现<code class="fe mt mu mv mj b">count</code>值的<code class="fe mt mu mv mj b">Count</code>组件。</p><p id="a093" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了使<code class="fe mt mu mv mj b">Count</code>组件重新呈现，我们通过更新<code class="fe mt mu mv mj b">App</code>中<code class="fe mt mu mv mj b">count</code>状态的值来更新<code class="fe mt mu mv mj b">count</code>属性的值。</p><p id="b17a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这部分和前面的例子一样。</p><p id="8810" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">并且我们知道<code class="fe mt mu mv mj b">Count</code>被重新渲染，因为我们看到了再次渲染的<code class="fe mt mu mv mj b">count</code>的最新值。</p><h1 id="2012" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">强制重新呈现React组件</h1><p id="1d16" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">有时，当组件外部的某些内容被更新时，我们可能希望强制React组件重新呈现。</p><p id="b15a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，我们可以创建自己的钩子。</p><p id="4c8a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="me mf mg mh gt mi mj mk ml aw mm bi"><span id="1371" class="mn lc iq mj b gy mo mp l mq mr">import React, { useCallback, useState } from "react";</span><span id="294a" class="mn lc iq mj b gy ms mp l mq mr">let count = 0;</span><span id="3e06" class="mn lc iq mj b gy ms mp l mq mr">setInterval(() =&gt; {<br/>  count++;<br/>}, 1000);</span><span id="ecb4" class="mn lc iq mj b gy ms mp l mq mr">const useForceUpdate = () =&gt; {<br/>  const [, setTick] = useState(0);<br/>  const update = useCallback(() =&gt; {<br/>    setTick((tick) =&gt; tick + 1);<br/>  }, []);<br/>  return update;<br/>};</span><span id="0937" class="mn lc iq mj b gy ms mp l mq mr">export default function App() {<br/>  const update = useForceUpdate();</span><span id="2517" class="mn lc iq mj b gy ms mp l mq mr">  return (<br/>    &lt;div className="App"&gt;<br/>      &lt;button onClick={() =&gt; update()}&gt;update&lt;/button&gt;<br/>      &lt;p&gt;{count}&lt;/p&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><p id="8376" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有一个<code class="fe mt mu mv mj b">setInterval</code>回调函数来设置<code class="fe mt mu mv mj b">count</code>变量的值。</p><p id="79f7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们创建了一个用<code class="fe mt mu mv mj b">setTick</code>函数更新状态的<code class="fe mt mu mv mj b">useForceUpdate</code>钩子。</p><p id="30b6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><code class="fe mt mu mv mj b">setTick</code>在我们返回的<code class="fe mt mu mv mj b">update</code>函数中被调用，因此我们可以在组件代码中使用它。</p><p id="9b59" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在<code class="fe mt mu mv mj b">App</code>中，我们调用<code class="fe mt mu mv mj b">useForceUpdate</code>来将返回值赋给<code class="fe mt mu mv mj b">update</code>变量。</p><p id="af50" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后在按钮中，当我们点击它时，我们调用<code class="fe mt mu mv mj b">update</code>。</p><p id="e901" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，当我们点击它时，我们看到显示的是<code class="fe mt mu mv mj b">count</code>的最新值。</p><h1 id="6383" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="3591" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">有几种方法可以用React挂钩触发React组件的重新渲染。</p><p id="aad8" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mw">更多内容请看</em><a class="ae kc" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir"><em class="mw">plain English . io</em></strong></a><em class="mw">。报名参加我们的</em> <a class="ae kc" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir"> <em class="mw">免费周报</em> </strong> </a> <em class="mw">。在我们的</em> <a class="ae kc" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir"> <em class="mw">社区</em> </strong> </a> <em class="mw">获得独家获得写作机会和建议。</em></p></div></div>    
</body>
</html>