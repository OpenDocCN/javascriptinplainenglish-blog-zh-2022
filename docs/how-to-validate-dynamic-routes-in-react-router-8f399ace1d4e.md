# å¦‚ä½•åœ¨ React è·¯ç”±å™¨ä¸­éªŒè¯åŠ¨æ€è·¯ç”±

> åŸæ–‡ï¼š<https://javascript.plainenglish.io/how-to-validate-dynamic-routes-in-react-router-8f399ace1d4e?source=collection_archive---------8----------------------->

## åœ¨å‘ˆç°ç»„ä»¶ä¹‹å‰è·å–å¹¶éªŒè¯æ•°æ®

![](img/86d29d19eaebfedfaee9010f31331658.png)

Photo by [Ferenc Almasi](https://unsplash.com/@flowforfrank?utm_source=medium&utm_medium=referral) on [Unsplash](https://unsplash.com?utm_source=medium&utm_medium=referral)

æºä»£ç :[https://github . com/AbdelrhmanAmin/React-Dynamic-Routes-Manager](https://github.com/AbdelrhmanAmin/React-Dynamic-Routes-Manager)

# é—®é¢˜æ˜¯:

ä¸ºäº†è¯´æ˜è¿™ä¸ªé—®é¢˜ï¼Œè®©æˆ‘ä»¬ä»¥ç”¨æˆ·æ¡£æ¡ˆä¸ºä¾‹ã€‚

æˆ‘å°†ä½¿ç”¨å‚æ•°`users/:userId`å®šä¹‰åŠ¨æ€è·¯çº¿ï¼Œå¹¶å‘ˆç°é…ç½®æ–‡ä»¶ç»„ä»¶ï¼Œåœ¨ç»„ä»¶å†…éƒ¨ï¼Œæˆ‘å°†ä»`useParams`è·å–`userId`ï¼Œåœ¨`useEffect`å†…éƒ¨ï¼Œæˆ‘å°†å‘å‡ºè·å–è¯·æ±‚ä»¥è·å–ç”¨æˆ·ä¿¡æ¯ã€‚

![](img/fa26825aee03cc60296641f94cc86829.png)

é—®é¢˜æ˜¯ï¼Œ`userId`çœŸçš„å¯ä»¥æ˜¯ä»»ä½•ä¸œè¥¿ã€‚å®ƒå¯èƒ½æ˜¯`12`æˆ–`hellomom`â€¦å› ä¸º React åœ¨å®¢æˆ·ç«¯åšæ‰€æœ‰äº‹æƒ…ï¼Œæ‰€ä»¥å³ä½¿æœ‰äººå°† URL æ›´æ”¹ä¸ºæ— æ•ˆå†…å®¹(ä¾‹å¦‚`users/hilol`)æˆ–æœ‰äººè¯•å›¾è®¿é—®å·²è¢«åˆ é™¤çš„ç”¨æˆ·é…ç½®æ–‡ä»¶çš„ URLï¼Œé¡µé¢ç»„ä»¶ä¹Ÿä¼šå‘ˆç°ã€‚

å½“ç„¶ï¼Œæ‹¥æœ‰è‰¯å¥½çš„ç»“æ„å¾ˆé‡è¦ï¼Œåœ¨è·å–æ•°æ®æ—¶åœ¨é¡µé¢ç»„ä»¶ä¸­æ˜¾ç¤ºåŠ è½½æŒ‡ç¤ºå™¨ä»¥åŠè·å–å¤±è´¥æ—¶çš„é”™è¯¯æ¶ˆæ¯æ˜¯è‡³å…³é‡è¦çš„ã€‚ä½†æ˜¯ï¼Œå¦‚æœæˆ‘ä»¬å¯ä»¥åœ¨å‘ˆç°ç»„ä»¶ä¹‹å‰è·å–å¹¶éªŒè¯æ•°æ®ï¼Œé‚£ä¼šæ€ä¹ˆæ ·å‘¢ï¼Ÿ

# æˆ‘çš„è§£å†³æ–¹æ¡ˆ

æˆ‘æ„å»ºäº†ä¸€ä¸ªç®¡ç†å™¨ç»„ä»¶ï¼Œå®ƒè´Ÿè´£éªŒè¯è·å–å“åº”æ˜¯å¦æ­£å¸¸ï¼Œå¦‚æœæ˜¯ï¼Œåˆ™å‘ˆç°é¡µé¢ç»„ä»¶ï¼Œå¦åˆ™æ˜¾ç¤º 404 é¡µé¢ã€‚

è®©æˆ‘å¸¦ä½ çœ‹ä¸€ä¸‹ä»£ç ã€‚

é¦–å…ˆï¼Œæˆ‘ä¼šå°†é¡µé¢ç»„ä»¶åŒ…è£…åœ¨ç®¡ç†å™¨ç»„ä»¶ä¸­ï¼Œå¦‚ä¸‹æ‰€ç¤º:

![](img/223d498c5520e05d354c53b7b851609f.png)

ç„¶åï¼Œæˆ‘å°†ä¼ é€’ç»™ç®¡ç†å™¨ä¸€ä¸ªåä¸º`fetcher`çš„å±æ€§ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ¥æ”¶è·¯ç”±å‚æ•°å¹¶è¿”å›è·å–è¯·æ±‚çš„å‡½æ•°ã€‚

![](img/05eb8b90a70f01e37aa1e51630c3cfa0.png)

å½“ç”¨æˆ·è¿›å…¥é¡µé¢æ—¶ï¼Œé¦–å…ˆä¼šå‘ç”Ÿçš„äº‹æƒ…æ˜¯ï¼Œç®¡ç†å™¨å°†æ‰§è¡Œç¬¬ä¸€ä¸ª useEffectï¼Œå³è¿›è¡ŒéªŒè¯çš„é‚£ä¸ªã€‚ä»…å½“è·¯å¾„åä¸åœ¨`invalidRoutesRef`å†…æ—¶ã€‚

> æ³¨æ„:è¿™åœ¨æ¯æ¬¡æŒ‚è½½æ—¶éƒ½æ˜¯ç©ºçš„ï¼Œæˆ‘å»ºè®®ä½ ä½¿ç”¨ Redux æˆ– React context æ¥å­˜å‚¨`invalidRoutes`ä»¥é¿å…æ— æ•ˆçš„éªŒè¯è·¯å¾„ã€‚
> 
> æˆ‘ä¹‹æ‰€ä»¥ä½¿ç”¨`*invalidRoutesRef*`è€Œä¸æ˜¯ç®€å•åœ°ä½¿ç”¨åƒ`*isValid*`è¿™æ ·çš„æ ‡å¿—ï¼Œæ˜¯å› ä¸ºæˆ‘æ³¨æ„åˆ°åœ¨å¯¼èˆªåˆ°ä¸€ä¸ªä¸åŒçš„é…ç½®æ–‡ä»¶å,`*isValid*`çš„å€¼å°†ä¿æŒä¸ºâ€œfalse â€,å› æ­¤å³ä½¿`*userId*`æœ‰æ•ˆï¼Œé¡µé¢ä¹Ÿä¼šæ˜¾ç¤º 404ã€‚

![](img/e50533fec33e2f5b42c39a72a2a6c325.png)

è¯¥å‡½æ•°é¦–å…ˆå°†`isLoading`è®¾ç½®ä¸º true(æç¤º:é»˜è®¤è®¾ç½®ä¸º trueï¼Œä»¥ä¾¿åœ¨ç¬¬ä¸€æ¬¡æ¸²æŸ“æ—¶æ˜¾ç¤ºåŠ è½½æŒ‡ç¤ºå™¨ğŸ˜„)å¹¶å°†è·¯ç”±çš„`params`ä¼ é€’ç»™`fetcher`å‡½æ•°ï¼Œå¹¶ç­‰å¾…ç›´åˆ°è·å–è§£å†³ã€‚

![](img/ce8df9cf7f69f63abbf6422b6678ad4e.png)

`isLoading`å°†åœ¨è·å–æ•°æ®æ—¶æ˜¾ç¤ºåŠ è½½å±å¹•ã€‚

![](img/e28cdc2afffbd8d896a291dcd3d30b56.png)

å¦‚æœè¯·æ±‚å¤±è´¥ï¼Œåˆ™æŒ‰ä¸‹`pathname`è‡³`invalidRoutesRef`ã€‚ç„¶åï¼Œå°†`isLoading`è®¾ç½®ä¸ºå‡ã€‚

![](img/37e4229116a34adfb1651ea6fb4dc993.png)

æœ€åã€‚

![](img/c5602b7a7d25522cdd7e6535d0a92946.png)

æˆ‘å¸Œæœ›è¿™èƒ½ä½¿ä½ å—ç›Šã€‚

*æ›´å¤šå†…å®¹çœ‹* [***è¯´ç™½äº†ã€‚æŠ¥åå‚åŠ æˆ‘ä»¬çš„***](https://plainenglish.io/) **[***å…è´¹å‘¨æŠ¥***](http://newsletter.plainenglish.io/) *ã€‚å…³æ³¨æˆ‘ä»¬å…³äº* [***æ¨ç‰¹***](https://twitter.com/inPlainEngHQ) ï¼Œ[***LinkedIn***](https://www.linkedin.com/company/inplainenglish/)*ï¼Œ*[***YouTube***](https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw)*ï¼Œ* [***ä¸å’Œ***](https://discord.gg/GtDtUAvyhW) *ã€‚***