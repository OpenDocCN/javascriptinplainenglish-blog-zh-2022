<html>
<head>
<title>How to Convert CSV to JSON in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在JavaScript中将CSV转换成JSON</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/javascript-convert-csv-to-json-91dbbd4ae436?source=collection_archive---------2-----------------------#2022-11-10">https://javascript.plainenglish.io/javascript-convert-csv-to-json-91dbbd4ae436?source=collection_archive---------2-----------------------#2022-11-10</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="a2ac" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">了解如何轻松地将字符串或文件中的CSV数据转换为JavaScript中的JSON字符串。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/3c62eac7299d652e2167ac7a09b92b82.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wT5o55bM1WQE0J2O-xL-qA.png"/></div></div></figure><p id="247e" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">您可以使用JavaScript中的<code class="fe lk ll lm ln b">csvtojson</code>库快速将CSV转换为JSON:</p><p id="3ea3" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><code class="fe lk ll lm ln b">index.js</code></p><pre class="kd ke kf kg gt lo ln lp bn lq lr bi"><span id="59bc" class="ls lt in ln b be lu lv l lw lx">import csvToJson from 'csvtojson';<br/><br/>const csvFilePath = 'data.csv';<br/><br/>const json = await csvToJson().fromFile(csvFilePath);<br/>console.log(json);</span></pre><p id="9c10" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">对于这样一个<code class="fe lk ll lm ln b">data.csv</code>文件:</p><p id="2608" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><code class="fe lk ll lm ln b">data.csv</code></p><pre class="kd ke kf kg gt lo ln lp bn lq lr bi"><span id="4796" class="ls lt in ln b be lu lv l ly lx">color,maxSpeed,age<br/>"red",120,2<br/>"blue",100,3<br/>"green",130,2</span></pre><p id="5f0c" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">这将是生成的JSON:</p><p id="89ee" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><code class="fe lk ll lm ln b">Output</code></p><pre class="kd ke kf kg gt lo ln lp bn lq lr bi"><span id="8a3f" class="ls lt in ln b be lu lv l lw lx">[<br/>  { color: 'red', maxSpeed: '120', age: '2' },<br/>  { color: 'blue', maxSpeed: '100', age: '3' },<br/>  { color: 'green', maxSpeed: '130', age: '2' }<br/>]</span></pre><h1 id="8d99" class="lz lt in bd ma mb mc md me mf mg mh mi jt mj ju mk jw ml jx mm jz mn ka mo mp bi translated">安装<code class="fe lk ll lm ln b">csvtojson</code></h1><p id="06cd" class="pw-post-body-paragraph ko kp in kq b kr mq jo kt ku mr jr kw kx ms kz la lb mt ld le lf mu lh li lj ig bi translated">在使用<code class="fe lk ll lm ln b">csvtojson</code>之前，你需要在我们的项目中安装它。您可以使用NPM或Yarn CLI来完成此操作。</p><pre class="kd ke kf kg gt lo ln lp bn lq lr bi"><span id="9754" class="ls lt in ln b be lu lv l lw lx">npm i csvtojson<br/><br/># Yarn<br/>yarn add csvtojson</span></pre><p id="32b7" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">安装后，您可以将其导入JavaScript模块，如下所示:</p><pre class="kd ke kf kg gt lo ln lp bn lq lr bi"><span id="1c7c" class="ls lt in ln b be lu lv l lw lx">import csvToJson from 'csvtojson';<br/><br/>// CommonJS<br/>const csvToJson = require('csvtojson');</span></pre><h1 id="1e5d" class="lz lt in bd ma mb mc md me mf mg mh mi jt mj ju mk jw ml jx mm jz mn ka mo mp bi translated">用<code class="fe lk ll lm ln b">fromFile()</code>将CSV文件转换成JSON</h1><p id="bf79" class="pw-post-body-paragraph ko kp in kq b kr mq jo kt ku mr jr kw kx ms kz la lb mt ld le lf mu lh li lj ig bi translated">我们调用<code class="fe lk ll lm ln b">csvtojson</code>模块的默认导出函数来创建将转换CSV的对象。这个对象有一堆方法，每个方法都以某种方式与CSV到JSON的转换相关，而<code class="fe lk ll lm ln b">fromFile()</code>就是其中之一。</p><p id="1c3d" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">它接受要转换的CSV文件的名称，并返回一个<code class="fe lk ll lm ln b">Promise</code>，因为转换是一个异步过程。<code class="fe lk ll lm ln b">Promise</code>将用产生的JSON字符串进行解析。</p><h1 id="56a8" class="lz lt in bd ma mb mc md me mf mg mh mi jt mj ju mk jw ml jx mm jz mn ka mo mp bi translated">用<code class="fe lk ll lm ln b">fromString()</code>将CSV字符串转换成JSON</h1><p id="9eed" class="pw-post-body-paragraph ko kp in kq b kr mq jo kt ku mr jr kw kx ms kz la lb mt ld le lf mu lh li lj ig bi translated">要直接从CSV数据字符串转换，而不是从文件转换，可以使用converter对象的异步<code class="fe lk ll lm ln b">fromString()</code>方法:</p><p id="4c00" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><code class="fe lk ll lm ln b">index.js</code></p><pre class="kd ke kf kg gt lo ln lp bn lq lr bi"><span id="294e" class="ls lt in ln b be lu lv l lw lx">import csvToJson from 'csvtojson';<br/><br/>const csv = `"First Name","Last Name","Age"<br/>"Russell","Castillo",23<br/>"Christy","Harper",35<br/>"Eleanor","Mark",26`;<br/>const json = await csvToJson().fromString(csv);<br/>console.log(json);</span></pre><p id="aaa1" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><code class="fe lk ll lm ln b">Output</code></p><pre class="kd ke kf kg gt lo ln lp bn lq lr bi"><span id="7254" class="ls lt in ln b be lu lv l lw lx">[<br/>  { 'First Name': 'Russell', 'Last Name': 'Castillo', Age: '23' },<br/>  { 'First Name': 'Christy', 'Last Name': 'Harper', Age: '35' },<br/>  { 'First Name': 'Eleanor', 'Last Name': 'Mark', Age: '26' }<br/>]</span></pre><h1 id="f5c5" class="lz lt in bd ma mb mc md me mf mg mh mi jt mj ju mk jw ml jx mm jz mn ka mo mp bi translated">自定义CSV到JSON的转换</h1><p id="1c13" class="pw-post-body-paragraph ko kp in kq b kr mq jo kt ku mr jr kw kx ms kz la lb mt ld le lf mu lh li lj ig bi translated"><code class="fe lk ll lm ln b">csvtojson</code>的默认导出功能接受一个对象，该对象用于指定自定义转换过程的选项。</p><p id="6017" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">一个这样的选项是<code class="fe lk ll lm ln b">header</code>，一个用于指定CSV数据中的头的数组。</p><p id="b86c" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><code class="fe lk ll lm ln b">index.js</code></p><pre class="kd ke kf kg gt lo ln lp bn lq lr bi"><span id="a97f" class="ls lt in ln b be lu lv l lw lx">import csvToJson from 'csvtojson';<br/><br/>const csv = `"First Name","Last Name","Age"<br/>"Russell","Castillo",23<br/>"Christy","Harper",35<br/>"Eleanor","Mark",26`;<br/>const json = await csvToJson({<br/>  headers: ['firstName', 'lastName', 'age'],<br/>}).fromString(csv);<br/>console.log(json);</span></pre><p id="3d3e" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><code class="fe lk ll lm ln b">Output</code></p><pre class="kd ke kf kg gt lo ln lp bn lq lr bi"><span id="e892" class="ls lt in ln b be lu lv l lw lx">[<br/>  { firstName: 'Russell', lastName: 'Castillo', age: '23' },<br/>  { firstName: 'Christy', lastName: 'Harper', age: '35' },<br/>  { firstName: 'Eleanor', lastName: 'Mark', age: '26' }<br/>]</span></pre><p id="6d60" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">另一个是<code class="fe lk ll lm ln b">delimeter</code>，用于表示分隔各列的字符:</p><pre class="kd ke kf kg gt lo ln lp bn lq lr bi"><span id="6345" class="ls lt in ln b be lu lv l lw lx">import csvToJson from 'csvtojson';<br/><br/>const csv = `"First Name"|"Last Name"|"Age"<br/>"Russell"|"Castillo"|23<br/>"Christy"|"Harper"|35<br/>"Eleanor"|"Mark"|26`;<br/>const json = await csvToJson({<br/>  headers: ['firstName', 'lastName', 'age'],<br/>  delimiter: '|',<br/>}).fromString(csv);</span></pre><p id="d630" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><code class="fe lk ll lm ln b">Output</code></p><pre class="kd ke kf kg gt lo ln lp bn lq lr bi"><span id="ab4d" class="ls lt in ln b be lu lv l lw lx">[<br/>  { firstName: 'Russell', lastName: 'Castillo', age: '23' },<br/>  { firstName: 'Christy', lastName: 'Harper', age: '35' },<br/>  { firstName: 'Eleanor', lastName: 'Mark', age: '26' }<br/>]</span></pre><p id="f035" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我们还有<code class="fe lk ll lm ln b">ignoreColumns</code>，一个使用正则表达式指示转换器忽略某些列的选项。</p><pre class="kd ke kf kg gt lo ln lp bn lq lr bi"><span id="025c" class="ls lt in ln b be lu lv l lw lx">import csvToJson from 'csvtojson';<br/><br/>const csv = `"First Name"|"Last Name"|"Age"<br/>"Russell"|"Castillo"|23<br/>"Christy"|"Harper"|35<br/>"Eleanor"|"Mark"|26`;<br/>const json = await csvToJson({<br/>  headers: ['firstName', 'lastName', 'age'],<br/>  delimiter: '|',<br/>  ignoreColumns: /lastName/,<br/>}).fromString(csv);<br/>console.log(json);js</span></pre><p id="54da" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><code class="fe lk ll lm ln b">Output</code></p><pre class="kd ke kf kg gt lo ln lp bn lq lr bi"><span id="0d48" class="ls lt in ln b be lu lv l lw lx">[<br/>  { firstName: 'Russell', age: '23' },<br/>  { firstName: 'Christy', age: '35' },<br/>  { firstName: 'Eleanor', age: '26' }<br/>]</span></pre><h1 id="bed5" class="lz lt in bd ma mb mc md me mf mg mh mi jt mj ju mk jw ml jx mm jz mn ka mo mp bi translated">将CSV转换为JSON行数组</h1><p id="a2db" class="pw-post-body-paragraph ko kp in kq b kr mq jo kt ku mr jr kw kx ms kz la lb mt ld le lf mu lh li lj ig bi translated">通过将<code class="fe lk ll lm ln b">output</code>选项设置为<code class="fe lk ll lm ln b">'csv'</code>，我们可以生成一个数组列表，其中每个数组代表一行，包含该行所有列的值。</p><p id="bdf9" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">例如:</p><p id="7b4b" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><code class="fe lk ll lm ln b">index.js</code></p><pre class="kd ke kf kg gt lo ln lp bn lq lr bi"><span id="f409" class="ls lt in ln b be lu lv l lw lx">import csvToJson from 'csvtojson';<br/><br/>const csv = `color,maxSpeed,age<br/>"red",120,2<br/>"blue",100,3<br/>"green",130,2`;<br/>const json = await csvToJson({<br/>  output: 'csv',<br/>}).fromString(csv);<br/>console.log(json);</span></pre><p id="5de2" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><code class="fe lk ll lm ln b">Output</code></p><pre class="kd ke kf kg gt lo ln lp bn lq lr bi"><span id="01b5" class="ls lt in ln b be lu lv l lw lx">[<br/>  [ 'red', '120', '2' ],<br/>  [ 'blue', '100', '3' ],<br/>  [ 'green', '130', '2' ]<br/>]</span></pre><h1 id="5c72" class="lz lt in bd ma mb mc md me mf mg mh mi jt mj ju mk jw ml jx mm jz mn ka mo mp bi translated">CSV到JSON的本机转换</h1><p id="b761" class="pw-post-body-paragraph ko kp in kq b kr mq jo kt ku mr jr kw kx ms kz la lb mt ld le lf mu lh li lj ig bi translated">不使用任何第三方库也可以将CSV转换成JSON。</p><p id="1a81" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><code class="fe lk ll lm ln b">index.js</code></p><pre class="kd ke kf kg gt lo ln lp bn lq lr bi"><span id="50ab" class="ls lt in ln b be lu lv l lw lx">function csvToJson(csv) {<br/>  // \n or \r\n depending on the EOL sequence<br/>  const lines = csv.split('\n');<br/>  const delimeter = ',';<br/><br/>  const result = [];<br/>  const headers = lines[0].split(delimeter);<br/>  for (const line of lines) {<br/>    const obj = {};<br/>    const row = line.split(delimeter);<br/>    for (let i = 0; i &lt; headers.length; i++) {<br/>      const header = headers[i];<br/>      obj[header] = row[i];<br/>    }<br/>    result.push(obj);<br/>  }<br/>  // Prettify output<br/>  return JSON.stringify(result, null, 2);<br/>}<br/><br/>const csv = `color,maxSpeed,age<br/>"red",120,2<br/>"blue",100,3<br/>"green",130,2`;<br/>const json = csvToJson(csv);<br/>console.log(json);</span></pre><p id="8faa" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><code class="fe lk ll lm ln b">Output</code></p><pre class="kd ke kf kg gt lo ln lp bn lq lr bi"><span id="00e8" class="ls lt in ln b be lu lv l lw lx">[<br/>  {<br/>    "color": "color",<br/>    "maxSpeed": "maxSpeed",<br/>    "age": "age"<br/>  },<br/>  {<br/>    "color": "\"red\"",<br/>    "maxSpeed": "120",<br/>    "age": "2"<br/>  },<br/>  {<br/>    "color": "\"blue\"",<br/>    "maxSpeed": "100",<br/>    "age": "3"<br/>  },<br/>  {<br/>    "color": "\"green\"",<br/>    "maxSpeed": "130",<br/>    "age": "2"<br/>  }<br/>]</span></pre><p id="9afc" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">您可以修改上面的代码，以允许变化和更复杂的CSV数据。</p></div><div class="ab cl mv mw hr mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="ig ih ii ij ik"><p id="8694" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><em class="nc">原载于</em>【codingbeautydev.com】<em class="nc"/></p><h1 id="a1b7" class="lz lt in bd ma mb mc md me mf mg mh mi jt mj ju mk jw ml jx mm jz mn ka mo mp bi translated">JavaScript做的每一件疯狂的事情</h1><p id="e18c" class="pw-post-body-paragraph ko kp in kq b kr mq jo kt ku mr jr kw kx ms kz la lb mt ld le lf mu lh li lj ig bi translated">一本关于JavaScript微妙的警告和鲜为人知的部分的迷人指南。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/143ee152ba78025ea8643ba5b9726a20.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*YS5Oub8REWy8vnOEqBnsyQ.png"/></div></figure><p id="7d6e" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><a class="ae nd" href="https://cbdev.link/d3c4eb" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io">报名</strong> </a>立即免费领取一份。</p></div></div>    
</body>
</html>