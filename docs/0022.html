<html>
<head>
<title>How to Use MySQL with Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Node.js中使用MySQL</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-use-mysql-with-node-js-fdb84658055b?source=collection_archive---------5-----------------------#2022-01-03">https://javascript.plainenglish.io/how-to-use-mysql-with-node-js-fdb84658055b?source=collection_archive---------5-----------------------#2022-01-03</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="1380" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">今天，我们将看看如何通过Node.js使用MySQL数据库。我们将创建一个简单的RESTful API来执行基本的CRUD操作。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/d4b2a1cd7d65d73a778740b48704f345.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*BvQWRuvmkVOfEYdp"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@goshua13?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Joshua Aragon</a> on <a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h2 id="752b" class="kt ku in bd kv kw kx dn ky kz la dp lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">先决条件:</h2><ul class=""><li id="8dd1" class="lp lq in lr b ls lt lu lv lc lw lg lx lk ly lz ma mb mc md bi translated">了解如何在Express framework中使用Node.js。</li><li id="d17e" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated">在您的机器上安装MySQL和MySQL workbench(这只是用于与数据库交互的GUI)。如果没有，你可以跟随这个<a class="ae ks" href="https://www.youtube.com/watch?v=OM4aZJW_Ojs&amp;ab_channel=AmitThinks" rel="noopener ugc nofollow" target="_blank">视频</a>，把它安装到你的本地机器上。</li><li id="49f9" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated">为了测试API路由，我们将使用Postman。如果你的机器上没有安装Postman，你可以根据你的操作系统点击这些链接:<a class="ae ks" href="https://www.youtube.com/watch?v=3eHJkcA8mTs&amp;ab_channel=GeekyScript" rel="noopener ugc nofollow" target="_blank"> Windows </a>，<a class="ae ks" href="https://www.youtube.com/watch?v=sriayOzVaMM&amp;ab_channel=Postman" rel="noopener ugc nofollow" target="_blank"> macOS </a>，<a class="ae ks" href="https://www.youtube.com/watch?v=XBxtX-tWBr4&amp;ab_channel=ProgrammingKnowledge2" rel="noopener ugc nofollow" target="_blank"> Ubuntu </a>。您还应该知道如何使用Postman来测试您的路线。</li><li id="bc1a" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated">计算机上安装的Visual Studio代码。如果没有，可以去他们的<a class="ae ks" href="https://code.visualstudio.com/" rel="noopener ugc nofollow" target="_blank">网站</a>看看，流程挺简单的。</li></ul></div><div class="ab cl mj mk hr ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="ig ih ii ij ik"><h2 id="02d4" class="kt ku in bd kv kw kx dn ky kz la dp lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">什么是MySQL？</h2><p id="771a" class="pw-post-body-paragraph mq mr in lr b ls lt jo ms lu lv jr mt lc mu mv mw lg mx my mz lk na nb nc lz ig bi translated">MySQL是一个<strong class="lr io">关系数据库管理系统(RDMS)，</strong>这意味着RDMS由各种表的集合组成，单个表由不同的行和列组成。表中的行也被称为<em class="nd">元组</em>，而列也被称为<em class="nd">字段</em>。</p><p id="2f60" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">为了操作MySQL中的数据，我们使用结构化查询语言，这是与RDMS交互的标准。</p><p id="fc3f" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">一个MySQL数据库可以包含许多表，一个表可以包含许多行和列。关系数据库通过使用<em class="nd">键在数据库内部的不同表之间创建<em class="nd">关系</em>来工作。</em></p><p id="0f19" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">在一个表中，使用一个叫做<em class="nd">“主键”的东西来惟一地标识一行。在为数据库中的表定义表模式时，我们指定了保存行主键的列(我们将在后面看到)。</em></p><p id="fb70" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">当一个列持有表的主键时，那么这个列<em class="nd">不能为空。</em>一个表只能有<em class="nd">一列</em>和<em class="nd">主键</em>约束。并且该列中的值应该是<em class="nd">唯一的。</em></p><p id="e7c3" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">一个数据库可以有许多表，这些表之间可以有关系。两个或多个表之间的关系是通过使用一种叫做<em class="nd">“外键”的东西来创建的。</em></p><p id="9f8f" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated"><em class="nd">外键</em>是一个表中的一个(或多个)字段，它保存另一个表的字段值，从而创建一个引用。通常，一个表中保存<em class="nd">外键</em>的字段会保存另一个表的<em class="nd">主键</em>，因为<em class="nd">主键</em>在一个表中是唯一的。</p><p id="a181" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">一个表的<em class="nd">外键</em>不一定要引用另一个表的<em class="nd">主键</em>，它也可以引用表中其他字段的值，但该值必须是唯一的。与<em class="nd">主键</em>约束不同，<em class="nd">外键</em>字段可以保存<em class="nd">空值以及非唯一值。</em></p><p id="78ab" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">请看下图，以便更好地理解<em class="nd">主键和外键。</em>假设我们有一个基本的网络应用程序，用户可以注册和登录。登录后，用户可以将图像上传到他/她的帐户中的数据库。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nj"><img src="../Images/4420b7b5c94d635f7a0f94d4801c1784.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xl4UK5kQXVK-JTsNsFzTlQ.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">image by author</figcaption></figure><p id="0cb7" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">如您所见，我们的MySQL数据库中有两个表，一个名为“users”，另一个名为“images”。“users”和“images”表都有一个<strong class="lr io"> id </strong>字段，它是各自表的<em class="nd">主键，将保存一些唯一的非空值。</em></p><p id="c5d9" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">“images”表将保存用户上传的图像的URL。“images”表中的“user_id”字段包含对“users”表中“id”字段的引用，以便能够判断哪个用户上传了哪个图像。<em class="nd">“图像”表中的“用户标识”字段是一个外键。</em></p><p id="b4a2" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">现在，让我们开始创建API。</p></div><div class="ab cl mj mk hr ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="ig ih ii ij ik"><h1 id="54a1" class="nk ku in bd kv nl nm nn ky no np nq lb jt nr ju lf jw ns jx lj jz nt ka ln nu bi translated">设置数据库和创建表:</h1><p id="97b3" class="pw-post-body-paragraph mq mr in lr b ls lt jo ms lu lv jr mt lc mu mv mw lg mx my mz lk na nb nc lz ig bi translated">打开MySQL workbench，使用您在安装过程中使用的密码登录。登录后，使用以下命令获取MySQL本地实例中存在的所有数据库的列表:</p><pre class="kd ke kf kg gt nv nw nx ny aw nz bi"><span id="1049" class="kt ku in nw b gy oa ob l oc od">show databases;</span></pre><p id="a793" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">键入命令后，使用顶部的<em class="nd">惊雷图标</em>执行查询:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oe"><img src="../Images/0193927846699cac6e381764ba51af46.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ddIFOH2gmi6QNi3q_6zoig.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">image by author</figcaption></figure><p id="e31f" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">您将获得您机器上存在的数据库列表。</p><p id="d56c" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">现在，我们将为这个项目创建一个名为“node_mysql_db”的新数据库。你可以给它起任何你想要的名字。使用下面的命令创建数据库。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi of"><img src="../Images/99fc788d870f5e581cb936660a428fa6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sFAgO20LIUBfZxLAkYxDag.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">image by author</figcaption></figure><p id="3ce3" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">运行此命令后，如果您在操作输出中没有得到任何错误，那么这意味着数据库已成功创建。创建数据库后，我们必须告诉MySQL我们要使用哪个数据库。使用以下命令实现这一点:</p><pre class="kd ke kf kg gt nv nw nx ny aw nz bi"><span id="4836" class="kt ku in nw b gy oa ob l oc od">// use database_name; // in this case it is 'node_mysql'<br/>use node_mysql_db;</span></pre><p id="3251" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">注意每个命令后的操作输出，以确保没有错误。</p><p id="c74f" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">选择数据库后，我们将开始在我们的<em class="nd"> node_mysql_db </em>数据库中创建表。</p><p id="388d" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">要创建表格，我们将使用“创建表格”命令。create table命令的工作方式如下:</p><pre class="kd ke kf kg gt nv nw nx ny aw nz bi"><span id="98c3" class="kt ku in nw b gy oa ob l oc od">CREATE TABLE table_name(<br/> columnName dataTypeForColumn constraint,<br/> columnName dataTypeForColumn constraint,<br/> columnName dataTypeForColumn constraint<br/> .<br/> .<br/> .<br/>)</span></pre><p id="496c" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">首先，我们定义列的名称，然后定义列将包含的数据类型，如整数、字符串、布尔、日期等。你可以在这里看一下SQL拥有的所有数据类型<a class="ae ks" href="https://www.w3schools.com/sql/sql_datatypes.asp" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="bf22" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">指定数据类型后，我们将输入特定列的约束。顾名思义，约束就是为特定的列添加规则/限制。可以使用的一些常见约束有-NOT NULL、DEFAULT、PRIMARY KEY、UNIQUE等。您可以查看所有的SQL约束，并在这里阅读关于它们的详细信息<a class="ae ks" href="https://www.w3schools.com/sql/sql_constraints.asp" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="12c9" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">特定列可以有多个约束。</p><p id="a14c" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">我将解释我将在文章中使用的所有数据类型和约束。为了更深入的理解，您可以查看上面附加的所有数据类型和约束的链接。</p><p id="49e4" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">现在使用下面的命令在<em class="nd"> node_mysql_db数据库中创建一个表:</em></p><pre class="kd ke kf kg gt nv nw nx ny aw nz bi"><span id="87a6" class="kt ku in nw b gy oa ob l oc od">CREATE TABLE users (<br/> id int NOT NULL UNIQUE PRIMARY KEY auto_increment,<br/> email varchar(255) NOT NULL UNIQUE,<br/> full_name varchar(255) NOT NULL,<br/> user_password varchar(255) NOT NULL<br/>);</span></pre><p id="cc4b" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated"><strong class="lr io">注意:</strong> <a class="ae ks" href="https://docs.microsoft.com/en-us/sql/t-sql/language-elements/reserved-keywords-transact-sql?view=sql-server-ver15" rel="noopener ugc nofollow" target="_blank"> <strong class="lr io">这里的</strong> </a> <strong class="lr io">是一些不能用作表名、列名等的SQL关键字。</strong></p><p id="a1e3" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">在MySQL workbench中运行该命令后，将在<em class="nd"> node_mysql_db </em>数据库中创建一个名为<em class="nd"> users </em>的表。</p><p id="6f00" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">现在，让我们分解“<em class="nd">用户”</em>表来理解数据类型和约束:</p><ul class=""><li id="3701" class="lp lq in lr b ls ne lu nf lc og lg oh lk oi lz ma mb mc md bi translated">第一列名为<em class="nd"> id </em>，其数据类型为<em class="nd"> int，</em>，这意味着<em class="nd"> id </em>列可以保存正负整数，但不能保存小数或分数。id列包含4个约束:第一个是<em class="nd"> NOT NULL </em>，这意味着该列不能包含NULL值。第二个是<em class="nd"> UNIQUE </em>，它告诉我们整个列中的值将是唯一的。最后，我们有<em class="nd">主键</em>约束，这意味着id列中的值可以用来惟一地标识表中的记录。第四个是<em class="nd"> auto_increment </em>，这意味着我们不必为该列指定值，它会自动添加，并且由于数据类型是<em class="nd"> int </em>，该值将是一个整数。</li><li id="4881" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated">第二列名为<em class="nd">电子邮件</em>，其数据类型为<em class="nd"> varchar(255) </em>。<em class="nd">‘varchar’</em>代表‘可变字符’，‘T6】255指定该列可以容纳的最大字符串长度。从1开始，255是我们可以对varchar使用的最大值。但是如果你有一个比这个更长的字符串，你可以使用<em class="nd">文本</em>数据类型。该列有两个约束，即，<em class="nd"> NOT NULL和唯一</em>。<em class="nd"> NOT NULL </em>指定列不能有空值，而<em class="nd"> UNIQUE </em>表示该值在整个列中应该是唯一的。</li><li id="6a2a" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated">第三列是<em class="nd"> full_name </em>，它与<em class="nd"> email </em>列具有相同的数据类型和约束(保留<em class="nd">唯一</em>约束)。</li><li id="757e" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated">第四列<em class="nd"> user_password </em>与<em class="nd"> full_name </em>列具有相同的数据类型和约束。</li></ul><p id="3591" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">在为列输入值时，如果不满足数据类型或约束条件，则SQL查询会抛出错误。</p><h1 id="9582" class="nk ku in bd kv nl oj nn ky no ok nq lb jt ol ju lf jw om jx lj jz on ka ln nu bi translated">在VS代码中设置项目:</h1><p id="1f6e" class="pw-post-body-paragraph mq mr in lr b ls lt jo ms lu lv jr mt lc mu mv mw lg mx my mz lk na nb nc lz ig bi translated">在机器上的任意位置创建一个名为“node_mysql”的文件夹(可以任意命名)，然后在VS代码中打开新创建的文件夹。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oo"><img src="../Images/f88ecfa61cad235bdaf9f25df74a8e13.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*R67Wr3LAppCeTSQLYfFOeQ.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">image by author</figcaption></figure><p id="a7f3" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">在windows上按“Ctrl + J”或在mac上按“cmd + J ”,在VS代码中打开集成终端。在VS代码中使用集成终端的最大好处是它已经导航到我们正在工作的当前目录。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi op"><img src="../Images/2cd0da33822ad9241f3108b12b97cc2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6WqzQSSMWW3EkR_yzaoOgw.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">image by author</figcaption></figure><p id="fe2c" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">现在，正如我们对所有Node.js项目所做的那样，我们将首先初始化目录以获得我们的<em class="nd">‘package . JSON’</em>文件。我用<em class="nd">纱线</em>做项目，如果你愿意，你也可以用<em class="nd"> npm </em>。运行以下命令初始化目录。</p><pre class="kd ke kf kg gt nv nw nx ny aw nz bi"><span id="cfc2" class="kt ku in nw b gy oa ob l oc od">yarn init -y // for NPM - npm init -y</span></pre><p id="1f37" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">初始化目录后，在目录的根目录下创建一个<em class="nd"> 'server.js' </em>文件。创建文件后，我们将为项目添加依赖项，有2个，即:<em class="nd"> express(用于创建路线)和mysql(用于与我们的MySQL数据库交互的驱动程序)。</em></p><p id="7169" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">使用以下命令添加项目的依赖项，</p><pre class="kd ke kf kg gt nv nw nx ny aw nz bi"><span id="c6a8" class="kt ku in nw b gy oa ob l oc od">yarn add express mysql<br/>// For NPM - npm install express mysql</span></pre><p id="8050" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">完成上述步骤并添加依赖项后，您的目录应该如下所示:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oq"><img src="../Images/d2b4d708bbc8f497c21286491577ff18.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZiqNtkd71uIpKMRpJPoecQ.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">image by author</figcaption></figure><p id="4da0" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">如果您使用的是<em class="nd"> npm </em>，那么您将收到<em class="nd">‘package-lock . JSON’而不是<em class="nd">‘yarn . lock’</em>。</em></p><p id="3c74" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">为了简单起见，我将在' server.js '文件中编写所有代码，但在现实世界中，该项目被分成多个文件夹和多个文件。</p><p id="6c93" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">在编写server.js文件中的代码之前，我们将只在package.json文件中添加一个“开发脚本”,以使用“nodemon”运行run server.js文件。(我在全局范围内安装了nodemon，这就是为什么我在这里没有将它作为开发依赖项添加进来)。要将Nodemon作为全局依赖项添加，请使用以下命令:</p><pre class="kd ke kf kg gt nv nw nx ny aw nz bi"><span id="bb2f" class="kt ku in nw b gy oa ob l oc od">yarn global add nodemon<br/>For NPM - npm install -g nodemon</span></pre><p id="d970" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">您的package.json文件应该如下所示:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi or"><img src="../Images/b27b4a9e4a01604b0bbcaefe366f321c.png" data-original-src="https://miro.medium.com/v2/resize:fit:860/format:webp/1*6WIX7D2ucghYWS3IguouZQ.png"/></div></figure><h1 id="57f3" class="nk ku in bd kv nl oj nn ky no ok nq lb jt ol ju lf jw om jx lj jz on ka ln nu bi translated">编写代码:</h1><p id="eb6f" class="pw-post-body-paragraph mq mr in lr b ls lt jo ms lu lv jr mt lc mu mv mw lg mx my mz lk na nb nc lz ig bi translated">看看下面的代码，然后我会解释它。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi os"><img src="../Images/f5f27fa65e8b2c7174a1e204d91182de.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Ym-epj09im8ne2BPEOztYA.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">image by author</figcaption></figure><ul class=""><li id="a9b0" class="lp lq in lr b ls ne lu nf lc og lg oh lk oi lz ma mb mc md bi translated">首先，我们需要我们安装的所有依赖项。然后在第5行，我们初始化express依赖项，以便能够创建路由、中间件等。由于这种初始化，在第7行，我们可以监听端口3000，回调函数将运行，告诉我们在运行服务器时没有问题。</li><li id="5a2d" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated">现在，在终端中使用以下命令运行dev服务器:</li></ul><pre class="kd ke kf kg gt nv nw nx ny aw nz bi"><span id="5078" class="kt ku in nw b gy oa ob l oc od">yarn run dev // For NPM - npm run dev</span></pre><p id="2c3f" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">我们正在运行一个dev服务器，因为它将使用nodemon来运行文件，当对代码进行任何更改时，服务器将自动重启。</p><p id="fddd" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">运行“dev”命令后，您应该看到终端上打印的回调函数消息。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ot"><img src="../Images/fbb8400802d41f04a0c6d7a01eb32c8f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9uyEyj45g22nWZWQ4POW5g.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">image by author</figcaption></figure><h2 id="d510" class="kt ku in bd kv kw kx dn ky kz la dp lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">正在创建MySQL连接:</h2><p id="5080" class="pw-post-body-paragraph mq mr in lr b ls lt jo ms lu lv jr mt lc mu mv mw lg mx my mz lk na nb nc lz ig bi translated">现在，我们将创建从server.js文件到我们创建的数据库的MySQL连接，即“node_mysql_db”。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ou"><img src="../Images/2a98f9da56b005a4abe910497167203c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*48zlUYpNkq1ej6jTjHL1XA.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">image by author</figcaption></figure><p id="9cee" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">我们将使用MySQL库连接到MySQL数据库。</p><ul class=""><li id="0ede" class="lp lq in lr b ls ne lu nf lc og lg oh lk oi lz ma mb mc md bi translated"><em class="nd">' MySQL . create connection()'</em>获取一个对象，在该对象中，我们指定它获取一组帮助连接到我们的数据库的键-值对。</li><li id="cb0f" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated">“host”属性指定数据库所在的主机，在我们的示例中是“localhost”。但是对于生产就绪的应用程序，这将是一个URL。</li><li id="7d04" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated"><em class="nd">‘用户’</em>和<em class="nd">‘密码’</em>属性定义了试图访问数据库的用户。它将与您在安装MySQL时设置的相同。</li><li id="7374" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated"><em class="nd">‘database’</em>属性指定了我们试图连接的数据库。我们编写的所有SQL查询都将在这个特定的数据库上执行。</li><li id="4d26" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated">您还可以在createConnection方法中传递其他选项。你可以在这里看看它们<a class="ae ks" href="https://github.com/mysqljs/mysql#readme" rel="noopener ugc nofollow" target="_blank">。</a></li><li id="949c" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated"><em class="nd"> 'connection.connect()' </em>方法尝试使用上面提供的凭据连接到数据库。这个方法接受一个回调函数，该函数有助于在连接到数据库时处理任何错误。</li><li id="56ca" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated">如果连接到数据库时没有出现错误，则显示消息“MySQL成功连接！”会被打印到终端上。</li><li id="a7ad" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated">保存' server.js '文件(你的服务器会因为nodemon而自动重启)并检查你的终端，应该是这样的。</li></ul><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ov"><img src="../Images/a172495036d13882b8ca9cadef610bd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FN4fs5jH2kQhDU2PGYT6PA.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Image by author</figcaption></figure><ul class=""><li id="ebcf" class="lp lq in lr b ls ne lu nf lc og lg oh lk oi lz ma mb mc md bi translated">由于消息被打印到控制台，这意味着我们已经成功地创建了与数据库的连接。</li><li id="ba1e" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated">如果您遇到任何类型的错误，请检查拼写错误，这是最常见的错误，或者尝试阅读打印到终端的错误消息并尝试修复它。</li><li id="5139" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated">现在，您的文件应该如下所示:</li></ul><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ow"><img src="../Images/ff9d4e2a932f25687cc99b619a8ae46d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WtFa1S42KkJ572rgwr1KHA.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">image by author</figcaption></figure><h2 id="726e" class="kt ku in bd kv kw kx dn ky kz la dp lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">创建路线:</h2><p id="ab7b" class="pw-post-body-paragraph mq mr in lr b ls lt jo ms lu lv jr mt lc mu mv mw lg mx my mz lk na nb nc lz ig bi translated">在第5行初始化express模块的下面，我们将开始为CRUD应用程序创建路由。</p><p id="e034" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated"><strong class="lr io">创建:</strong></p><p id="1b93" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">为了使POST路由工作，我们将首先使用一个名为<em class="nd"> express.json() </em>的中间件，它有助于将传入的json对象解析为一个简单的对象。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi ox"><img src="../Images/5a0c2be96d6afc209dd0d050ea876d28.png" data-original-src="https://miro.medium.com/v2/resize:fit:584/format:webp/1*GCIGP_6xARJmUIjDnE_aig.png"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">image by author</figcaption></figure><p id="6082" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">现在，看下面创建的post路由，然后图片下面会有说明。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oy"><img src="../Images/99675c6cc4cc87e44539b78cf3a707dd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ADaDrVRC0Adt5JZnbdYx4Q.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">image by author</figcaption></figure><ul class=""><li id="9f24" class="lp lq in lr b ls ne lu nf lc og lg oh lk oi lz ma mb mc md bi translated">首先，我们析构“req.body”对象来提取name、email和password属性。如果你不知道什么是析构，那么看看这里的<a class="ae ks" href="https://www.w3schools.com/react/react_es6_destructuring.asp" rel="noopener ugc nofollow" target="_blank"/>。</li><li id="e0fc" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated">然后，在“try”块中，我们使用作为对象的“connection”变量，并访问其中的“query”方法，以编写我们想要执行的SQL查询。</li><li id="d586" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated">“query”对象有3个参数，第一个是查询，第二个是值(如果有的话)，第三个是回调函数。</li><li id="3d89" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated">“插入”用于在表中插入记录。“users”是我们将要插入一行的表。指定表后，我们将打开括号来指定表中的列名。指定列后，我们使用“VALUES”关键字来声明指定列的值。这些值也在括号内指定，并用逗号分隔。</li><li id="d5f0" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated">这里的值，我们放了三个“？”，其值将被“query”方法的第二个参数替换，即数组[name，email，password]。列的顺序并不重要，但是值的顺序应该与列的顺序相匹配。</li><li id="1da5" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated">假设我们将姓名、电子邮件和密码的值输入为“John Doe”、“jdoe@gmail.com”、“test12”。因此，当查询将被执行时，它看起来像这样:“INSERT INTO users (full_name，email，password)值(' John Doe '，' jdoe@gmail.com '，' test 12 ')”；</li><li id="ff54" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated">如果查询方法的第二个参数是[email，name，password]，那么“full_name”列将保存用户的电子邮件，反之亦然。</li><li id="d221" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated">第三个参数是回调函数，用于处理任何错误和查询发送的结果。该函数总共有3个参数，但是对于这个查询，我们将只检查错误。你可以<em class="nd"> console.log </em>其他参数，看看它们会返回什么，如果它们对你的应用有用的话。</li><li id="e048" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated">在回调中，我们检查是否有任何错误，如果有错误，那么我们console.log它并返回400错误。</li><li id="8047" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated">如果没有出现错误，那么我们发送一个201状态，这意味着created，并发送一个JSON格式的消息，只说new users created。</li></ul><p id="ee81" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">现在，它只是一个基本的应用程序，所以我们不做任何验证，只是存储密码，没有哈希。如果你喜欢，你可以这样做，但对于这个项目，我会保持事情简单。</p><p id="a35f" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">现在，打开Postman应用程序，创建一条指向“localhost:3000/create”的投递路线。现在我们必须在我们的主体中发送JSON对象，所以点击Body &gt; Raw &gt; JSON。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oz"><img src="../Images/6a05563843a29c45f956ed6ba6e50aa1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ULOCu5PmnnusfAs-YQQIjw.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">image by author</figcaption></figure><p id="ff0e" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">选择输入区域并打开花括号({})来表示一个JSON对象，然后我们将添加键值对。看看下面的图片，并阅读下面的解释。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi pa"><img src="../Images/a965b01163d7e2c52174d8df56b710e0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*boMbP12Zd6NrA4SN25ir8A.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">image by author</figcaption></figure><ul class=""><li id="3770" class="lp lq in lr b ls ne lu nf lc og lg oh lk oi lz ma mb mc md bi translated">密钥——名称、电子邮件和密码应该准确输入，因为我们希望在我们的post路由中输入相同的内容。这些值可以是您喜欢的任何值。</li><li id="b73d" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated">输入值后，单击“发送”按钮并等待响应。如果你做了所有的事情，你应该会得到一个成功的回应。使用相同的过程，添加2或3个使用不同电子邮件的用户。</li></ul><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi pb"><img src="../Images/c7c1ca9c01168d4d5eae9d6ba47f8726.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zu8HNbYgCtYvlRO0SfaGpA.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">image by author</figcaption></figure><p id="96d5" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">现在，一个新用户已经成功地添加到了我们的数据库中的“users”表中。现在用同一封电子邮件尝试一个请求。名称和密码字段可以不同。用同一封电子邮件运行请求后，您将得到一个400错误。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi pc"><img src="../Images/997bee9e87dc29e95d671e70f17dfa05.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4DW8zBzAICYMWfeOe5_enA.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">image by author</figcaption></figure><p id="eb87" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">这是因为在我们的表中，我们指定email列应该只保存唯一的值，现在出现了重复。因此，会引发一个错误，并且该记录不会输入到数据库中。</p><p id="0691" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated"><strong class="lr io">读作:</strong></p><p id="2d18" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">现在，我们将读取添加到数据库中的用户。为了读取数据，我们将在server.js文件中创建一个GET route。首先，我们将看看如何获取所有用户，然后我们将看看如何根据条件读取数据。</p><ol class=""><li id="c5f9" class="lp lq in lr b ls ne lu nf lc og lg oh lk oi lz pd mb mc md bi translated">读取所有用户</li></ol><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi pe"><img src="../Images/e8f1dc952db2775dee74eaeae8ed80c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zsa3DOzSjkvf3yvJC-tLDA.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">image by author</figcaption></figure><ul class=""><li id="f56c" class="lp lq in lr b ls ne lu nf lc og lg oh lk oi lz ma mb mc md bi translated">这里，我们也将使用“query”方法来编写我们想要执行的SQL查询。</li><li id="231f" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated">SQL“SELECT”语句用于从数据库中读取数据。“*”表示选择表中的所有列。在“*”符号之后，我们使用FROM命令，该命令用于告诉表应该在哪个表上执行查询。然后我们指定表，在本例中，它是“用户”。</li><li id="93f6" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated">我们也可以用我们想要的列名来替换“*”号。然后，列名必须用逗号分隔。例如:“从用户中选择全名、电子邮件、用户密码”。</li><li id="409c" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated">因为我们没有任何需要插入到查询中的值，所以我们将跳过“query”方法的第二个参数，直接进入回调函数。</li><li id="0b7f" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated">同样，我们将检查错误，如果没有错误，我们将继续。</li><li id="a142" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated">在这种情况下，我们将使用results参数，因为该参数将保存从DB接收的结果。</li><li id="0a0c" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated">我们将把收到的结果作为JSON文档发送。</li><li id="73e2" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated">现在，在postman中创建新的GET请求，指向这个get URL，然后单击“send”。您应该会看到数据库中所有用户的列表。</li></ul><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi pf"><img src="../Images/2c0074e8ebf9acdaa19d4a85f5009819.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*G4x-HrcNVjdweQ_tUvhHTA.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">image by author</figcaption></figure><p id="715c" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">2.阅读特定用户</p><p id="ce97" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">为了根据条件获取记录，我们将使用WHERE子句。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi pg"><img src="../Images/53a0c414f1e3dd9b7eca76c35a4c3b0c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kO_KEEQpDOxcztJt84eP1Q.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">image by author</figcaption></figure><ul class=""><li id="6a40" class="lp lq in lr b ls ne lu nf lc og lg oh lk oi lz ma mb mc md bi translated">我们将创建一个新的路由并接受“email”作为参数，然后在我们的请求中提取email参数。</li><li id="77d8" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated">一切都和上面一样，但是在表名后面，我们将写“WHERE”来帮助过滤记录。在WHERE之后，我们将指定列名，列的for值将只是一个“？”就像我们之前做的。</li><li id="6c68" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated">现在，我们将为“查询”方法添加第二个参数，这是我们想要使用的值，也就是来自参数的电子邮件。</li><li id="057d" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated">其他都一样，现在用Postman跑这条路线。</li></ul><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi pf"><img src="../Images/d99d6a370b051131a4e0aeb1619c7a0f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*UpGQl38iwl9K4z9_a8kIOw.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">image by author</figcaption></figure><p id="4c32" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated"><strong class="lr io">更新:</strong></p><p id="248e" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">现在，我们将看看如何更新数据库中已经存在的记录。我们将更新特定用户的密码。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ph"><img src="../Images/9e29e883625c68fff6864f1c8febd0c8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZTq9Y7MgeQOgPgU7GoTe6w.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">image by author</figcaption></figure><ul class=""><li id="a00c" class="lp lq in lr b ls ne lu nf lc og lg oh lk oi lz ma mb mc md bi translated">我们将创建一个补丁路由，并将用户的电子邮件作为我们要更新的参数，新密码将输入到请求正文中。</li><li id="2adc" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated">“更新”命令用于更新表中已经存在的记录。在UPDATE之后，我们指定表名，然后使用SET命令指定应该更新哪一列。在SET之后，我们再次使用WHERE子句来过滤我们想要更新的记录。</li><li id="9214" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated">列“user_password”和“email”的值将再次传递给查询参数的第二个参数。</li><li id="10ea" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated">在Postman中运行以下请求并查看记录的密码，参数中指定的电子邮件将被更新。</li></ul><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi pa"><img src="../Images/b1261042f456713680aa53b4ed94426d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*H62QfBS8xgHQprGItRodIw.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">image by author</figcaption></figure><p id="361b" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">更新后，您可以再次运行“read”命令，您将看到您指定的用户的密码已被更新。</p><p id="998c" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated"><strong class="lr io">删除:</strong></p><p id="cc77" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">让我们看一下我们将要创建的最后一条路线。这里我们将删除一个使用电子邮件的用户，我们将再次把它作为一个参数。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi pi"><img src="../Images/c374fc8de490e7963fdc4b0a5f2789df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9QUZaz1QJ72dpjsDm251RA.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">image by author</figcaption></figure><ul class=""><li id="f781" class="lp lq in lr b ls ne lu nf lc og lg oh lk oi lz ma mb mc md bi translated">从参数中提取电子邮件后，我们将使用“query”方法中的“DELETE”语句删除一条记录。</li><li id="f9b3" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated">在“DELETE”之后，我们将使用FROM关键字来指定要删除的表名。</li><li id="d424" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated">指定表名后，我们将使用“WHERE”子句来过滤我们希望根据电子邮件删除的记录。</li><li id="8bbf" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated">email列的值将是“查询”方法的第二个参数，即email from参数。</li><li id="fd3a" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated">在回调函数中，我们将首先检查错误，如果没有错误，那么我们将继续下一步。</li><li id="cc54" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated">如果用户已被删除，则“results.affectedRows”将不为0。如果为0，则意味着数据库中没有删除任何记录，如果在数据库中没有找到输入电子邮件的记录，就会出现这种情况。</li><li id="8392" class="lp lq in lr b ls me lu mf lc mg lg mh lk mi lz ma mb mc md bi translated">现在，在邮差中运行这条路线。</li></ul><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi pj"><img src="../Images/8334dbf73437b0cb51b48f48eb1cb0ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LiG_ddW7eTz3qeiKwf_2tA.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">image by author</figcaption></figure><p id="5897" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">如果您看到此消息，则意味着该用户已从“用户”表中成功删除。</p><p id="10a1" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">如果您使用相同的电子邮件运行相同的路线，您将得到404错误。</p><h1 id="c3a9" class="nk ku in bd kv nl oj nn ky no ok nq lb jt ol ju lf jw om jx lj jz on ka ln nu bi translated">结论:</h1><p id="d4f0" class="pw-post-body-paragraph mq mr in lr b ls lt jo ms lu lv jr mt lc mu mv mw lg mx my mz lk na nb nc lz ig bi translated">MySQL是许多大公司使用最广泛的SQL数据库，如脸书、Twitter、LinkedIn、Tumblr等等。学习MySQL可以很好地影响你的职业生涯，因为大多数公司要求开发人员具备MySQL知识。</p><p id="bd76" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">这篇文章比预期的要长，但是我希望它值得你花时间，并且你确实从中学到了一些东西。</p><p id="8ebc" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated">直到下一次，保持安全和快乐的编码！</p><p id="7c3f" class="pw-post-body-paragraph mq mr in lr b ls ne jo ms lu nf jr mt lc ng mv mw lg nh my mz lk ni nb nc lz ig bi translated"><em class="nd">更多内容看</em> <a class="ae ks" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <em class="nd">说白了。报名参加我们的</em> </a><a class="ae ks" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <em class="nd">免费每周简讯</em> </a> <em class="nd">。在我们的</em> <a class="ae ks" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <em class="nd">社区</em> </a> <em class="nd">获得独家写作机会和建议。</em></p></div></div>    
</body>
</html>