<html>
<head>
<title>Serverless Bundling— Numbers Talk!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">无服务器捆绑—数字说话！</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/serverless-bundling-numbers-talk-7826f762a29e?source=collection_archive---------10-----------------------#2022-05-06">https://javascript.plainenglish.io/serverless-bundling-numbers-talk-7826f762a29e?source=collection_archive---------10-----------------------#2022-05-06</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="dc27" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">这将是对webpack和esbuild的经典测试</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/e1111f3040592137f35243c356d9b70a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*s9kVQEW_jm9PPfcleZQ99A.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Webpack and esbuild</figcaption></figure><h2 id="5e3a" class="ks kt in bd ku kv kw dn kx ky kz dp la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">语境</h2><p id="e39b" class="pw-post-body-paragraph lo lp in lq b lr ls jo lt lu lv jr lw lb lx ly lz lf ma mb mc lj md me mf mg ig bi translated">随着我们的一项无服务器服务开始增长，构建和部署时间也在增长。这是一项我们需要经常部署的服务，所以20分钟左右的部署时间是不可接受的。我们正在使用<a class="ae mh" href="https://www.serverless.com/" rel="noopener ugc nofollow" target="_blank">无服务器框架</a>，它为我们提供了很好的服务。除了框架之外，我们使用webpack和Gitlab将服务部署到AWS。</p><p id="0391" class="pw-post-body-paragraph lo lp in lq b lr mi jo lt lu mj jr lw lb mk ly lz lf ml mb mc lj mm me mf mg ig bi translated">下面你会看到一个小表格，显示了从webpack切换到esbuild的结果:</p><h1 id="7774" class="mn kt in bd ku mo mp mq kx mr ms mt la jt mu ju le jw mv jx li jz mw ka lm mx bi translated">速度下降</h1><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi my"><img src="../Images/ca1cb5400305078c0c5c4a82a789c775.png" data-original-src="https://miro.medium.com/v2/resize:fit:980/format:webp/1*gqwQqhfdn6JcnwUUbkbSKA.png"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Some key numbers</figcaption></figure><p id="1658" class="pw-post-body-paragraph lo lp in lq b lr mi jo lt lu mj jr lw lb mk ly lz lf ml mb mc lj mm me mf mg ig bi translated">如上所述，切换到esbuild的变化是巨大的！<br/>我最感兴趣的两个指标是部署时间和功能大小。<br/>在这种情况下，我们的部署时间减少了近60%,最大的功能减少了近95%。</p><h2 id="da58" class="ks kt in bd ku kv kw dn kx ky kz dp la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">esbuild真的那么好吗？</h2><p id="8b6f" class="pw-post-body-paragraph lo lp in lq b lr ls jo lt lu lv jr lw lb lx ly lz lf ma mb mc lj md me mf mg ig bi translated">简而言之，是的！</p><p id="4350" class="pw-post-body-paragraph lo lp in lq b lr mi jo lt lu mj jr lw lb mk ly lz lf ml mb mc lj mm me mf mg ig bi translated">Esbuild在用最少的配置捆绑您的项目方面非常出色。这才是真正的关键。配置！许多项目可能需要非常专业的设置，因此Webpack可能更好。但是Webpack也因为有一个非常陡峭的学习曲线而出名。</p><p id="89a3" class="pw-post-body-paragraph lo lp in lq b lr mi jo lt lu mj jr lw lb mk ly lz lf ml mb mc lj mm me mf mg ig bi translated">我确信我可以大大改进Webpack的构建。首先，我在排除<code class="fe mz na nb nc b">aws-sdk</code>时遇到了麻烦，它最终被打包在每个函数中(而且非常大)。<br/>因此，webpack设置中的功能大小远远大于它们需要的大小。<br/>我100%确定Webpack有能力排除<code class="fe mz na nb nc b">aws-sdk</code>包，但是我花了很长时间才弄明白，以至于我在沮丧中开始关注esbuild。</p><p id="26e3" class="pw-post-body-paragraph lo lp in lq b lr mi jo lt lu mj jr lw lb mk ly lz lf ml mb mc lj mm me mf mg ig bi translated">简单绝对是一个关键特性，我相信这会吸引更多的人使用esbuild。速度是另一个！</p><h2 id="0769" class="ks kt in bd ku kv kw dn kx ky kz dp la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">一个简单的例子</h2><p id="9048" class="pw-post-body-paragraph lo lp in lq b lr ls jo lt lu lv jr lw lb lx ly lz lf ma mb mc lj md me mf mg ig bi translated">如上所述，webpack确实有它擅长的领域。但是对我来说，这对于我们的设置来说太复杂了。</p><p id="6e2b" class="pw-post-body-paragraph lo lp in lq b lr mi jo lt lu mj jr lw lb mk ly lz lf ml mb mc lj mm me mf mg ig bi translated">我们的webpack设置需要:</p><ul class=""><li id="7ab9" class="nd ne in lq b lr mi lu mj lb nf lf ng lj nh mg ni nj nk nl bi translated"><code class="fe mz na nb nc b">webpack</code>和<code class="fe mz na nb nc b">serverless-webpack</code>套餐(外加一些额外费用)。</li><li id="38f6" class="nd ne in lq b lr nm lu nn lb no lf np lj nq mg ni nj nk nl bi translated">一个有很多配置的<code class="fe mz na nb nc b">webpack.config.js</code>文件。这里会有关于构建的大部分细节。这个文件可能会变得相当复杂，缺省值不能解决这个问题。</li><li id="31a7" class="nd ne in lq b lr nm lu nn lb no lf np lj nq mg ni nj nk nl bi translated"><code class="fe mz na nb nc b">serverless.yaml</code>文件中的一些配置。</li></ul><p id="6946" class="pw-post-body-paragraph lo lp in lq b lr mi jo lt lu mj jr lw lb mk ly lz lf ml mb mc lj mm me mf mg ig bi translated">我们的esbuild设置需要:</p><ul class=""><li id="6ed4" class="nd ne in lq b lr mi lu mj lb nf lf ng lj nh mg ni nj nk nl bi translated"><code class="fe mz na nb nc b">esbuild</code>和<code class="fe mz na nb nc b">serverless-esbuild</code>包(加上一些额外的)</li><li id="12d0" class="nd ne in lq b lr nm lu nn lb no lf np lj nq mg ni nj nk nl bi translated"><code class="fe mz na nb nc b">serverless.yaml</code>中的一个配置看起来是这样的:</li></ul><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nr ns l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Serverless.yaml</figcaption></figure><p id="88aa" class="pw-post-body-paragraph lo lp in lq b lr mi jo lt lu mj jr lw lb mk ly lz lf ml mb mc lj mm me mf mg ig bi translated">剩下的都是esbuild设置的默认值。</p><h2 id="d7ae" class="ks kt in bd ku kv kw dn kx ky kz dp la lb lc ld le lf lg lh li lj lk ll lm ln bi translated">结论</h2><p id="facf" class="pw-post-body-paragraph lo lp in lq b lr ls jo lt lu lv jr lw lb lx ly lz lf ma mb mc lj md me mf mg ig bi translated">从webpack迁移到esbuild大约需要3-4个小时，现在我们的部署时间和功能规模都大大缩短了。这将有助于加快反馈循环，并改善AWS的冷启动。将来，其他项目可能仍然需要webpack，但现在，esbuild将是我的默认选择！</p><blockquote class="nt"><p id="92a9" class="nu nv in bd nw nx ny nz oa ob oc mg dk translated">-补水是关键！</p></blockquote><p id="b2e5" class="pw-post-body-paragraph lo lp in lq b lr od jo lt lu oe jr lw lb of ly lz lf og mb mc lj oh me mf mg ig bi translated"><em class="oi">更多内容尽在</em> <a class="ae mh" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="lq io"> <em class="oi">说白了. io </em> </strong> </a> <em class="oi">。报名参加我们的</em> <a class="ae mh" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="lq io"> <em class="oi">免费周报</em> </strong> </a> <em class="oi">。关注我们关于</em> <a class="ae mh" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"> <strong class="lq io"> <em class="oi">推特</em> </strong> </a> <em class="oi">和</em><a class="ae mh" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="lq io"><em class="oi">LinkedIn</em></strong></a><em class="oi">。加入我们的</em> <a class="ae mh" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="lq io"> <em class="oi">社区不和谐</em> </strong> </a> <em class="oi">。</em></p></div></div>    
</body>
</html>