<html>
<head>
<title>How to Create a Simple API with Next.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Next.js创建简单的API</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/creating-simple-api-with-next-js-b945b8cf4a43?source=collection_archive---------9-----------------------#2022-05-19">https://javascript.plainenglish.io/creating-simple-api-with-next-js-b945b8cf4a43?source=collection_archive---------9-----------------------#2022-05-19</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="3284" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">使用Next.js创建简单API的指南</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/871f4b405d2bfa227da36b38f7b3c2d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7sH8eij3HrUm78wz"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@ramesquinerie?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Rames Quinerie</a> on <a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="7739" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如果你已经熟悉React，你可能听说过Next.js。它是由Vercel构建的React框架。它为我们提供了一条开箱即用的可选路径，这意味着我们可以用JavaScript编写后端代码。所以让我们开始创建我们的第一个API。</p><h2 id="5f4e" class="lp lq in bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated">安装Next.js</h2><p id="2535" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">在您的终端中运行以下命令:</p><pre class="kd ke kf kg gt mn mo mp mq aw mr bi"><span id="8cd1" class="lp lq in mo b gy ms mt l mu mv">npx create-next-app@latest</span></pre><p id="1ce2" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">安装完成后，您会看到一些来自Next.js的样板文件。现在只需关注<code class="fe mw mx my mo b">pages</code>文件夹。默认情况下，里面会有<code class="fe mw mx my mo b">api</code>文件夹、<code class="fe mw mx my mo b">_app.js</code>和<code class="fe mw mx my mo b">index.js</code>文件。<code class="fe mw mx my mo b">Index.js</code>文件就像我们的home组件，<code class="fe mw mx my mo b">_app.js</code>是我们应用程序的包装器，<code class="fe mw mx my mo b">api</code>文件夹是我们将要创建的API的所有端点所在的地方。</p><p id="2480" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">不要忘记运行下面的命令来启动我们的下一个应用程序:</p><pre class="kd ke kf kg gt mn mo mp mq aw mr bi"><span id="03ad" class="lp lq in mo b gy ms mt l mu mv">npm run dev</span></pre><p id="bf3c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这个命令将在http://localhost:3000启动我们的应用程序。</p><p id="ae2f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在让我们只关注<code class="fe mw mx my mo b">api</code>文件夹，因为我们的工作主要在这里。在<code class="fe mw mx my mo b">api</code>文件夹里，你会看到<code class="fe mw mx my mo b">hello.js</code>文件，如果你愿意，你可以删除它。</p><p id="0175" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在这个演示中，假设我们想要制作一个API，它将返回一个英雄和角色的集合。在Next.js中，我们的文件夹结构将成为我们的端点路径，因此我们将更容易组织它。</p><p id="550e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在创建<code class="fe mw mx my mo b">heroes</code>文件夹，并在其中创建一个<code class="fe mw mx my mo b">index.js</code>文件。如果URL中没有发送参数，<code class="fe mw mx my mo b">index.js</code>文件将成为默认路径。由于我们也想获得具有特定id的英雄，所以我们也在英雄文件夹中创建了<code class="fe mw mx my mo b">[id].js</code>文件。为了在Next.js中创建一个动态API路由，我们必须将文件名放在括号中，以告诉Next.js这是一个动态路由。在<code class="fe mw mx my mo b">index.js</code>文件中，编写如下所示的代码:</p><pre class="kd ke kf kg gt mn mo mp mq aw mr bi"><span id="e680" class="lp lq in mo b gy ms mt l mu mv">export default async function handler(req, res) {</span><span id="0d5a" class="lp lq in mo b gy mz mt l mu mv">let data = await fetch(`${urlToFetch}`)</span><span id="5867" class="lp lq in mo b gy mz mt l mu mv">let json = await data.json()</span><span id="a023" class="lp lq in mo b gy mz mt l mu mv">res.send(json)</span><span id="0b45" class="lp lq in mo b gy mz mt l mu mv">}</span></pre><p id="faab" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这段代码将检索所有英雄的列表，并将其发送回客户端<em class="na">(注意:您可以根据需要修改代码)。</em></p><p id="c601" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">要访问我们的API，我们需要追加我们的URL。我们的URL变成了<a class="ae ks" href="http://localhost:3000" rel="noopener ugc nofollow" target="_blank"><em class="na">http://localhost:3000</em></a><em class="na">/API/heroes</em>，因为我们在heroes文件夹中，我们需要在URL中反映它。</p><p id="db00" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在在<code class="fe mw mx my mo b">[id].js</code>文件中，编写如下所示的代码:</p><pre class="kd ke kf kg gt mn mo mp mq aw mr bi"><span id="bd64" class="lp lq in mo b gy ms mt l mu mv">export default async function handler(req, res) {</span><span id="f43d" class="lp lq in mo b gy mz mt l mu mv">let id = req.query.id</span><span id="d6fb" class="lp lq in mo b gy mz mt l mu mv">let data = await fetch(`${urlToFetch}/${id}`)</span><span id="fa5a" class="lp lq in mo b gy mz mt l mu mv">let json = await data.json()</span><span id="ae8a" class="lp lq in mo b gy mz mt l mu mv">res.send(json)</span><span id="98f8" class="lp lq in mo b gy mz mt l mu mv">}</span></pre><p id="9491" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">要访问API，我们只需要编写<a class="ae ks" href="http://localhost:3000" rel="noopener ugc nofollow" target="_blank"><em class="na">http://localhost:3000</em></a><em class="na">/API/heroes/{ id }</em>并用某个特定的id替换id即可。注意，我们可以使用与文件名相同的单词来访问URL中的参数，因为我们的文件名是<code class="fe mw mx my mo b">[id].js</code>，那么我们就可以得到它<code class="fe mw mx my mo b">by req.query.id</code>。这将向客户端发送包含特定数据的响应。角色部分也是如此，我们只需要在英雄文件夹的同一层再创建一个文件夹。</p><p id="169e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">就是这样！希望这篇文章能帮助你开始用Next.js创建API，干杯！🍻</p></div><div class="ab cl nb nc hr nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="ig ih ii ij ik"><h2 id="e121" class="lp lq in bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated">进一步阅读</h2><div class="ni nj gp gr nk nl"><a rel="noopener  ugc nofollow" target="_blank" href="/data-fetching-with-next-js-13s-bleeding-edge-features-a-primer-a60ddd3f7570"><div class="nm ab fo"><div class="nn ab no cl cj np"><h2 class="bd io gy z fp nq fr fs nr fu fw im bi translated">使用Next.js 13的前沿特性获取数据——入门</h2><div class="ns l"><h3 class="bd b gy z fp nq fr fs nr fu fw dk translated">NextJS 13中的数据获取使用了应用程序目录、流、暂挂以及混合服务器和客户端组件。</h3></div><div class="nt l"><p class="bd b dl z fp nq fr fs nr fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="nu l"><div class="nv l nw nx ny nu nz km nl"/></div></div></a></div><p id="a339" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="na">更多内容看</em> <a class="ae ks" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="na">说白了。报名参加我们的</em> <a class="ae ks" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="na">免费周报</em> </strong> </a> <em class="na">。关注我们关于</em><a class="ae ks" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="na">Twitter</em></strong></a><em class="na">和</em><a class="ae ks" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="na">LinkedIn</em></strong></a><em class="na">。查看我们的</em> <a class="ae ks" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="na">社区不和谐</em> </strong> </a> <em class="na">加入我们的</em> <a class="ae ks" href="https://inplainenglish.pallet.com/talent/welcome" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="na">人才集体</em> </strong> </a> <em class="na">。</em></strong></a></p></div></div>    
</body>
</html>