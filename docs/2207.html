<html>
<head>
<title>How to Execute JavaScript Code Stored in a String?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何执行存储在字符串中的JavaScript代码？</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-execute-javascript-code-stored-in-a-string-6aff91c7590e?source=collection_archive---------3-----------------------#2022-05-21">https://javascript.plainenglish.io/how-to-execute-javascript-code-stored-in-a-string-6aff91c7590e?source=collection_archive---------3-----------------------#2022-05-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/5ee3be8d9ac8542bae3c598006506741.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*d1juG-X_AUjA8Y1y"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@bruno_nascimento?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Bruno Nascimento</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="e9c6" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有时，我们有一个JavaScript字符串，其中包含我们想要运行的代码。</p><p id="715a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在本文中，我们将研究如何执行存储在字符串中的JavaScript代码。</p><h1 id="411c" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">用函数构造器创建一个新函数</h1><p id="a789" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用<code class="fe me mf mg mh b">Function</code>构造函数从JavaScript代码串中创建一个新函数。</p><p id="9c50" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如，我们可以写:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="5a49" class="mq lc iq mh b gy mr ms l mt mu">const code = "alert('Hello World'); let x = 100";<br/>const F = new Function(code);<br/>F();</span></pre><p id="37fa" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">创建代码串并将其存储到<code class="fe me mf mg mh b">code</code>变量中。</p><p id="accf" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们将<code class="fe me mf mg mh b">code</code>传递给<code class="fe me mf mg mh b">Function</code>构造函数，从中创建一个函数。</p><p id="84dc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">然后我们调用<code class="fe me mf mg mh b">F</code>来运行这个函数。</p><h1 id="90ca" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">使用setTimeout函数</h1><p id="fea7" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们还可以将JavaScript代码串传入<code class="fe me mf mg mh b">setTimeout</code>函数来运行代码串。</p><p id="e5ba" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为此，我们写道:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="0c28" class="mq lc iq mh b gy mr ms l mt mu">const code = "alert('Hello World'); let x = 100";<br/>setTimeout(code, 1);</span></pre><p id="4a74" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们将<code class="fe me mf mg mh b">code</code>作为<code class="fe me mf mg mh b">setTimeout</code>函数的第一个参数来运行它。</p><p id="8fa7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">第二个参数是运行该函数之前的延迟(毫秒)。</p><h1 id="cdcd" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">不要使用eval函数</h1><p id="6608" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们不应该使用<code class="fe me mf mg mh b">eval</code>函数从字符串中运行代码。</p><p id="6ccc" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这是因为任何人都可以轻松地向其中注入代码，这是一个很大的安全风险。</p><p id="bc3e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">此外，它创建了自己的作用域，这意味着它可能会做我们意想不到的事情。</p><p id="850d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">所以我们不应该写这样的代码:</p><pre class="mi mj mk ml gt mm mh mn mo aw mp bi"><span id="ad7e" class="mq lc iq mh b gy mr ms l mt mu">const code = "alert('Hello World'); let x = 100";<br/>eval(code)</span></pre><p id="c37e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在我们的JavaScript代码中。</p><h1 id="8535" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="d7e9" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">我们可以用JavaScript运行存储在字符串中的JavaScript代码，方法是用<code class="fe me mf mg mh b">Function</code>构造函数创建一个函数，或者将它传递给<code class="fe me mf mg mh b">setTimeout</code>函数。</p><p id="3d32" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mv">更多内容请看</em><a class="ae kc" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir"><em class="mv">plain English . io</em></strong></a><em class="mv">。报名参加我们的</em> <a class="ae kc" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir"> <em class="mv">免费周报</em> </strong> </a> <em class="mv">。关注我们关于</em><a class="ae kc" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir"><em class="mv">Twitter</em></strong></a><em class="mv">和</em><a class="ae kc" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir"><em class="mv">LinkedIn</em></strong></a><em class="mv">。查看我们的</em> <a class="ae kc" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir"> <em class="mv">社区不和谐</em> </strong> </a> <em class="mv">加入我们的</em> <a class="ae kc" href="https://inplainenglish.pallet.com/talent/welcome" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir"> <em class="mv">人才集体</em> </strong> </a> <em class="mv">。</em></p></div></div>    
</body>
</html>