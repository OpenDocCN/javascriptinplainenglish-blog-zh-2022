<html>
<head>
<title>How to Check Equality in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在JavaScript中检查等式</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-check-equality-in-javascript-d8742a990fd?source=collection_archive---------8-----------------------#2022-06-29">https://javascript.plainenglish.io/how-to-check-equality-in-javascript-d8742a990fd?source=collection_archive---------8-----------------------#2022-06-29</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="0257" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">创建一个函数来检查对象是否相等</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/049d1e91ac9ba2a7a1c0faa5479a3c4b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7rhJ37iyrRiV56xphiJdag.jpeg"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://www.pexels.com/@pedro-figueras-202443/" rel="noopener ugc nofollow" target="_blank">Pedro Figueras</a> on <a class="ae ks" href="https://www.pexels.com/photo/two-pigeon-perched-on-white-track-light-681447/" rel="noopener ugc nofollow" target="_blank">pexels</a></figcaption></figure><p id="7ce5" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">最近我在做一个项目，我必须检查两个对象是否有相同的数据点。这是我以前做过的一项任务，所以我认为我过去的一些解决方案可能会奏效。事实证明，我之前实施的解决方案不起作用。它不处理嵌入对象、嵌入数组或未定义/空数据类型等情况。考虑到这一点，我决定重新创建一个解决方案来处理所有这些情况(如果您发现一个测试用例使这个解决方案失败，请确保在评论中删除它)。在这篇博客中，我将讨论我的思考过程，以及我是如何创造出解决这个问题的方案的。</p><p id="5fe6" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">另一件需要注意的重要事情是，已经存在npm解决方案来为您处理这个问题。例如，npm Lodash有一个<a class="ae ks" href="https://lodash.com/docs/4.17.15#isEqual" rel="noopener ugc nofollow" target="_blank"> isEqual </a>函数来检查对象之间的相等性。然而，当我需要的只是一个单一的函数时，我不想安装这么大的软件包。</p><p id="58e7" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在我们开始之前，你也可以看看这篇由Sankalp Lakhina 撰写的<a class="ae ks" href="https://medium.com/@sankalp.lakhina91/understanding-object-equality-in-javascript-ec3e7a2b5b1d" rel="noopener">博客，以了解为什么在JavaScript中检查<code class="fe lp lq lr ls b">obj1 === obj2</code>不起作用。</a></p><h2 id="123c" class="lt lu in bd lv lw lx dn ly lz ma dp mb lc mc md me lg mf mg mh lk mi mj mk ml bi translated">最终答案</h2><p id="43e0" class="pw-post-body-paragraph kt ku in kv b kw mm jo ky kz mn jr lb lc mo le lf lg mp li lj lk mq lm ln lo ig bi translated">为了节省那些只需要答案的读者的时间，我把我的解决方案放在顶部。博客的其余部分将涵盖我的工作流程/测试案例。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mr ms l"/></div></figure><h2 id="106a" class="lt lu in bd lv lw lx dn ly lz ma dp mb lc mc md me lg mf mg mh lk mi mj mk ml bi translated">设置</h2><p id="7ac2" class="pw-post-body-paragraph kt ku in kv b kw mm jo ky kz mn jr lb lc mo le lf lg mp li lj lk mq lm ln lo ig bi translated">为了快速准确地测试我正在创建的<code class="fe lp lq lr ls b">isEqual</code>函数，我将编写许多测试用例。我将使用<code class="fe lp lq lr ls b">Jest</code>运行这些测试用例。如果你不确定如何编写测试用例，你可以看看我的博客<a class="ae ks" rel="noopener ugc nofollow" target="_blank" href="/how-to-write-javascript-unit-tests-using-jest-422b3c4e050f"/>。在接下来的几节中，您将能够看到我创建的测试用例。</p><h2 id="2fd2" class="lt lu in bd lv lw lx dn ly lz ma dp mb lc mc md me lg mf mg mh lk mi mj mk ml bi translated">第一步:简单的物体</h2><p id="9605" class="pw-post-body-paragraph kt ku in kv b kw mm jo ky kz mn jr lb lc mo le lf lg mp li lj lk mq lm ln lo ig bi translated">我从处理“简单对象”开始。我将“简单对象”定义为不包含嵌入对象的对象。“简单对象”仅由JavaScript <a class="ae ks" href="https://developer.mozilla.org/en-US/docs/Glossary/Primitive" rel="noopener ugc nofollow" target="_blank">原始类型</a>组成。根据MDN Web文档的定义，JavaScript只有7种原始数据类型:<a class="ae ks" href="https://developer.mozilla.org/en-US/docs/Glossary/String" rel="noopener ugc nofollow" target="_blank">字符串</a>，<a class="ae ks" href="https://developer.mozilla.org/en-US/docs/Glossary/Number" rel="noopener ugc nofollow" target="_blank">数字</a>，<a class="ae ks" href="https://developer.mozilla.org/en-US/docs/Glossary/BigInt" rel="noopener ugc nofollow" target="_blank"> bigint </a>，<a class="ae ks" href="https://developer.mozilla.org/en-US/docs/Glossary/Boolean" rel="noopener ugc nofollow" target="_blank">布尔</a>，<a class="ae ks" href="https://developer.mozilla.org/en-US/docs/Glossary/undefined" rel="noopener ugc nofollow" target="_blank">未定义</a>，<a class="ae ks" href="https://developer.mozilla.org/en-US/docs/Glossary/Symbol" rel="noopener ugc nofollow" target="_blank">符号</a>，以及<a class="ae ks" href="https://developer.mozilla.org/en-US/docs/Glossary/Null" rel="noopener ugc nofollow" target="_blank">空值</a>。</p><p id="5de0" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">注意:我排除了符号的测试用例。符号是一种唯一的数据类型，其中创建的每个符号都应该是唯一的，除非它们是用<code class="fe lp lq lr ls b">.for()</code>方法创建的。你可以在这里阅读更多关于符号<a class="ae ks" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Symbol" rel="noopener ugc nofollow" target="_blank">的内容。</a></p><p id="c31f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我从创建以下测试用例开始。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="0638" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">下面你可以看到我的解决方案。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="baad" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">有了这个解决方案，除了两个之外，所有的测试用例都通过了。第一个问题是关于<code class="fe lp lq lr ls b">NaN</code>值。<code class="fe lp lq lr ls b">NaN === NaN</code>评估为<code class="fe lp lq lr ls b">false</code>，然而，我期望这个评估为<code class="fe lp lq lr ls b">true</code>。为了解决这个问题，我将首先检查传递的值是否属于类型<code class="fe lp lq lr ls b">number</code>，并使用JavaScript的内置函数<code class="fe lp lq lr ls b">Number.isNaN()</code>检查它们是否为<code class="fe lp lq lr ls b">NaN</code>。如果是这样，我就返回<code class="fe lp lq lr ls b">true</code>。</p><p id="158a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">第二个问题是关于<code class="fe lp lq lr ls b">null</code>原始类型。<code class="fe lp lq lr ls b">Null</code>属于JavaScript 中的<code class="fe lp lq lr ls b">object</code>类型，必须被隐式检查。简单地在函数顶部添加一个隐式的<code class="fe lp lq lr ls b">null</code>值检查应该可以解决这些问题。</p><p id="c476" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">下面你可以看到<code class="fe lp lq lr ls b">isEqual</code>函数是如何被修改的。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="0fec" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">然后我写了应该评估为<code class="fe lp lq lr ls b">false</code>的测试用例。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="e5e1" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这些测试案例发现了新的错误。首先，让我们解决一个对象的值设置为<code class="fe lp lq lr ls b">undefined</code>而另一个对象缺少键的情况。为了解决这个问题，我决定添加一个<code class="fe lp lq lr ls b">if</code>条件和另一个循环。我将首先检查两个对象是否有相同数量的键。如果对象有不同数量的键，我将立即返回<code class="fe lp lq lr ls b">false</code>。接下来，我将遍历object1的键，并确保它们出现在object2中。如果钥匙不在，我会马上归还。这个增加应该可以处理对象看起来像这样的测试用例。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="6133" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在本节中，我不会在每个键上递归调用<code class="fe lp lq lr ls b">isEqual</code>。原因在于，只要对象具有相同的键值对，它们就应该被认为是相等的。它们的键的顺序并不重要。</p><p id="c6cb" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">新的和更新的代码和测试用例应该是这样的。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mr ms l"/></div></figure><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="bd35" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在我们可以继续解决更复杂的物体。</p><h2 id="5d7c" class="lt lu in bd lv lw lx dn ly lz ma dp mb lc mc md me lg mf mg mh lk mi mj mk ml bi translated">第二步:复杂的物体</h2><p id="3e1d" class="pw-post-body-paragraph kt ku in kv b kw mm jo ky kz mn jr lb lc mo le lf lg mp li lj lk mq lm ln lo ig bi translated">幸运的是，我们的解决方案应该足够健壮，能够处理嵌入式对象。我创建了下面的测试用例只是为了确保。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="9012" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在运行这些测试用例之后，我们可以看到嵌入的对象正在按预期工作。</p><h2 id="266b" class="lt lu in bd lv lw lx dn ly lz ma dp mb lc mc md me lg mf mg mh lk mi mj mk ml bi translated">第三步:列表</h2><p id="ed0d" class="pw-post-body-paragraph kt ku in kv b kw mm jo ky kz mn jr lb lc mo le lf lg mp li lj lk mq lm ln lo ig bi translated">测试列表之间的相等性应该很容易。首先，我将检查传递的值是否是列表。接下来，我将检查它们是否长度相同。如果它们长度相同，那么我将遍历列表，递归地调用每个元素上的<code class="fe lp lq lr ls b">isEqual</code>。如果元素不相等，我将返回<code class="fe lp lq lr ls b">false</code>。最后，如果列表长度不等，那么我将返回<code class="fe lp lq lr ls b">false</code>。下面你可以看到我做的测试用例以及代码是如何修改的。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mr ms l"/></div></figure><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mr ms l"/></div></figure><h2 id="2651" class="lt lu in bd lv lw lx dn ly lz ma dp mb lc mc md me lg mf mg mh lk mi mj mk ml bi translated">第四步:集合</h2><p id="e2f6" class="pw-post-body-paragraph kt ku in kv b kw mm jo ky kz mn jr lb lc mo le lf lg mp li lj lk mq lm ln lo ig bi translated">最后，我想在set上测试我的解决方案。下面你可以看到我做的测试案例。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mr ms l"/></div></figure><p id="ea78" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">正如所料，当前的解决方案不起作用，但是，这有一个简单的解决办法。在运行数组逻辑之前，我将检查传递的值是否是一个<code class="fe lp lq lr ls b">instanceof Set</code>。如果它们都是集合，我将把它们转换成数组，对它们进行排序，并对排序后的数组运行<code class="fe lp lq lr ls b">isEqual</code>逻辑。我必须对它们进行排序，因为集合和对象一样，只要包含相同的值，就应该被评估为<code class="fe lp lq lr ls b">true</code>。顺序应该无关紧要。如果不是两套，我就返回<code class="fe lp lq lr ls b">false</code>。更新后的代码应该如下所示。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mr ms l"/></div></figure></div><div class="ab cl mt mu hr mv" role="separator"><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my mz"/><span class="mw bw bk mx my"/></div><div class="ig ih ii ij ik"><p id="99a1" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">通过这个简单的加法，我们完成了<code class="fe lp lq lr ls b">isEqual</code>函数。希望这对你有帮助。</p><p id="283d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="na">更多内容看</em> <a class="ae ks" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="na">说白了就是io </em> </strong> </a> <em class="na">。报名参加我们的</em> <a class="ae ks" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="na">免费周报</em> </strong> </a> <em class="na">。关注我们关于</em><a class="ae ks" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="na">Twitter</em></strong></a><em class="na">和</em><a class="ae ks" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="na">LinkedIn</em></strong></a><em class="na">。查看我们的</em> <a class="ae ks" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="na">社区不和谐</em> </strong> </a> <em class="na">加入我们的</em> <a class="ae ks" href="https://inplainenglish.pallet.com/talent/welcome" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="na">人才集体</em> </strong> </a> <em class="na">。</em></p></div></div>    
</body>
</html>