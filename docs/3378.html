<html>
<head>
<title>Get the Redux State in a React 18 Production Build via the Browser’s Console</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过浏览器的控制台获取React 18生产版本中的Redux状态</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-get-the-redux-state-in-a-react-18-production-build-via-the-browsers-console-a01814eebfa8?source=collection_archive---------13-----------------------#2022-08-23">https://javascript.plainenglish.io/how-to-get-the-redux-state-in-a-react-18-production-build-via-the-browsers-console-a01814eebfa8?source=collection_archive---------13-----------------------#2022-08-23</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="a582" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">关于如何通过浏览器控制台在React18生产版本中获得Redux状态的教程。</h2></div><p id="bd4b" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">几个月前我写了一篇关于<a class="ae ky" href="https://pablo.gg/en/blog/coding/how-to-get-the-redux-state-from-a-production-build-via-the-browsers-console/" rel="noopener ugc nofollow" target="_blank">如何在产品</a>中获得Redux状态的博文，但是随着React 18的最新发布，这些代码不再有效。</p><p id="f5ea" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">让我们深入了解为什么它不再有效，并找出如何创建一个有效的新脚本。</p><h1 id="8a34" class="kz la in bd lb lc ld le lf lg lh li lj jt lk ju ll jw lm jx ln jz lo ka lp lq bi translated">什么变了？</h1><p id="5c17" class="pw-post-body-paragraph kc kd in ke b kf lr jo kh ki ls jr kk kl lt kn ko kp lu kr ks kt lv kv kw kx ig bi translated">在React 17上，React容器包含了一个名为<code class="fe lw lx ly lz b">_reactRootContainer</code>的属性，而React 18不再是这种情况，<a class="ae ky" href="https://github.com/facebook/react/blob/a724a3b578dce77d427bef313102a4d0e978d9b4/packages/react-dom/src/client/ReactDOMComponentTree.js#L40" rel="noopener ugc nofollow" target="_blank">正如我们在React源代码</a>中看到的，它现在使用<code class="fe lw lx ly lz b">__reactContainer</code>作为前缀，最后是一个随机键。</p><p id="7d62" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">记住这一点，我们可以通过检查React容器是否包含以<code class="fe lw lx ly lz b">__reactContainer</code>开头的属性来尝试找到React容器，但在此之前，我们需要找到所有可能成为React容器的潜在DOM元素。</p><p id="5fe1" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">大多数React apps会用一个HTML <code class="fe lw lx ly lz b">id</code>来设置容器，然后用<code class="fe lw lx ly lz b">getElementById()</code>来查询，所以要查询文档中所有带<code class="fe lw lx ly lz b">id</code>的元素，我们可以用<code class="fe lw lx ly lz b">document.querySelectorAll("*[id]")</code>。</p><p id="4916" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">要查找页面上的所有React容器，我们可以运行以下脚本:</p><figure class="ma mb mc md gt me"><div class="bz fp l di"><div class="mf mg l"/></div></figure><p id="66fa" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">搞定了。现在我们所要做的就是找到<code class="fe lw lx ly lz b">_internalRoot</code>，我们就准备好了，对吗？对吗？</p><h1 id="c483" class="kz la in bd lb lc ld le lf lg lh li lj jt lk ju ll jw lm jx ln jz lo ka lp lq bi translated">不</h1><p id="5e27" class="pw-post-body-paragraph kc kd in ke b kf lr jo kh ki ls jr kk kl lt kn ko kp lu kr ks kt lv kv kw kx ig bi translated">老实说，第一部分很容易理解，由于我不太熟悉React源代码，在尝试了容器元素中所有可用的属性之后，我决定采用惰性解决方案。</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div class="gh gi mh"><img src="../Images/6131873f1c57fd9d69713a0a2df126f0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/0*i24td8ZKIBTabobH.gif"/></div></figure><p id="3bfd" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">好了，我们知道可以通过<code class="fe lw lx ly lz b">getState()</code>函数获得Redux状态，所以我们要做的就是在React容器变量中进行树搜索。简单。</p><p id="54f2" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">谢天谢地，<a class="ae ky" href="https://gist.github.com/mindplay-dk/1843c267fc633688059dfa5e3b07d0dd" rel="noopener ugc nofollow" target="_blank">对于这个</a>已经有了一个GitHub要点，所以我们所要做的就是使它适应我们的情况，所以我们研究一个特定的变量，而不是在<code class="fe lw lx ly lz b">window</code>。</p><figure class="ma mb mc md gt me"><div class="bz fp l di"><div class="mf mg l"/></div></figure><p id="ada8" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">完成，现在我们可以用<code class="fe lw lx ly lz b">[...stores].map((store) =&gt; store.getState())</code>访问状态。</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="ml mm di mn bf mo"><div class="gh gi mk"><img src="../Images/c2f1173bdbd8f4e4cda52133fd0c9a70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Vv-8agO8j_KE_Qn4.png"/></div></div></figure><p id="42eb" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">您可以复制并粘贴以下完整脚本:</p><figure class="ma mb mc md gt me"><div class="bz fp l di"><div class="mf mg l"/></div></figure><p id="e05a" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">下一场见！</p></div><div class="ab cl mp mq hr mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ig ih ii ij ik"><p id="d7fd" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="mw">最初发布于</em><a class="ae ky" href="https://pablo.gg/en/blog/coding/how-to-get-the-redux-state-from-a-react-18-production-build-via-the-browsers-console/" rel="noopener ugc nofollow" target="_blank"><em class="mw">https://pablo . gg</em></a><em class="mw">。</em></p></div><div class="ab cl mp mq hr mr" role="separator"><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu mv"/><span class="ms bw bk mt mu"/></div><div class="ig ih ii ij ik"><p id="6594" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="mw">更多内容看</em> <a class="ae ky" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io"> <em class="mw">说白了。报名参加我们的</em> <a class="ae ky" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io"> <em class="mw">免费周报</em> </strong> </a> <em class="mw">。关注我们关于</em> <a class="ae ky" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io"> <em class="mw">推特</em> </strong> </a>，<a class="ae ky" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="ke io"><em class="mw">LinkedIn</em></strong></a><em class="mw">，</em><a class="ae ky" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"><strong class="ke io"><em class="mw">YouTube</em></strong></a><em class="mw">，以及</em> <a class="ae ky" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io"> <em class="mw">不和</em> </strong> </a> <em class="mw">。</em></strong></a></p></div></div>    
</body>
</html>