<html>
<head>
<title>Can (a==1 &amp;&amp; a==2 &amp;&amp; a==3) ever evaluate to true in JavaScript?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在JavaScript中(a==1 &amp;&amp; a==2 &amp;&amp; a==3)能计算为真吗？</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/9-ways-to-make-a-1-a-2-a-3-true-in-javascript-c2e1903b24b?source=collection_archive---------0-----------------------#2022-04-04">https://javascript.plainenglish.io/9-ways-to-make-a-1-a-2-a-3-true-in-javascript-c2e1903b24b?source=collection_archive---------0-----------------------#2022-04-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="059d" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">是的，这可能是真的，而且有9种方式——太神奇了！</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/6a6ca37a120d06c6d4db04c05bfb20f3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VTJ4EPjThhasxcWgVaT6HQ.png"/></div></div></figure><h1 id="b80a" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">前言</h1><p id="5226" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">最近有人问了我一个很有意思的面试问题:在JavaScript中(a== 1 &amp;&amp; a ==2 &amp;&amp; a==3)有没有可能求值为true？。</p><p id="b0fe" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">那一刻，我被问题惊呆了，以为面试官在开玩笑。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mk"><img src="../Images/9f9e22571cc3b6339dbd1662a6d749ca.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*WuLsazVSlBYjiZpR.png"/></div></div></figure><p id="aaf0" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">但当我看到他的“微笑”时，一种“你一定不知道答案”的感觉划过我的脑海。这绝对不是一个容易解决的问题。</p><p id="b0cb" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">文章会给<strong class="ll ir">三个神奇答案</strong>和<strong class="ll ir">五个专业答案</strong>。让我们马上开始。</p></div><div class="ab cl ml mm hu mn" role="separator"><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq mr"/><span class="mo bw bk mp mq"/></div><div class="ij ik il im in"><h1 id="1c25" class="kr ks iq bd kt ku ms kw kx ky mt la lb jw mu jx ld jz mv ka lf kc mw kd lh li bi translated">隐藏的角色很有趣</h1><p id="bf1c" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">首先，我们先来看看一些神奇的答案，不管面试官问这个问题背后的目的是什么，他们渴望具体考察哪些知识。</p><h1 id="405f" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">解决方案1:隐藏字符+ if</h1><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="21b7" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated"><strong class="ll ir">眼见为实</strong>🙈</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mz"><img src="../Images/a575fb45afcf2e946fa423731e83041e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*Fdpgj_LhLBPO2QRg.png"/></div></div></figure><p id="a178" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">可能这个时候，你也在大大的怀疑自己的眼睛:<strong class="ll ir">如果</strong>也可以改写？<strong class="ll ir"> a </strong>是9但可以等于1，2，3？</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi na"><img src="../Images/f4d186f6ee133bbf21b50b050b321c16.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/0*hODpiJolUp0nETsB.png"/></div></figure><p id="7005" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">别担心，这其实是掩饰。这只是一个蒙蔽我们双眼的把戏，请看下图。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nb"><img src="../Images/c7f8d9af9f32f8da3e683db4fb2ef848.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*h2qCBA8aBQu4oo5D.png"/></div></div></figure><p id="396e" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">真相大白:<strong class="ll ir">if后面有一个隐藏字符，本质上声明了一个无论输入什么都返回true的函数。以下代码块与此函数无关。反正是要执行的！</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="7f7b" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated"><strong class="ll ir">太神奇了！</strong></p><h1 id="8dde" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">解决方案2:隐藏字符+变量</h1><p id="79e6" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">有了以上的经验，接下来的回答你就不会惊讶了。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nd"><img src="../Images/e4afbebaa4ace08e670ffe272a250d93.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*c5ITi5Xo0aZmcbpP.png"/></div></div></figure><h1 id="aee1" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">解决方案3:隐藏字符+数字变量</h1><p id="72de" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">既然可以伪造三个<code class="fe ne nf ng nh b">a</code>变量，那么也可以伪造三个<code class="fe ne nf ng nh b">1</code>、<code class="fe ne nf ng nh b">2</code>、<code class="fe ne nf ng nh b">3</code>数字变量。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="bdbe" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated"><strong class="ll ir">眼见为实！</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ni"><img src="../Images/71a56b916f4eff245c04ca9903e8b7fa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*JTjGckfg_PHkGUEH.png"/></div></div></figure><h1 id="8068" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">解决方案4:使用“with”运算符</h1><p id="6fa5" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">以上答案本质上都没有让<code class="fe ne nf ng nh b">a == 1 &amp;&amp; a == 2 &amp;&amp; a == 3</code>回归<code class="fe ne nf ng nh b">true</code>，这只是一个障眼法。让我们微笑吧！哈哈哈下次我要认真了。</p><p id="7d7f" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated"><a class="ae nj" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/with" rel="noopener ugc nofollow" target="_blank"> MDN </a>有一个关于<code class="fe ne nf ng nh b">with</code>使用的警告，仿佛它的存在就是一个错误。我在工作中没有用过，但是可以用来解决这个问题。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nk"><img src="../Images/74034b11add9674b7e5afd2f6c241e50.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*PsNAGkBrJRjiKGTG.png"/></div></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure><p id="85ef" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">你太聪明了，甚至不需要我解释代码的意思。</p><h1 id="e41e" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">隐式转换规则是解决问题的关键</h1><p id="9a3c" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">上面给出的四种解法有些不规则。为了说服面试官，下一个才是最完美的答案，JavaScript中隐含的转换规则也是解决这个问题的关键。</p><h1 id="9630" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">解释部分隐式转换规则</h1><p id="46a6" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">当在JavaScript中使用<code class="fe ne nf ng nh b">==</code>比较两个值时，执行以下操作:</p><ol class=""><li id="3910" class="nl nm iq ll b lm mf lp mg ls nn lw no ma np me nq nr ns nt bi translated">将两个比较值转换为同一类型。</li><li id="53b6" class="nl nm iq ll b lm nu lp nv ls nw lw nx ma ny me nq nr ns nt bi translated">转换后(等式的一侧或两侧可能被转换)，比较这些值。</li></ol><p id="aec1" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">下表显示了比较规则</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nz"><img src="../Images/0c273b44eaa2ba0b7e7e219d8f5ac224.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*pRLPrWYp2JlIK_TF.png"/></div></div></figure><p id="130c" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">从表中可以获得一些信息。为了使(<code class="fe ne nf ng nh b">a == 1</code>)，a只能是这几种情况。</p><ol class=""><li id="44fa" class="nl nm iq ll b lm mf lp mg ls nn lw no ma np me nq nr ns nt bi translated"><code class="fe ne nf ng nh b">a</code>的类型是字符串，可以转换成数字1 ( <code class="fe ne nf ng nh b">'1' == 1 =&gt; true</code>)。</li><li id="b5ea" class="nl nm iq ll b lm nu lp nv ls nw lw nx ma ny me nq nr ns nt bi translated"><code class="fe ne nf ng nh b">a</code>的类型为布尔型，可以转换为数字1 ( <code class="fe ne nf ng nh b">true == 1 =&gt; true</code>)。</li><li id="9772" class="nl nm iq ll b lm nu lp nv ls nw lw nx ma ny me nq nr ns nt bi translated"><code class="fe ne nf ng nh b">a</code>的类型是Object，可以通过“转换机制”转换成数字1。</li></ol><h1 id="22c2" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">对象到原始类型的“转换机制”</h1><p id="1b8b" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">规则1和规则2没有什么特别之处。让我们来看看3:</p><p id="4221" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated">当对象转换为原始类型时，将调用内置的[top primitive]函数。逻辑大致如下:</p><ol class=""><li id="5670" class="nl nm iq ll b lm mf lp mg ls nn lw no ma np me nq nr ns nt bi translated">如果有<code class="fe ne nf ng nh b">Symbol.toPrimitive</code>方法，先调用它，否则2。</li><li id="e021" class="nl nm iq ll b lm nu lp nv ls nw lw nx ma ny me nq nr ns nt bi translated">调用<code class="fe ne nf ng nh b">valueOf</code>，如果可以转换成原来的类型，返回，否则</li><li id="1762" class="nl nm iq ll b lm nu lp nv ls nw lw nx ma ny me nq nr ns nt bi translated">调用<code class="fe ne nf ng nh b">toString</code>，如果能转换成原来的类型，返回，否则，4。</li><li id="6529" class="nl nm iq ll b lm nu lp nv ls nw lw nx ma ny me nq nr ns nt bi translated">如果没有返回原始类型，将会报告一个错误。</li></ol><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure><h1 id="c7b5" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">解决方案5: Symbol.toPrimitive</h1><p id="a633" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">我们可以用隐式转换规则3来完成问题(看完答案你就知道为什么了！).</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure><h1 id="a146" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">解决方案6: valueOf vs toString</h1><p id="c56e" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">当然，你也可以使用<strong class="ll ir"> valueOf </strong>和<strong class="ll ir"> toString。</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure><h1 id="df8d" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">解决方案7:数组和连接</h1><p id="b882" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">数组对象的隐式转换也符合规则3，但是“join”方法会在“toString”之前调用。所以你可以从这里开始。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure><h1 id="2223" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">数据劫持也是一种出路</h1><p id="79af" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">通过隐式转换，我们做了3个让<code class="fe ne nf ng nh b">a == 1 &amp;&amp; a == 2 &amp;&amp; a == 3</code>返回真的答案，你一定想到了另一个答案，<code class="fe ne nf ng nh b">data hijacking</code>，伟大的Vue我们用它赢得了百万开发者的心，我们也尝试用它来解决这个面试问题。</p><h1 id="e5b6" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">解决方案8: Object.defineProperty</h1><p id="afb8" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">通过劫持“窗口”对象，每次读取“a”属性时，a都会加1。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure><h1 id="c974" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">解决方案9:代理</h1><p id="a75a" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">还有一种劫持数据的方式，Vue3也已经把<code class="fe ne nf ng nh b">Object.defineProperty</code>换成了<code class="fe ne nf ng nh b">Proxy</code>。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx my l"/></div></figure><h1 id="3bfe" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">最后</h1><p id="b670" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">希望这是一次美妙的旅行，并给你带来快乐，<strong class="ll ir">感谢阅读。</strong></p><p id="7ca6" class="pw-post-body-paragraph lj lk iq ll b lm mf jr lo lp mg ju lr ls mh lu lv lw mi ly lz ma mj mc md me ij bi translated"><em class="nc">更多内容看</em> <a class="ae nj" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ll ir"> <em class="nc">说白了就是</em> </strong> </a> <em class="nc">。报名参加我们的</em> <a class="ae nj" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ll ir"> <em class="nc">免费周报</em> </strong> </a> <em class="nc">。关注我们关于</em><a class="ae nj" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="ll ir"><em class="nc">Twitter</em></strong></a><em class="nc">和</em><a class="ae nj" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="ll ir"><em class="nc">LinkedIn</em></strong></a><em class="nc">。加入我们的</em> <a class="ae nj" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="ll ir"> <em class="nc">社区</em> </strong> </a> <em class="nc">。</em></p></div></div>    
</body>
</html>