<html>
<head>
<title>How to Create Custom Pipes in Angular</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Angular中创建自定义管道</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-create-custom-pipes-in-angular-15e49dea125f?source=collection_archive---------7-----------------------#2022-08-10">https://javascript.plainenglish.io/how-to-create-custom-pipes-in-angular-15e49dea125f?source=collection_archive---------7-----------------------#2022-08-10</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="7a28" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">如何在Angular中实现自定义管道的指南。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/9efb8381605bccedf77db90468fb2745.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CIip2w55jDqtGYyf"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@er1end?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Erlend Ekseth</a> on <a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="d24d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在本系列的第1部分中，我们介绍了管道的基本概念，并讨论了一些内置管道。在这一部分中，我们将更进一步，看看如何实现定制管道。</p><p id="bf04" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们将通过创建一个用例来学习定制管道。</p><p id="6255" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io"> <em class="lp">用例——假设我们需要显示基于开始和结束索引的字符串的修剪数据。如何使用管道实现同样的功能？</em> </strong></p><p id="4b8f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io"> <em class="lp">第一步:</em> </strong>用angular-cli创建一个管道。</p><pre class="kd ke kf kg gt lq lr ls lt aw lu bi"><span id="2068" class="lv lw in lr b gy lx ly l lz ma">ng g p stringSubstr</span></pre><p id="5c1b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">该命令将在我们的Angular应用程序中创建一个默认管道。让我们看看默认的代码结构:</p><pre class="kd ke kf kg gt lq lr ls lt aw lu bi"><span id="c1b8" class="lv lw in lr b gy lx ly l lz ma">import { Pipe, PipeTransform } from '@angular/core';</span><span id="2413" class="lv lw in lr b gy mb ly l lz ma">@Pipe({                            </span><span id="0970" class="lv lw in lr b gy mb ly l lz ma">name: 'stringSubstr'                 // Line 1</span><span id="3642" class="lv lw in lr b gy mb ly l lz ma">})</span><span id="2716" class="lv lw in lr b gy mb ly l lz ma">export class StringSubstrPipe implements PipeTransform {  // Line 2</span><span id="2af6" class="lv lw in lr b gy mb ly l lz ma">transform(value: unknown, ...args: unknown[]): unknown {  // Line 3</span><span id="344f" class="lv lw in lr b gy mb ly l lz ma">return null;                                              // Line 4</span><span id="7cf5" class="lv lw in lr b gy mb ly l lz ma">}</span><span id="f4c0" class="lv lw in lr b gy mb ly l lz ma">}</span></pre><p id="00cf" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">让我们来分析一下这个片段:</p><ol class=""><li id="1c58" class="mc md in kv b kw kx kz la lc me lg mf lk mg lo mh mi mj mk bi translated">管道装饰器，即@Pipe有一个名为<strong class="kv io"><em class="lp">“name”</em></strong>的属性，它引用了管道名，然后在HTML文件中使用该管道名。(第一行)</li><li id="90cf" class="mc md in kv b kw ml kz mm lc mn lg mo lk mp lo mh mi mj mk bi translated"><strong class="kv io"><em class="lp">“Pipe transform”</em></strong>是需要自定义管道实现的接口。(第二行)</li><li id="6c63" class="mc md in kv b kw ml kz mm lc mn lg mo lk mp lo mh mi mj mk bi translated">在第3行，我们实现了PipeTransform接口的"<strong class="kv io"><em class="lp"/></strong>方法。<br/>此转换方法包含两个参数，第一个是需要转换的值，即在HTML中应用管道的值，第二个是rest参数，包含传递到管道中的所有参数。(如果您不确定rest参数是如何工作的，请查看这篇<a class="ae ks" href="https://medium.com/javascript-in-plain-english/javascript-rest-parameter-simplified-2054d7c49238" rel="noopener">文章</a>。)</li><li id="c1c2" class="mc md in kv b kw ml kz mm lc mn lg mo lk mp lo mh mi mj mk bi translated">最后，确保在转换后返回值(第4行),否则您将得不到想要的结果。</li></ol><p id="c11f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">因此，这是创建定制管道需要遵循的4个步骤。现在，让我们在上面提到的用例中使用它们。</p><p id="1ddc" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们将讨论两种场景:</p><ol class=""><li id="a6be" class="mc md in kv b kw kx kz la lc me lg mf lk mg lo mh mi mj mk bi translated"><strong class="kv io"> <em class="lp">单参数— </em> </strong>修剪从给定索引到字符串末尾的数据。</li></ol><p id="06cc" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们已经准备好了烟斗。现在，让我们开始同样的工作。</p><p id="ec85" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">下面，我们在需要修剪的字符串上添加了管道，并在其中一个参数中作为3传递。</p><pre class="kd ke kf kg gt lq lr ls lt aw lu bi"><span id="80af" class="lv lw in lr b gy lx ly l lz ma">&lt;div&gt;</span><span id="741e" class="lv lw in lr b gy mb ly l lz ma">{{pipeExample | stringSubstr : 3}} // pipeExample is defined in ts with value = 'Javascript is too good';</span><span id="af30" class="lv lw in lr b gy mb ly l lz ma">&lt;/div&gt;</span></pre><p id="e881" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">让我们分析一下在应用了一些日志程序之后，我们的转换方法中存在什么值。</p><pre class="kd ke kf kg gt lq lr ls lt aw lu bi"><span id="b9c4" class="lv lw in lr b gy lx ly l lz ma">export class StringSubstrPipe implements PipeTransform {</span><span id="784d" class="lv lw in lr b gy mb ly l lz ma">transform(value: string, ...args: number[]): unknown {</span><span id="c6eb" class="lv lw in lr b gy mb ly l lz ma">console.log('Value is ', value);  </span><span id="3bcf" class="lv lw in lr b gy mb ly l lz ma">console.log('Arguments is ', args);</span><span id="91e8" class="lv lw in lr b gy mb ly l lz ma">console.log('First Argument is ', args[0]);</span><span id="69ad" class="lv lw in lr b gy mb ly l lz ma">return value;</span><span id="4b10" class="lv lw in lr b gy mb ly l lz ma">}</span><span id="148d" class="lv lw in lr b gy mb ly l lz ma">}</span></pre><p id="8e60" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">因此，上述记录器的输出是:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mq"><img src="../Images/b4fb49997127005c32e77c484d65ef94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ylX6vG0QwCuEAZB7CPPRbg.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Logger_Snapshot</figcaption></figure><p id="0439" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如您所见，value是我们想要转换的值(通过它添加自定义管道), args是我们传递给管道的参数的完整列表。<br/>参数可以按照它们在HTML中传递的顺序用索引来访问。</p><p id="53af" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">一旦你理解了上面的部分，剩下的就很简单了，就是普通的JavaScript。</p><p id="a3c6" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在让我们看看完整的实现:</p><pre class="kd ke kf kg gt lq lr ls lt aw lu bi"><span id="9771" class="lv lw in lr b gy lx ly l lz ma">export class StringSubstrPipe implements PipeTransform {</span><span id="73a1" class="lv lw in lr b gy mb ly l lz ma">transform(value: string, ...args: number[]): string {</span><span id="b87d" class="lv lw in lr b gy mb ly l lz ma">let initialIndex = args[0];</span><span id="0560" class="lv lw in lr b gy mb ly l lz ma">let subStr = value.substring(initialIndex);</span><span id="badc" class="lv lw in lr b gy mb ly l lz ma">return subStr;</span><span id="3040" class="lv lw in lr b gy mb ly l lz ma">}</span><span id="c0de" class="lv lw in lr b gy mb ly l lz ma">}</span></pre><p id="d710" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在初始索引中，我们获取传递的第一个参数，并在下一步中使用JavaScript substring方法对数据进行切片。</p><p id="82bf" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">最后返回计算后的数据，这将在HTML中可见。</p><p id="8aa5" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这是第一个场景，现在切换到第二个场景。</p><p id="08c5" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">2.<strong class="kv io"> <em class="lp">多参数— </em> </strong>从给定的起始索引到给定的结束索引修剪数据。</p><p id="3567" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">更改HTML以传入两个参数。</p><pre class="kd ke kf kg gt lq lr ls lt aw lu bi"><span id="98d7" class="lv lw in lr b gy lx ly l lz ma">&lt;div&gt;</span><span id="730b" class="lv lw in lr b gy mb ly l lz ma">{{pipeExample | stringSubstr : 3 : 9}}</span><span id="1f1e" class="lv lw in lr b gy mb ly l lz ma">&lt;/div&gt;</span></pre><p id="1de5" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">因此，在这里我们将第一个参数作为3传递，将第二个参数作为9传递。</p><p id="4f24" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在，我们将在自定义管道中访问相同的内容:</p><pre class="kd ke kf kg gt lq lr ls lt aw lu bi"><span id="66eb" class="lv lw in lr b gy lx ly l lz ma">export class StringSubstrPipe implements PipeTransform {</span><span id="ee2f" class="lv lw in lr b gy mb ly l lz ma">transform(value: string, ...args: number[]): string {</span><span id="babc" class="lv lw in lr b gy mb ly l lz ma">let initialIndex = args[0];</span><span id="4333" class="lv lw in lr b gy mb ly l lz ma">let secondIndex = args[1];</span><span id="189f" class="lv lw in lr b gy mb ly l lz ma">let subStr = value.substring(initialIndex, secondIndex);</span><span id="5b98" class="lv lw in lr b gy mb ly l lz ma">return subStr;</span><span id="5ed4" class="lv lw in lr b gy mb ly l lz ma">}</span><span id="222b" class="lv lw in lr b gy mb ly l lz ma">}</span></pre><p id="a64c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">与第一种方法类似，我们提取单独变量中的参数，并使用JavaScript substring方法进行转换，最后返回值。</p><p id="1fc2" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如预期的那样，输出是:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/de3be7a5ab4fa288642e5d051440fdfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1070/format:webp/1*xydp_8Csr2FHyySYJ9_MMA.png"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Multiple Argument</figcaption></figure><p id="d673" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">所以，简单地说，这就是你如何实现一个定制管道。希望你能在这里获得一些基本的理解。如果您有任何进一步的疑问或需要更多的澄清，请告诉我。</p></div><div class="ab cl ms mt hr mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ig ih ii ij ik"><p id="e2ee" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">关于我——我是一个编程爱好者，喜欢阅读和写作前端设计、JavaScript和UI/UX相关的东西。点击<a class="ae ks" href="https://medium.com/@avinash.dev21987" rel="noopener">这里</a>阅读我所有的文章，并让我知道你的反馈。</p></div><div class="ab cl ms mt hr mu" role="separator"><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx my"/><span class="mv bw bk mw mx"/></div><div class="ig ih ii ij ik"><p id="9baa" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="lp">更多内容看</em> <a class="ae ks" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="lp">说白了就是io </em> </strong> </a> <em class="lp">。报名参加我们的</em> <a class="ae ks" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="lp">免费周报</em> </strong> </a> <em class="lp">。关注我们关于</em> <a class="ae ks" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="lp">推特</em> </strong> </a>，<a class="ae ks" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="lp">领英</em> </strong> </a> <em class="lp">，以及</em> <a class="ae ks" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="lp">不和</em> </strong> </a> <em class="lp">。</em></p></div></div>    
</body>
</html>