<html>
<head>
<title>How to Ruin Client-Side Form Validation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何破坏客户端表单验证</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-ruin-client-side-form-validation-f9d7a619006?source=collection_archive---------0-----------------------#2022-08-21">https://javascript.plainenglish.io/how-to-ruin-client-side-form-validation-f9d7a619006?source=collection_archive---------0-----------------------#2022-08-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="5135" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">以及如何避免？</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/386c6a853ffbb1eceebffa87129e7da2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Zsvm31OqQNA9-nnsiTUNSQ.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">credit card Photo by <a class="ae kv" href="https://unsplash.com/@rupixen?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">rupixen.com</a> on <a class="ae kv" href="https://unsplash.com/s/photos/online-shopping?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="a852" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在向服务器提交表单之前，默认的浏览器行为是检查所有必需的字段是否都存在并且格式正确。这称为客户端表单验证。然而，无意中禁用这种有用的浏览器行为是非常容易的。</p><h1 id="4bfb" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">对用户体验的影响</h1><p id="2de6" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">首先，我们这里说的是一个用户体验问题，而不是安全问题。表单提交后，必须在服务器端进行验证。这确保了只有正确的数据才能进入数据库。因此，虽然客户端表单验证不应该涉及应用程序的安全性，但它对于良好的用户体验是很重要的。您希望为用户提供关于输入数据是否“可以提交”的即时反馈。如果没有客户端验证，用户必须等待服务器返回响应，并在等待后调整数据。</p><h1 id="d090" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">浏览器会检查什么</h1><p id="abab" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">虽然您可以在JavaScript中构建额外的检查，但以下是浏览器将自动执行的内置检查:</p><h2 id="7c7c" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated">输入类型检查</h2><p id="947b" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">每当您给输入字段一个类型时，浏览器将检查用户输入是否与表单提交上的类型匹配。更具体地说，当您提交一个表单并且您的输入不匹配时，浏览器会通知您，并且表单不会提交，直到您修复它。</p><pre class="kg kh ki kj gt nb nc nd bn ne nf bi"><span id="df0c" class="ng lt iq nc b be nh ni l nj nk">&lt;input type="email"&gt;</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nl"><img src="../Images/eae5575874dba6539b9ccc4f63c13ebf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0rlUjomJaMwhAPRViItBRg.png"/></div></div></figure><h2 id="5cb0" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated">检查必填字段是否存在</h2><p id="1d31" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">每当输入字段有一个必需的属性时，就会检查它是否存在。</p><pre class="kg kh ki kj gt nb nc nd bn ne nf bi"><span id="9de4" class="ng lt iq nc b be nh ni l nj nk">&lt;input type="text" required&gt;</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nm"><img src="../Images/8f7891a32811e5e71bfa1e5198a2fc6e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1164/format:webp/1*9tZzBI9S9b2ELHRlwTvPfQ.png"/></div></figure><p id="1825" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于客户端的<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Learn/Forms/Form_validation" rel="noopener ugc nofollow" target="_blank">输入验证</a>，您可以使用更多的内置特性。</p><p id="2a03" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">既然我们已经概括了浏览器强大的验证功能，让我们看看这是如何被意外破坏的，以及如何减轻这种破坏。</p><h1 id="bbdb" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">用表单属性破坏表单验证</h1><p id="551f" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">从HTML5开始，你可以在表单外使用按钮来提交表单。要做到这一点，您必须为按钮提供带有表单id值的表单属性。</p><pre class="kg kh ki kj gt nb nc nd bn ne nf bi"><span id="e067" class="ng lt iq nc b be nh ni l nj nk">&lt;form id="login-form"&gt;<br/>    &lt;input type="text" name="street" required&gt;<br/>&lt;/form&gt;<br/>  <br/>&lt;button form='login-form'&gt;Submit form&lt;/button&gt;</span></pre><p id="c79b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这将提交表单，即使按钮在表单之外。虽然这是可能的，但它跳过了浏览器的本地输入检查功能。</p><h1 id="1e10" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">用JS提交函数破坏表单验证</h1><p id="9889" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">如果表单是通过JS submit函数提交的，那么所有的输入检查都会被跳过。</p><pre class="kg kh ki kj gt nb nc nd bn ne nf bi"><span id="452f" class="ng lt iq nc b be nh ni l nj nk">form.submit();</span></pre><h1 id="859b" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">如何缓解</h1><ol class=""><li id="b87c" class="nn no iq ky b kz mk lc ml lf np lj nq ln nr lr ns nt nu nv bi translated">非JS方法:使用标准表单标记</li></ol><p id="34bc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">将按钮保留在表单中，并通过用户直接单击提交表单，表单将被自动验证。</p><pre class="kg kh ki kj gt nb nc nd bn ne nf bi"><span id="b926" class="ng lt iq nc b be nh ni l nj nk">&lt;form id="login-form"&gt;<br/>    &lt;input type="text" name="street" required&gt;<br/>    &lt;button&gt;Submit form&lt;/button&gt;<br/>&lt;/form&gt;</span></pre><p id="27c9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">2.JS方法:使用HTMLFormElement.reportValidity()</p><p id="8931" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以通过调用表单上的方法<code class="fe nw nx ny nc b">reportValidity</code>来使用内置的浏览器验证。在验证输入之后，使用JavaScript <code class="fe nw nx ny nc b">submit</code>方法。</p><pre class="kg kh ki kj gt nb nc nd bn ne nf bi"><span id="3e46" class="ng lt iq nc b be nh ni l nj nk">btn.addEventListener("click", () =&gt; {<br/>    const isValid = form.reportValidity();<br/>    if(isValid){          <br/>        form.submit();<br/>    } <br/>})</span></pre><p id="2c50" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">截至发布之日，此方法在除IE之外的所有浏览器中都可用。</p><p id="08af" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">还有一种类似的方法:<code class="fe nw nx ny nc b">requestSubmit</code>。但是Safari还不支持(当然还有IE)。使用<code class="fe nw nx ny nc b">requestSubmit</code>方法，您可以立即请求提交表单，验证将在提交之前进行。这就像单击提交按钮(在表单内部)时发生的默认行为一样。</p><pre class="kg kh ki kj gt nb nc nd bn ne nf bi"><span id="6cd1" class="ng lt iq nc b be nh ni l nj nk">btn.addEventListener("click", () =&gt; form.requestSubmit());</span></pre><p id="1ea1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">您可以在这里检查实现状态<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLFormElement/requestSubmit" rel="noopener ugc nofollow" target="_blank">，但是现在，在JS表单提交方面，您应该坚持使用<code class="fe nw nx ny nc b">reportValidity</code>和<code class="fe nw nx ny nc b">submit</code>方法。</a></p><h1 id="e751" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">摘要</h1><p id="7d97" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">您可以通过在提交表单之前在客户端验证输入来改善用户体验。要小心，因为浏览器的默认验证行为很容易被破坏。</p><p id="567f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">避免在表单之外使用按钮，但是如果你这样做，只有在调用表单上的<code class="fe nw nx ny nc b">reportValidity</code>之后才使用JavaScript提交表单。</p></div><div class="ab cl nz oa hu ob" role="separator"><span class="oc bw bk od oe of"/><span class="oc bw bk od oe of"/><span class="oc bw bk od oe"/></div><div class="ij ik il im in"><p id="efc2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢您的阅读！我希望你能从这篇文章中学到一些东西。请在评论中告诉我你的想法。</p><h2 id="171e" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated">来源和其他资源</h2><p id="eb37" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">了解有关客户端表单验证的更多信息</p><p id="a63f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Learn/Forms/Form_validation" rel="noopener ugc nofollow" target="_blank">https://developer . Mozilla . org/en-US/docs/Learn/Forms/Form _ validation</a></p><p id="6e86" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">关于reportValidity的更多详细信息</p><p id="a4c1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLFormElement/reportValidity" rel="noopener ugc nofollow" target="_blank">https://developer . Mozilla . org/en-US/docs/Web/API/HTMLFormElement/report validity</a></p><p id="ab1b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">更多关于<code class="fe nw nx ny nc b">requestSubmit</code>的细节。</p><div class="og oh gp gr oi oj"><a href="https://developer.mozilla.org/en-US/docs/Web/API/HTMLFormElement/requestSubmit" rel="noopener  ugc nofollow" target="_blank"><div class="ok ab fo"><div class="ol ab om cl cj on"><h2 class="bd ir gy z fp oo fr fs op fu fw ip bi translated">htmlformelement . request submit()-Web API | MDN</h2><div class="oq l"><h3 class="bd b gy z fp oo fr fs op fu fw dk translated">在下面的例子中，通过尝试使用requestSubmit()发送请求来提交表单，如果它可用的话…</h3></div><div class="or l"><p class="bd b dl z fp oo fr fs op fu fw dk translated">developer.mozilla.org</p></div></div><div class="os l"><div class="ot l ou ov ow os ox kp oj"/></div></div></a></div><p id="4793" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所有HTML输入类型<a class="ae kv" href="https://www.w3schools.com/html/html_form_input_types.asp" rel="noopener ugc nofollow" target="_blank">https://www.w3schools.com/html/html_form_input_types.asp</a></p></div><div class="ab cl nz oa hu ob" role="separator"><span class="oc bw bk od oe of"/><span class="oc bw bk od oe of"/><span class="oc bw bk od oe"/></div><div class="ij ik il im in"><p id="2b27" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="oy">更多内容请看</em><a class="ae kv" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="oy">plain English . io</em></strong></a><em class="oy">。报名参加我们的</em> <a class="ae kv" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="oy">免费周报</em> </strong> </a> <em class="oy">。关注我们关于</em><a class="ae kv" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="oy">Twitter</em></strong></a><a class="ae kv" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="oy">LinkedIn</em></strong></a><em class="oy"/><a class="ae kv" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="oy">YouTube</em></strong></a><em class="oy"/><a class="ae kv" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="oy">不和</em> </strong> </a> <em class="oy">。</em></p></div></div>    
</body>
</html>