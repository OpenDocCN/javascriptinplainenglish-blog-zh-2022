<html>
<head>
<title>Higher Order Components in React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React中的高阶组件</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/higher-order-components-in-react-aa39c0ffe675?source=collection_archive---------3-----------------------#2022-10-19">https://javascript.plainenglish.io/higher-order-components-in-react-aa39c0ffe675?source=collection_archive---------3-----------------------#2022-10-19</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="7601" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">React中有哪些高阶组件，以及如何创建和使用高阶组件。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/aaeda7e9f01fdfbfc83e68192df9f5aa.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zyPw_RDLvGQbthTtKzrpCQ.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Image by Author</figcaption></figure><blockquote class="ks kt ku"><p id="d8c8" class="kv kw kx ky b kz la jo lb lc ld jr le lf lg lh li lj lk ll lm ln lo lp lq lr ig bi translated">在这篇博客中，我将从功能组件而不是基于类的组件的角度来讨论高阶组件。</p></blockquote></div><div class="ab cl ls lt hr lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ig ih ii ij ik"><h1 id="2ae3" class="lz ma in bd mb mc md me mf mg mh mi mj jt mk ju ml jw mm jx mn jz mo ka mp mq bi translated">什么是高阶元件？</h1><p id="fcc4" class="pw-post-body-paragraph kv kw in ky b kz mr jo lb lc ms jr le mt mu lh li mv mw ll lm mx my lp lq lr ig bi translated">高阶组件(HOC)不是React中使用的库或npm模块。相反，它只是React中使用的一种高级技术，用于重用组件逻辑，以避免重复。</p><p id="049e" class="pw-post-body-paragraph kv kw in ky b kz la jo lb lc ld jr le mt lg lh li mv lk ll lm mx lo lp lq lr ig bi translated">高阶组件将功能组件作为参数，并返回增强组件。</p><p id="f902" class="pw-post-body-paragraph kv kw in ky b kz la jo lb lc ld jr le mt lg lh li mv lk ll lm mx lo lp lq lr ig bi translated">特设是这样的:</p><pre class="kd ke kf kg gt mz na nb nc aw nd bi"><span id="ba53" class="ne ma in na b gy nf ng l nh ni">const HigherOrderComponent = (WrappedComponent) =&gt; function HOC() {<br/>  return (<br/>    &lt;section&gt;<br/>      &lt;h1&gt;This is a Higher Order Component&lt;/h1&gt;<br/>      &lt;div&gt;<br/>        &lt;h2&gt;<br/>          The code part below will be dynamic as it depends on the 'Wrapped<br/>          Component'<br/>        &lt;/h2&gt;<br/>        &lt;WrappedComponent /&gt;<br/>      &lt;/div&gt;<br/>    &lt;/section&gt;<br/>  );<br/>};</span><span id="79ba" class="ne ma in na b gy nj ng l nh ni">export default HigherOrderComponent;</span></pre><p id="c6e3" class="pw-post-body-paragraph kv kw in ky b kz la jo lb lc ld jr le mt lg lh li mv lk ll lm mx lo lp lq lr ig bi translated">在上面的代码片段中，我们有以下内容:</p><ul class=""><li id="5334" class="nk nl in ky b kz la lc ld mt nm mv nn mx no lr np nq nr ns bi translated">函数“HigherOrderComponet”接受一个名为“WrappedComponent”的参数，它将是一个功能组件。</li><li id="403a" class="nk nl in ky b kz nt lc nu mt nv mv nw mx nx lr np nq nr ns bi translated">这个“HigherOrderComponet”函数立即返回一个名为“HOC”的函数(可以是任何名称，也可以是一个箭头函数)，它是一个功能组件，即它返回JSX代码。</li><li id="7011" class="nk nl in ky b kz nt lc nu mt nv mv nw mx nx lr np nq nr ns bi translated">如您所见，我们从“HOC”功能组件返回JSX，该组件利用了我们期望作为参数的“WrappedComponent”。</li><li id="eb43" class="nk nl in ky b kz nt lc nu mt nv mv nw mx nx lr np nq nr ns bi translated">我们在导出其他组件时使用这个高阶组件。</li></ul><p id="0191" class="pw-post-body-paragraph kv kw in ky b kz la jo lb lc ld jr le mt lg lh li mv lk ll lm mx lo lp lq lr ig bi translated">假设我们有另一个名为“Products”的组件，为了将高阶组件与“Products”组件一起使用，我们可以在导出时将“Products”组件包装在“Higher Order Component”函数中。</p><pre class="kd ke kf kg gt mz na nb nc aw nd bi"><span id="638b" class="ne ma in na b gy nf ng l nh ni">import HigherOrderComponent from "./HigherOrderComponent";</span><span id="f975" class="ne ma in na b gy nj ng l nh ni">const Products = () =&gt; {<br/>  return (<br/>    &lt;div&gt;<br/>      &lt;h3&gt;Products&lt;/h3&gt;<br/>      &lt;ul&gt;<br/>        &lt;li&gt;Product 1 &lt;/li&gt;<br/>        &lt;li&gt;Product 2 &lt;/li&gt;<br/>      &lt;/ul&gt;<br/>    &lt;/div&gt;<br/>  );<br/>};</span><span id="dfd9" class="ne ma in na b gy nj ng l nh ni">export default HigherOrderComponent(Products);</span></pre><p id="52e6" class="pw-post-body-paragraph kv kw in ky b kz la jo lb lc ld jr le mt lg lh li mv lk ll lm mx lo lp lq lr ig bi translated">在上面的代码片段中，“HigherOrderComponent”使用产品组件来提供一个新的增强组件。</p><p id="d495" class="pw-post-body-paragraph kv kw in ky b kz la jo lb lc ld jr le mt lg lh li mv lk ll lm mx lo lp lq lr ig bi translated">在用HigherOrderComponent函数包装了产品组件之后，产品组件看起来将如下所示:</p><pre class="kd ke kf kg gt mz na nb nc aw nd bi"><span id="995b" class="ne ma in na b gy nf ng l nh ni">function HOC() {<br/>  return (<br/>    &lt;section&gt;<br/>      &lt;h1&gt;This is a Higher Order Component&lt;/h1&gt;<br/>      &lt;div&gt;<br/>        &lt;h2&gt;<br/>          The code part below will be dynamic as it depends on the 'Wrapped<br/>          Component'<br/>        &lt;/h2&gt;<br/>        &lt;Products /&gt;<br/>      &lt;/div&gt;<br/>    &lt;/section&gt;<br/>  );<br/>}</span></pre><p id="f397" class="pw-post-body-paragraph kv kw in ky b kz la jo lb lc ld jr le mt lg lh li mv lk ll lm mx lo lp lq lr ig bi translated">这将是产品组件的可视化输出:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ny"><img src="../Images/39801b11bfb54b38d09ee659064136d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KIRnM0-3nIFZWmxMKdFbEw.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Image by Author</figcaption></figure><p id="8081" class="pw-post-body-paragraph kv kw in ky b kz la jo lb lc ld jr le mt lg lh li mv lk ll lm mx lo lp lq lr ig bi translated">当使用高阶组件时，<code class="fe nz oa ob na b">props</code>在组件内部无法正常工作。</p><p id="9e67" class="pw-post-body-paragraph kv kw in ky b kz la jo lb lc ld jr le mt lg lh li mv lk ll lm mx lo lp lq lr ig bi translated">让我们将一个名为<code class="fe nz oa ob na b">info</code>的<code class="fe nz oa ob na b">prop</code>添加到组件中的<code class="fe nz oa ob na b">Products</code>中，并将这个<code class="fe nz oa ob na b">info</code>的值传递到<code class="fe nz oa ob na b">App</code>组件中。</p><pre class="kd ke kf kg gt mz na nb nc aw nd bi"><span id="6670" class="ne ma in na b gy nf ng l nh ni">// Products.js<br/>import HigherOrderComponent from "./HigherOrderComponent";</span><span id="f9ab" class="ne ma in na b gy nj ng l nh ni">const Products = ({ info }) =&gt; {<br/>  return (<br/>    &lt;div&gt;<br/>      &lt;h3&gt;Products&lt;/h3&gt;<br/>      &lt;ul&gt;<br/>        &lt;li&gt;Product 1 &lt;/li&gt;<br/>        &lt;li&gt;Product 2 &lt;/li&gt;<br/>      &lt;/ul&gt;<br/>      &lt;p&gt;{info}&lt;/p&gt;<br/>    &lt;/div&gt;<br/>  );<br/>};</span><span id="3340" class="ne ma in na b gy nj ng l nh ni">export default HigherOrderComponent(Products);</span><span id="6e6d" class="ne ma in na b gy nj ng l nh ni">//_app.js<br/>export default function App() {<br/>  return (<br/>    &lt;&gt;<br/>      &lt;Products info="Some products are out of stock" /&gt;<br/>    &lt;/&gt;<br/>  );<br/>}</span></pre><p id="1cfa" class="pw-post-body-paragraph kv kw in ky b kz la jo lb lc ld jr le mt lg lh li mv lk ll lm mx lo lp lq lr ig bi translated">这是上面代码的输出:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ny"><img src="../Images/39801b11bfb54b38d09ee659064136d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KIRnM0-3nIFZWmxMKdFbEw.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Image by Author</figcaption></figure><ul class=""><li id="a426" class="nk nl in ky b kz la lc ld mt nm mv nn mx no lr np nq nr ns bi translated"><code class="fe nz oa ob na b">prop</code> <code class="fe nz oa ob na b">info</code>的值没有显示在网页上，尽管我们正确地传递和接收了那个<code class="fe nz oa ob na b">prop</code>的值。</li><li id="969b" class="nk nl in ky b kz nt lc nu mt nv mv nw mx nx lr np nq nr ns bi translated">发生这种情况是因为当<code class="fe nz oa ob na b">HigherOrderComponent</code>正在<strong class="ky io">消费</strong>组件<code class="fe nz oa ob na b">Products</code>并且我们没有在<code class="fe nz oa ob na b">HigherOrderComponent</code>中指定我们正在期待<code class="fe nz oa ob na b">WrappedComponent</code>的一些道具，所以<code class="fe nz oa ob na b">props</code>没有在<code class="fe nz oa ob na b">HOC</code>组件函数中被利用。</li><li id="4306" class="nk nl in ky b kz nt lc nu mt nv mv nw mx nx lr np nq nr ns bi translated">为了确保道具正常工作，我们可以对HigherOrderComponent做一个小小的编辑:</li></ul><pre class="kd ke kf kg gt mz na nb nc aw nd bi"><span id="f09d" class="ne ma in na b gy nf ng l nh ni">const HigherOrderComponent = (WrappedComponent) =&gt; function HOC(props) {<br/>  return (<br/>    &lt;section&gt;<br/>      &lt;h1&gt;This is a Higher Order Component&lt;/h1&gt;<br/>      &lt;div&gt;<br/>        &lt;h2&gt;<br/>          The code part below will be dynamic as it depends on the 'Wrapped<br/>          Component'<br/>        &lt;/h2&gt;<br/>        &lt;WrappedComponent {...props} /&gt;<br/>      &lt;/div&gt;<br/>    &lt;/section&gt;<br/>  );<br/>};</span><span id="2cf3" class="ne ma in na b gy nj ng l nh ni">export default HigherOrderComponent;</span></pre><p id="1099" class="pw-post-body-paragraph kv kw in ky b kz la jo lb lc ld jr le mt lg lh li mv lk ll lm mx lo lp lq lr ig bi translated">现在，我们在我们的HOC功能组件中接受props，并使用spread操作符获取所有的<code class="fe nz oa ob na b">props</code>值，并将其传递给WrappedComponent。因此，现在在导出产品组件时，它将看起来像这样:</p><pre class="kd ke kf kg gt mz na nb nc aw nd bi"><span id="292d" class="ne ma in na b gy nf ng l nh ni">function HOC(props) {<br/>  return (<br/>    &lt;section&gt;<br/>      &lt;h1&gt;This is a Higher Order Component&lt;/h1&gt;<br/>      &lt;div&gt;<br/>        &lt;h2&gt;<br/>          The code part below will be dynamic as it depends on the 'Wrapped<br/>          Component'<br/>        &lt;/h2&gt;<br/>        &lt;Products info="Some products are out of stock" /&gt;<br/>      &lt;/div&gt;<br/>    &lt;/section&gt;<br/>  );<br/>}</span></pre><p id="c9e7" class="pw-post-body-paragraph kv kw in ky b kz la jo lb lc ld jr le mt lg lh li mv lk ll lm mx lo lp lq lr ig bi translated">这里，<code class="fe nz oa ob na b">info</code> <code class="fe nz oa ob na b">prop</code> get是从HOC功能组件的props参数中析构的。这样做之后，我们的输出将是这样的:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oc"><img src="../Images/a613cd23a62f96f9172e396235938dc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gzWHcQwVspE68sLHeoIX6w.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Image by author</figcaption></figure></div><div class="ab cl ls lt hr lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ig ih ii ij ik"><p id="d0e5" class="pw-post-body-paragraph kv kw in ky b kz la jo lb lc ld jr le mt lg lh li mv lk ll lm mx lo lp lq lr ig bi translated"><em class="kx">更多内容看</em> <a class="ae od" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky io"> <em class="kx">说白了。报名参加我们的</em> <a class="ae od" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky io"> <em class="kx">免费周报</em> </strong> </a> <em class="kx">。关注我们关于</em> <a class="ae od" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"> <strong class="ky io"> <em class="kx">推特</em> </strong> </a>，<a class="ae od" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="ky io"><em class="kx">LinkedIn</em></strong></a><em class="kx">，</em><a class="ae od" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"><strong class="ky io"><em class="kx">YouTube</em></strong></a><em class="kx">，以及</em> <a class="ae od" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="ky io"> <em class="kx">不和</em> </strong> </a> <em class="kx">。对增长黑客感兴趣？检查</em> <a class="ae od" href="https://circuit.ooo/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky io"> <em class="kx">电路</em> </strong> </a> <em class="kx">。</em></strong></a></p></div></div>    
</body>
</html>