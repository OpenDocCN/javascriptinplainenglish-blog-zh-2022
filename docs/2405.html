<html>
<head>
<title>Make a Rich Text Editor with JavaScript in 5 Minutes</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用JavaScript在5分钟内制作一个富文本编辑器</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/make-a-rich-text-editor-with-javascript-in-5-minutes-ee8025694e76?source=collection_archive---------1-----------------------#2022-06-06">https://javascript.plainenglish.io/make-a-rich-text-editor-with-javascript-in-5-minutes-ee8025694e76?source=collection_archive---------1-----------------------#2022-06-06</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><div class=""><h2 id="2d16" class="pw-subtitle-paragraph jo iq ir bd b jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dk translated">用100行代码制作富文本编辑器</h2></div><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj kg"><img src="../Images/476c55eaa31150725b12e32eca902f2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Z0q31anO-cdM5lJ6d7AzNA.png"/></div></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">This is what we are going to do!</figcaption></figure><p id="1190" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">我一直认为做富文本编辑器是火箭科学的事情😆。首先，我想到的是从一个不可见的<code class="fe ls lt lu lv b">textarea</code>获取一个文本，并将输入的文本附加到输入后面的HTML中。当你选择某样东西时，用标签包装选择，或者用正则表达式替换它。但是一切都好办多了！</p><p id="e891" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">所有的神奇都是因为添加了一个属性<code class="fe ls lt lu lv b">contenteditable=”true”</code>而发生的。您可以将它添加到任何元素中，这样该元素及其子元素就可以通过浏览器进行编辑。</p><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj lw"><img src="../Images/4126c02f01d22a2b227bc6e320af54e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*aRLCitdmm_Kecu1zF5U0Dg.gif"/></div></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">Editable content in browser with contenteditable=” true”</figcaption></figure><p id="aa21" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">如您所见，我们可以修改现有的元素。同样，当我们点击enter时，我们添加一个块元素<code class="fe ls lt lu lv b">div</code>作为新的一行。但是，我们如何改变选定的文本，使一些词，例如，粗体或斜体？</p><h2 id="2c08" class="lx ly ir bd lz ma mb dn mc md me dp mf lf mg mh mi lj mj mk ml ln mm mn mo mp bi translated">如何实现富文本编辑器</h2><p id="fae2" class="pw-post-body-paragraph kw kx ir ky b kz mq js lb lc mr jv le lf ms lh li lj mt ll lm ln mu lp lq lr ik bi translated">最简单的方法就是用<code class="fe ls lt lu lv b">document.execCommand()</code>。</p><p id="0ede" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated"><em class="mv">这里我不得不说一下</em> <code class="fe ls lt lu lv b"><em class="mv">document.execCommand</em></code> <em class="mv">是弃用的。一些浏览器不能标准化它，在文档中你会看到这个特性已经过时了。虽然它在某些浏览器中仍然可以工作，但是不鼓励使用它，因为它可以随时被删除。</em></p><p id="a26f" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">但是已经被弃用很多年了。<strong class="ky is">尽管如此，它没有替代品</strong>，许多开发者<strong class="ky is">仍然在所见即所得编辑器中使用</strong>它。</p><p id="aefe" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">有了这个函数，要让选中的文字加粗，我们需要调用<code class="fe ls lt lu lv b">document.execCommand('bold', false);</code>函数，就这样。</p><p id="a855" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">所以我们的任务是创建一个带按钮的工具栏。然后当用户按下它们中的任何一个时，调用一行代码。</p><p id="2c67" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">现在，让我们创建一个富文本编辑器，作为带有一些格式按钮的定制组件。我喜欢Lit库，目前，它是我们演示的一个好选择。</p><p id="7932" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">我已经写了一些关于这个图书馆的文章。如果您还没有机会了解这个制作web组件的最有性能的库之一，下面是它们:</p><div class="mw mx gq gs my mz"><a rel="noopener  ugc nofollow" target="_blank" href="/5-reasons-why-you-should-try-litelement-in-your-next-project-b75f143fbb78"><div class="na ab fp"><div class="nb ab nc cl cj nd"><h2 class="bd is gz z fq ne fs ft nf fv fx iq bi translated">你应该在下一个项目中尝试LitElement的5个理由</h2><div class="ng l"><h3 class="bd b gz z fq ne fs ft nf fv fx dk translated">可能是构建web组件的最佳库</h3></div><div class="nh l"><p class="bd b dl z fq ne fs ft nf fv fx dk translated">javascript.plainenglish.io</p></div></div><div class="ni l"><div class="nj l nk nl nm ni nn kq mz"/></div></div></a></div><div class="mw mx gq gs my mz"><a rel="noopener  ugc nofollow" target="_blank" href="/state-management-for-complex-web-components-cb4e370bfd6e"><div class="na ab fp"><div class="nb ab nc cl cj nd"><h2 class="bd is gz z fq ne fs ft nf fv fx iq bi translated">复杂Web组件的状态管理</h2><div class="ng l"><h3 class="bd b gz z fq ne fs ft nf fv fx dk translated">如何在LitElement组件中使用Redux</h3></div><div class="nh l"><p class="bd b dl z fq ne fs ft nf fv fx dk translated">javascript.plainenglish.io</p></div></div><div class="ni l"><div class="no l nk nl nm ni nn kq mz"/></div></div></a></div><h2 id="df71" class="lx ly ir bd lz ma mb dn mc md me dp mf lf mg mh mi lj mj mk ml ln mm mn mo mp bi translated">用Lit库构建富文本web组件</h2><p id="e195" class="pw-post-body-paragraph kw kx ir ky b kz mq js lb lc mr jv le lf ms lh li lj mt ll lm ln mu lp lq lr ik bi translated">这只是一个教程，所以我们将下载<a class="ae np" href="https://github.com/lit/lit-element-starter-ts" rel="noopener ugc nofollow" target="_blank"> Lit组件初学者工具包</a>以节省开发服务器配置的时间。解压缩文件夹并安装依赖项<code class="fe ls lt lu lv b">npm i</code>。</p><p id="910c" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">此外，我们需要安装一个额外的包，用于简单地在按钮中显示材质图标。</p><pre class="kh ki kj kk gu nq lv nr ns aw nt bi"><span id="966d" class="lx ly ir lv b gz nu nv l nw nx">npm i @material/mwc-icon-button</span></pre><p id="f614" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">我们已经有了<code class="fe ls lt lu lv b">src/my-element.ts</code>。我甚至没有改变班级的名字。我只是导入了图标组件，添加了一些样式，在渲染函数中，我添加了一个工具栏和标签，我们将在其中编辑文本。</p><p id="9724" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">为了渲染工具栏，我创建了一个包含材质图标名称和它们应该调用的命令的数组。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="ny nz l"/></div></figure><p id="521e" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">现在我们只需要修改图标导入和一些CSS样式的演示index.html。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="ny nz l"/></div></figure><p id="cd96" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">可以在<a class="ae np" href="https://tinyurl.com/4dyckkhe" rel="noopener ugc nofollow" target="_blank"> <strong class="ky is">点亮的游乐场</strong> </a>上玩组件。</p><h2 id="757d" class="lx ly ir bd lz ma mb dn mc md me dp mf lf mg mh mi lj mj mk ml ln mm mn mo mp bi translated">替代方法</h2><p id="5792" class="pw-post-body-paragraph kw kx ir ky b kz mq js lb lc mr jv le lf ms lh li lj mt ll lm ln mu lp lq lr ik bi translated">似乎取代<code class="fe ls lt lu lv b">document.execCommand</code>的将是<a class="ae np" href="https://w3c.github.io/input-events/" rel="noopener ugc nofollow" target="_blank">输入事件级别2 </a>。但是在将来和现在，它不包含撤销/重做这样的功能。</p><p id="07ed" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">目前，还可以通过获取选择并将其包装到格式标签中来实现手动HTML修改。</p><p id="6eec" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">比如类似这样的。</p><pre class="kh ki kj kk gu nq lv nr ns aw nt bi"><span id="5581" class="lx ly ir lv b gz nu nv l nw nx">function bold() {<br/>    const boldEl = document.createElement("b");<br/>    const textSelection = window.getSelection();<br/>    userSelection.getRangeAt(0).surroundContents(strongElement);<br/>}</span></pre><p id="cf3d" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">但它将只涵盖包装功能。要撤销更改，我们需要实现一些更复杂的东西。</p><p id="6c74" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">如你所见，目前，在2022年，<code class="fe ls lt lu lv b">document.execCommand</code>功能几乎是富文本编辑器的单一和直接的选择。</p><p id="35b9" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated"><strong class="ky is">感谢阅读！</strong></p></div><div class="ab cl oa ob hv oc" role="separator"><span class="od bw bk oe of og"/><span class="od bw bk oe of og"/><span class="od bw bk oe of"/></div><div class="ik il im in io"><p id="b93f" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated">如果你喜欢我的帖子，出于某种原因，你还不是一个媒体会员，你可以支持我，并通过这个链接获得会员资格。</p><p id="745e" class="pw-post-body-paragraph kw kx ir ky b kz la js lb lc ld jv le lf lg lh li lj lk ll lm ln lo lp lq lr ik bi translated"><em class="mv">更多内容请看</em> <a class="ae np" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky is"> <em class="mv">说白了。报名参加我们的</em> <a class="ae np" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky is"> <em class="mv">免费周报</em> </strong> </a> <em class="mv">。关注我们</em><a class="ae np" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="ky is"><em class="mv">Twitter</em></strong></a><em class="mv">和</em><a class="ae np" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="ky is"><em class="mv">LinkedIn</em></strong></a><em class="mv">。查看我们的</em> <a class="ae np" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="ky is"> <em class="mv">社区不和谐</em> </strong> </a> <em class="mv">加入我们的</em> <a class="ae np" href="https://inplainenglish.pallet.com/talent/welcome" rel="noopener ugc nofollow" target="_blank"> <strong class="ky is"> <em class="mv">人才集体</em> </strong> </a> <em class="mv">。</em></strong></a></p></div></div>    
</body>
</html>