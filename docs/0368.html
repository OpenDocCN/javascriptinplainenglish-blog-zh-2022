<html>
<head>
<title>How to Transform XY Coordinates to LatLng Values with Proj4.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Proj4.js将XY坐标转换为LatLng值</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/transforming-xy-coordinates-to-latlng-values-with-proj4-js-d91a6139ba90?source=collection_archive---------13-----------------------#2022-01-21">https://javascript.plainenglish.io/transforming-xy-coordinates-to-latlng-values-with-proj4-js-d91a6139ba90?source=collection_archive---------13-----------------------#2022-01-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="fffb" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">包括XY到LatLng转换器工具的代码实现</h2></div><p id="ec26" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当涉及到处理地理空间数据集时，每个Geo开发人员应该做的主要检查之一是了解Geo坐标是在哪个<a class="ae lb" href="https://datacarpentry.org/organization-geospatial/03-crs/" rel="noopener ugc nofollow" target="_blank">坐标参考系统(CRS) </a>中呈现的。</p><h2 id="a4e1" class="lc ld iq bd le lf lg dn lh li lj dp lk ko ll lm ln ks lo lp lq kw lr ls lt lu bi translated">CRS的简要背景</h2><p id="413b" class="pw-post-body-paragraph kf kg iq kh b ki lv jr kk kl lw ju kn ko lx kq kr ks ly ku kv kw lz ky kz la ij bi translated">由于地球具有球形模型而非平坦表面，因此根据XY坐标位于地球的哪个部分，将应用不同的空间投影和数学计算来转换显示在2D地图上的值:</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi ma"><img src="../Images/6b8ec63374eae409888a9ff6afba0f94.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GaIUFZ0RuKBEy1Y5PHU2RA.png"/></div></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk">Illustration by Author | At different parts of the Earth’s spherical model, XY values at Americas, Europe and Asia-Australia would be rendered in unique CRS</figcaption></figure><p id="7cba" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">虽然在线实用程序如<a class="ae lb" href="https://epsg.io/transform" rel="noopener ugc nofollow" target="_blank"> EPSG.io </a>可用于一次性转换，但在现实世界的用例中，更多情况下不需要<strong class="kh ir">批处理</strong>。<em class="mq">此外，在</em> <strong class="kh ir"> <em class="mq">处理机密数据集</em> </strong> <em class="mq">的情况下，离线处理它们总是比上传到任何公共在线平台更具战略性。</em></p><blockquote class="mr"><p id="c21c" class="ms mt iq bd mu mv mw mx my mz na la dk translated">幸运的是，JavaScript库<a class="ae lb" href="https://github.com/proj4js/proj4js" rel="noopener ugc nofollow" target="_blank"> Proj4.js </a>是专门为这个功能构建的。</p></blockquote><h2 id="ff34" class="lc ld iq bd le lf nb dn lh li nc dp lk ko nd lm ln ks ne lp lq kw nf ls lt lu bi translated">使用案例演示:新加坡</h2><p id="007d" class="pw-post-body-paragraph kf kg iq kh b ki lv jr kk kl lw ju kn ko lx kq kr ks ly ku kv kw lz ky kz la ij bi translated">例如，新加坡这个国家位于东南亚大陆。对于新加坡的任何一对XY值，它都遵循一个<a class="ae lb" href="https://epsg.io/3414" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir"> SVY 21坐标系</strong> </a>进行变换。</p><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi ng"><img src="../Images/66eebd6da4c84358af4cd935bee8f812.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*X5ThDWGlpN68rKX8VosOCQ.png"/></div></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk">Illustration by Author | The Well Known Text (WKT) representation of geometry above provides the values to define Singapore’s spatial projection in <a class="ae lb" href="https://github.com/proj4js/proj4js" rel="noopener ugc nofollow" target="_blank">Proj4.js</a></figcaption></figure><blockquote class="nh ni nj"><p id="f736" class="kf kg mq kh b ki kj jr kk kl km ju kn nk kp kq kr nl kt ku kv nm kx ky kz la ij bi translated"><strong class="kh ir"> <em class="iq">解释:</em></strong><em class="iq">XY值的数据源会正确定义其WKT。在随后的示例中，由于XY值列表是从</em> <a class="ae lb" href="https://www.sla.gov.sg/geospatial-development-and-services/onemap" rel="noopener ugc nofollow" target="_blank"> <em class="iq">新加坡土地管理局(SLA)的地图服务提供商Onemap </em> </a> <em class="iq">和SLA规定的官方2D CRS为</em><a class="ae lb" href="http://50.57.85.98/crs_4757/SVY21.html" rel="noopener ugc nofollow" target="_blank"><em class="iq">svy 21</em></a><em class="iq">中检索的，因此在</em><a class="ae lb" href="https://epsg.io/" rel="noopener ugc nofollow" target="_blank"><em class="iq">epsg . io</em></a><em class="iq">中搜索将呈现其投影系统的WKT文档(包括在上图中)。</em></p></blockquote><p id="51f4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">因此，这转化为<a class="ae lb" href="https://github.com/proj4js/proj4js" rel="noopener ugc nofollow" target="_blank"> Proj4.js </a>中的以下实现:</p><pre class="mb mc md me gt nn no np bn nq nr bi"><span id="14c4" class="ns ld iq no b be nt nu l nv nw">proj4.defs('EPSG:3414': '+proj=tmerc +lat_0=1.366666666666667 +lon_0=103.8333333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +units=m +no_defs');</span></pre><ul class=""><li id="4534" class="nx ny iq kh b ki kj kl km ko nz ks oa kw ob la oc od oe of bi translated">投影["Traverse_Mercator"] <code class="fe og oh oi no b">proj=tmerc</code></li><li id="78d2" class="nx ny iq kh b ki oj kl ok ko ol ks om kw on la oc od oe of bi translated">参数["原点纬度"] <code class="fe og oh oi no b">lat_0=1.366666666666667</code></li><li id="f8ca" class="nx ny iq kh b ki oj kl ok ko ol ks om kw on la oc od oe of bi translated">参数[“中央子午线”] <code class="fe og oh oi no b">lon_0=103.8333333333333</code></li><li id="9bfe" class="nx ny iq kh b ki oj kl ok ko ol ks om kw on la oc od oe of bi translated">参数["比例因子"] <code class="fe og oh oi no b">k=1</code></li><li id="f23e" class="nx ny iq kh b ki oj kl ok ko ol ks om kw on la oc od oe of bi translated">参数["false_easting"] <code class="fe og oh oi no b">x_0=28001.64</code></li><li id="ab8b" class="nx ny iq kh b ki oj kl ok ko ol ks om kw on la oc od oe of bi translated">参数["false_northing"] <code class="fe og oh oi no b">y_0=38744.572</code></li><li id="669c" class="nx ny iq kh b ki oj kl ok ko ol ks om kw on la oc od oe of bi translated">椭球体[“WGS 84”]<code class="fe og oh oi no b">ellps=WGS84</code><strong class="kh ir">(Spherioid =椭球体)</strong></li><li id="9c71" class="nx ny iq kh b ki oj kl ok ko ol ks om kw on la oc od oe of bi translated">单位[“米”] <code class="fe og oh oi no b">units=m</code></li></ul><p id="8a73" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">以下代码片段返回包含一对<strong class="kh ir">【Lat，Lng】</strong>的数组:</p><pre class="mb mc md me gt nn no np bn nq nr bi"><span id="2e95" class="ns ld iq no b be nt nu l nv nw">var fromProj = proj4.defs('EPSG:3414');<br/>var toProf = proj4.defs('EPSG:4326');<br/>proj4(fromProj, toProf, [x, y]) // [lat, lng]</span></pre><p id="2ddc" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">为了适应不同的坐标参考系统(CRS)，定义列表已被编译在:<a class="ae lb" href="https://github.com/josueggh/proj4-list" rel="noopener ugc nofollow" target="_blank">proj 4-list</a><strong class="kh ir">(GitHub用户的鸣谢:</strong><a class="ae lb" href="https://github.com/josueggh" rel="noopener ugc nofollow" target="_blank"><strong class="kh ir">Josueggh</strong></a><strong class="kh ir">)</strong></p><h2 id="75f9" class="lc ld iq bd le lf lg dn lh li lj dp lk ko ll lm ln ks lo lp lq kw lr ls lt lu bi translated">注意:在我的GitHub: <a class="ae lb" href="https://gist.github.com/incubated-geek-cc/4a105a65ebc62321c8fb7cc9ccb98153" rel="noopener ugc nofollow" target="_blank"> proj4_list.js </a>中有一个投影<em class="oo">(不包括未定义的值和空条目)</em>的合并版本</h2><h1 id="dba9" class="op ld iq bd le oq or os lh ot ou ov lk jw ow jx ln jz ox ka lq kc oy kd lt oz bi translated">构建将XY转换为LatLng的浏览器工具</h1><h2 id="cb50" class="lc ld iq bd le lf lg dn lh li lj dp lk ko ll lm ln ks lo lp lq kw lr ls lt lu bi translated">导入以下JavaScript插件</h2><pre class="mb mc md me gt nn no np bn nq nr bi"><span id="f7d7" class="ns ld iq no b be nt nu l nv nw">&lt;script src='proj4.js'&gt;&lt;/script&gt;&lt;!-- proj4 plugin --&gt;<br/>&lt;script src='proj4_list.js'&gt;&lt;/script&gt;&lt;!-- object of crs list --&gt;<br/>&lt;script src='json2csv.js'&gt;&lt;/script&gt;&lt;!-- plugin for data export--&gt;</span></pre><p id="826e" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">假设输入数据格式是CSV文件，则在HTML页面上呈现一个简单的用户界面，供用户上传包含两个单独列中的XY值的数据文件，以输出附加了两个附加列的CSV文件，这两个附加列是由<a class="ae lb" href="https://github.com/proj4js/proj4js" rel="noopener ugc nofollow" target="_blank"> Proj4.js </a>计算的<strong class="kh ir">“纬度”</strong>和<strong class="kh ir">“经度”</strong></p><figure class="mb mc md me gt mf gh gi paragraph-image"><div role="button" tabindex="0" class="mg mh di mi bf mj"><div class="gh gi pa"><img src="../Images/5d518a47fb3076ca0217f8478de73243.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Gcp47w_425x1DXcvJG24wQ.png"/></div></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk">Illustration by Author | A sample output by the tool which appends columns — [LATITUDE] &amp; [LONGITUDE] to the input csv data</figcaption></figure><h2 id="cba0" class="lc ld iq bd le lf lg dn lh li lj dp lk ko ll lm ln ks lo lp lq kw lr ls lt lu bi translated">综上所述，XY to LatLng浏览器工具的最终版本如下:</h2><figure class="mb mc md me gt mf gh gi paragraph-image"><div class="gh gi pb"><img src="../Images/af3c2fc3b08d7d2eb44560fa9ee897ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/1*WgJzNmVZr8H6CtRC4xN6zA.gif"/></div><figcaption class="mm mn gj gh gi mo mp bd b be z dk">Screencapture by Author | List of crs options are rendered in a dropdown list. EPSG of coordinates is 3414 (note that the dropdown list is sorted)</figcaption></figure><h2 id="3ad6" class="lc ld iq bd le lf lg dn lh li lj dp lk ko ll lm ln ks lo lp lq kw lr ls lt lu bi translated">注意:要运行该工具，只需双击HTML文件并在任何支持JavaScript的浏览器中显示它。(不需要设置服务器)</h2><h2 id="3ea2" class="lc ld iq bd le lf lg dn lh li lj dp lk ko ll lm ln ks lo lp lq kw lr ls lt lu bi translated">要获得完整的源代码，请随意从我的GitHub获取回购协议，网址:<a class="ae lb" href="https://github.com/incubated-geek-cc/xy-to-latlng-convertor" rel="noopener ugc nofollow" target="_blank">xy-to-lat LNG-converter</a>或在这里试用<a class="ae lb" href="https://incubated-geek-cc.github.io/xy-to-latlng-convertor/" rel="noopener ugc nofollow" target="_blank"/>！</h2></div><div class="ab cl pc pd hu pe" role="separator"><span class="pf bw bk pg ph pi"/><span class="pf bw bk pg ph pi"/><span class="pf bw bk pg ph"/></div><div class="ij ik il im in"><p id="2da5" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">现在你知道了！非常感谢你坚持到这篇文章的结尾！❤希望你觉得这个指南很有用，如果你想了解更多GIS、数据分析&amp; Web应用相关的内容，请随时<a class="ae lb" href="https://medium.com/@geek-cc" rel="noopener">关注我的Medium </a>。会非常感激—😀</p><div class="pj pk gp gr pl pm"><a href="https://geek-cc.medium.com/membership" rel="noopener follow" target="_blank"><div class="pn ab fo"><div class="po ab pp cl cj pq"><h2 class="bd ir gy z fp pr fr fs ps fu fw ip bi translated">通过我的推荐链接加入灵媒——李思欣·崔</h2><div class="pt l"><h3 class="bd b gy z fp pr fr fs ps fu fw dk translated">获得李思欣·崔和其他作家在媒体上的所有帖子！😃您的会员费直接…</h3></div><div class="pu l"><p class="bd b dl z fp pr fr fs ps fu fw dk translated">geek-cc.medium.com</p></div></div><div class="pv l"><div class="pw l px py pz pv qa mk pm"/></div></div></a></div><p id="9aa4" class="pw-post-body-paragraph kf kg iq kh b ki kj jr kk kl km ju kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="mq">更多内容请看</em><a class="ae lb" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kh ir"><em class="mq">plain English . io</em></strong></a><em class="mq">。报名参加我们的</em> <a class="ae lb" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir"> <em class="mq">免费周报</em> </strong> </a> <em class="mq">。在我们的</em> <a class="ae lb" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kh ir"> <em class="mq">社区</em> </strong> </a> <em class="mq">获得独家获得写作机会和建议。</em></p></div></div>    
</body>
</html>