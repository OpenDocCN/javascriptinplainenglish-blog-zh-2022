<html>
<head>
<title>Build an Alert Messenger in React Using Context and TypeScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用上下文和类型脚本在React中构建警报信使</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/build-an-alert-messenger-in-react-using-context-and-typescript-6a7c56b707d7?source=collection_archive---------2-----------------------#2022-05-06">https://javascript.plainenglish.io/build-an-alert-messenger-in-react-using-context-and-typescript-6a7c56b707d7?source=collection_archive---------2-----------------------#2022-05-06</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="3378" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">为React应用程序创建警报系统的分步指南。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/d687af1ddf7eac4b2bc34a82c5fe0205.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uptAPaLK2ld75cBOQS8G8A.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk"><a class="ae kv" href="https://marvel.fandom.com/" rel="noopener ugc nofollow" target="_blank">https://marvel.fandom.com/</a></figcaption></figure><p id="e10d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一个好的前端应用需要一个更好的通知系统。您应该根据应用程序的要求和用户的pov创建并向用户显示警报。通常，您可以在每页上实现一条toast消息。在某些情况下，您可能希望在同一页面上同时显示多条消息。很有可能。警报的性质也可能因通知的类型而异。拥有良好的警报机制有助于改善UX(用户体验)。</p><p id="fa06" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本文中，我将一步一步地为您的React应用程序创建一个可靠的警报系统。我们将使用高级的React.js概念，比如上下文、redux模式、状态管理等等。</p><h2 id="21dc" class="ls lt iq bd lu lv lw dn lx ly lz dp ma lf mb mc md lj me mf mg ln mh mi mj mk bi translated">先决条件:</h2><ol class=""><li id="2a6c" class="ml mm iq ky b kz mn lc mo lf mp lj mq ln mr lr ms mt mu mv bi translated">React项目(React 17+)</li><li id="cb0a" class="ml mm iq ky b kz mw lc mx lf my lj mz ln na lr ms mt mu mv bi translated">良好的反应知识</li><li id="2e2c" class="ml mm iq ky b kz mw lc mx lf my lj mz ln na lr ms mt mu mv bi translated">打字稿的基础知识</li></ol><p id="441f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在本文中，我将使用TypeScript编写代码。如果你喜欢简单的JS，你可以去掉打字。</p><h1 id="3af7" class="nc lt iq bd lu nd ne nf lx ng nh ni ma jw nj jx md jz nk ka mg kc nl kd mj nm bi translated">目录</h1><ol class=""><li id="b143" class="ml mm iq ky b kz mn lc mo lf mp lj mq ln mr lr ms mt mu mv bi translated">包括必要的依赖性</li><li id="728f" class="ml mm iq ky b kz mw lc mx lf my lj mz ln na lr ms mt mu mv bi translated">设置基本提供商</li><li id="2b6d" class="ml mm iq ky b kz mw lc mx lf my lj mz ln na lr ms mt mu mv bi translated">包括基础应用程序模板</li><li id="3111" class="ml mm iq ky b kz mw lc mx lf my lj mz ln na lr ms mt mu mv bi translated">创建警报和警报包装组件</li><li id="eb03" class="ml mm iq ky b kz mw lc mx lf my lj mz ln na lr ms mt mu mv bi translated">包括状态缩减器</li><li id="2a1f" class="ml mm iq ky b kz mw lc mx lf my lj mz ln na lr ms mt mu mv bi translated">添加和删除警报的逻辑的收尾工作</li><li id="1b2f" class="ml mm iq ky b kz mw lc mx lf my lj mz ln na lr ms mt mu mv bi translated">结论</li><li id="c25a" class="ml mm iq ky b kz mw lc mx lf my lj mz ln na lr ms mt mu mv bi translated">奖励:拦截网络错误</li></ol><h1 id="bf11" class="nc lt iq bd lu nd ne nf lx ng nh ni ma jw nj jx md jz nk ka mg kc nl kd mj nm bi translated">1.包括必要的依赖性</h1><p id="9278" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf nn lh li lj no ll lm ln np lp lq lr ij bi translated">React包括创建一个<strong class="ky ir">应用程序</strong>所需的一切。另一方面，在React中与<strong class="ky ir"> CSS </strong>合作有点困难。任何CSS库，比如<strong class="ky ir">类名</strong>，都可以使用。也可以使用<strong class="ky ir">类装载机</strong>，如<a class="ae kv" href="https://webpack.js.org/loaders/sass-loader/" rel="noopener ugc nofollow" target="_blank"> sass-loader </a>。我将在本文中使用<a class="ae kv" href="https://styled-components.com/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir">样式化组件</strong> </a> <strong class="ky ir"> </strong>。React中处理CSS最好的库之一是样式组件。</p><pre class="kg kh ki kj gt nq nr ns nt aw nu bi"><span id="38c7" class="ls lt iq nr b gy nv nw l nx ny">yarn add styled-components @types/styled-components</span></pre><h1 id="3658" class="nc lt iq bd lu nd ne nf lx ng nh ni ma jw nj jx md jz nk ka mg kc nl kd mj nm bi translated">2.设置基本提供商</h1><p id="4c00" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf nn lh li lj no ll lm ln np lp lq lr ij bi translated">在<strong class="ky ir">样式组件</strong>中，我们将使用基本主题。我们必须将我们的应用程序包装在主题提供者T21中来使用主题变量。让我们更改<strong class="ky ir"> index.tsx </strong>并将基础应用程序包装在<strong class="ky ir"> ThemeProvider </strong>中。</p><pre class="kg kh ki kj gt nq nr nz bn oa ob bi"><span id="a519" class="oc lt iq nr b be od oe l of ny">// index.tsx<br/>import { StrictMode } from "react";<br/>import ReactDOMClient from "react-dom/client";<br/>import { createGlobalStyle, ThemeProvider } from "styled-components";<br/>import App from "./App";<br/>import { AlertContextProvider } from "./components/Alert/AlertContextProvider";<br/>const Global = createGlobalStyle`<br/>  p,<br/>  h1,<br/>  h2,<br/>  h3,<br/>  h4,<br/>  h5,<br/>  h6 {<br/>    padding: 0;<br/>    margin: 0%;<br/>  }<br/>`;<br/>const rootElement = document.getElementById("root");<br/>const root = ReactDOMClient.createRoot(rootElement as HTMLElement);<br/>const theme = {<br/>  colors: {<br/>    message_error: "#fdeded",<br/>    message_success: "#edf7ed",<br/>  },<br/>};<br/>root.render(<br/>  &lt;StrictMode&gt;<br/>    &lt;ThemeProvider theme={theme}&gt;<br/>      &lt;AlertContextProvider&gt;<br/>        &lt;Global /&gt;<br/>        &lt;App /&gt;<br/>      &lt;/AlertContextProvider&gt;<br/>    &lt;/ThemeProvider&gt;<br/>  &lt;/StrictMode&gt;<br/>);</span></pre><p id="8953" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">上面的代码很简单。然而，如你所见，我们将<strong class="ky ir">应用</strong>包含在<strong class="ky ir"> AlertContextProvider </strong>中。这个AlertContextProvider将处理Alter消息及其逻辑。让我们从配置<strong class="ky ir"> AlertContextProvider </strong>开始。</p><pre class="kg kh ki kj gt nq nr nz bn oa ob bi"><span id="7964" class="oc lt iq nr b be od oe l of ny">// src/components/Alert/AlertContextProvider.tsx<br/>import { createContext, FC, ReactNode } from "react";<br/>interface AlertContext {}<br/>export const AlertMessengerContext = createContext&lt;AlertContext&gt;({} as AlertContext);<br/>export const AlertContextProvider: FC&lt;{<br/>  children: ReactNode;<br/>  noOfMessages?: number;<br/>  autoHideTimeout?: number;<br/>  autoHideError?: boolean;<br/>}&gt; = ({ children, noOfMessages = 5, autoHideTimeout = 3000, autoHideError = false }) =&gt; {<br/>  return(<br/>    &lt;AlertMessengerContext.Provider value={{}}&gt;<br/>      {children}<br/>    &lt;/AlertMessengerContext.Provider&gt;<br/>  );<br/>};</span></pre><h1 id="baa3" class="nc lt iq bd lu nd ne nf lx ng nh ni ma jw nj jx md jz nk ka mg kc nl kd mj nm bi translated">3.包括基础应用程序模板</h1><p id="22cc" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf nn lh li lj no ll lm ln np lp lq lr ij bi translated">让我们添加一个基本的<strong class="ky ir">模板</strong>到<strong class="ky ir"> App.tsx </strong>来测试应用程序。</p><pre class="kg kh ki kj gt nq nr nz bn oa ob bi"><span id="f37b" class="oc lt iq nr b be od oe l of ny">// src/App.tsx<br/>import { AppContainer, Button } from "./components/Alert/styled.components";<br/>function App() {<br/>  const onSuccess = () =&gt; {};<br/>const onError = () =&gt; {};<br/>return (<br/>    &lt;AppContainer&gt;<br/>      &lt;Button onClick={onSuccess} variant="success"&gt;<br/>        Alert Success<br/>      &lt;/Button&gt;<br/>      &lt;Button onClick={onError} variant="error"&gt;<br/>        Alert Error<br/>      &lt;/Button&gt;<br/>    &lt;/AppContainer&gt;<br/>  );<br/>}<br/>export default App;</span></pre><p id="f714" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在前面的代码中，我们从<strong class="ky ir"> styled.components. </strong>中导入了<strong class="ky ir"> AppContainer </strong>和<strong class="ky ir">按钮</strong></p><pre class="kg kh ki kj gt nq nr nz bn oa ob bi"><span id="2036" class="oc lt iq nr b be od oe l of ny">// src/components/Alert/styled.components.tsx<br/>import styled from "styled-components";<br/>export const AppContainer = styled.div`<br/>  display: flex;<br/>  justify-content: space-evenly;<br/>`;<br/>export const Button = styled.button&lt;{ variant: string }&gt;`<br/>  height: 48px;<br/>  width: 200px;<br/>  background-color: ${(p) =&gt; p.theme.colors[`message_${p.variant}`]};<br/>`;</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi og"><img src="../Images/39e66482a21a196cb53fa9987bad861b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*g-KT1iaBy3u4EO1_amdoHg.png"/></div></div></figure><h1 id="1202" class="nc lt iq bd lu nd ne nf lx ng nh ni ma jw nj jx md jz nk ka mg kc nl kd mj nm bi translated">4.创建警报和警报包装组件</h1><p id="214d" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf nn lh li lj no ll lm ln np lp lq lr ij bi translated">在进入逻辑显示-隐藏之前，让我们从一个简单的警报组件开始。警报组件的属性和变化会有所不同。消息可以像Alter组件中的div一样简单。但是，因为我们将有多个功能，如显示隐藏和可关闭。可以添加<strong class="ky ir">类型</strong>、<strong class="ky ir">标题</strong>、<strong class="ky ir">消息</strong>、<strong class="ky ir">动作图标</strong>和<strong class="ky ir"> onAction </strong>等属性。</p><pre class="kg kh ki kj gt nq nr nz bn oa ob bi"><span id="9eb4" class="oc lt iq nr b be od oe l of ny">//src/components/Alert/index.tsx<br/>import { MouseEvent, ReactNode } from "react";<br/>import styled from "styled-components";<br/>enum MessageType {<br/>  SUCCESS = "success",<br/>  ERROR = "error",<br/>}<br/>interface AlertProps {<br/>  type?: MessageType;<br/>  title: string;<br/>  message?: string;<br/>  gutterBottom?: boolean;<br/>  gutterTop?: boolean;<br/>  actionIcon?: ReactNode | boolean;<br/>  onAction?: (e?: MouseEvent&lt;HTMLButtonElement&gt;) =&gt; void;<br/>}<br/>const noop = (_?: MouseEvent&lt;HTMLButtonElement&gt;) =&gt; {};<br/>const AlertContainer = styled.div&lt;Partial&lt;AlertProps&gt;&gt;`<br/>  padding: 10px 20px;<br/>  background: ${(p) =&gt; p.theme.colors[`message_${p.type}`]};<br/>  margin-top: ${(p) =&gt; p.gutterTop &amp;&amp; "10px"};<br/>  margin-bottom: ${(p) =&gt; p.gutterBottom &amp;&amp; "10px"};<br/>  min-width: 300px;<br/>  height: 80px;<br/>  border-radius: 4px;<br/>  position: relative;<br/>  padding-top: 40px;<br/>`;<br/>const ActionIconContainer = styled.div`<br/>  position: absolute;<br/>  right: 10px;<br/>  top: 10px;<br/>`;<br/>const Alert = ({<br/>  type = MessageType.SUCCESS,<br/>  title,<br/>  message,<br/>  gutterBottom,<br/>  gutterTop,<br/>  actionIcon,<br/>  onAction,<br/>}: AlertProps) =&gt; {<br/>  const ActionIcon =<br/>    typeof actionIcon === "boolean" &amp;&amp; actionIcon ? &lt;button onClick={onAction ?? noop}&gt;X&lt;/button&gt; : actionIcon;<br/>  return (<br/>    &lt;AlertContainer type={type} gutterBottom={gutterBottom} gutterTop={gutterTop}&gt;<br/>      {actionIcon &amp;&amp; &lt;ActionIconContainer&gt;{ActionIcon}&lt;/ActionIconContainer&gt;}<br/>      &lt;h4&gt;{title}&lt;/h4&gt;<br/>      &lt;p&gt;{message}&lt;/p&gt;<br/>    &lt;/AlertContainer&gt;<br/>  );<br/>};<br/>export default Alert;</span></pre><p id="0c31" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在前面的示例代码中，<strong class="ky ir"> actionIcon </strong>可以接受任何react元素；否则，在<strong class="ky ir">布尔</strong>属性的基础上，会添加一个关闭按钮。<strong class="ky ir"> onAction </strong>功能可用于执行关闭按钮上的功能。<br/>我们可以向<strong class="ky ir"> AlertContextProvider </strong>添加虚拟消息来查看组件的实际可视化效果。</p><pre class="kg kh ki kj gt nq nr nz bn oa ob bi"><span id="2b37" class="oc lt iq nr b be od oe l of ny">// src/components/Alert/AlertContextProvider.tsx<br/>import { createContext, FC, ReactNode } from "react";<br/>import styled from "styled-components";<br/>import Alert from ".";<br/>interface AlertContext {}<br/>enum MessageType {<br/>  SUCCESS = "success",<br/>  ERROR = "error",<br/>}<br/>export const AlertMessengerContext = createContext&lt;AlertContext&gt;({} as AlertContext);<br/>const messages = [<br/>  {<br/>    id: Date.now(),<br/>    type: MessageType.ERROR,<br/>    title: "Error Header",<br/>    message: "Error Message",<br/>  },<br/>  {<br/>    id: Date.now(),<br/>    type: MessageType.SUCCESS,<br/>    title: "Success Header",<br/>    message: "Success Message",<br/>  },<br/>];<br/>const AlertsContainer = styled.div`<br/>  background: #fff;<br/>  position: absolute;<br/>  left: 0;<br/>  bottom: 0;<br/>  padding: 10px 20px;<br/>  overflow-y: auto;<br/>  max-height: calc(100vh - 100px);<br/>`;<br/>export const AlertContextProvider: FC&lt;{<br/>  children: ReactNode;<br/>  noOfMessages?: number;<br/>  autoHideTimeout?: number;<br/>  autoHideError?: boolean;<br/>}&gt; = ({ children, noOfMessages = 5, autoHideTimeout = 3000, autoHideError = false }) =&gt; {<br/>  return (<br/>    &lt;AlertMessengerContext.Provider value={{}}&gt;<br/>      {children}<br/>      &lt;AlertsContainer&gt;<br/>        {messages.map(({ type, title, message, id }) =&gt; (<br/>          &lt;Alert<br/>            key={`alert__message__${id}`}<br/>            type={type}<br/>            title={title}<br/>            message={message}<br/>            gutterTop<br/>            actionIcon={type === "error"}<br/>            onAction={() =&gt; null}<br/>          /&gt;<br/>        ))}<br/>      &lt;/AlertsContainer&gt;<br/>    &lt;/AlertMessengerContext.Provider&gt;<br/>  );<br/>};</span></pre><p id="b06a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">一旦您更新了<strong class="ky ir"> AlertContextProvider </strong>，您可以看到下面的界面:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oh"><img src="../Images/2002193ae9f9eb6f7d5a7a19555b7fd1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TWXWjWF3Aexm0TzudifXcQ.png"/></div></div></figure><h1 id="2af6" class="nc lt iq bd lu nd ne nf lx ng nh ni ma jw nj jx md jz nk ka mg kc nl kd mj nm bi translated">5.包括状态缩减器</h1><p id="3325" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf nn lh li lj no ll lm ln np lp lq lr ij bi translated">既然UI已经准备好了，我们可以专注于多个警报的状态。为了简化状态管理，我们可以使用任何状态管理器。在这篇博客中，我将使用<a class="ae kv" href="https://reactjs.org/docs/context.html" rel="noopener ugc nofollow" target="_blank"> React Context </a> API。</p><pre class="kg kh ki kj gt nq nr nz bn oa ob bi"><span id="8705" class="oc lt iq nr b be od oe l of ny">interface Message {<br/>  id: string;<br/>  type: MessageType;<br/>  title: string;<br/>  message?: string;<br/>}<br/>enum AlertActionKind {<br/>  ADD_SUCCESS = "ADD_SUCCESS",<br/>  ADD_ERROR = "ADD_ERROR",<br/>  REMOVE_MESSAGE = "REMOVE_MESSAGE",<br/>}<br/>interface AlertAction {<br/>  type: AlertActionKind;<br/>  payload?: any;<br/>}<br/>interface AlertState {<br/>  messages: Message[];<br/>  noOfMessages: number;<br/>}<br/>const AlertReducer = (state: AlertState, action: AlertAction) =&gt; {<br/>  switch (action.type) {<br/>    case AlertActionKind.ADD_SUCCESS:<br/>      return {<br/>        ...state,<br/>        messages: [{ type: "success", ...action.payload }, ...state.messages].slice(0, state.noOfMessages),<br/>      };<br/>    case AlertActionKind.ADD_ERROR:<br/>      return {<br/>        ...state,<br/>        messages: [{ type: "error", ...action.payload }, ...state.messages].slice(0, state.noOfMessages),<br/>      };<br/>    case AlertActionKind.REMOVE_MESSAGE:<br/>      return { ...state, messages: state.messages.filter((message) =&gt; message.id !== action.payload.id) };<br/>  }<br/>};</span></pre><p id="22a9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在上面的例子中，我们定义了两个主要动作<strong class="ky ir">添加成功</strong>、<strong class="ky ir">删除消息</strong>和<strong class="ky ir">添加错误</strong>。</p><h1 id="1be6" class="nc lt iq bd lu nd ne nf lx ng nh ni ma jw nj jx md jz nk ka mg kc nl kd mj nm bi translated">6.添加和删除警报的逻辑的收尾工作</h1><p id="00aa" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf nn lh li lj no ll lm ln np lp lq lr ij bi translated">既然我们已经完成了应用程序的所有先决条件。现在我们可以专注于添加和删除消息的逻辑。我们可以直接曝光redux <strong class="ky ir"> dispatch </strong>。然而，我们可以通过遵循<strong class="ky ir"> Kent C Dodds </strong>来自<a class="ae kv" href="https://kentcdodds.com/blog/how-to-use-react-context-effectively" rel="noopener ugc nofollow" target="_blank">how-to-use-react-context-effectively</a>的“良好实践”,在提供者内部包装一个函数。现在让我们更新<strong class="ky ir"> AlertContextProvider </strong>。</p><pre class="kg kh ki kj gt nq nr nz bn oa ob bi"><span id="9742" class="oc lt iq nr b be od oe l of ny">// src/components/Alert/AlertContextProvider.tsx<br/>export const AlertContextProvider: FC&lt;{<br/>  children: ReactNode;<br/>  noOfMessages?: number;<br/>  autoHideTimeout?: number;<br/>  autoHideError?: boolean;<br/>}&gt; = ({ children, noOfMessages = 5, autoHideTimeout = 3000, autoHideError = false }) =&gt; {<br/>  const [state, dispatch] = useReducer(AlertReducer, { messages: [], noOfMessages });<br/>const addSuccessMessage = useCallback(<br/>    (data: any) =&gt; {<br/>      const id = Date.now();<br/>      dispatch({ type: AlertActionKind.ADD_SUCCESS, payload: { id, ...data } });<br/>      setTimeout(() =&gt; {<br/>        dispatch({ type: AlertActionKind.REMOVE_MESSAGE, payload: { id } });<br/>      }, autoHideTimeout);<br/>    },<br/>    [dispatch, autoHideTimeout]<br/>  );<br/>const addErrorMessage = useCallback(<br/>    (data: any) =&gt; {<br/>      const id = Date.now();<br/>      dispatch({ type: AlertActionKind.ADD_ERROR, payload: { id, ...data } });<br/>      if (autoHideError) {<br/>        setTimeout(() =&gt; {<br/>          dispatch({ type: AlertActionKind.REMOVE_MESSAGE, payload: { id } });<br/>        }, autoHideTimeout);<br/>      }<br/>    },<br/>    [dispatch, autoHideError, autoHideTimeout]<br/>  );<br/>const removeMessage = useCallback(<br/>    (id: any) =&gt; {<br/>      dispatch({ type: AlertActionKind.REMOVE_MESSAGE, payload: { id } });<br/>    },<br/>    [dispatch]<br/>  );<br/>  return (<br/>    &lt;AlertMessengerContext.Provider value={{ state, addSuccessMessage, addErrorMessage, removeMessage }}&gt;<br/>      {children}<br/>      &lt;AlertsContainer&gt;<br/>        {state.messages.map(({ type, title, message, id }) =&gt; (<br/>          &lt;Alert<br/>            key={`alert__message__${id}`}<br/>            type={type}<br/>            title={title}<br/>            message={message}<br/>            gutterTop<br/>            actionIcon={type === "error"}<br/>            onAction={type === "error" ? () =&gt; removeMessage(id) : undefined}/&gt;<br/>        ))}<br/>      &lt;/AlertsContainer&gt;<br/>    &lt;/AlertMessengerContext.Provider&gt;<br/>  );<br/>};</span></pre><p id="e720" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> addSuccessMessage </strong>方法将消息添加到队列中，并启动一个定时器来移除它。<strong class="ky ir"> addErrorMessage </strong>方法将一个错误消息插入到队列中，并根据<strong class="ky ir"> autoHideTimeout </strong>清除它或使其保持可关闭状态。最后，在<strong class="ky ir"> App.jsx中，</strong>更新逻辑使用addSuccessMessage和addErrorMessage。</p><pre class="kg kh ki kj gt nq nr nz bn oa ob bi"><span id="26a3" class="oc lt iq nr b be od oe l of ny">function App() {<br/>  const { addSuccessMessage, addErrorMessage } = useContext(AlertMessengerContext);<br/>const onSuccess = () =&gt; {<br/>    const time = new Date().toLocaleString();<br/>    addSuccessMessage({ title: `Success: ${time}`, message: `This message generated at ${time}` });<br/>  };<br/>const onError = () =&gt; {<br/>    const time = new Date().toLocaleString();<br/>    addErrorMessage({ title: `Error: ${time}`, message: `This message generated at ${time}` });<br/>  };<br/>return (<br/>    &lt;AppContainer&gt;<br/>      &lt;Button onClick={onSuccess} variant="success"&gt;<br/>        Alert Success<br/>      &lt;/Button&gt;<br/>      &lt;Button onClick={onError} variant="error"&gt;<br/>        Alert Error<br/>      &lt;/Button&gt;<br/>    &lt;/AppContainer&gt;<br/>  );<br/>}</span></pre><p id="0ce1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">结果如下:</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oi"><img src="../Images/5940ec06c1772a914bfb2ed6fd129de0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*R45fwvOhVv2dlZmktiUmcQ.gif"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">working demo</figcaption></figure><h1 id="a999" class="nc lt iq bd lu nd ne nf lx ng nh ni ma jw nj jx md jz nk ka mg kc nl kd mj nm bi translated">7.结论</h1><p id="42e7" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf nn lh li lj no ll lm ln np lp lq lr ij bi translated">React有点啰嗦。然而，编写一个定制模块来处理应用程序通知是有意义的。它允许采用新的综合逻辑来提高应用程序的UX。我只是试图为Alert Messenger组合基本的逻辑块。根据您的需求，您可以增强和改进您的应用程序。</p><p id="bc05" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">注意:</strong>请记住，完整的源代码可以在下面的代码沙箱中找到。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="oj ok l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">react-alert-toast-message</figcaption></figure><h1 id="9b50" class="nc lt iq bd lu nd ne nf lx ng nh ni ma jw nj jx md jz nk ka mg kc nl kd mj nm bi translated">8.奖励:拦截网络错误</h1><p id="2b2b" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf nn lh li lj no ll lm ln np lp lq lr ij bi translated">很常见的情况是，您希望创建一个通用的toast messenger来显示页面中的错误。为此，您需要拦截网络响应。大多数网络库都提供发布-订阅拦截器方法。您可以使用这些方法并相应地显示错误。比如我要给Axios库写代码。这是最著名的图书馆之一。</p><p id="0728" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="nb">为了避免破坏功能，我会保留代码注释。您可以取消对代码的注释来查看实际的代码。</em></p><pre class="kg kh ki kj gt nq nr nz bn oa ob bi"><span id="7d77" class="oc lt iq nr b be od oe l of ny">// AlertContextProvider.tsx<br/><br/>export const AlertContextProvider: FC&lt;{<br/>  children: ReactNode;<br/>  noOfMessages?: number;<br/>  autoHideTimeout?: number;<br/>  autoHideError?: boolean;<br/>  // add prop to enable interceptor<br/>  interceptNetwork?: boolean;<br/>}&gt; = ({<br/>  children,<br/>  noOfMessages = 5,<br/>  autoHideTimeout = 3000,<br/>  autoHideError = false,<br/>  interceptNetwork = false // default can be null<br/>}) =&gt; <br/><br/>//add hooks to intercept network.<br/> <br/>useEffect(() =&gt; {<br/>    if (interceptNetwork) {<br/>      /* Intercept code here<br/>        axios.interceptors.response.use(<br/>        function (response: any) {<br/>          // If error 400 response show messages<br/>          if (response.status === 400) {<br/>            const time = new Date().toLocaleString();<br/>            addErrorMessage({<br/>              title: `Error: ${time}`,<br/>              message: `This message generated at ${time}`<br/>            });<br/>          }<br/>          return response;<br/>        },<br/>        function (error: Error) {<br/>          return Promise.reject(error);<br/>        }<br/>      );<br/>        */<br/>    }<br/>  }, []);</span></pre><p id="c1f1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="nb">更多内容看</em> <a class="ae kv" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="nb">说白了就是</em> </strong> </a> <em class="nb">。报名参加我们的</em> <a class="ae kv" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="nb">免费周报</em> </strong> </a> <em class="nb">。关注我们关于</em><a class="ae kv" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="nb">Twitter</em></strong></a><em class="nb">和</em><a class="ae kv" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="nb">LinkedIn</em></strong></a><em class="nb">。加入我们的</em> <a class="ae kv" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="nb">社区</em> </strong> </a> <em class="nb">。</em></p></div></div>    
</body>
</html>