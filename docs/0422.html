<html>
<head>
<title>You Don’t Have to Give a Full Object while Asserting with Jest</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Jest断言时，你不必给出完整的对象</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/you-dont-have-to-give-a-full-object-while-asserting-with-jest-18ea3ccad398?source=collection_archive---------23-----------------------#2022-01-24">https://javascript.plainenglish.io/you-dont-have-to-give-a-full-object-while-asserting-with-jest-18ea3ccad398?source=collection_archive---------23-----------------------#2022-01-24</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="2af5" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">当您只对一个值感兴趣时，为什么要给出对象的全部内容呢？</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/7a54e1129ec683713c8e3c1f3e4c8972.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hMPVgk-MDzE2jtnPKOQsnA.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Nothing to do with the article, but it looks nice! (Photo by <a class="ae kv" href="https://www.pexels.com/@umutdagli?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">Umut Dağlı</a> from <a class="ae kv" href="https://www.pexels.com/photo/grayscale-photo-of-birds-flying-over-the-sea-10567313/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">Pexels</a>)</figcaption></figure><p id="1188" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在使用了近3年之后，Jest对我来说仍然是一个谜。但是我几乎每天都会发现新的东西，这让我意识到这个工具有多强大。</p><p id="2279" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">今天，我正在写我平常的大量测试，这时我面临一个新的挑战:我必须使用函数<code class="fe ls lt lu lv b">toHaveBeenCalledWith</code>并断言一个巨大的对象。我添加的物品和子对象越多，我就越希望Jest有适合我的东西。</p><p id="4e5d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在浏览了一部分文档后，我终于找到了我的救命恩人:<code class="fe ls lt lu lv b">expect.objectContaining</code>！</p><h2 id="364c" class="lw lx iq bd ly lz ma dn mb mc md dp me lf mf mg mh lj mi mj mk ln ml mm mn mo bi translated">断言一个对象</h2><p id="39b7" class="pw-post-body-paragraph kw kx iq ky b kz mp jr lb lc mq ju le lf mr lh li lj ms ll lm ln mt lp lq lr ij bi translated">你可能对Jest中著名的<code class="fe ls lt lu lv b">expect().toBe()</code>很熟悉。有了它，你可以断言<code class="fe ls lt lu lv b">value a</code>严格等于<code class="fe ls lt lu lv b">value b</code>。<br/>但是，<code class="fe ls lt lu lv b">toBe</code>和<code class="fe ls lt lu lv b">objectContaining</code>就不行了。</p><p id="d6a9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不过不用担心，Jest有个解决方案给你:<code class="fe ls lt lu lv b">expect().toEqual()</code></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mu"><img src="../Images/1ef66e73e60cadacf941e0076984661c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IcCTQIoh4eQprCCpB7Oeog.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">This test passes!</figcaption></figure><p id="0cee" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如您所见，我刚刚编写了一个简单的测试，将一个对象与另一个对象进行比较。<br/>然而我只对<code class="fe ls lt lu lv b">a</code>的存在和价值感兴趣。<br/>这样使用<code class="fe ls lt lu lv b">objectContaining</code>，我们只是关心<code class="fe ls lt lu lv b">a</code>的值，而完全忽略了<code class="fe ls lt lu lv b">b</code>！</p><h2 id="8ada" class="lw lx iq bd ly lz ma dn mb mc md dp me lf mf mg mh lj mi mj mk ln ml mm mn mo bi translated">断言函数调用的参数</h2><p id="85b5" class="pw-post-body-paragraph kw kx iq ky b kz mp jr lb lc mq ju le lf mr lh li lj ms ll lm ln mt lp lq lr ij bi translated">一种最常见的测试方法是检查一个特定的函数是否被精确的参数调用。</p><p id="f428" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">同样，这些参数可能是大对象，或者有时是不值得嘲笑的未知值。不过谢天谢地，<code class="fe ls lt lu lv b">objectContaining</code>又在救我们的命了！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mv"><img src="../Images/c265e133a5bf42ed73a6150ac2551bd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HVBxz5EbxqR1EjPhnqzWkg.png"/></div></div></figure><p id="7106" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这段代码中，我使用<code class="fe ls lt lu lv b">jest.fn()</code>创建一个被Jest监视的假函数。</p><p id="841c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后我调用带有两个参数的函数，一个字符串和一个对象。</p><p id="ad6e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，我们使用<code class="fe ls lt lu lv b">toHaveBeenCalledWith</code>来断言用于调用函数的参数。同样，我们感兴趣的只是对象中的属性<code class="fe ls lt lu lv b">a</code>。因此，通过使用<code class="fe ls lt lu lv b">objectContaining</code>，我们可以检查<code class="fe ls lt lu lv b">a</code>的值是否符合预期！</p><p id="e2aa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="mw">更多内容请看</em><a class="ae kv" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="mw">plain English . io</em></strong></a><em class="mw">。报名参加我们的</em> <a class="ae kv" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="mw">免费周报</em> </strong> </a> <em class="mw">。在我们的</em> <a class="ae kv" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="mw">社区</em> </strong> </a> <em class="mw">获得独家获得写作机会和建议。</em></p></div></div>    
</body>
</html>