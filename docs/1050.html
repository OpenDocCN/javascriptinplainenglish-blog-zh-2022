<html>
<head>
<title>Build an Ionic App that Works Offline</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">建立一个离线工作的离子应用程序</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/build-an-ionic-app-that-works-offline-ec8907bb5b8f?source=collection_archive---------5-----------------------#2022-03-01">https://javascript.plainenglish.io/build-an-ionic-app-that-works-offline-ec8907bb5b8f?source=collection_archive---------5-----------------------#2022-03-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="58b0" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">奖励:带有在线指示器</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/3539f22fdeb5fe3d7bfb941b90e74d70.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*CkBxKzjW7tfvWKRn"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@sigmund?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Sigmund</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><blockquote class="kw kx ky"><p id="50cf" class="kz la lb lc b ld le jr lf lg lh ju li lj lk ll lm ln lo lp lq lr ls lt lu lv ij bi translated">…我想让这个应用程序脱机工作。我想让它告诉我什么时候离线，什么时候恢复在线。我想这<strong class="lc ir">应该很简单吧？<em class="iq"> — </em> </strong> <em class="iq">客户简介</em></p></blockquote><p id="89c6" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">嗯，有人可能会说这可能是一个简单的命题，你是对的，它非常简单。但是，请记住，在您开始着手解决此客户简报之前，需要一些先决条件，即:</p><ol class=""><li id="d613" class="lz ma iq lc b ld le lg lh lw mb lx mc ly md lv me mf mg mh bi translated">对离子和角度发展有一些经验和熟悉。</li><li id="d6ca" class="lz ma iq lc b ld mi lg mj lw mk lx ml ly mm lv me mf mg mh bi translated">电容器方面的一些经验。</li></ol><p id="c54b" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">否则，应该很容易弄清楚。说真的只有4步。</p><p id="0e70" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated"><strong class="lc ir">步骤0:启动一个离子项目</strong></p><p id="64de" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">如果你对Ionic不熟悉，那就熟悉它，因为这是开发移动或网络应用最简单的方法。</p><div class="mn mo gp gr mp mq"><a href="https://www.ionicframework.com" rel="noopener  ugc nofollow" target="_blank"><div class="mr ab fo"><div class="ms ab mt cl cj mu"><h2 class="bd ir gy z fp mv fr fs mw fu fw ip bi translated">跨平台移动应用开发:Ionic框架</h2><div class="mx l"><h3 class="bd b gy z fp mv fr fs mw fu fw dk translated">Ionic Framework的应用程序开发平台构建了令人惊叹的跨平台移动、web和桌面应用程序，只需一个…</h3></div><div class="my l"><p class="bd b dl z fp mv fr fs mw fu fw dk translated">www.ionicframework.com</p></div></div><div class="mz l"><div class="na l nb nc nd mz ne kp mq"/></div></div></a></div><p id="2377" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">我正在为此应用程序使用的版本:</p><p id="a50d" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated"><em class="lb"> Ionic CLI版本6.18.1 </em></p><p id="bb2d" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated"><em class="lb">离子版6 </em></p><p id="2dd0" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated"><strong class="lc ir">步骤1:在Ionic项目中生成服务</strong></p><p id="fdea" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">这个想法是在一个服务中完成所有的过程。我将把这项服务称为网络检查服务。为了生成这个服务，我使用以下命令:</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="60e7" class="nk nl iq ng b gy nm nn l no np">ionic g service services/network-checker</span></pre><p id="daa9" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated"><strong class="lc ir">第二步:设置网络插件</strong></p><p id="7333" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">下一步是设置网络插件。您需要使用以下命令将该插件安装到项目中:</p><pre class="kg kh ki kj gt nf ng nh ni aw nj bi"><span id="0299" class="nk nl iq ng b gy nm nn l no np">npm install @capacitor/network</span></pre><p id="5ad3" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">安装过程完成后，我们需要通过将它添加到network-checker.service.ts:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="cb36" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated"><strong class="lc ir">第2行:</strong>从电容器/网络导入网络</p><p id="bb69" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated"><strong class="lc ir">第10行:</strong>函数<code class="fe ns nt nu ng b">openCheckNetwork()</code>将启动一个addListener来监听网络状态的任何变化</p><p id="e8fd" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated"><strong class="lc ir">第16行:</strong>函数<code class="fe ns nt nu ng b">logNetworkState()</code>使用网络插件中的<code class="fe ns nt nu ng b">getStatus()</code>函数获取通话时的网络状态。如果您注意到了，我在这个函数中使用了<em class="lb"> async-await </em>来确保getStatus()函数执行并返回值。</p><p id="53cc" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated"><strong class="lc ir">第三步:从你想使用的地方调用函数</strong></p><p id="cf05" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">我将在启动点从home.page.ts调用这些函数(<code class="fe ns nt nu ng b">ngOnInit()</code>)。请注意，您可以使用app.component.ts或任何其他页面或组件来完成此操作，但我将使用home.page.ts来完成此操作。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="0b80" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated"><strong class="lc ir">第2行:</strong>导入<code class="fe ns nt nu ng b">NetworkCheckerService</code></p><p id="0fcf" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated"><strong class="lc ir">第13和14行:</strong>执行<code class="fe ns nt nu ng b">NetworkCheckerService</code>中的功能</p><p id="d289" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">好了，现在你可以使用Capacitor的网络插件来检查你的设备是否在线。</p><p id="7e7e" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated"><strong class="lc ir">奖金:在线指标！</strong></p><p id="f0db" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">在network-checker.service.ts中创建一个在线指示器布尔值</p><p id="3d26" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">我推荐使用像<em class="lb"> ngrx </em>或<em class="lb"> ngxs </em>这样的状态管理。它更好，更酷，让一切都有条不紊。然而，对于这个例子，我将只创建一个简单的布尔值作为network-checker.service.ts中的指示器，它将在home.page.ts中使用。</p><p id="d89a" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">修改<code class="fe ns nt nu ng b">network-checker.service.ts</code>添加一个在线指示器标志，如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="a3e9" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">第8行:上面的文件与前面的network-checker.service.ts文件完全一样，只是添加了一个名为<code class="fe ns nt nu ng b">onlineIndicator</code>的布尔值。</p><p id="5557" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">第15行和第23行:根据设备是否在线，分配布尔值<em class="lb">真</em>或<em class="lb">假</em>。</p><p id="b51f" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">我们现在可以使用<code class="fe ns nt nu ng b">onlineIndicator</code>来检查设备是否在线。</p><p id="93f0" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">因为我们已经在<code class="fe ns nt nu ng b">home.page.ts</code>里面导入了<code class="fe ns nt nu ng b">network-checker.service.ts</code>(见上图)。我们可以像这样在HTML文件中使用<code class="fe ns nt nu ng b">network-checker.service.ts</code>:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="ca02" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">第5行和第8行:这一行包括<em class="lb"> *ngIf </em>，如果设备在线，则显示绿色全闪标志，如果设备离线，则显示空闪轮廓。</p><div class="kg kh ki kj gt ab cb"><figure class="nv kk nw nx ny nz oa paragraph-image"><img src="../Images/df057fdee0686791450f5a9e138a3834.png" data-original-src="https://miro.medium.com/v2/resize:fit:894/format:webp/1*QJ4MYVDfhiQR1uApApKkkQ.jpeg"/></figure><figure class="nv kk ob nx ny nz oa paragraph-image"><img src="../Images/ddae83ccb4a6192223bb893d21656bcc.png" data-original-src="https://miro.medium.com/v2/resize:fit:832/format:webp/1*X_yrIFBAPKiZR_ue8nJe6A.jpeg"/><figcaption class="kr ks gj gh gi kt ku bd b be z dk oc di od oe">Offline and online indicator in the top right of the app</figcaption></figure></div><p id="9d77" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">给你。就这么简单。一定要试一试。</p><h2 id="13a1" class="nk nl iq bd of og oh dn oi oj ok dp ol lw om on oo lx op oq or ly os ot ou ov bi translated">我应该什么时候使用这个？</h2><p id="9d17" class="pw-post-body-paragraph kz la iq lc b ld ow jr lf lg ox ju li lw oy ll lm lx oz lp lq ly pa lt lu lv ij bi translated">以下是开发应用程序时确保其在线或离线的一些示例用例:</p><ol class=""><li id="90e1" class="lz ma iq lc b ld le lg lh lw mb lx mc ly md lv me mf mg mh bi translated">当设备离线/在线时将数据同步到您的服务器。使用网络服务中的监听器，您可以在联机或脱机时更改“状态”并做不同的事情</li><li id="af6a" class="lz ma iq lc b ld mi lg mj lw mk lx ml ly mm lv me mf mg mh bi translated">可以用来告诉用户你的系统在线/离线</li><li id="c935" class="lz ma iq lc b ld mi lg mj lw mk lx ml ly mm lv me mf mg mh bi translated">设备在线/离线时启用/禁用某些功能</li></ol><p id="32ed" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated">谢谢你，祝你愉快。</p><p id="59bc" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated"><em class="lb">塞拉马特·孟加图拉</em></p><p id="6d9d" class="pw-post-body-paragraph kz la iq lc b ld le jr lf lg lh ju li lw lk ll lm lx lo lp lq ly ls lt lu lv ij bi translated"><em class="lb">更多内容请看</em><a class="ae kv" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="lc ir"><em class="lb">plain English . io</em></strong></a><em class="lb">。报名参加我们的</em> <a class="ae kv" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="lc ir"> <em class="lb">免费周报</em> </strong> </a> <em class="lb">。关注我们关于</em><a class="ae kv" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="lc ir"><em class="lb">Twitter</em></strong></a><em class="lb">和</em><a class="ae kv" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="lc ir"><em class="lb">LinkedIn</em></strong></a><em class="lb">。加入我们的</em> <a class="ae kv" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="lc ir"> <em class="lb">社区不和谐</em> </strong> </a> <em class="lb">。</em></p></div></div>    
</body>
</html>