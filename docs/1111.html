<html>
<head>
<title>Fun in the Terminal: JavaScript in the Shell</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">终端中的乐趣:外壳中的JavaScript</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/fun-in-the-terminal-js-in-the-shell-a650b8ea2c67?source=collection_archive---------24-----------------------#2022-03-03">https://javascript.plainenglish.io/fun-in-the-terminal-js-in-the-shell-a650b8ea2c67?source=collection_archive---------24-----------------------#2022-03-03</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/1afe8a64facc4a3afd181c2673ce140b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*RIaAFurwjNIe0PpS"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/@marcrnt?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Marc Rentschler</a> on <a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="a5fa" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">首先，让我们问问自己:</p><h2 id="b3e4" class="ky kz in bd la lb lc dn ld le lf dp lg kl lh li lj kp lk ll lm kt ln lo lp lq bi translated"><strong class="ak"><em class="lr">shell和bash脚本有什么问题？</em>T3】</strong></h2><p id="afcc" class="pw-post-body-paragraph ka kb in kc b kd ls kf kg kh lt kj kk kl lu kn ko kp lv kr ks kt lw kv kw kx ig bi translated">嗯，理论上，没有——除了你必须学习一种新的编程语言到每一个你想自动化的操作系统上(比如假装没有别的选择可以在Windows上运行bash)。</p><p id="7d4b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">有一次我在网上看到一个评论，说JS开发人员总是避免学习，这就是为什么他们到处都带着JS，我认为这很有趣，大多数时候看起来真的是这样(只是说JS只是我知道的语言之一，不是我最喜欢的，这就是为什么我觉得它很有趣；)).</p><p id="3085" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">但我们也需要说，现在大部分自动化不是由shell或bash脚本完成的，而是由<strong class="kc io"> Python </strong>脚本完成的，<strong class="kc io"> Lua </strong>也被大量使用，最流行的macOS软件包管理器使用<strong class="kc io"> ruby，</strong>，通常当需要创建cron作业时，人们使用<strong class="kc io"> PHP </strong>来完成。</p><h2 id="1a63" class="ky kz in bd la lb lc dn ld le lf dp lg kl lh li lj kp lk ll lm kt ln lo lp lq bi translated"><strong class="ak">那么为什么不是JavaScript呢？</strong></h2><p id="1d85" class="pw-post-body-paragraph ka kb in kc b kd ls kf kg kh lt kj kk kl lu kn ko kp lv kr ks kt lw kv kw kx ig bi translated">我认为Node.js发布后，我们获得使用js自动化任务的合适替代方案只是时间问题，现在我认为我终于找到了一个非常好的工具来使用JS。</p><p id="75f8" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">而对于这篇文章，我们准备用<a class="ae jz" href="https://github.com/google/zx" rel="noopener ugc nofollow" target="_blank"> <strong class="kc io"> zx </strong> </a>来为它。</p><p id="b215" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Zx是一个JavaScript工具，使用JS作为主要的bash脚本语言。</p><p id="bc52" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">要开始，我们需要安装node JS和npm，之后，我们只需要运行:</p><pre class="lx ly lz ma gt mb mc md me aw mf bi"><span id="eca3" class="ky kz in mc b gy mg mh l mi mj">npm i -g zx</span></pre><p id="5b8a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">安装zx后，我们只需用。mjs扩展<br/>并开始编写我们的脚本。</p><p id="eded" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们应该添加到脚本中的第一行代码是:</p><pre class="lx ly lz ma gt mb mc md me aw mf bi"><span id="5e42" class="ky kz in mc b gy mg mh l mi mj">#!/usr/bin/env zx</span></pre><p id="f866" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">默认的shell将是bash，所以如果您想换成另一个shell，只需使用$。shell = shell路径</p><pre class="lx ly lz ma gt mb mc md me aw mf bi"><span id="d8de" class="ky kz in mc b gy mg mh l mi mj">$.shell = ‘C:\Windows\WinSxS\wow64_microsoft-windows-powershell-exe_31bf3856ad364e35_10.0.19041.546_none_5163f0069562aff6/powershell’</span></pre><p id="9c3e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">让我们首先创建一个文件夹</p><pre class="lx ly lz ma gt mb mc md me aw mf bi"><span id="1449" class="ky kz in mc b gy mg mh l mi mj">let folderName = ‘myzxtutorial’<br/>await $`mkdir ${folderName}`</span></pre><p id="ea30" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">要运行它，我们只需在shell中键入</p><pre class="lx ly lz ma gt mb mc md me aw mf bi"><span id="e834" class="ky kz in mc b gy mg mh l mi mj">zx filepath/filename.mjs</span></pre><p id="3ed3" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们应该得到这样的输出:</p><pre class="lx ly lz ma gt mb mc md me aw mf bi"><span id="0d8a" class="ky kz in mc b gy mg mh l mi mj">$ mkdir myzxtutorial</span></pre><p id="9048" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在让我们在该目录中创建两个文件:</p><pre class="lx ly lz ma gt mb mc md me aw mf bi"><span id="be8c" class="ky kz in mc b gy mg mh l mi mj">await $`touch myzxtutorial/file1.txt`</span></pre><p id="7d7d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">对于第二个文件，我们不用键入文件夹/文件名，而是用cd命令来更改目录</p><pre class="lx ly lz ma gt mb mc md me aw mf bi"><span id="02a6" class="ky kz in mc b gy mg mh l mi mj">cd('myzxtutorial')<br/>await $`touch second_file.txt`</span></pre><p id="ec99" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果我们在bash上运行，我们应该给出这样的输出:</p><pre class="lx ly lz ma gt mb mc md me aw mf bi"><span id="ce12" class="ky kz in mc b gy mg mh l mi mj">$ ←[92mtouch ←[39mmyzxtutorial/file1.txt<br/>$ ←[92mcd ←[39mmyzxtutorial<br/>$ ←[92mtouch ←[39msecond_file.txt</span></pre><p id="8154" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在让我们做一些更复杂的事情，一个web请求，zx在fetch库中有一个包装器，允许我们做类似JS的请求:</p><pre class="lx ly lz ma gt mb mc md me aw mf bi"><span id="6998" class="ky kz in mc b gy mg mh l mi mj">const resp = await fetch(‘<a class="ae jz" href="https://httpbin.org/ip" rel="noopener ugc nofollow" target="_blank">https://httpbin.org/ip</a>')<br/>if (resp.status == 200) {<br/> const jsonRes = JSON.parse(JSON.stringify(await resp.json()))<br/> console.log(jsonRes.origin)<br/>}</span></pre><p id="2388" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果我们运行这个脚本，我们将得到如下结果:</p><pre class="lx ly lz ma gt mb mc md me aw mf bi"><span id="2d9a" class="ky kz in mc b gy mg mh l mi mj">$ fetch <a class="ae jz" href="https://httpbin.org/ip" rel="noopener ugc nofollow" target="_blank">https://httpbin.org/ip</a><br/>167.249.93.243</span></pre><p id="561b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">好了，现在让我们通过用户使用问题功能来获得一些输入</p><pre class="lx ly lz ma gt mb mc md me aw mf bi"><span id="5bd0" class="ky kz in mc b gy mg mh l mi mj">const num1 = await question(‘type a number’)<br/>console.log(`calc is ${parseInt(num1) + 2}`)</span></pre><p id="d720" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果我们运行它，结果将类似于:</p><pre class="lx ly lz ma gt mb mc md me aw mf bi"><span id="e099" class="ky kz in mc b gy mg mh l mi mj">type a number4<br/>calc is 6</span></pre><p id="b017" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">但是我们也可以并且应该处理文件系统和操作系统，zx在两个库周围都有包装器，为了演示，让我们在之前创建的一个文件上写内容:</p><pre class="lx ly lz ma gt mb mc md me aw mf bi"><span id="a866" class="ky kz in mc b gy mg mh l mi mj">await fs.writeFile(‘./myzxtutorial/second_file.txt’, ‘any content’)</span></pre><p id="088c" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果我们打开我们的second_file.txt文件中的<strong class="kc io"> <em class="mk">【任何内容】</em> </strong>消息应该被写入文件中。</p><p id="c5ef" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">最后，让我们使用粉笔包装为终端添加一些颜色</p><pre class="lx ly lz ma gt mb mc md me aw mf bi"><span id="5eee" class="ky kz in mc b gy mg mh l mi mj">console.log(chalk.blue(3))</span></pre><p id="1e6b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">运行脚本，我们应该看到蓝色的数字3</p><p id="9326" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我希望这个简短的zx介绍可以让你很好地理解这个不错的工具，也激发你的好奇心去了解更多，zx有许多其他的特性和包装器，甚至有实验性的特性供你测试，所以如果你感兴趣，我建议你仔细看看<a class="ae jz" href="https://github.com/google/zx" rel="noopener ugc nofollow" target="_blank">文档</a>。<br/>再见！</p><blockquote class="ml"><p id="2173" class="mm mn in bd mo mp mq mr ms mt mu kx dk translated">[额外挑战警报]</p></blockquote><p id="6404" class="pw-post-body-paragraph ka kb in kc b kd mv kf kg kh mw kj kk kl mx kn ko kp my kr ks kt mz kv kw kx ig bi translated">创建一个脚本，使用获取包装器<strong class="kc io"> <em class="mk"> </em> </strong>向<strong class="kc io"><em class="mk">'</em></strong><a class="ae jz" href="https://httpbin.org/ip" rel="noopener ugc nofollow" target="_blank"><strong class="kc io"><em class="mk">https://httpbin.org/ip</em></strong></a><strong class="kc io"><em class="mk">'</em></strong>执行请求，并使用fs包装器将其解析为JSON的响应体写入file1.txt文件。</p><p id="9193" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="mk">更多内容请看</em> <a class="ae jz" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kc io"> <em class="mk">说白了就是</em> </strong> </a> <em class="mk">。报名参加我们的</em> <a class="ae jz" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kc io"> <em class="mk">免费每周简讯</em> </strong> </a> <em class="mk">。关注我们</em><a class="ae jz" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="kc io"><em class="mk">Twitter</em></strong></a><em class="mk">和</em><a class="ae jz" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kc io"><em class="mk">LinkedIn</em></strong></a><em class="mk">。加入我们的</em> <a class="ae jz" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kc io"> <em class="mk">社区不和谐</em> </strong> </a> <em class="mk">。</em></p></div></div>    
</body>
</html>