<html>
<head>
<title>How to Schedule Tasks in Node.js using Node-Cron</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Node-Cron在Node.js中调度任务</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-schedule-tasks-in-node-js-using-node-cron-e584dc14388b?source=collection_archive---------9-----------------------#2022-01-04">https://javascript.plainenglish.io/how-to-schedule-tasks-in-node-js-using-node-cron-e584dc14388b?source=collection_archive---------9-----------------------#2022-01-04</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="1e1f" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">再次简化Node.js中的任务调度</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/17deab5ee5080bcce26085a05900d3cb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*6uqLcCjYo3X4XES1"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@chuttersnap?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">CHUTTERSNAP</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="fd96" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">创建Node.js应用程序时，有时需要重复运行某些任务。</p><p id="59bf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">例如，你可能需要在每个月的第一天运行一个web scrapper，或者你可能需要在每周二、三、四的早上6点发送电子邮件。</p><p id="c3c7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">像这样的用例是节点包<a class="ae kv" href="https://github.com/node-cron/node-cron" rel="noopener ugc nofollow" target="_blank"> node-cron </a>开始发光的地方。</p><p id="7c50" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这篇博文中，我将向您展示如何每秒、每5秒和每分钟打印console.log语句，这样您就可以开始理解如何使用node-cron。</p><h1 id="a9d7" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">什么是node-cron？</h1><p id="47d7" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">node-cron是一个Node.js模块，允许您使用crontab语法调度任务。</p><p id="686a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您不知道crontab语法是什么，这是一种通过使用由5–6个字段组成的字符串来表示一组时间的方法。</p><p id="5f87" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">crontab的语法如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mp"><img src="../Images/968bef6d5c2fcaea67ac1ead578286bc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rDRsD9zxsfB18CbmDNK8cA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Crontab Syntax</figcaption></figure><p id="097f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用crontab语法时，星号(*)表示“每隔<em class="mq">间隔</em>运行此任务”</p><p id="168e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">例如，cron表达式:<strong class="ky ir">* * * * * * *</strong>表示“每秒、每分钟、每小时、每小时、每天、每月、每周的每一天运行以下任务”</p><blockquote class="mr ms mt"><p id="b788" class="kw kx mq ky b kz la jr lb lc ld ju le mu lg lh li mv lk ll lm mw lo lp lq lr ij bi translated">本质上，这个cron表达式将每秒运行一个任务。</p></blockquote></div><div class="ab cl mx my hu mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ij ik il im in"><p id="02dd" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了更精确，我们可以用数字代替星号。</p><p id="42f4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">例如，如果我们想每小时运行一个任务，我们可以使用cron表达式:</p><blockquote class="mr ms mt"><p id="64e0" class="kw kx mq ky b kz la jr lb lc ld ju le mu lg lh li mv lk ll lm mw lo lp lq lr ij bi">* * 1 * **</p></blockquote><p id="6095" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果我们想每五个小时运行一个任务，我们可以使用cron表达式:</p><blockquote class="mr ms mt"><p id="75d9" class="kw kx mq ky b kz la jr lb lc ld ju le mu lg lh li mv lk ll lm mw lo lp lq lr ij bi">* * */5 * * *</p></blockquote><p id="c8ff" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在我们对crontab语法有了基本的了解，是时候在实际项目中使用我们的新知识了。</p><p id="8a51" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="mq">注意:如果您需要更好地理解crontab语法，我建议您通读一下</em><a class="ae kv" href="https://github.com/node-cron/node-cron" rel="noopener ugc nofollow" target="_blank"><em class="mq">node-cron</em></a><em class="mq">文档，并使用</em> <a class="ae kv" href="https://crontab.guru/#*_*_*_*_*" rel="noopener ugc nofollow" target="_blank"> <em class="mq"> crontab。guru </em> </a> <em class="mq">练习写cron表情。</em></p><h1 id="f172" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">导入节点-cron</h1><p id="bebb" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">要使用node-cron，您只需运行以下npm命令:</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="1e89" class="nj lt iq nf b gy nk nl l nm nn">$ npm install --save node-cron</span></pre><p id="a798" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">之后，创建一个名为<strong class="ky ir"> server.js </strong>的新javascript文件，并添加以下代码</p><pre class="kg kh ki kj gt ne nf ng nh aw ni bi"><span id="0761" class="nj lt iq nf b gy nk nl l nm nn">const cron = require('node-cron');</span></pre><p id="32cc" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这就是开始使用node-cron所需要做的全部工作。</p><h1 id="0cec" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">使用Cron.schedule</h1><p id="7ba5" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">现在我们已经设置了node-cron，是时候开始调度任务了。</p><p id="d93f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将使用cron。安排来完成这项工作。</p><p id="edf5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">克朗。schedule接受两个参数一个cron表达式和一个回调函数以及要执行的任务。</p><p id="5832" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">下面的代码显示了如何运行每秒打印的任务</p><blockquote class="mr ms mt"><p id="4a66" class="kw kx mq ky b kz la jr lb lc ld ju le mu lg lh li mv lk ll lm mw lo lp lq lr ij bi translated">“每秒运行一个任务”</p></blockquote><p id="795e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">到控制台。</p><p id="8bdb" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">代码如下:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="no np l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Scheduling a task every second</figcaption></figure><p id="90c2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">太好了！</p><p id="f7a4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在你所要做的就是运行<em class="mq"> </em> <strong class="ky ir">节点server.js </strong>，你应该看到“每秒运行一个任务”被每秒打印到控制台。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/2e990013e779db91c27d7d48b0d5d651.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*0JPKZLZDj8D2IEaS5EFDJw.gif"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">The output of Running Server.js</figcaption></figure><p id="8531" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">很好，现在是时候做同样的事情了，但是这次是每5秒和1分钟一次。</p><p id="5267" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">代码如下:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="no np l"/></div></figure><p id="7315" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是您将看到的输出:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/540a7ff13849ac2cba8ff8edbfcba949.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*1hdk6coYjD57l5homUGFJA.gif"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Console Output of running a task every second,5 seconds, and minute</figcaption></figure><h1 id="c1d2" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">结论</h1><p id="103f" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">感谢您阅读完我的文章<strong class="ky ir">‘如何使用Node-Cron在Node.js中调度任务’</strong>。如果你有任何问题，请随意提问，我会尽快回答。</p><p id="df60" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我希望你有美好的一天。如果你是中级新手，你可以点击这里的链接<a class="ae kv" href="https://bookeraziz.medium.com/membership" rel="noopener">加入。</a></p></div><div class="ab cl mx my hu mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ij ik il im in"><div class="kg kh ki kj gt nr"><a rel="noopener  ugc nofollow" target="_blank" href="/how-to-add-dynamic-styles-in-react-and-react-native-628280320ca4"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd ir gy z fp nw fr fs nx fu fw ip bi translated">如何在React和React Native中添加动态样式</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">让你的应用充满活力的初学者指南</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="oa l"><div class="ob l oc od oe oa of kp nr"/></div></div></a></div><div class="og oh gp gr oi nr"><a href="https://blog.devgenius.io/6-vs-code-quality-of-life-extensions-acbfd1425561" rel="noopener  ugc nofollow" target="_blank"><div class="ns ab fo"><div class="nt ab nu cl cj nv"><h2 class="bd ir gy z fp nw fr fs nx fu fw ip bi translated">6 VS代码生命质量扩展</h2><div class="ny l"><h3 class="bd b gy z fp nw fr fs nx fu fw dk translated">这些扩展可能不会让你更有效率，但是它们会让你的生活变得更加轻松</h3></div><div class="nz l"><p class="bd b dl z fp nw fr fs nx fu fw dk translated">blog.devgenius.io</p></div></div><div class="oa l"><div class="oj l oc od oe oa of kp nr"/></div></div></a></div><p id="fed4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="mq">更多内容请看</em><a class="ae kv" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><em class="mq">plain English . io</em></a><em class="mq">。报名参加我们的</em> <a class="ae kv" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <em class="mq">免费周报</em> </a> <em class="mq">。在我们的</em> <a class="ae kv" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <em class="mq">社区</em> </a> <em class="mq">获得独家的写作机会和建议。</em></p></div></div>    
</body>
</html>