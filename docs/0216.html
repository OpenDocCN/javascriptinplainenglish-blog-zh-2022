<html>
<head>
<title>Reduce your React Applications Bundle Size by 75% with Compression</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">通过压缩将您的React应用捆绑包大小减少75%</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/reduce-your-react-applications-bundle-size-by-75-with-compression-e0103abe9b69?source=collection_archive---------0-----------------------#2022-01-13">https://javascript.plainenglish.io/reduce-your-react-applications-bundle-size-by-75-with-compression-e0103abe9b69?source=collection_archive---------0-----------------------#2022-01-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/13b2951ad1e05aef30e9e1de80e85bb8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*EDJzDy2W7GSWloVKyRfbhQ.jpeg"/></div></div></figure><p id="7052" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">每个React开发人员都应该在他们的捆绑过程中增加压缩。</p><p id="d208" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">减少React应用程序包大小的最有效技术之一是压缩。</p><p id="f4c6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="kw">压缩是通过对文件数据进行重新编码以使用比原始文件更少的存储位来减小文件大小的过程。</em></p><p id="f980" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">压缩通常是通过像Rollup或Webpack这样的JavaScript bundler实现的。在本文中，我将展示如何用Webpack实现压缩。</p><p id="d9dd" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="kw">本文假设读者对Webpack及其配置有基本的了解。</em></p><p id="792e" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先，让我们看看未压缩时我的应用程序包大小:</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi kx"><img src="../Images/77c4f18c8caf31f7d62980d48617b801.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hZJgoM7X-YoftDdLJX3gAw.png"/></div></div></figure><p id="a540" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我的应用程序使用代码分割，所以我有比现成配置更多的文件。</p><p id="22f3" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">添加压缩</strong></p><p id="2278" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">首先要做的是安装<a class="ae lc" href="https://webpack.js.org/plugins/compression-webpack-plugin/" rel="noopener ugc nofollow" target="_blank"> Webpack压缩插件</a></p><pre class="ky kz la lb gt ld le lf lg aw lh bi"><span id="d6c6" class="li lj iq le b gy lk ll l lm ln">yarn add compression-webpack-plugin -D</span><span id="1510" class="li lj iq le b gy lo ll l lm ln">or</span><span id="0e7c" class="li lj iq le b gy lo ll l lm ln">npm install compression-webpack-plugin --save-dev</span></pre><p id="85dc" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">安装完成后，将插件导入webpack.config.js</p><pre class="ky kz la lb gt ld le lf lg aw lh bi"><span id="c2b4" class="li lj iq le b gy lk ll l lm ln">const CompressionPlugin = require("compression-webpack-plugin")</span></pre><p id="e378" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">接下来，将插件添加到插件数组中</p><pre class="ky kz la lb gt ld le lf lg aw lh bi"><span id="3295" class="li lj iq le b gy lk ll l lm ln">plugins: [</span><span id="3ef5" class="li lj iq le b gy lo ll l lm ln">  ...other plugins,</span><span id="60d7" class="li lj iq le b gy lo ll l lm ln"><em class="kw">  new</em> CompressionPlugin({</span><span id="b5a7" class="li lj iq le b gy lo ll l lm ln">    test: /\.js(\?.*)?$/i,</span><span id="991e" class="li lj iq le b gy lo ll l lm ln">    filename: "[path][query]",</span><span id="0071" class="li lj iq le b gy lo ll l lm ln">    algorithm: "gzip",</span><span id="88f9" class="li lj iq le b gy lo ll l lm ln">    deleteOriginalAssets: false,</span><span id="b8ae" class="li lj iq le b gy lo ll l lm ln">  }),</span><span id="57af" class="li lj iq le b gy lo ll l lm ln">],</span></pre><p id="9061" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">对于包括的项目:</p><p id="3758" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">测试:</strong>包括所有通过测试断言的资产。</p><p id="6f44" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">文件名</strong>:目标资产文件名。</p><p id="8a2d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">算法</strong>:压缩算法/函数。</p><p id="db4f" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir"> deleteOriginalAssets </strong>:是否删除原有资产。</p><p id="1c0c" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">我建议查看所有可用选项的Webpack文档。</p><p id="a870" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">完整网络包配置:</strong></p><figure class="ky kz la lb gt jr"><div class="bz fp l di"><div class="lp lq l"/></div></figure><p id="bdc9" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">一旦配置就绪，您所要做的就是像平常一样运行您的构建。您的构建文件夹中的文件将显著变小。</p><p id="3b19" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">在我的例子中，包含的每个JavaScript文件都比原始文件小75%。</p><figure class="ky kz la lb gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi kx"><img src="../Images/fa8d70a3da4d1b9a16855babc1aff557.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Jlc8meVGYgAJNtHHiMw6rg.png"/></div></div></figure><p id="043d" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><strong class="ka ir">最终注释</strong></p><p id="884a" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">为了让浏览器读取压缩文件，它们必须包含标题:</p><pre class="ky kz la lb gt ld le lf lg aw lh bi"><span id="2287" class="li lj iq le b gy lk ll l lm ln">Content-Encoding: gzip</span></pre><p id="52bb" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">如果没有这个头文件，您的浏览器会试图将这些文件作为普通的JavaScript文件读取并崩溃。</p><p id="34b6" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">当它们在s3上传到我的CDN时，我将这些头添加到每个文件中。</p><pre class="ky kz la lb gt ld le lf lg aw lh bi"><span id="44dd" class="li lj iq le b gy lk ll l lm ln">aws s3 sync --delete ./dist s3://${S3_BUCKET}${BRANCH_NAME} --content-encoding gzip</span></pre><p id="2493" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated">你的情况可能有所不同，但指出这一点很重要。</p><p id="b496" class="pw-post-body-paragraph jy jz iq ka b kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv ij bi translated"><em class="kw">更多内容请看</em> <a class="ae lc" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir"> <em class="kw">说白了就是</em> </strong> </a> <em class="kw">。报名参加我们的</em> <a class="ae lc" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir"> <em class="kw">免费每周简讯</em> </strong> </a> <em class="kw">。在我们的</em> <a class="ae lc" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="ka ir"> <em class="kw">社区</em> </strong> </a> <em class="kw">获得独家获得写作机会和建议。</em></p></div></div>    
</body>
</html>