<html>
<head>
<title>Mock Only Some Items from a Module with Jest</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Jest模仿模块中的一些项目</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/mock-only-some-items-from-a-module-with-jest-8f33a3d87e5c?source=collection_archive---------12-----------------------#2022-04-12">https://javascript.plainenglish.io/mock-only-some-items-from-a-module-with-jest-8f33a3d87e5c?source=collection_archive---------12-----------------------#2022-04-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="fde6" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何使用Jest mocking针对模块中的特定函数或值？</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/79339a1b1ea1d09c7173a04b6e5a12c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*kxx_h0AxxCU8jOHT.png"/></div></div></figure><p id="82cc" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">很长一段时间以来，Jest对我来说一直是个谜。嘲笑是困难的，找到正确的文档本身就是一个挑战。</p><p id="d3d6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">经过大量的练习(以及对想法的记录)，我终于可以解决几乎所有的问题，并能流利地讲笑话。</p></div><div class="ab cl ln lo hu lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="ij ik il im in"><p id="d6ef" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在本文中，我们将关注如何模拟来自模块的特定函数或变量。</p><p id="529e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这样做的方法基本上是通过用<code class="fe lu lv lw lx b">jest.requiredActual</code>导入整个模块，并用之前模拟的值在一个新对象中传播。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ly"><img src="../Images/ea5fc4c4957dd8b6be811abd883dabc7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VJfEs78EKc6Vzyb0TqC1LA.png"/></div></div><figcaption class="lz ma gj gh gi mb mc bd b be z dk">Our final result</figcaption></figure><p id="460f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">让我们深入了解一下:</p><ul class=""><li id="f7f7" class="md me iq kt b ku kv kx ky la mf le mg li mh lm mi mj mk ml bi translated"><code class="fe lu lv lw lx b">const originalModule = jest.requireActual(‘../my-module’);</code></li></ul><p id="06a9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在这一行，我们导入实际的模块，没有模仿。它允许我们重新注入您想要保留的值，就像原始值一样。</p><ul class=""><li id="3a0e" class="md me iq kt b ku kv kx ky la mf le mg li mh lm mi mj mk ml bi translated"><code class="fe lu lv lw lx b">…originalModule</code></li></ul><p id="48ce" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这里，我们将原始值和函数注入到新对象中。</p><ul class=""><li id="3be2" class="md me iq kt b ku kv kx ky la mf le mg li mh lm mi mj mk ml bi translated"><code class="fe lu lv lw lx b">_esModule: true</code></li></ul><p id="62b9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这是告诉JS，对方其实是一个模块。</p><ul class=""><li id="1d75" class="md me iq kt b ku kv kx ky la mf le mg li mh lm mi mj mk ml bi translated"><code class="fe lu lv lw lx b">default: () =&gt; ‘foo’</code></li></ul><p id="646d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在本例中，我们模仿了模块的默认导出(<code class="fe lu lv lw lx b">export default</code>)。只有在导出默认值时才这样，否则不要使用它。</p><ul class=""><li id="9672" class="md me iq kt b ku kv kx ky la mf le mg li mh lm mi mj mk ml bi translated"><code class="fe lu lv lw lx b">foo: () =&gt; ‘bar’,</code></li></ul><p id="ce6b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们模仿函数<code class="fe lu lv lw lx b">foo</code>返回<code class="fe lu lv lw lx b">bar</code>。</p><ul class=""><li id="8663" class="md me iq kt b ku kv kx ky la mf le mg li mh lm mi mj mk ml bi translated"><code class="fe lu lv lw lx b">toto: 'tata</code></li></ul><p id="1c4e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">最后，我们将导出值<code class="fe lu lv lw lx b">toto</code>的值改为<code class="fe lu lv lw lx b">tata</code></p><blockquote class="mm mn mo"><p id="9124" class="kr ks mp kt b ku kv jr kw kx ky ju kz mq lb lc ld mr lf lg lh ms lj lk ll lm ij bi translated">改变一个值也适用于<code class="fe lu lv lw lx b">const</code>变量，因为它不是改变它的值，而是创建一个新值</p></blockquote></div><div class="ab cl ln lo hu lp" role="separator"><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls lt"/><span class="lq bw bk lr ls"/></div><div class="ij ik il im in"><p id="a333" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">当找到并理解正确的文档/教程时，用Jest嘲弄是相当容易的。正如您所看到的，没有用很多行就得到我们想要的结果！</p><p id="9c1e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我希望你喜欢这篇文章，不要犹豫，继续关注更多！</p><p id="c691" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><em class="mp">更多内容请看</em><a class="ae mt" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kt ir"><em class="mp">plain English . io</em></strong></a><em class="mp">。报名参加我们的</em> <a class="ae mt" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir"> <em class="mp">免费周报</em> </strong> </a> <em class="mp">。关注我们关于</em><a class="ae mt" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="kt ir"><em class="mp">Twitter</em></strong></a><em class="mp">和</em><a class="ae mt" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kt ir"><em class="mp">LinkedIn</em></strong></a><em class="mp">。加入我们的</em> <a class="ae mt" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir"> <em class="mp">社区不和谐</em> </strong> </a> <em class="mp">。</em></p></div></div>    
</body>
</html>