<html>
<head>
<title>Stop Using Logical OR, Use ?? Instead</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">停止使用逻辑OR，使用？？代替</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/stop-using-logical-or-use-null-coalescing-instead-f7668c96b0db?source=collection_archive---------3-----------------------#2022-06-10">https://javascript.plainenglish.io/stop-using-logical-or-use-null-coalescing-instead-f7668c96b0db?source=collection_archive---------3-----------------------#2022-06-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="0343" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">你可以在很多事情上使用逻辑操作符，但是不要在任何事情上都使用它们！我们现在有更好的东西了。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/425cdd1a0c4ac6a6a73616ff9b7e7cef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*C8TFJXc8EQs_v6OWz4TANA.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Seriously. Stop using the logical OR when you’re not writing boolean</figcaption></figure><p id="b8ef" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">JavaScript有非常灵活的语法；你可以用不同的方式使用相同的语法表达来完成不同的事情；这是用JavaScript编程的好处之一。</p><p id="a074" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">软件开发人员(在任何语言中)在评估布尔表达式的真实性时通常使用<code class="fe lr ls lt lu b">||</code>操作符。JavaScript开发人员也可以通过其他方式使用它。</p><p id="25e0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">软件通常使用默认值，也称为回退值。如果数据不存在，则使用回退值。在ES2020之前，开发人员使用逻辑OR运算符来实现这一点。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/aa2376511d85ebeaf43f9bf880969c47.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/0*zkedmlZ5YbeO5KPU"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">outOf defaults to 5 if the argument is not provided</figcaption></figure><p id="ff10" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">请注意，如果<code class="fe lr ls lt lu b">outOf</code>是<code class="fe lr ls lt lu b">null</code>或<code class="fe lr ls lt lu b">undefined</code>，上面的代码如何使用逻辑OR运算符返回到5。上面的代码是一种更好的书写方式:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/e5765b17213a15dd845e4c1f95cb4f1a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/0*1VdAWtRRnWAZWfFN"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Using an if-statement for providing a fallback value</figcaption></figure><p id="67d9" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">首先，我们想知道为什么会这样。然后，我们还想了解为什么这可能是一个问题，是您的软件中的一个主要错误。</p><h1 id="11d2" class="lw lx iq bd ly lz ma mb mc md me mf mg jw mh jx mi jz mj ka mk kc ml kd mm mn bi translated">分配默认值时，逻辑OR运算符如何工作</h1><p id="e2f5" class="pw-post-body-paragraph kv kw iq kx b ky mo jr la lb mp ju ld le mq lg lh li mr lk ll lm ms lo lp lq ij bi translated">在计算机科学中，有一个布尔表达式短路的概念。短路是计算机通过减少继续执行后续命令所需的操作数量来优化运行时间的方式。</p><p id="4021" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">任何由逻辑AND ( <code class="fe lr ls lt lu b">&amp;&amp;</code>)连接的真理陈述将是<code class="fe lr ls lt lu b">false</code>，除非<code class="fe lr ls lt lu b">&amp;&amp;</code>的两边都为真。所以如果<code class="fe lr ls lt lu b">&amp;&amp;</code>操作符的左边是<code class="fe lr ls lt lu b">false</code>，那么计算操作符的右边是没有意义的，因为你已经知道整个语句将是<code class="fe lr ls lt lu b">false</code>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/0a4839f4872942a61d69d9e017ef586f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/0*6BWEPIWtedFOqAzm"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Any logical AND will result in false if the preceding value is false</figcaption></figure><p id="26be" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">与<code class="fe lr ls lt lu b">&amp;&amp;</code>操作器类似，<code class="fe lr ls lt lu b">||</code>操作器也会短路。OR运算的结果总是<code class="fe lr ls lt lu b">true</code>，除非两边都是<code class="fe lr ls lt lu b">false</code>。因此，如果OR操作符的左边是<code class="fe lr ls lt lu b">true</code>，那么计算操作符的右边是没有意义的，因为你已经知道整个语句将是<code class="fe lr ls lt lu b">true</code>。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/1b2a5bfaacd47c8ad57f9a4a16c9bdd3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/0*1B-JEusHPHhsciuH"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Any logical OR will result in true if the preceding value is true</figcaption></figure><p id="2066" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">由于逻辑短路，如果不需要的话，JavaScript引擎甚至不会费心去读取或评估操作符的右边。</p><p id="8d18" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在JavaScript中，任何值都可以计算为布尔值。我写了一整篇文章(<a class="ae mt" rel="noopener ugc nofollow" target="_blank" href="/the-7-false-like-values-of-javascript-and-typescript-93df73bda44">JavaScript(和TypeScript) </a>的7个类似错误的值)讨论JavaScript中相当于<code class="fe lr ls lt lu b">false</code>的值。这个想法是，<code class="fe lr ls lt lu b">undefined</code>和<code class="fe lr ls lt lu b">null</code>是<code class="fe lr ls lt lu b">falsy</code>值。</p><p id="0b24" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">使用OR运算符时，如果初始值未定义或为空，表达式将默认为后续值。如果初始值是<code class="fe lr ls lt lu b">undefined</code> <strong class="kx ir">或</strong> <code class="fe lr ls lt lu b">null</code>，JavaScript会使用它。因此，JavaScript开发人员经常使用<code class="fe lr ls lt lu b">||</code>操作符来提供后备。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/7e48a08cdd88092c9fe202b841b6443c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/0*i3nj_WBPY1OrDbp7"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">How fallback values work with the logical AND</figcaption></figure><h1 id="b059" class="lw lx iq bd ly lz ma mb mc md me mf mg jw mh jx mi jz mj ka mk kc ml kd mm mn bi translated">逻辑OR的问题是</h1><p id="8563" class="pw-post-body-paragraph kv kw iq kx b ky mo jr la lb mp ju ld le mq lg lh li mr lk ll lm ms lo lp lq ij bi translated">如果你还没有读我的另一篇文章，我们将在这里讨论它。尽管我强烈建议你先点击这里阅读那篇文章。</p><p id="b20c" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">JavaScript中有各种类似<code class="fe lr ls lt lu b">false</code>的值。有的是<code class="fe lr ls lt lu b">undefined</code>、<code class="fe lr ls lt lu b">null</code>、<code class="fe lr ls lt lu b">NaN</code>、<code class="fe lr ls lt lu b">void</code>、<code class="fe lr ls lt lu b">""</code>(空串)，最后是<code class="fe lr ls lt lu b">0</code>。有问题的情况是<code class="fe lr ls lt lu b">0</code>和一个空字符串。</p><p id="37f9" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">假设你有一个接受数值参数的函数。如果该参数缺失，那么它应该默认为<code class="fe lr ls lt lu b">10</code>。您的代码将如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/22b132befc50b1b82ce8859e04fbfd8b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/0*qnq7xq3dmaTr36l9"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">A buggy function (try figuring out where the bug is)</figcaption></figure><p id="9f9b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">你发现问题了吗？花一分钟试着弄明白它。(提示:参考falsy值列表)</p><p id="59d6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果我输入一个参数，但是输入的是数字<code class="fe lr ls lt lu b">0</code>怎么办？根据JavaScript，<code class="fe lr ls lt lu b">0</code>和<code class="fe lr ls lt lu b">false</code>是一样的。如果我有另一个接受字符串的函数，但是我传递了一个空字符串怎么办？那也和<code class="fe lr ls lt lu b">false</code>一样。在这些情况下，<code class="fe lr ls lt lu b">||</code>操作符将强制JavaScript使用后续值作为后备。你不会想要这个的！</p><h1 id="70cf" class="lw lx iq bd ly lz ma mb mc md me mf mg jw mh jx mi jz mj ka mk kc ml kd mm mn bi translated">零合并算子</h1><p id="78dd" class="pw-post-body-paragraph kv kw iq kx b ky mo jr la lb mp ju ld le mq lg lh li mr lk ll lm ms lo lp lq ij bi translated">ES2020引入了指定回退值的新规范。这被称为<strong class="kx ir">零合并操作符</strong>。类似于<code class="fe lr ls lt lu b">||</code>，你可以使用<code class="fe lr ls lt lu b">??</code>。</p><p id="3ead" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">对于回退值，空合并运算符的工作方式类似于<code class="fe lr ls lt lu b"><strong class="kx ir">||</strong></code>运算符。唯一的区别是，它确保如果您输入一个空字符串或一个<code class="fe lr ls lt lu b">0</code>，它将使用那个值，而不是回退。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi lv"><img src="../Images/97580f2e0fec2ae980d014830c5ed053.png" data-original-src="https://miro.medium.com/v2/resize:fit:1386/0*fM4HFpYIurlu6VCg"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Using the null coalescing operator</figcaption></figure><p id="e739" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">当使用<code class="fe lr ls lt lu b">||</code>提供默认值时，大多数JavaScript开发人员并没有意识到潜在的缺陷。ECMAScript的开发人员意识到了这一点，并提供了一个方便的修复方法。请确保从现在开始使用该运算符！</p><p id="fc30" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">编码快乐！</p><p id="6e7a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="mu">更多内容看</em><a class="ae mt" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kx ir"><em class="mu">o</em></strong><em class="mu"/></a><em class="mu">。报名参加我们的</em> <a class="ae mt" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kx ir"> <em class="mu">免费周报</em> </strong> </a> <em class="mu">。关注我们关于</em><a class="ae mt" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="kx ir"><em class="mu">Twitter</em></strong></a><em class="mu">和</em><a class="ae mt" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kx ir"><em class="mu">LinkedIn</em></strong></a><em class="mu">。查看我们的</em> <a class="ae mt" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kx ir"> <em class="mu">社区不和谐</em> </strong> </a> <em class="mu">加入我们的</em> <a class="ae mt" href="https://inplainenglish.pallet.com/talent/welcome" rel="noopener ugc nofollow" target="_blank"> <strong class="kx ir"> <em class="mu">人才集体</em> </strong> </a> <em class="mu">。</em></p></div></div>    
</body>
</html>