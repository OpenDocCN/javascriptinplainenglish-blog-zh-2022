<html>
<head>
<title>Data driven application with Angular using ng-store</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用ng-store的Angular数据驱动应用程序</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/data-driven-application-with-angular-using-ng-store-5b12cfda0866?source=collection_archive---------9-----------------------#2022-12-23">https://javascript.plainenglish.io/data-driven-application-with-angular-using-ng-store-5b12cfda0866?source=collection_archive---------9-----------------------#2022-12-23</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/fe48af6bdcc43d945e9ffede16f28d31.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*19YK3CsxkWyAeyqa"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/ja/@hharritt?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Hunter Harritt</a> on <a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="c692" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在Angular应用程序中管理数据有时非常棘手。这是因为有多种方法可以做到这一点，最糟糕的方法是将数据直接存储到组件中，最好的方法是使用存储。</p><p id="dc0e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">商店就像一种服务，它集中并管理您数据，以便您能够以有效的方式访问或更新它们。已经有一些库可以帮助你做到这一点，比如NgRx。</p><p id="d79b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">虽然我肯定这个图书馆很好，但我不得不承认我不喜欢使用它。事实上，在我的日常工作中，我必须构建一个工作流管理应用程序，在那里我必须使用相当多的数据。我开始时有一个非常糟糕的想法，就是将它们存储在组件中，然后才意识到:</p><ul class=""><li id="a5f9" class="ky kz in kc b kd ke kh ki kl la kp lb kt lc kx ld le lf lg bi translated">让你的组件变得更加复杂。</li><li id="bf8f" class="ky kz in kc b kd lh kh li kl lj kp lk kt ll kx ld le lf lg bi translated">使加载的数据只在加载它们的组件中可用(或者它需要一些复杂的数据共享机制)。</li><li id="78fd" class="ky kz in kc b kd lh kh li kl lj kp lk kt ll kx ld le lf lg bi translated">当组件正常情况下应该做且只能做一件事情时，强制组件获取并显示数据(在理想情况下)。</li></ul><p id="74e2" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">然后，当我意识到这个解决方案不可伸缩时，我决定将数据存储在服务中。尽管这是一个更好的解决方案，但由于某些原因，它并不是一个完美的解决方案:</p><ul class=""><li id="b661" class="ky kz in kc b kd ke kh ki kl la kp lb kt lc kx ld le lf lg bi translated">当数据在服务之间被分割时，从一个服务访问另一个服务的数据就打开了循环依赖的大门。</li><li id="41c3" class="ky kz in kc b kd lh kh li kl lj kp lk kt ll kx ld le lf lg bi translated">如果您使用“OnPush”变更检测策略(正如您应该做的那样)，您需要某种方式来告诉使用数据的组件，它们已经为Angular更新了视图。</li></ul><p id="d43a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">就在那时，我遇到了我的第一个循环依赖问题，于是我决定看看NgRx哦，天哪，我认真考虑过尝试修复循环依赖问题。</p><p id="fc18" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">不要误解我，我确信这个库做了它应该做的事情，但是我发现它很难使用。您需要创建动作，然后是reducers，然后是选择器。你还必须为异步操作创造效果，等等…然后，在所有这些之后，你必须把所有的东西绑在一起，并希望它能工作，因为如果你必须调试一个问题，你会在一个有趣的时刻…</p><p id="16d0" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">让我们也坦诚一些:我很快就放弃了。当我看到这个库的复杂性时，我决定另辟蹊径。再说一次，我不是在贬低这个库，我肯定很多人喜欢使用它并且完全理解它，但是我…嗯…</p><p id="ca37" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">也是在这个时候，我决定我必须提高我对RxJS的了解，所以这是建立我自己的商店管理系统的完美时机，这就是我通过创建<a class="ae jz" href="https://github.com/ssougnez/ng-store" rel="noopener ugc nofollow" target="_blank"> ng-store </a>所做的。</p><p id="7fe7" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这个库旨在关注数据:加载、创建、更新和删除数据。以下是该库功能的简短列表:</p><ul class=""><li id="f47f" class="ky kz in kc b kd ke kh ki kl la kp lb kt lc kx ld le lf lg bi translated">以一种高效的方式存储您的数据，以便能够快速找到它们。</li><li id="5243" class="ky kz in kc b kd lh kh li kl lj kp lk kt ll kx ld le lf lg bi translated">支持索引，以便根据字段值快速查找值。</li><li id="3f37" class="ky kz in kc b kd lh kh li kl lj kp lk kt ll kx ld le lf lg bi translated">支持使用REST API调用加载、创建、更新和删除数据。</li><li id="ec91" class="ky kz in kc b kd lh kh li kl lj kp lk kt ll kx ld le lf lg bi translated">支持加载/添加/更新/删除指示器，以便根据数据状态更新UI。</li><li id="60c1" class="ky kz in kc b kd lh kh li kl lj kp lk kt ll kx ld le lf lg bi translated">支持不变性，不需要使用spread运算符来基于旧对象创建新对象。基本上，您可以像使用可变对象一样更新存储中的数据。</li><li id="222f" class="ky kz in kc b kd lh kh li kl lj kp lk kt ll kx ld le lf lg bi translated">提供了一个组件，用于减少锅炉板的加载和显示数据。</li><li id="1dd8" class="ky kz in kc b kd lh kh li kl lj kp lk kt ll kx ld le lf lg bi translated">您以一种被动的方式从存储中选择数据，允许您使用“OnPush”更改检测策略在数据更改时自动刷新视图。</li><li id="9bad" class="ky kz in kc b kd lh kh li kl lj kp lk kt ll kx ld le lf lg bi translated">支持部分数据加载，允许您仅在需要所有数据时才完全加载实体。</li></ul><p id="2f0a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">让我们看一个如何使用ng-store加载数据的简单例子。</p><p id="5170" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">首先，您必须创建想要存储的数据的模型:</p><figure class="lm ln lo lp gt jo"><div class="bz fp l di"><div class="lq lr l"/></div></figure><p id="423b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">然后，创建状态的形状及其初始值:</p><figure class="lm ln lo lp gt jo"><div class="bz fp l di"><div class="lq lr l"/></div></figure><p id="9672" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">一旦你有了这个，你就可以调用一个函数来加载你想要的数据到存储中。您可以加载所有数据，或者只加载其中的一部分，或者基于id加载特定的值，或者甚至基于条件加载一些实体。</p><p id="afa2" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在这里，让我们加载商店中的所有口袋妖怪:</p><figure class="lm ln lo lp gt jo"><div class="bz fp l di"><div class="lq lr l"/></div></figure><p id="c48b" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">下面是显示所有口袋妖怪列表的组件的样子:</p><figure class="lm ln lo lp gt jo"><div class="bz fp l di"><div class="lq lr l"/></div></figure><figure class="lm ln lo lp gt jo"><div class="bz fp l di"><div class="lq lr l"/></div></figure><p id="4e1e" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如您所见，这非常简单，ngs容器的优点是它处理请求的不同状态。事实上，在执行REST调用时，会自动显示一个加载指示器，如果出现错误，这个指示器会自动显示在组件中。当然，您可以使用注入令牌或直接使用ngs-container的属性，以全局方式完全定制加载指示器的外观以及错误的外观。</p><p id="ab49" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这是一个使用商店的简单例子，但是如果我激起了你的兴趣，我邀请你阅读这个包的完整文档以更好地了解它提供的所有功能。</p><h2 id="f458" class="ls lt in bd lu lv lw dn lx ly lz dp ma kl mb mc md kp me mf mg kt mh mi mj mk bi translated">更多内容请访问<a class="ae jz" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> PlainEnglish.io </a>。</h2><p id="e8a0" class="pw-post-body-paragraph ka kb in kc b kd ml kf kg kh mm kj kk kl mn kn ko kp mo kr ks kt mp kv kw kx ig bi translated"><em class="mq">报名参加我们的</em> <a class="ae jz" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kc io"> <em class="mq">免费周报</em> </strong> </a> <em class="mq">。关注我们上</em> <a class="ae jz" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"> <strong class="kc io"> <em class="mq">推特</em> </strong> </a>，<a class="ae jz" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"> <strong class="kc io"> <em class="mq">领英</em> </strong> </a> <strong class="kc io"> <em class="mq">，</em></strong><a class="ae jz" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"><strong class="kc io"><em class="mq">YouTube</em></strong></a><strong class="kc io"><em class="mq">，以及</em></strong><em class="mq"/><a class="ae jz" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"><strong class="kc io"><em class="mq">不和</em> </strong> </a>T47】</p><h2 id="9278" class="ls lt in bd lu lv lw dn lx ly lz dp ma kl mb mc md kp me mf mg kt mh mi mj mk bi translated">想扩大你的软件创业规模吗？检查<a class="ae jz" href="https://circuit.ooo/?utm=publication-post-cta" rel="noopener ugc nofollow" target="_blank">电路</a>。</h2></div></div>    
</body>
</html>