<html>
<head>
<title>How to Create a Sankey Diagram (with JavaScript)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何创建桑基图(用JavaScript)</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-create-a-sankey-diagram-with-javascript-ca4fb8a66594?source=collection_archive---------15-----------------------#2022-05-25">https://javascript.plainenglish.io/how-to-create-a-sankey-diagram-with-javascript-ca4fb8a66594?source=collection_archive---------15-----------------------#2022-05-25</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/0923a1d80b21d2cc863b6f0630499a98.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ZVEgM06F8yZV7-kC.png"/></div></div></figure><p id="812d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">你想学习如何快速创建一个非常酷的图表，称为桑基图吗？你来对地方了！我们将一起使用JavaScript构建一个优雅的<a class="ae kt" href="https://www.anychart.com/chartopedia/chart-type/sankey-diagram/" rel="noopener ugc nofollow" target="_blank">桑基图表</a>，然后你将能够毫不费力地自己制作这样的数据可视化。</p><p id="a426" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">Sankey图描述了值从一个集合到另一个集合的流动，当您需要图形化地表示两个域或多个阶段的多个路径之间的多对多映射时，它是理想的选择。因此，制作它们的能力将是处理<a class="ae kt" href="https://www.anychart.com/blog/2018/11/20/data-visualization-definition-history-examples/" rel="noopener ugc nofollow" target="_blank">数据可视化</a>设计和开发的任何人的技能集的一大补充。</p><p id="6e89" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在1912年4月15日沉没110年后,<a class="ae kt" href="https://en.wikipedia.org/wiki/Titanic" rel="noopener ugc nofollow" target="_blank">泰坦尼克号</a>仍然让我们着迷，激发着人们的想象力。现在，我们将使用JS Sankey图表技术来查看其乘客和机组人员，并根据性别、年龄和机票等级找出幸存者和遇难者。跟着走！</p><h1 id="6146" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">桑基图预览</h1><p id="0b6d" class="pw-post-body-paragraph jv jw in jx b jy ls ka kb kc lt ke kf kg lu ki kj kk lv km kn ko lw kq kr ks ig bi translated">看一看我们将在本教程结束时构建的Sankey图:</p><figure class="ly lz ma mb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lx"><img src="../Images/8de07092b2d85ebc82d579a18fae074f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*t53wYAttjHVNVqTN.gif"/></div></div></figure><p id="b493" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在，旅程开始了——继续阅读，了解如何使用纯JavaScript构建这样的桑基图！</p><h1 id="27c8" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">构建一个基本的JS桑基图</h1><p id="8018" class="pw-post-body-paragraph jv jw in jx b jy ls ka kb kc lt ke kf kg lu ki kj kk lv km kn ko lw kq kr ks ig bi translated">Sankey图看起来非常令人兴奋，并且很容易用JS创建。web技术的一些基本知识在交互式数据可视化中总是有益的。但在现实中，一切都不复杂，即使你是初学者，你也会明白这一切。</p><p id="a007" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">创建基于JavaScript的Sankey图的过程可以分为四个步骤:</p><ol class=""><li id="6df3" class="mc md in jx b jy jz kc kd kg me kk mf ko mg ks mh mi mj mk bi translated">创建一个HTML页面。</li><li id="bfa1" class="mc md in jx b jy ml kc mm kg mn kk mo ko mp ks mh mi mj mk bi translated">添加脚本。</li><li id="a30e" class="mc md in jx b jy ml kc mm kg mn kk mo ko mp ks mh mi mj mk bi translated">设置数据。</li><li id="0a4c" class="mc md in jx b jy ml kc mm kg mn kk mo ko mp ks mh mi mj mk bi translated">写一些JS代码。</li></ol><p id="fc87" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">让我们一起来过一遍。</p><h2 id="badf" class="mq kv in bd kw mr ms dn la mt mu dp le kg mv mw li kk mx my lm ko mz na lq nb bi translated">1.创建HTML页面</h2><p id="e0f9" class="pw-post-body-paragraph jv jw in jx b jy ls ka kb kc lt ke kf kg lu ki kj kk lv km kn ko lw kq kr ks ig bi translated">首先，创建一个基本的HTML页面来保存预期的Sankey图表，并在其中定义一个block元素。</p><p id="a60e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">为了在后面的代码中引用这个<code class="fe nc nd ne nf b">&lt;div&gt;</code>，给它一个标识属性(在这个例子中是“container”)并设置所需的样式属性(这里，宽度和高度是100%，这将让图表伸展到整个web页面)。</p><pre class="ly lz ma mb gt ng nf nh ni aw nj bi"><span id="b3d9" class="mq kv in nf b gy nk nl l nm nn">&lt;html&gt;<br/>  &lt;head&gt;<br/>    &lt;title&gt;JavaScript Sankey Diagram&lt;/title&gt;<br/>    &lt;style type="text/css"&gt;      <br/>      html, body, #container { <br/>        width: 100%; height: 100%; margin: 0; padding: 0; <br/>      } <br/>    &lt;/style&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;div id="container"&gt;&lt;/div&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><h2 id="a277" class="mq kv in bd kw mr ms dn la mt mu dp le kg mv mw li kk mx my lm ko mz na lq nb bi translated">2.添加脚本</h2><p id="ed17" class="pw-post-body-paragraph jv jw in jx b jy ls ka kb kc lt ke kf kg lu ki kj kk lv km kn ko lw kq kr ks ig bi translated">下一步是添加必要的脚本。</p><p id="06cd" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在本教程中，我使用的是<a class="ae kt" href="https://www.anychart.com" rel="noopener ugc nofollow" target="_blank"> AnyChart JavaScript库</a>。由于其全面的<a class="ae kt" href="https://docs.anychart.com/" rel="noopener ugc nofollow" target="_blank">文档</a>以及许多现成的<a class="ae kt" href="https://www.anychart.com/products/anychart/gallery/" rel="noopener ugc nofollow" target="_blank">图表示例</a>，它非常灵活且易于使用。</p><p id="7426" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">AnyChart是模块化的，它允许您通过连接您实际需要的图表类型和特性来最小化在您的网页上运行的JavaScript代码的大小，仅此而已。对于桑基图表开发，您只需要<a class="ae kt" href="https://docs.anychart.com/Quick_Start/Modules#core" rel="noopener ugc nofollow" target="_blank">核心模块</a>以及特定的<a class="ae kt" href="https://docs.anychart.com/Quick_Start/Modules#sankey_diagram" rel="noopener ugc nofollow" target="_blank">桑基模块</a>。将两者都添加到HTML页面的<code class="fe nc nd ne nf b">&lt;head&gt;</code>部分。</p><pre class="ly lz ma mb gt ng nf nh ni aw nj bi"><span id="25d7" class="mq kv in nf b gy nk nl l nm nn">&lt;html&gt;<br/>  &lt;head&gt;<br/>    &lt;title&gt;JavaScript Sankey Diagram&lt;/title&gt;<br/>    &lt;script src="https://cdn.anychart.com/releases/8.11.0/js/anychart-core.min.js"&gt;&lt;/script&gt;<br/>    &lt;script src="https://cdn.anychart.com/releases/8.11.0/js/anychart-sankey.min.js"&gt;&lt;/script&gt;<br/>    &lt;style type="text/css"&gt;      <br/>      html, body, #container { <br/>        width: 100%; height: 100%; margin: 0; padding: 0; <br/>      } <br/>    &lt;/style&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;  <br/>    &lt;div id="container"&gt;&lt;/div&gt;<br/>    &lt;script&gt;<br/><strong class="nf io"><em class="no">      // All the code for the JS Sankey Diagram will come here.<br/></em></strong>    &lt;/script&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><h2 id="9e97" class="mq kv in bd kw mr ms dn la mt mu dp le kg mv mw li kk mx my lm ko mz na lq nb bi translated">3.设置数据</h2><p id="1d63" class="pw-post-body-paragraph jv jw in jx b jy ls ka kb kc lt ke kf kg lu ki kj kk lv km kn ko lw kq kr ks ig bi translated">本教程的数据取自Kaggle上的<a class="ae kt" href="https://www.kaggle.com/datasets/ibrahimelsayed182/titanic-dataset" rel="noopener ugc nofollow" target="_blank">泰坦尼克号数据集</a>。我只是把它放在一个适合桑基图的形式中。</p><p id="264e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">数据集并不大，可以就这样直接添加到代码中。(当然，对于特定的任务，你可以选择另一种方式<a class="ae kt" href="https://docs.anychart.com/Working_with_Data/Overview" rel="noopener ugc nofollow" target="_blank">处理数据</a>。)</p><pre class="ly lz ma mb gt ng nf nh ni aw nj bi"><span id="cd9b" class="mq kv in nf b gy nk nl l nm nn">const data = [<br/>  {from: 'First Class', to: 'Child', value: 6},<br/>  {from: 'Second Class', to: 'Child', value: 24},<br/>  {from: 'Third Class', to: 'Child', value: 79},<br/>  {from: 'Crew', to: 'Child', value: 0},<br/>  {from: 'First Class', to: 'Adult', value: 319},<br/>  {from: 'Second Class', to: 'Adult', value: 261},<br/>  {from: 'Third Class', to: 'Adult', value: 627},<br/>  {from: 'Crew', to: 'Adult', value: 885},<br/>  {from: 'Child', to: 'Female', value: 45},<br/>  {from: 'Child', to: 'Male', value: 64},<br/>  {from: 'Adult', to: 'Female', value: 425},<br/>  {from: 'Adult', to: 'Male', value: 1667},<br/>  {from: 'Female', to: 'Survived', value: 344},<br/>  {from: 'Female', to: 'Perished', value: 126},<br/>  {from: 'Male', to: 'Survived', value: 367},<br/>  {from: 'Male', to: 'Perished', value: 1364},<br/>]</span></pre><p id="65f2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">好了，大家都准备好了，现在是时候通过编写几行JS图表代码扬帆起航了！</p><h2 id="a677" class="mq kv in bd kw mr ms dn la mt mu dp le kg mv mw li kk mx my lm ko mz na lq nb bi translated">4.写一些JS代码</h2><p id="240f" class="pw-post-body-paragraph jv jw in jx b jy ls ka kb kc lt ke kf kg lu ki kj kk lv km kn ko lw kq kr ks ig bi translated">如果你没有太多的编写代码的经验，你可能会觉得很难。但是对于一个优雅的Sankey图，一些非常简单的基本代码就足够了。</p><p id="19bb" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在做任何事情之前，添加包含所有代码的<code class="fe nc nd ne nf b">anychart.onDocumentReady()</code>函数，这确保了只有当页面准备就绪时，其中的所有内容才会运行。里面首先要补充的是数据。</p><pre class="ly lz ma mb gt ng nf nh ni aw nj bi"><span id="3560" class="mq kv in nf b gy nk nl l nm nn">anychart.onDocumentReady(function () {</span><span id="6527" class="mq kv in nf b gy np nl l nm nn"><strong class="nf io"><em class="no">  // add data<br/></em></strong>  const data = [<br/>    {from: 'First Class', to: 'Child', value: 6},<br/>    {from: 'Second Class', to: 'Child', value: 24},<br/>    {from: 'Third Class', to: 'Child', value: 79},<br/>    {from: 'Crew', to: 'Child', value: 0},<br/>    {from: 'First Class', to: 'Adult', value: 319},<br/>    {from: 'Second Class', to: 'Adult', value: 261},<br/>    {from: 'Third Class', to: 'Adult', value: 627},<br/>    {from: 'Crew', to: 'Adult', value: 885},<br/>    {from: 'Child', to: 'Female', value: 45},<br/>    {from: 'Child', to: 'Male', value: 64},<br/>    {from: 'Adult', to: 'Female', value: 425},<br/>    {from: 'Adult', to: 'Male', value: 1667},<br/>    {from: 'Female', to: 'Survived', value: 344},<br/>    {from: 'Female', to: 'Perished', value: 126},<br/>    {from: 'Male', to: 'Survived', value: 367},<br/>    {from: 'Male', to: 'Perished', value: 1364},<br/>  ]</span><span id="8c18" class="mq kv in nf b gy np nl l nm nn"><strong class="nf io"><em class="no">  // everything else goes here<br/></em></strong> <br/>});</span></pre><p id="0947" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在，使用内置的图表功能创建一个Sankey diagram实例并加载数据。</p><pre class="ly lz ma mb gt ng nf nh ni aw nj bi"><span id="6b88" class="mq kv in nf b gy nk nl l nm nn">let chart = anychart.sankey();<br/>chart.data(data);</span></pre><p id="151e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">一些填充可以确保标签不会被剪掉，图表标题总是很有帮助。</p><pre class="ly lz ma mb gt ng nf nh ni aw nj bi"><span id="d837" class="mq kv in nf b gy nk nl l nm nn">chart.padding(20, 40);  <br/>chart.title('Titanic Survivors');</span></pre><p id="f880" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">最后，只需引用容器元素来显示Sankey图表需要显示的位置，并绘制结果可视化。</p><pre class="ly lz ma mb gt ng nf nh ni aw nj bi"><span id="4ffe" class="mq kv in nf b gy nk nl l nm nn">chart.container('container');<br/>chart.draw();</span></pre><p id="e48b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">瞧啊。一个奇妙而实用的基于JavaScript的Sankey图已经准备好了！</p><figure class="ly lz ma mb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nq"><img src="../Images/7b26a0caf58e4c1ebbe2e1ff51c5212d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*AfLVSdcXWGIICx3C.png"/></div></div></figure><p id="75fe" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">看看这个在AnyChart Playground 上的初始JS Sankey图表，其中有完整的JS/CSS/HTML代码(为了方便起见，也在下面提供)。</p><pre class="ly lz ma mb gt ng nf nh ni aw nj bi"><span id="632a" class="mq kv in nf b gy nk nl l nm nn">&lt;html&gt;<br/>  &lt;head&gt;<br/>    &lt;title&gt;JavaScript Sankey Diagram&lt;/title&gt;<br/>    &lt;script src="https://cdn.anychart.com/releases/8.11.0/js/anychart-core.min.js"&gt;&lt;/script&gt;<br/>    &lt;script src="https://cdn.anychart.com/releases/8.11.0/js/anychart-sankey.min.js"&gt;&lt;/script&gt;<br/>    &lt;style type="text/css"&gt;      <br/>      html, body, #container { <br/>        width: 100%; height: 100%; margin: 0; padding: 0; <br/>      } <br/>    &lt;/style&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;  <br/>    &lt;div id="container"&gt;&lt;/div&gt;<br/>    &lt;script&gt;<br/>      anychart.onDocumentReady(function () {<br/>  <br/><strong class="nf io"><em class="no">        // add data<br/></em></strong>        const data = [<br/>          {from: "First Class", to: "Child", value: 6},<br/>          {from: "Second Class", to: "Child", value: 24},<br/>          {from: "Third Class", to: "Child", value: 79},<br/>          {from: "Crew", to: "Child", value: 0},<br/>          {from: "First Class", to: "Adult", value: 319},<br/>          {from: "Second Class", to: "Adult", value: 261},<br/>          {from: "Third Class", to: "Adult", value: 627},<br/>          {from: "Crew", to: "Adult", value: 885},<br/>          {from: "Child", to: "Female", value: 45},<br/>          {from: "Child", to: "Male", value: 64},<br/>          {from: "Adult", to: "Female", value: 425},<br/>          {from: "Adult", to: "Male", value: 1667},<br/>          {from: "Female", to: "Survived", value: 344},<br/>          {from: "Female", to: "Perished", value: 126},<br/>          {from: "Male", to: "Survived", value: 367},<br/>          {from: "Male", to: "Perished", value: 1364}<br/>        ];<br/>  <br/><strong class="nf io"><em class="no">        // create a sankey diagram instance<br/></em></strong>        let chart = anychart.sankey();</span><span id="a2d4" class="mq kv in nf b gy np nl l nm nn"><strong class="nf io"><em class="no">        // load the data to the sankey diagram instance<br/></em></strong>        chart.data(data);</span><span id="ecb0" class="mq kv in nf b gy np nl l nm nn"><strong class="nf io"><em class="no">        // set the chart's padding<br/></em></strong>        chart.padding(20, 40);<br/>  <br/><strong class="nf io"><em class="no">        // add a title<br/></em></strong>        chart.title('Titanic Survivors');<br/>  <br/><strong class="nf io"><em class="no">        // set the chart container id<br/></em></strong>        chart.container("container");</span><span id="3127" class="mq kv in nf b gy np nl l nm nn"><strong class="nf io"><em class="no">        // draw the chart<br/></em></strong>        chart.draw();<br/>  <br/>      });<br/>    &lt;/script&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><h1 id="1910" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">自定义JavaScript桑基图</h1><p id="3126" class="pw-post-body-paragraph jv jw in jx b jy ls ka kb kc lt ke kf kg lu ki kj kk lv km kn ko lw kq kr ks ig bi translated">使用健壮的JS图表库的一个巨大优势是创建初始数据可视化的简易性和进一步定制的灵活性。让我们看看如何增强Sankey图的功能，并通过一些简单的修改来调整它的外观。</p><h2 id="5b6f" class="mq kv in bd kw mr ms dn la mt mu dp le kg mv mw li kk mx my lm ko mz na lq nb bi translated">1.调色板</h2><p id="532d" class="pw-post-body-paragraph jv jw in jx b jy ls ka kb kc lt ke kf kg lu ki kj kk lv km kn ko lw kq kr ks ig bi translated">首先，为什么不添加比默认颜色看起来更直观的颜色呢？您可以通过简单地列出您想要的颜色来创建自己的调色板。添加颜色时要注意顺序。</p><pre class="ly lz ma mb gt ng nf nh ni aw nj bi"><span id="2bec" class="mq kv in nf b gy nk nl l nm nn">chart.palette([<br/>  "#f5dc50",<br/>  "#e1a03c",<br/>  "#c87d5a",<br/>  "#fff0c8",<br/>  "#aa96b4",<br/>  "#6e5a7d",<br/>  "#e19196",<br/>  "#419bd2",<br/>  "#46afaa",<br/>  "#5a5050"<br/>]);</span></pre><h2 id="872e" class="mq kv in bd kw mr ms dn la mt mu dp le kg mv mw li kk mx my lm ko mz na lq nb bi translated">2.节点</h2><p id="8e06" class="pw-post-body-paragraph jv jw in jx b jy ls ka kb kc lt ke kf kg lu ki kj kk lv km kn ko lw kq kr ks ig bi translated">现在你已经有了一个个性化的调色板，让我们增加节点的宽度，使它们更加突出。对于较大的节点，还可以在它们之间进行更大的填充。</p><pre class="ly lz ma mb gt ng nf nh ni aw nj bi"><span id="26cd" class="mq kv in nf b gy nk nl l nm nn">chart.nodeWidth("40%");<br/>chart.nodePadding(30);</span></pre><p id="1bce" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">更大的标签可能看起来也更好。另外，对于每个节点，您可以显示数据中相应的值，并利用HTML来格式化文本。</p><pre class="ly lz ma mb gt ng nf nh ni aw nj bi"><span id="31a2" class="mq kv in nf b gy nk nl l nm nn">chart.node().normal().labels().fontSize(14);<br/>chart.node().labels().useHtml(true);<br/>chart<br/>  .node()<br/>  .labels()<br/>  .format("&lt;span style='font-weight:bold'&gt;{%name}&lt;/span&gt;&lt;br&gt;{%value}");</span></pre><figure class="ly lz ma mb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nq"><img src="../Images/70d96090d4906628c441dd425fcf2bfb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*6J3MHFGUdfSM8RP_.png"/></div></div></figure><p id="c1c9" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在<a class="ae kt" href="https://playground.anychart.com/2NjCcNFk" rel="noopener ugc nofollow" target="_blank"> AnyChart游乐场</a>上看看这个定制的基于JavaScript的Sankey图的代码。</p><h2 id="aad1" class="mq kv in bd kw mr ms dn la mt mu dp le kg mv mw li kk mx my lm ko mz na lq nb bi translated">3.链接</h2><p id="677a" class="pw-post-body-paragraph jv jw in jx b jy ls ka kb kc lt ke kf kg lu ki kj kk lv km kn ko lw kq kr ks ig bi translated">现在是时候增强链接的外观了。让我们用和它们的源节点一样的颜色来给它们着色。此外，当鼠标悬停在链接上时，链接会显得稍微暗一些。</p><pre class="ly lz ma mb gt ng nf nh ni aw nj bi"><span id="ebe0" class="mq kv in nf b gy nk nl l nm nn">chart.flow({<br/>  normal: {<br/>    fill: function () {<br/>      return anychart.color.lighten(this.sourceColor, 0.5) + " " + 0.3;<br/>    }<br/>  },<br/>  hovered: {<br/>    fill: function () {<br/>      return this.sourceColor + " " + 0.8;<br/>    }<br/>  }<br/>});</span></pre><p id="aa32" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">悬停在一个节点或一个链接上会触发一个工具提示，它甚至不需要修改，因为它非常有用，默认情况下看起来很好。</p><h2 id="6a57" class="mq kv in bd kw mr ms dn la mt mu dp le kg mv mw li kk mx my lm ko mz na lq nb bi translated">4.标题</h2><p id="c10d" class="pw-post-body-paragraph jv jw in jx b jy ls ka kb kc lt ke kf kg lu ki kj kk lv km kn ko lw kq kr ks ig bi translated">对于最后的定制，让我们应用基于HTML的格式来突出标题，并添加一个副标题来更清楚地说明Sankey图可视化的内容。</p><pre class="ly lz ma mb gt ng nf nh ni aw nj bi"><span id="e779" class="mq kv in nf b gy nk nl l nm nn">chart<br/>  .title()<br/>  .enabled(true)<br/>  .useHtml(true)<br/>  .text(<br/>    '&lt;span style = "color: #2b2b2b; font-size:20px;"&gt;Titanic Survivors&lt;/span&gt;' +<br/>      '&lt;br/&gt;&lt;span style="color:#00bfa5; font-size: 16px;"&gt;(by gender, age, ticket class)&lt;/span&gt;'<br/>  );</span></pre><p id="8a04" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">仅此而已！现在桑基图看起来非常个性化和迷人，不是吗？</p><figure class="ly lz ma mb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nq"><img src="../Images/384d1a393d84b1b2c395151e4b15b21e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*aPe12AzvRlMgLZDs.png"/></div></div></figure><p id="69e9" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">查看下面的交互式JavaScript Sankey图的最终代码，并在<a class="ae kt" href="https://playground.anychart.com/fiKvNzuZ" rel="noopener ugc nofollow" target="_blank"> AnyChart游乐场</a>上玩得开心。</p><pre class="ly lz ma mb gt ng nf nh ni aw nj bi"><span id="935d" class="mq kv in nf b gy nk nl l nm nn">&lt;html&gt;<br/>  &lt;head&gt;<br/>    &lt;title&gt;JavaScript Sankey Diagram&lt;/title&gt;<br/>    &lt;script src="https://cdn.anychart.com/releases/8.11.0/js/anychart-core.min.js"&gt;&lt;/script&gt;<br/>    &lt;script src="https://cdn.anychart.com/releases/8.11.0/js/anychart-sankey.min.js"&gt;&lt;/script&gt;<br/>    &lt;style type="text/css"&gt;      <br/>      html, body, #container { <br/>        width: 100%; height: 100%; margin: 0; padding: 0; <br/>      } <br/>    &lt;/style&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;  <br/>    &lt;div id="container"&gt;&lt;/div&gt;<br/>    &lt;script&gt;<br/>      anychart.onDocumentReady(function () {<br/>  <br/><strong class="nf io"><em class="no">        // add data<br/></em></strong>        const data = [<br/>          {from: "First Class", to: "Child", value: 6},<br/>          {from: "Second Class", to: "Child", value: 24},<br/>          {from: "Third Class", to: "Child", value: 79},<br/>          {from: "Crew", to: "Child", value: 0},<br/>          {from: "First Class", to: "Adult", value: 319},<br/>          {from: "Second Class", to: "Adult", value: 261},<br/>          {from: "Third Class", to: "Adult", value: 627},<br/>          {from: "Crew", to: "Adult", value: 885},<br/>          {from: "Child", to: "Female", value: 45},<br/>          {from: "Child", to: "Male", value: 64},<br/>          {from: "Adult", to: "Female", value: 425},<br/>          {from: "Adult", to: "Male", value: 1667},<br/>          {from: "Female", to: "Survived", value: 344},<br/>          {from: "Female", to: "Perished", value: 126},<br/>          {from: "Male", to: "Survived", value: 367},<br/>          {from: "Male", to: "Perished", value: 1364}<br/>        ];<br/>  <br/><strong class="nf io"><em class="no">        // create a sankey diagram instance<br/></em></strong>        let chart = anychart.sankey();</span><span id="9c6f" class="mq kv in nf b gy np nl l nm nn"><strong class="nf io"><em class="no">        // load the data to the sankey diagram instance<br/></em></strong>        chart.data(data);</span><span id="b84f" class="mq kv in nf b gy np nl l nm nn"><strong class="nf io"><em class="no">        // set the chart's padding<br/></em></strong>        chart.padding(20, 40);</span><span id="4f1c" class="mq kv in nf b gy np nl l nm nn"><strong class="nf io"><em class="no">        // configure a custom color palette<br/></em></strong>        chart.palette([<br/>          "#f5dc50",<br/>          "#e1a03c",<br/>          "#c87d5a",<br/>          "#fff0c8",<br/>          "#aa96b4",<br/>          "#6e5a7d",<br/>          "#e19196",<br/>          "#419bd2",<br/>          "#46afaa",<br/>          "#5a5050"<br/>        ]);<br/>  <br/><strong class="nf io"><em class="no">        // customize the nodes:<br/>        // set the width<br/></em></strong>        chart.nodeWidth("40%");<br/><strong class="nf io"><em class="no">        // set the padding<br/></em></strong>        chart.nodePadding(30);<br/><strong class="nf io"><em class="no">        // customize the labels<br/></em></strong>        chart.node().normal().labels().fontSize(14);<br/>        chart.node().labels().useHtml(true);<br/>        chart<br/>          .node()<br/>          .labels()<br/>          .format("&lt;span style='font-weight:bold'&gt;{%name}&lt;/span&gt;&lt;br&gt;{%value}");</span><span id="a591" class="mq kv in nf b gy np nl l nm nn"><strong class="nf io"><em class="no">        // customize the links<br/></em></strong>        chart.flow({<br/>          normal: {<br/>            fill: function () {<br/>              return anychart.color.lighten(this.sourceColor, 0.5) + " " + 0.3;<br/>            }<br/>          },<br/>          hovered: {<br/>            fill: function () {<br/>              return this.sourceColor + " " + 0.8;<br/>            }<br/>          }<br/>        });</span><span id="4f58" class="mq kv in nf b gy np nl l nm nn"><strong class="nf io"><em class="no">        // add a title and customize it<br/></em></strong>        chart<br/>          .title()<br/>          .enabled(true)<br/>          .useHtml(true)<br/>          .text(<br/>            '&lt;span style = "color: #2b2b2b; font-size:20px;"&gt;Titanic Survivors&lt;/span&gt;' +<br/>              '&lt;br/&gt;&lt;span style="color:#00bfa5; font-size: 16px;"&gt;(by gender, age, ticket class)&lt;/span&gt;'<br/>          );<br/>  <br/><strong class="nf io"><em class="no">        // set the chart container id<br/></em></strong>        chart.container("container");</span><span id="b7f0" class="mq kv in nf b gy np nl l nm nn"><strong class="nf io"><em class="no">        // draw the chart<br/></em></strong>        chart.draw();<br/>  <br/>      });<br/>    &lt;/script&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><h1 id="d4aa" class="ku kv in bd kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr bi translated">结论</h1><p id="d19a" class="pw-post-body-paragraph jv jw in jx b jy ls ka kb kc lt ke kf kg lu ki kj kk lv km kn ko lw kq kr ks ig bi translated">桑基是如此迷人的图表类型。创造一个美丽的是如此简单！</p><p id="f049" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">实际上，这只是冰山一角，所以继续下去，看看更多的桑基图的<a class="ae kt" href="https://www.anychart.com/products/anychart/gallery/Sankey_Diagram" rel="noopener ugc nofollow" target="_blank">示例，并查看</a><a class="ae kt" href="https://docs.anychart.com/Basic_Charts/Sankey_Diagram" rel="noopener ugc nofollow" target="_blank">桑基图文档</a>来学习如何做一些关于它们的其他事情。此外，请随意查看其他图表类型。</p><p id="15a3" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如有任何疑问或建议，请与我们联系。</p></div><div class="ab cl nr ns hr nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="ig ih ii ij ik"><p id="271f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">AnyChart的团队感谢数据设计师Shachee Swadia创建了这个伟大的Sankey图解教程。T3】</p><p id="20c8" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"> <em class="no">如果你想写一篇很酷的客座博文，请将你的想法发送到我们的</em> </strong> <a class="ae kt" href="https://www.anychart.com/support/" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io"> <em class="no">支持团队</em> </strong> </a> <strong class="jx io"> <em class="no">。</em> </strong></p><p id="40da" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"> <em class="no">查看我们博客上更多</em></strong><a class="ae kt" href="https://www.anychart.com/blog/category/javascript-chart-tutorials/" rel="noopener ugc nofollow" target="_blank"><strong class="jx io"><em class="no">JavaScript制图教程</em> </strong> </a> <strong class="jx io"> <em class="no">。</em> </strong></p></div><div class="ab cl nr ns hr nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="ig ih ii ij ik"><p id="1784" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="no">原载于2022年5月25日https://www.anychart.com</em><a class="ae kt" href="https://www.anychart.com/blog/2022/05/25/sankey-diagram-js/" rel="noopener ugc nofollow" target="_blank"><em class="no"/></a><em class="no">。</em></p></div><div class="ab cl nr ns hr nt" role="separator"><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw nx"/><span class="nu bw bk nv nw"/></div><div class="ig ih ii ij ik"><p id="d302" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="no">更多内容看</em> <a class="ae kt" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io"> <em class="no">说白了。报名参加我们的</em> <a class="ae kt" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io"> <em class="no">免费周报</em> </strong> </a> <em class="no">。关注我们关于</em><a class="ae kt" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="jx io"><em class="no">Twitter</em></strong></a><em class="no">和</em><a class="ae kt" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="jx io"><em class="no">LinkedIn</em></strong></a><em class="no">。查看我们的</em> <a class="ae kt" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io"> <em class="no">社区不和谐</em> </strong> </a> <em class="no">加入我们的</em> <a class="ae kt" href="https://inplainenglish.pallet.com/talent/welcome" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io"> <em class="no">人才集体</em> </strong> </a> <em class="no">。</em></strong></a></p></div></div>    
</body>
</html>