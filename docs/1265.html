<html>
<head>
<title>A Beginner’s Guide to JavaScript Proxies</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript代理初学者指南</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/javascript-proxies-a-beginners-guide-2aceeab0a098?source=collection_archive---------3-----------------------#2022-03-12">https://javascript.plainenglish.io/javascript-proxies-a-beginners-guide-2aceeab0a098?source=collection_archive---------3-----------------------#2022-03-12</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="1a0b" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">JavaScript中的代理概述。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/20aeed03e2adddb7e77547b96f78d5d9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QPgIerxoNPJbe6A1ZE5GRQ.png"/></div></div></figure><p id="43e2" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">JavaScript中的代理是语言中隐藏的瑰宝之一，大多数JavaScript初学者和中级开发人员都不知道。根据<a class="ae lk" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy" rel="noopener ugc nofollow" target="_blank"> MDN </a>文档，<code class="fe ll lm ln lo b">Proxy</code>对象允许你创建一个可以用来代替原始对象的对象，但是它可以重新定义基本的<code class="fe ll lm ln lo b">Object</code>操作，比如获取、设置和定义属性。</p><p id="885f" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">从定义上看，代理可以用来干预对象的底层操作，例如，你可以扩展如何在函数上设置属性，你可以在定义如何设置或打印对象属性之前执行一些操作，等等。</p><p id="c492" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">为了解释这一点，请考虑一个场景，其中有一个表示用户配置文件的对象。</p><pre class="kd ke kf kg gt lp lo lq lr aw ls bi"><span id="733c" class="lt lu in lo b gy lv lw l lx ly">const profile = {<br/>  username: "Anderson",<br/>  image: "/path/to/img"<br/>}</span></pre><p id="1090" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在我们的应用程序中，我们希望能够更新用户名。但是在用户更新他们的用户名之前，您需要验证该名称是否被其他用户使用。一种方法是编写一个函数来验证用户名是否有效，另一种方法是使用代理。</p><p id="eb57" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我们首先初始化一个<code class="fe ll lm ln lo b">Proxy</code>对象的实例。构造函数接受两个参数:</p><ul class=""><li id="38f1" class="lz ma in kq b kr ks ku kv kx mb lb mc lf md lj me mf mg mh bi translated"><strong class="kq io">目标</strong>:你要代理的对象。</li><li id="4a4d" class="lz ma in kq b kr mi ku mj kx mk lb ml lf mm lj me mf mg mh bi translated"><strong class="kq io"> Handler </strong>:定义哪些操作将被拦截，以及如何重新定义被拦截的操作的对象。</li></ul><pre class="kd ke kf kg gt lp lo lq lr aw ls bi"><span id="18ad" class="lt lu in lo b gy lv lw l lx ly">let profile_proxy = new Proxy(profile, {/* handler blank for now */}</span></pre><p id="1495" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">至此，我们已经为概要文件对象创建了一个代理。现在要看的主要是handler对象。它用于确定我们想要在对象上定制的行为。首先，让我们定义一个<code class="fe ll lm ln lo b">set</code>属性。正如你可能猜到的，<code class="fe ll lm ln lo b">set</code>属性用于定制对象的设置方式。这是一个接受三个参数的函数。</p><ul class=""><li id="4c61" class="lz ma in kq b kr ks ku kv kx mb lb mc lf md lj me mf mg mh bi translated">对象:这是原始对象</li><li id="bb19" class="lz ma in kq b kr mi ku mj kx mk lb ml lf mm lj me mf mg mh bi translated">Prop:您试图设置的属性</li><li id="d093" class="lz ma in kq b kr mi ku mj kx mk lb ml lf mm lj me mf mg mh bi translated">值:要分配给属性的值。</li></ul><p id="10da" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">所以让我们重新定义我们的处理程序。</p><pre class="kd ke kf kg gt lp lo lq lr aw ls bi"><span id="d8be" class="lt lu in lo b gy lv lw l lx ly">const handler = {<br/>    set: (obj, prop, value) {<br/>        if (/* certain condition is met */) {<br/>            obj[prop] = value<br/>            return true;<br/>        } else {<br/>            throw new Error("Required condition not met")<br/>        }<br/>    }<br/>}</span></pre><p id="7a62" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在，我们可以在启动代理时传递handler对象:</p><pre class="kd ke kf kg gt lp lo lq lr aw ls bi"><span id="cb40" class="lt lu in lo b gy lv lw l lx ly">const profile_proxy = new Proxy(profile, handler)</span></pre><p id="0a88" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在，如果您试图将<code class="fe ll lm ln lo b">profile_proxy</code>对象中的<code class="fe ll lm ln lo b">username</code>设置为一个新值，它将首先评估您设置的条件，然后尽可能设置该对象，或者抛出一个新错误。</p><p id="ad80" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">注意:在初始化一个代理后，当试图修改变量时，你可以从代理中修改它，例如在上面的例子中你可以改变<code class="fe ll lm ln lo b">profile_proxy.username</code>而不是<code class="fe ll lm ln lo b">profile.username</code>，如果你调用<code class="fe ll lm ln lo b">profile.username</code>自定义设置器将不会运行。</p><p id="edc6" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在让我们定义get方法。</p><pre class="kd ke kf kg gt lp lo lq lr aw ls bi"><span id="1e1d" class="lt lu in lo b gy lv lw l lx ly">const handler = {<br/>  get(obj, prop) {<br/>    return prop in obj ?<br/>      obj[prop] :<br/>      <!-- -->"Not found"<!-- -->;<br/>  }<br/>};</span></pre><p id="b1e2" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">如果试图访问对象中的属性，将调用get方法。就像吸气剂一样。</p><pre class="kd ke kf kg gt lp lo lq lr aw ls bi"><span id="bd1e" class="lt lu in lo b gy lv lw l lx ly">// If we run:<br/>console.log(profile_proxy.some_missing_method)<br/>// Output: "Not found"</span></pre><p id="791c" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">从上面的例子中，您可能意识到创建一个全新的变量会使代码看起来很奇怪，所以更好的方法是:</p><pre class="kd ke kf kg gt lp lo lq lr aw ls bi"><span id="f80c" class="lt lu in lo b gy lv lw l lx ly">profile = new Proxy(profile, handler)<br/>// Or instead of first defining the object then create a proxy you can do this</span><span id="b622" class="lt lu in lo b gy mn lw l lx ly">const profile = new Proxy({/* All values in here*/}, handle)</span></pre><p id="d02b" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">这是代理的一个简单概述，现在让我们看看代理在真实项目中的实际应用。</p><ul class=""><li id="a09c" class="lz ma in kq b kr ks ku kv kx mb lb mc lf md lj me mf mg mh bi translated">Vue.js 3:根据Vue.js文档，vue.js的最新版本Vue 3利用JavaScript代理来实现反应式数据。对于<code class="fe ll lm ln lo b">reactive</code>功能。这里声明:</li></ul><div class="mo mp gp gr mq mr"><a href="https://vuejs.org/guide/essentials/reactivity-fundamentals.html#script-setup" rel="noopener  ugc nofollow" target="_blank"><div class="ms ab fo"><div class="mt ab mu cl cj mv"><h2 class="bd io gy z fp mw fr fs mx fu fw im bi translated">反应性基础| Vue.js</h2><div class="my l"><h3 class="bd b gy z fp mw fr fs mx fu fw dk translated">API首选项本页和本指南后面的许多章节包含选项API和…的不同内容</h3></div><div class="mz l"><p class="bd b dl z fp mw fr fs mx fu fw dk translated">vuejs.org</p></div></div><div class="na l"><div class="nb l nc nd ne na nf km mr"/></div></div></a></div><ul class=""><li id="535d" class="lz ma in kq b kr ks ku kv kx mb lb mc lf md lj me mf mg mh bi translated"><a class="ae lk" href="https://orbiton.js.org" rel="noopener ugc nofollow" target="_blank"> Orbiton JS </a>:也利用JavaScript代理创建代理绑定器，其行为方式与Vue.js的反应数据相同。</li></ul><p id="253a" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我希望这篇文章能帮助你理解代理。如果您想了解更多信息，可以访问MDN文档:</p><div class="mo mp gp gr mq mr"><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Proxy" rel="noopener  ugc nofollow" target="_blank"><div class="ms ab fo"><div class="mt ab mu cl cj mv"><h2 class="bd io gy z fp mw fr fs mx fu fw im bi translated">代理- JavaScript | MDN</h2><div class="my l"><h3 class="bd b gy z fp mw fr fs mx fu fw dk translated">代理对象使您能够为另一个对象创建代理，它可以截取和重新定义基本的…</h3></div><div class="mz l"><p class="bd b dl z fp mw fr fs mx fu fw dk translated">developer.mozilla.org</p></div></div><div class="na l"><div class="ng l nc nd ne na nf km mr"/></div></div></a></div><p id="db3b" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><em class="nh">更多内容尽在</em> <a class="ae lk" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io"> <em class="nh">说白了. io </em> </strong> </a> <em class="nh">。报名参加我们的</em> <a class="ae lk" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io"> <em class="nh">免费周报</em> </strong> </a> <em class="nh">。关注我们关于</em> <a class="ae lk" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io"> <em class="nh">推特</em> </strong> </a> <em class="nh">和</em><strong class="kq io"><em class="nh"/></strong><a class="ae lk" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kq io"><em class="nh">LinkedIn</em></strong></a><em class="nh">。加入我们的</em> <a class="ae lk" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io"> <em class="nh">社区</em> </strong> </a> <em class="nh">。</em></p></div></div>    
</body>
</html>