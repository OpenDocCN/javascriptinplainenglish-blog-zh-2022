<html>
<head>
<title>Deploy an Angular Application with Surge Using GitLab CI/CD</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">使用GitLab CI/CD部署带有Surge的角度应用程序</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/deploy-an-angular-application-with-surge-using-gitlab-ci-cd-dc34aad1f7e3?source=collection_archive---------4-----------------------#2022-06-22">https://javascript.plainenglish.io/deploy-an-angular-application-with-surge-using-gitlab-ci-cd-dc34aad1f7e3?source=collection_archive---------4-----------------------#2022-06-22</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="a52d" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">本文将帮助您为Angular项目设置GitLab CI/CD管道，并通过Surge部署它</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/f1f8cc7c0e6de3381bc68c66c8ccb594.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K5ikKDY4iIMXck-4FTbtFw.png"/></div></div></figure><h1 id="f727" class="ko kp in bd kq kr ks kt ku kv kw kx ky jt kz ju la jw lb jx lc jz ld ka le lf bi translated">浪涌(。sh)</h1><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi lg"><img src="../Images/711a252969b528b269d81ef3550a26e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:408/format:webp/1*924m-ca9y8XZOZYpoEWPHA.png"/></div></figure><p id="c36e" class="pw-post-body-paragraph lh li in lj b lk ll jo lm ln lo jr lp lq lr ls lt lu lv lw lx ly lz ma mb mc ig bi translated"><strong class="lj io"> Surge </strong>是一个用于免费部署静态网站的npm包。为此，你需要有一个帐户与浪涌部署时，他们为你提供一个自定义域或你可以使用你的域无论你的要求。</p><h1 id="5e2e" class="ko kp in bd kq kr ks kt ku kv kw kx ky jt kz ju la jw lb jx lc jz ld ka le lf bi translated">先决条件</h1><ol class=""><li id="9843" class="md me in lj b lk mf ln mg lq mh lu mi ly mj mc mk ml mm mn bi translated">你需要准备一个有角度的项目。如果你是Angular的初学者，你可以点击这个<a class="ae mo" href="https://medium.com/@jaykishan.khemani/how-to-setup-your-first-angular-app-77c1d6aa65f6" rel="noopener">链接</a>。</li><li id="bb52" class="md me in lj b lk mp ln mq lq mr lu ms ly mt mc mk ml mm mn bi translated">一个GitLab帐户，其存储库与Angular项目相关联。您可以从<a class="ae mo" href="https://gitlab.com/" rel="noopener ugc nofollow" target="_blank">这里</a>创建一个账户。</li><li id="5b78" class="md me in lj b lk mp ln mq lq mr lu ms ly mt mc mk ml mm mn bi translated">确保您拥有最新版本的<a class="ae mo" href="http://nodejs.org/" rel="noopener ugc nofollow" target="_blank"> Node.js </a>。</li><li id="2827" class="md me in lj b lk mp ln mq lq mr lu ms ly mt mc mk ml mm mn bi translated"><strong class="lj io">(可选)</strong>你也可以将你之前的角度项目Dockerize。这将使您的设置更容易。不熟悉的可以看一下<a class="ae mo" rel="noopener ugc nofollow" target="_blank" href="/how-to-dockerize-angular-application-3cd67e963832">这里</a>。我正在使用一个带有Dockerized环境的Angular项目。</li></ol><h1 id="c31a" class="ko kp in bd kq kr ks kt ku kv kw kx ky jt kz ju la jw lb jx lc jz ld ka le lf bi translated">步伐</h1><ol class=""><li id="7dd8" class="md me in lj b lk mf ln mg lq mh lu mi ly mj mc mk ml mm mn bi translated">在您的项目中安装Surge。</li><li id="0423" class="md me in lj b lk mp ln mq lq mr lu ms ly mt mc mk ml mm mn bi translated">为部署设置Gitlab CI/CD。</li><li id="6c4d" class="md me in lj b lk mp ln mq lq mr lu ms ly mt mc mk ml mm mn bi translated">将您的更改推送到GitLab。</li><li id="aa82" class="md me in lj b lk mp ln mq lq mr lu ms ly mt mc mk ml mm mn bi translated">GitLab会自动将您的更改部署到Surge上</li></ol><h1 id="813b" class="ko kp in bd kq kr ks kt ku kv kw kx ky jt kz ju la jw lb jx lc jz ld ka le lf bi translated">安装电涌</h1><ol class=""><li id="5eb7" class="md me in lj b lk mf ln mg lq mh lu mi ly mj mc mk ml mm mn bi translated">使用此命令将surge安装到您的项目中:</li></ol><pre class="kd ke kf kg gt mu mv mw mx aw my bi"><span id="39a6" class="mz kp in mv b gy na nb l nc nd">npm install --global surge</span></pre><p id="bc63" class="pw-post-body-paragraph lh li in lj b lk ll jo lm ln lo jr lp lq lr ls lt lu lv lw lx ly lz ma mb mc ig bi translated">2.现在，从任何目录中运行<code class="fe ne nf ng mv b">surge</code>，将该目录发布到web上。如果你是第一次运行它，它会要求你的电子邮件密码和其他细节。对于域部分，如果您没有任何域，请将该字段留空，它会自动为您分配一个域。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nh"><img src="../Images/f0dfa1e97367a3f154d7abd5bfb868e5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xdqFYtHWLTaakqFPIjuPHQ.png"/></div></div></figure><p id="dfbc" class="pw-post-body-paragraph lh li in lj b lk ll jo lm ln lo jr lp lq lr ls lt lu lv lw lx ly lz ma mb mc ig bi translated">对于项目选项，您需要在dist文件夹中提供角度构建的路径。此外，要构建您的项目，您可以使用以下命令:</p><pre class="kd ke kf kg gt mu mv mw mx aw my bi"><span id="cc24" class="mz kp in mv b gy na nb l nc nd">npm run build</span></pre><p id="19c6" class="pw-post-body-paragraph lh li in lj b lk ll jo lm ln lo jr lp lq lr ls lt lu lv lw lx ly lz ma mb mc ig bi translated">在我的情况下，我收到了这个域名<a class="ae mo" href="http://towering-taste.surge.sh/" rel="noopener ugc nofollow" target="_blank">http://towering-taste.surge.sh/</a>。</p><p id="d11f" class="pw-post-body-paragraph lh li in lj b lk ll jo lm ln lo jr lp lq lr ls lt lu lv lw lx ly lz ma mb mc ig bi translated">3.保存这个域名和电子邮件，让我们找到令牌。使用以下命令:</p><pre class="kd ke kf kg gt mu mv mw mx aw my bi"><span id="fd0a" class="mz kp in mv b gy na nb l nc nd">surge token</span></pre><p id="0666" class="pw-post-body-paragraph lh li in lj b lk ll jo lm ln lo jr lp lq lr ls lt lu lv lw lx ly lz ma mb mc ig bi translated">这将为您提供一个令牌，并保存它。在接下来的步骤中，您将需要所有这些。</p><p id="3523" class="pw-post-body-paragraph lh li in lj b lk ll jo lm ln lo jr lp lq lr ls lt lu lv lw lx ly lz ma mb mc ig bi translated">现在，您的项目必须已经手动部署。我们需要使用CI/CD来自动化所有这一过程。</p><h1 id="b096" class="ko kp in bd kq kr ks kt ku kv kw kx ky jt kz ju la jw lb jx lc jz ld ka le lf bi translated">GitLab设置</h1><p id="ef1d" class="pw-post-body-paragraph lh li in lj b lk mf jo lm ln mg jr lp lq ni ls lt lu nj lw lx ly nk ma mb mc ig bi translated">在项目的根目录下创建一个gitlab.yml文件。以下是其内容:</p><pre class="kd ke kf kg gt mu mv mw mx aw my bi"><span id="41d8" class="mz kp in mv b gy na nb l nc nd">image: node:14.15.4<br/>cache:<br/>  paths:<br/>    - node_modules/</span><span id="77b2" class="mz kp in mv b gy nl nb l nc nd">deploy_stage:<br/>  stage: deploy<br/>  only:<br/>    - master<br/>  script:<br/>    - rm ./package-lock.json<br/>    - npm install<br/>    - ./node_modules/@angular/cli/bin/ng build --progress false --prod --base-href <a class="ae mo" href="http://towering-taste.surge.sh/" rel="noopener ugc nofollow" target="_blank">http://towering-taste.surge.sh/</a><br/>    - ./node_modules/.bin/surge -p dist/angular-app/ --domain <a class="ae mo" href="http://towering-taste.surge.sh/" rel="noopener ugc nofollow" target="_blank">http://towering-taste.surge.sh/</a></span></pre><p id="af01" class="pw-post-body-paragraph lh li in lj b lk ll jo lm ln lo jr lp lq lr ls lt lu lv lw lx ly lz ma mb mc ig bi translated">现在在GitLab中设置两个环境变量:</p><p id="f4c1" class="pw-post-body-paragraph lh li in lj b lk ll jo lm ln lo jr lp lq lr ls lt lu lv lw lx ly lz ma mb mc ig bi translated">存储库&gt;设置&gt; CI/CD &gt;变量</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nm"><img src="../Images/45541fd514411e1a58dfa8fe50ba7785.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Qy2DddDZI9P3EFVEIf3xag.png"/></div></div></figure><p id="9455" class="pw-post-body-paragraph lh li in lj b lk ll jo lm ln lo jr lp lq lr ls lt lu lv lw lx ly lz ma mb mc ig bi translated">SURGE_LOGIN = <email used="" on="" surge=""/></p><p id="4f7c" class="pw-post-body-paragraph lh li in lj b lk ll jo lm ln lo jr lp lq lr ls lt lu lv lw lx ly lz ma mb mc ig bi translated">SURGE_TOKEN = <surge token="" saved="" in="" the="" previous="" step=""/></p><h1 id="3131" class="ko kp in bd kq kr ks kt ku kv kw kx ky jt kz ju la jw lb jx lc jz ld ka le lf bi translated"><strong class="ak">将您的更改推送到GitLab </strong></h1><p id="9d51" class="pw-post-body-paragraph lh li in lj b lk mf jo lm ln mg jr lp lq ni ls lt lu nj lw lx ly nk ma mb mc ig bi translated">现在使用以下命令提交并推送到主分支:</p><pre class="kd ke kf kg gt mu mv mw mx aw my bi"><span id="3530" class="mz kp in mv b gy na nb l nc nd">git add .<br/>git commit -m "added gitlab.yml"<br/>git push origin master</span></pre><h1 id="0c11" class="ko kp in bd kq kr ks kt ku kv kw kx ky jt kz ju la jw lb jx lc jz ld ka le lf bi translated">最后一步</h1><p id="9834" class="pw-post-body-paragraph lh li in lj b lk mf jo lm ln mg jr lp lq ni ls lt lu nj lw lx ly nk ma mb mc ig bi translated">现在GitLab将使用gitlab.yml中提供的脚本自动部署，您可以在Repository &gt; CI/CD中检查其过程。此外，您可以通过在管道中单击此选项来检查日志。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nn"><img src="../Images/c0c78b62ffe4cea9efdf7ca7a843026c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-oJHfNXbNZR1jebZxAs7Kg.png"/></div></div></figure><p id="ca5a" class="pw-post-body-paragraph lh li in lj b lk ll jo lm ln lo jr lp lq lr ls lt lu lv lw lx ly lz ma mb mc ig bi translated">像这样:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi no"><img src="../Images/838090fba3b219e95f88c7d8b2c6c262.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*GWze1WiaQ81lpnPJZv8j5g.png"/></div></div></figure><h1 id="692c" class="ko kp in bd kq kr ks kt ku kv kw kx ky jt kz ju la jw lb jx lc jz ld ka le lf bi translated">收尾工作</h1><p id="c9d9" class="pw-post-body-paragraph lh li in lj b lk mf jo lm ln mg jr lp lq ni ls lt lu nj lw lx ly nk ma mb mc ig bi translated">现在您的项目已经设置为自动部署。每次你推入主分支时，代码会自动部署到服务器上。这可以使用任何服务器来完成。这里我们使用的是浪涌。自己尝试，如果你有任何错误，你可以在下面评论，不要忘记与那些有需要的人分享这篇文章。感谢您宝贵的时间。🍻</p><div class="np nq gp gr nr ns"><a href="https://www.linkedin.com/in/jaykishan-khemani-a0452850/" rel="noopener  ugc nofollow" target="_blank"><div class="nt ab fo"><div class="nu ab nv cl cj nw"><h2 class="bd io gy z fp nx fr fs ny fu fw im bi translated">Jaykishan Khemani -解决方案工程师- GAMMASTACK | LinkedIn</h2><div class="nz l"><h3 class="bd b gy z fp nx fr fs ny fu fw dk translated">查看Jaykishan Khemani在世界上最大的职业社区LinkedIn上的个人资料。Jaykishan列出了3个工作…</h3></div><div class="oa l"><p class="bd b dl z fp nx fr fs ny fu fw dk translated">www.linkedin.com</p></div></div><div class="ob l"><div class="oc l od oe of ob og km ns"/></div></div></a></div><p id="fd7d" class="pw-post-body-paragraph lh li in lj b lk ll jo lm ln lo jr lp lq lr ls lt lu lv lw lx ly lz ma mb mc ig bi translated"><em class="oh">更多内容请看</em><a class="ae mo" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="lj io"><em class="oh">plain English . io</em></strong></a><em class="oh">。报名参加我们的</em> <a class="ae mo" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="lj io"> <em class="oh">免费周报</em> </strong> </a> <em class="oh">。关注我们关于</em><a class="ae mo" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="lj io"><em class="oh">Twitter</em></strong></a><em class="oh">和</em><a class="ae mo" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="lj io"><em class="oh">LinkedIn</em></strong></a><em class="oh">。查看我们的</em> <a class="ae mo" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="lj io"> <em class="oh">社区不和谐</em> </strong> </a> <em class="oh">加入我们的</em> <a class="ae mo" href="https://inplainenglish.pallet.com/talent/welcome" rel="noopener ugc nofollow" target="_blank"> <strong class="lj io"> <em class="oh">人才集体</em> </strong> </a> <em class="oh">。</em></p></div></div>    
</body>
</html>