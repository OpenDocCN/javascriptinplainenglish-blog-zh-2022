<html>
<head>
<title>How to Use express-validator in Combination with Schema &amp; Custom Validation</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何将express-validator与模式和自定义验证结合使用</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-use-express-validator-in-combination-with-schema-custom-validation-78bba466a246?source=collection_archive---------1-----------------------#2022-10-27">https://javascript.plainenglish.io/how-to-use-express-validator-in-combination-with-schema-custom-validation-78bba466a246?source=collection_archive---------1-----------------------#2022-10-27</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="8fb4" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">关于如何在使用ExpressJS时进行服务器端验证的教程</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/c30ec58db5e3d5686b0ece4269b76adf.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*koqyATyp9RUBHZPa4Lh54g.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/es/@brett_jordan?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Brett Jordan</a> on <a class="ae kv" href="https://unsplash.com/s/photos/error?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="c56a" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">什么是express-validator？</h1><blockquote class="lo lp lq"><p id="b286" class="lr ls lt lu b lv lw jr lx ly lz ju ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">express-validator是一套<a class="ae kv" href="http://expressjs.com/" rel="noopener ugc nofollow" target="_blank"> express.js </a>中间件，包装了<a class="ae kv" href="https://github.com/validatorjs/validator.js" rel="noopener ugc nofollow" target="_blank"> validator.js </a>验证器和杀毒器功能。</p><p id="b0c5" class="lr ls lt lu b lv lw jr lx ly lz ju ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">来源:<a class="ae kv" href="https://express-validator.github.io/docs/" rel="noopener ugc nofollow" target="_blank">https://express-validator.github.io/docs/</a></p></blockquote><p id="be1f" class="pw-post-body-paragraph lr ls iq lu b lv lw jr lx ly lz ju ma mo mc md me mp mg mh mi mq mk ml mm mn ij bi translated">如上所述，它是一个帮助验证数据的中间件。它已经存在了一段时间，也获得了对TypeScript的支持。</p><h1 id="b6e5" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">我们将实现什么？</h1><p id="21ac" class="pw-post-body-paragraph lr ls iq lu b lv mr jr lx ly ms ju ma mo mt md me mp mu mh mi mq mv ml mm mn ij bi translated">在这篇文章中，我们将看到如何使用这个库进行服务器端验证。</p><p id="faa0" class="pw-post-body-paragraph lr ls iq lu b lv lw jr lx ly lz ju ma mo mc md me mp mg mh mi mq mk ml mm mn ij bi translated">因为这个包使用了<a class="ae kv" href="https://github.com/validatorjs/validator.js" rel="noopener ugc nofollow" target="_blank">，</a>你可以在这里得到可用验证器的列表-<a class="ae kv" href="https://github.com/validatorjs/validator.js" rel="noopener ugc nofollow" target="_blank">https://github.com/validatorjs/validator.js</a></p><h2 id="631e" class="mw kx iq bd ky mx my dn lc mz na dp lg mo nb nc li mp nd ne lk mq nf ng lm nh bi translated">基本验证</h2><p id="bb07" class="pw-post-body-paragraph lr ls iq lu b lv mr jr lx ly ms ju ma mo mt md me mp mu mh mi mq mv ml mm mn ij bi translated">我们将从一些基本的验证开始，如字段不能为空，或者必须是数字，或者是电子邮件等。这可以在路由级别上很容易地实现。例如，如果您有一个包含3个表单字段的POST API route <code class="fe ni nj nk nl b">/charity</code>，那么您可以像这样进行验证</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">basic validation using express-validator</figcaption></figure><p id="98fa" class="pw-post-body-paragraph lr ls iq lu b lv lw jr lx ly lz ju ma mo mc md me mp mg mh mi mq mk ml mm mn ij bi translated">这些验证器有许多组合，它们也可以被链接起来。请参考此处关于验证器<a class="ae kv" href="https://github.com/validatorjs/validator.js" rel="noopener ugc nofollow" target="_blank">的文档。</a></p><h2 id="8627" class="mw kx iq bd ky mx my dn lc mz na dp lg mo nb nc li mp nd ne lk mq nf ng lm nh bi translated">基于模式的验证</h2><p id="41ea" class="pw-post-body-paragraph lr ls iq lu b lv mr jr lx ly ms ju ma mo mt md me mp mu mh mi mq mv ml mm mn ij bi translated">上述设置的问题是，如果您有大量的字段要验证，那么您的路径将很快变得非常臃肿。为了帮助解决这种情况，express-validator支持<code class="fe ni nj nk nl b">Schema based validation</code>。</p><p id="d79b" class="pw-post-body-paragraph lr ls iq lu b lv lw jr lx ly lz ju ma mo mc md me mp mg mh mi mq mk ml mm mn ij bi translated">您可以基于您的数据模型定义一个模式，并传递它进行验证。</p><p id="47bc" class="pw-post-body-paragraph lr ls iq lu b lv lw jr lx ly lz ju ma mo mc md me mp mg mh mi mq mk ml mm mn ij bi translated">例如，如果您想要验证这样的数据模型</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="a2a4" class="pw-post-body-paragraph lr ls iq lu b lv lw jr lx ly lz ju ma mo mc md me mp mg mh mi mq mk ml mm mn ij bi translated">然后，像这样添加您的模式定义(我希望这些是一个新文件)</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><blockquote class="lo lp lq"><p id="4f9a" class="lr ls lt lu b lv lw jr lx ly lz ju ma mb mc md me mf mg mh mi mj mk ml mm mn ij bi translated">注意我们如何使用点符号来遍历数据。</p></blockquote><p id="3257" class="pw-post-body-paragraph lr ls iq lu b lv lw jr lx ly lz ju ma mo mc md me mp mg mh mi mq mk ml mm mn ij bi translated">现在，您所要做的就是像这样在您的路由定义中传递这个模式</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="21c2" class="pw-post-body-paragraph lr ls iq lu b lv lw jr lx ly lz ju ma mo mc md me mp mg mh mi mq mk ml mm mn ij bi translated">这看起来更干净，更容易阅读，并且您可以在您可能需要的任何其他途径中共享相同的模式。</p><h2 id="4434" class="mw kx iq bd ky mx my dn lc mz na dp lg mo nb nc li mp nd ne lk mq nf ng lm nh bi translated">复杂情况下的中间件链</h2><p id="73ce" class="pw-post-body-paragraph lr ls iq lu b lv mr jr lx ly ms ju ma mo mt md me mp mu mh mi mq mv ml mm mn ij bi translated">最后，如果您必须在这个基于模式的验证之上添加一些自定义验证，那么您也可以这样做。您可以将其作为中间件链接到您的路线中。</p><p id="570b" class="pw-post-body-paragraph lr ls iq lu b lv lw jr lx ly lz ju ma mo mc md me mp mg mh mi mq mk ml mm mn ij bi translated">首先，像这样添加一个新的中间件功能-</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure><p id="67e1" class="pw-post-body-paragraph lr ls iq lu b lv lw jr lx ly lz ju ma mo mc md me mp mg mh mi mq mk ml mm mn ij bi translated">注意，我们是如何通过添加错误消息来传递<code class="fe ni nj nk nl b">error</code>数组的。它与上一步中模式验证函数填充的数组相同。</p><p id="738e" class="pw-post-body-paragraph lr ls iq lu b lv lw jr lx ly lz ju ma mo mc md me mp mg mh mi mq mk ml mm mn ij bi translated">我们现在在路由定义中调用一个中间件，就像这样-</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nm nn l"/></div></figure></div><div class="ab cl no np hu nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="ij ik il im in"><p id="0695" class="pw-post-body-paragraph lr ls iq lu b lv lw jr lx ly lz ju ma mo mc md me mp mg mh mi mq mk ml mm mn ij bi translated">感谢您的阅读，如果您想支持我，请关注我，成为会员，让我们所有人都留在这个平台上。</p><div class="nv nw gp gr nx ny"><a href="https://medium.com/@metacollective/membership" rel="noopener follow" target="_blank"><div class="nz ab fo"><div class="oa ab ob cl cj oc"><h2 class="bd ir gy z fp od fr fs oe fu fw ip bi translated">通过我的推荐链接加入媒体Meta Collective</h2><div class="of l"><h3 class="bd b gy z fp od fr fs oe fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="og l"><p class="bd b dl z fp od fr fs oe fu fw dk translated">medium.com</p></div></div><div class="oh l"><div class="oi l oj ok ol oh om kp ny"/></div></div></a></div></div><div class="ab cl no np hu nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="ij ik il im in"><p id="9244" class="pw-post-body-paragraph lr ls iq lu b lv lw jr lx ly lz ju ma mo mc md me mp mg mh mi mq mk ml mm mn ij bi translated"><em class="lt">更多内容尽在</em> <a class="ae kv" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="lu ir"> <em class="lt">说白了. io </em> </strong> </a> <em class="lt">。报名参加我们的</em> <a class="ae kv" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="lu ir"> <em class="lt">免费周报</em> </strong> </a> <em class="lt">。关注我们关于</em> <a class="ae kv" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"> <strong class="lu ir"> <em class="lt">推特</em> </strong> </a>，<a class="ae kv" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="lu ir"><em class="lt">LinkedIn</em></strong></a><em class="lt">，</em><a class="ae kv" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"><strong class="lu ir"><em class="lt">YouTube</em></strong></a><em class="lt">，</em> <a class="ae kv" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="lu ir"> <em class="lt">不和</em> </strong> </a> <em class="lt">。对增长黑客感兴趣？检查</em> <a class="ae kv" href="https://circuit.ooo/" rel="noopener ugc nofollow" target="_blank"> <strong class="lu ir"> <em class="lt">电路</em> </strong> </a> <em class="lt">。</em></p></div></div>    
</body>
</html>