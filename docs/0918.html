<html>
<head>
<title>How to Add TypeScript to a Node.js App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何向Node.js应用程序添加TypeScript</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/adding-typescript-to-a-node-app-2e8294f9476c?source=collection_archive---------12-----------------------#2022-02-21">https://javascript.plainenglish.io/adding-typescript-to-a-node-app-2e8294f9476c?source=collection_archive---------12-----------------------#2022-02-21</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="7014" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">如何将TypeScript添加到现有Node.js应用程序的简要演练；简单的方法。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/b57e4a0cb4770d2e82b321d8a492ada0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*npbvBGcHyxw2PdGDu0SdUg.png"/></div></div></figure></div><div class="ab cl ko kp hr kq" role="separator"><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt"/></div><div class="ig ih ii ij ik"><blockquote class="kv"><p id="f874" class="kw kx in bd ky kz la lb lc ld le lf dk translated">从零开始创造东西无疑是一个挑战，但更具挑战性的是在已经做出的东西上进行改进，而且效果很好。</p></blockquote></div><div class="ab cl ko kp hr kq" role="separator"><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt ku"/><span class="kr bw bk ks kt"/></div><div class="ig ih ii ij ik"><h1 id="0c60" class="lg lh in bd li lj lk ll lm ln lo lp lq jt lr ju ls jw lt jx lu jz lv ka lw lx bi translated">何必呢？</h1><p id="b00b" class="pw-post-body-paragraph ly lz in ma b mb mc jo md me mf jr mg mh mi mj mk ml mm mn mo mp mq mr ms lf ig bi translated">就像往常一样，在我们开始之前，问一个最重要的问题是很重要的，那就是，<strong class="ma io"> <em class="mt">我为什么要这么做？为什么要将TypeScript添加到Node.js应用程序中，这个应用程序运行良好，并且正在完成我的工作？嗯，总有改进的余地，不是吗？</em></strong></p><p id="4109" class="pw-post-body-paragraph ly lz in ma b mb mu jo md me mv jr mg mh mw mj mk ml mx mn mo mp my mr ms lf ig bi translated">一如既往，本文的代码可以在我的GitHub上找到</p><div class="mz na gp gr nb nc"><a href="https://github.com/the-devdesigner/node-ts-api.git" rel="noopener  ugc nofollow" target="_blank"><div class="nd ab fo"><div class="ne ab nf cl cj ng"><h2 class="bd io gy z fp nh fr fs ni fu fw im bi translated">GitHub-the-dev designer/node-ts-API:我在Medium上的文章的支持库。环👇</h2><div class="nj l"><h3 class="bd b gy z fp nh fr fs ni fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="nk l"><p class="bd b dl z fp nh fr fs ni fu fw dk translated">github.com</p></div></div><div class="nl l"><div class="nm l nn no np nl nq km nc"/></div></div></a></div><p id="a204" class="pw-post-body-paragraph ly lz in ma b mb mu jo md me mv jr mg mh mw mj mk ml mx mn mo mp my mr ms lf ig bi translated">假设您的web应用程序或任何其他应用程序有一组API端点，在过去的1个月中，它们已经启动并运行，可能是Heroku或AWS，没有出现任何问题。这难道不是软件开发的咒语之一吗:</p><blockquote class="kv"><p id="5549" class="kw kx in bd ky kz la lb lc ld le lf dk translated"><strong class="ak"> <em class="nr">如果能用，就不要碰。</em>T12】</strong></p></blockquote><p id="ef06" class="pw-post-body-paragraph ly lz in ma b mb ns jo md me nt jr mg mh nu mj mk ml nv mn mo mp nw mr ms lf ig bi translated">但是我们肯定不会不碰它😉。</p><h1 id="b21a" class="lg lh in bd li lj nx ll lm ln ny lp lq jt nz ju ls jw oa jx lu jz ob ka lw lx bi translated">入门指南</h1><p id="5e2e" class="pw-post-body-paragraph ly lz in ma b mb mc jo md me mf jr mg mh mi mj mk ml mm mn mo mp mq mr ms lf ig bi translated">请随意使用您自己的项目，您可能想将TypeScript添加到其中，或者简单地克隆附加的repo做最适合你的事。该项目是一个简单的节点/快速应用程序，有几个简单的API端点。尽管端点并不真正做很多事情，但它仍然是开始理解如何使用TypeScript并将其添加到现有项目中的好地方。</p><h1 id="e255" class="lg lh in bd li lj nx ll lm ln ny lp lq jt nz ju ls jw oa jx lu jz ob ka lw lx bi translated">路线和控制器(没有类型脚本)</h1><p id="5719" class="pw-post-body-paragraph ly lz in ma b mb mc jo md me mf jr mg mh mi mj mk ml mm mn mo mp mq mr ms lf ig bi translated">我们这里的路由和控制器是一条简单的<code class="fe oc od oe of b">/home</code>路由，当用户访问这条路由时，它会简单地向用户显示一条消息<code class="fe oc od oe of b">Welcome to the api</code>。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi og"><img src="../Images/ee98a3b4adb21841739cf3e07ea7c2d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9h8RZFcd7aCrBz2RwVHu-Q.png"/></div></div><figcaption class="oh oi gj gh gi oj ok bd b be z dk">Controller for homepage route</figcaption></figure><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ol"><img src="../Images/07f5f645a2bdee4bd986733ac299fc5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MWSrCpEinOJnhlTDnvbwYQ.png"/></div></div><figcaption class="oh oi gj gh gi oj ok bd b be z dk">Route for homepage — /home</figcaption></figure><p id="72cf" class="pw-post-body-paragraph ly lz in ma b mb mu jo md me mv jr mg mh mw mj mk ml mx mn mo mp my mr ms lf ig bi translated">任何使用Node/Express应用程序的人肯定会习惯并熟悉制作这些路线和控制器。虽然这很简单，但我们不会研究进入控制器的逻辑，而只是将TS添加到我们的节点应用程序中。我稍后会在本文附带的repo中添加更多的路由和控制器；控制器稍微复杂一点的——比如《T2》的动作。</p><h1 id="8818" class="lg lh in bd li lj nx ll lm ln ny lp lq jt nz ju ls jw oa jx lu jz ob ka lw lx bi translated">引进打字稿</h1><h2 id="c3e3" class="om lh in bd li on oo dn lm op oq dp lq mh or os ls ml ot ou lu mp ov ow lw ox bi translated">安装和初始化TypeScript</h2><p id="2ffe" class="pw-post-body-paragraph ly lz in ma b mb mc jo md me mf jr mg mh mi mj mk ml mm mn mo mp mq mr ms lf ig bi translated">TypeScript以及所有相关的express、node或其他类型的定义都将作为<code class="fe oc od oe of b">devDependencies</code>放入。</p><ol class=""><li id="bb9f" class="oy oz in ma b mb mu me mv mh pa ml pb mp pc lf pd pe pf pg bi translated">运行<code class="fe oc od oe of b">npm i -D typescript @types/node @types/express</code>将这些添加到项目中。</li><li id="2c4f" class="oy oz in ma b mb ph me pi mh pj ml pk mp pl lf pd pe pf pg bi translated">运行<code class="fe oc od oe of b">tsc — init</code>来生成<code class="fe oc od oe of b">tsconfig.json</code>，它将负责我们的<code class="fe oc od oe of b">.ts</code>文件如何被转换为JavaScript，以及是否要生成<code class="fe oc od oe of b">.d.ts</code>地图；还有更多。</li><li id="0f01" class="oy oz in ma b mb ph me pi mh pj ml pk mp pl lf pd pe pf pg bi translated">在<code class="fe oc od oe of b">tsconfig.json</code>中打开或关闭配置。作为参考，我的配置如下:</li></ol><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi pm"><img src="../Images/24f6baf0a3f2190cfb25f6c041c645d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1wXimpJ8kJyJ35Ji9vo1Lg.png"/></div></div><figcaption class="oh oi gj gh gi oj ok bd b be z dk">tsconfig.json for this project</figcaption></figure><h2 id="bc2c" class="om lh in bd li on oo dn lm op oq dp lq mh or os ls ml ot ou lu mp ov ow lw ox bi translated">重构路线和控制器</h2><p id="8fee" class="pw-post-body-paragraph ly lz in ma b mb mc jo md me mf jr mg mh mi mj mk ml mm mn mo mp mq mr ms lf ig bi translated">有了TS，立即增加的一件事就是定义类型。这意味着如果我们需要告诉TS<em class="mt">这个</em>是字符串类型。或者是一个遵循特定蓝图的物体。简而言之，这确保了当变量投入使用时，它获取或发送正确类型的数据。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ol"><img src="../Images/62db160df3ae6195c7e0c0526e4c6831.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sQCe9MeYoV60TQmVLE1eLw.png"/></div></div><figcaption class="oh oi gj gh gi oj ok bd b be z dk">Refactoring route with TS; adding type for router</figcaption></figure><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi pm"><img src="../Images/df587f3c7d28f048641685706e03c8ef.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iTI6KL_CTI_GckPAR5ddvw.png"/></div></div><figcaption class="oh oi gj gh gi oj ok bd b be z dk">Refactoring controller with TS; adding types Request and Response for req and res, respectively.</figcaption></figure><p id="4b9f" class="pw-post-body-paragraph ly lz in ma b mb mu jo md me mv jr mg mh mw mj mk ml mx mn mo mp my mr ms lf ig bi translated">我们来分析一下这是怎么回事。</p><ol class=""><li id="3197" class="oy oz in ma b mb mu me mv mh pa ml pb mp pc lf pd pe pf pg bi translated">在比较旧的控制器和添加了TypeScript的控制器时，从一开始，我们就看到类似于<code class="fe oc od oe of b">req: Request</code>的东西。这里，我们显式地将req定义为由@types/express提供的Request类型。</li><li id="7e7b" class="oy oz in ma b mb ph me pi mh pj ml pk mp pl lf pd pe pf pg bi translated">假设我们有一个名为<code class="fe oc od oe of b">validateInput(userInput)</code>的函数，它接受单个参数。在TS中，我们将该函数写成<code class="fe oc od oe of b">validateInput(userInput: String)</code>只是为了确保在任何情况下参数都不应该是String以外的任何其他数据类型。</li></ol><h2 id="9545" class="om lh in bd li on oo dn lm op oq dp lq mh or os ls ml ot ou lu mp ov ow lw ox bi translated">最后一档</h2><p id="7b0a" class="pw-post-body-paragraph ly lz in ma b mb mc jo md me mf jr mg mh mi mj mk ml mm mn mo mp mq mr ms lf ig bi translated">有了所有这些变化，我们现在可以运行<code class="fe oc od oe of b">tsc</code>并让TypeScript发挥它的魔力。本质上，将要发生的是，基于我们的<code class="fe oc od oe of b">tsconfig.json</code>，TS代码将被转换为普通的JavaScript，同时生成一些类型定义文件。这些类型定义将非常有用，并在我们使用代码时提供智能感知。</p><p id="2ce1" class="pw-post-body-paragraph ly lz in ma b mb mu jo md me mv jr mg mh mw mj mk ml mx mn mo mp my mr ms lf ig bi translated">一如既往，祈祷好运。如果我们做的一切都是正确的，我们会看到我们拥有的每个<code class="fe oc od oe of b">.ts</code>文件都有一个<code class="fe oc od oe of b">.js</code>和一个<code class="fe oc od oe of b">.d.ts</code>文件。</p><p id="5402" class="pw-post-body-paragraph ly lz in ma b mb mu jo md me mv jr mg mh mw mj mk ml mx mn mo mp my mr ms lf ig bi translated">而且，仅此而已！</p><p id="9876" class="pw-post-body-paragraph ly lz in ma b mb mu jo md me mv jr mg mh mw mj mk ml mx mn mo mp my mr ms lf ig bi translated">我们完了！</p><p id="548c" class="pw-post-body-paragraph ly lz in ma b mb mu jo md me mv jr mg mh mw mj mk ml mx mn mo mp my mr ms lf ig bi translated">我们刚刚在Node/Express应用程序中添加了TypeScript，以使它比以前更好，并防止我们亲爱的旧JS编译器出现错误。我们现在得到的最大优势是编译时检查，而不是JavaScript提供的运行时检查。</p><p id="adfd" class="pw-post-body-paragraph ly lz in ma b mb mu jo md me mv jr mg mh mw mj mk ml mx mn mo mp my mr ms lf ig bi translated">我希望这篇文章对你有帮助，并且容易理解。请务必查看我的其他文章。</p><p id="c20f" class="pw-post-body-paragraph ly lz in ma b mb mu jo md me mv jr mg mh mw mj mk ml mx mn mo mp my mr ms lf ig bi translated">结束！</p><p id="5e9f" class="pw-post-body-paragraph ly lz in ma b mb mu jo md me mv jr mg mh mw mj mk ml mx mn mo mp my mr ms lf ig bi translated"><em class="mt">更多内容请看</em><a class="ae pn" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="ma io"><em class="mt">plain English . io</em></strong></a><em class="mt">。报名参加我们的</em> <a class="ae pn" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ma io"> <em class="mt">免费周报</em> </strong> </a> <em class="mt">。在我们的</em> <a class="ae pn" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="ma io"> <em class="mt">社区</em> </strong> </a> <em class="mt">获得独家获得写作机会和建议。</em></p></div></div>    
</body>
</html>