<html>
<head>
<title>Letâ€™s Add Swift Guards to JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">è®©æˆ‘ä»¬ç»™JavaScriptæ·»åŠ Swift Guards</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://javascript.plainenglish.io/lets-add-swift-guards-to-javascript-42767b99a3ba?source=collection_archive---------12-----------------------#2022-06-21">https://javascript.plainenglish.io/lets-add-swift-guards-to-javascript-42767b99a3ba?source=collection_archive---------12-----------------------#2022-06-21</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/2c871de92f9ac00c699545d12a1da725.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*KUe64K_tsY2vt-29"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/@clemhlrdt?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">ClÃ©ment HÃ©lardot</a> on <a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><blockquote class="ka kb kc"><p id="93d7" class="kd ke kf kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ig bi translated">â€œå¦‚æœæ‰€æœ‰å…¶ä»–äººéƒ½æ¥å—äº†å…šå¼ºåŠ çš„è°è¨€â€”â€”å¦‚æœæ‰€æœ‰çš„è®°å½•éƒ½è®²è¿°äº†åŒæ ·çš„æ•…äº‹â€”â€”é‚£ä¹ˆè¿™ä¸ªè°è¨€å°±ä¼šæˆä¸ºå†å²ï¼Œæˆä¸ºçœŸç†ã€‚å…±äº§å…šçš„å£å·æ˜¯â€œè°æ§åˆ¶äº†è¿‡å»ï¼Œè°å°±æ§åˆ¶äº†æœªæ¥ï¼›è°æ§åˆ¶äº†ç°åœ¨ï¼Œè°å°±æ§åˆ¶äº†è¿‡å»â€â€ï¼Œâ€”â€”ã€Š1984ã€‹ï¼Œä¹”æ²»Â·å¥¥å¨å°”</p></blockquote><p id="1058" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated"><a class="ae jz" href="https://medium.com/@coderaiser/how-to-extend-javascript-parser-with-a-new-keyword-36d79be21ef8" rel="noopener">ä¸Šæ¬¡</a>æˆ‘ä»¬ç»™JavaScriptæ·»åŠ äº†<code class="fe lf lg lh li b">fn</code>å…³é”®å­—ï¼Œè®©æˆ‘ä»¬è¯•è¯•æ›´å¤æ‚çš„:ã€Swiftçš„å«å£«ã€‚</p><p id="d76f" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">ä¸‹é¢æ˜¯ä¸€ä¸ªç®€çŸ­çš„ä¾‹å­:</p><pre class="lj lk ll lm gt ln li lo lp aw lq bi"><span id="6a2f" class="lr ls in li b gy lt lu l lv lw">fn hello() {<br/>    guard (text !== "world") else {<br/>        return "";<br/>    }<br/>        <br/>    return "Hello " + text;<br/>}</span></pre><p id="500e" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">è¿™æ˜¯JavaScriptç‰ˆæœ¬:</p><pre class="lj lk ll lm gt ln li lo lp aw lq bi"><span id="307e" class="lr ls in li b gy lt lu l lv lw">function hello() {<br/>    if (!(text !== 'world')) {<br/>        return '';<br/>    }<br/><br/>    return 'Hello ' + text;<br/>}</span></pre><p id="befc" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">å¦‚ä½ æ‰€è§ï¼Œ<code class="fe lf lg lh li b">guard</code>åšçš„æ˜¯åè½¬ä¸€ä¸ªè¡¨è¾¾å¼ï¼Œæ‰€ä»¥å®ƒä¸åƒ<code class="fe lf lg lh li b">IfStatement</code> + <code class="fe lf lg lh li b">UnaryExpression</code>ã€‚å¬èµ·æ¥å¾ˆæœ‰è¶£ä¸æ˜¯å—:)ï¼Ÿæˆ‘ä»¬èµ°å§ï¼</p><h1 id="6ecf" class="lx ls in bd ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq mr ms mt bi translated">æ·»åŠ ä¿æŠ¤å…³é”®å­—</h1><p id="1488" class="pw-post-body-paragraph kd ke in kg b kh mu kj kk kl mv kn ko lc mw kr ks ld mx kv kw le my kz la lb ig bi translated">é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦æ·»åŠ ä¸€ä¸ªæ–°çš„å…³é”®å­—ç±»å‹:</p><pre class="lj lk ll lm gt ln li lo lp aw lq bi"><span id="1412" class="lr ls in li b gy lt lu l lv lw">function newSpeak(Parser) {<br/>    Parser.acorn.keywordTypes.guard = new TokenType('guard', {<br/>        keyword: 'guard',<br/>    });<br/>}</span></pre><p id="af66" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">ç„¶åï¼Œæˆ‘ä»¬åº”è¯¥åœ¨å…³é”®å­—åˆ—è¡¨ä¸­æ·»åŠ ä¸€ä¸ªæ–°çš„å…³é”®å­—(å¦‚å‰ä¸€ç¯‡æ–‡ç« æ‰€è¿°)ã€‚</p><pre class="lj lk ll lm gt ln li lo lp aw lq bi"><span id="8733" class="lr ls in li b gy lt lu l lv lw">function newSpeak(Parser) {   <br/>    Parser.acorn.keywordTypes.guard = new TokenType('guard', {<br/>        keyword: 'guard',<br/>    });<br/>    <br/>    return class extends Parser {<br/>        parse() {<br/>            this.keywords = addKeyword('guard', keywords);<br/>            return super.parse();<br/>        }<br/>    }</span><span id="467f" class="lr ls in li b gy mz lu l lv lw">}</span></pre><p id="4ac5" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">ç„¶åæˆ‘ä»¬éœ€è¦<code class="fe lf lg lh li b">parseStatement</code>:</p><pre class="lj lk ll lm gt ln li lo lp aw lq bi"><span id="4fa8" class="lr ls in li b gy lt lu l lv lw">class extends Parser {<br/>        parseStatement(context, topLevel, exports) {<br/>            if (this.type === Parser.acorn.keywordTypes.guard) {<br/>                return this.parseGuard(context, topLevel, exports);<br/>            }<br/><br/>            return super.parseStatement(context, topLevel, exports);<br/>        }<br/>        <br/>        parseGuard() {<br/>            this.next();<br/><br/>            const node = this.startNode();<br/>            <br/>            this.expect(tt.parenL);<br/>            <br/>            node.test = {<br/>                type: 'UnaryExpression',<br/>                operator: '!',<br/>                prefix: true,<br/>                argument: this.parseExpression(),<br/>            };<br/>            this.expect(tt.parenR);<br/>            this.expect(tt._else);<br/>    <br/>            node.consequent = this.parseStatement();<br/>            node.alternate = null;<br/>            <br/>            return this.finishNode(node, 'IfStatement');<br/>        }<br/>    };</span></pre><p id="5032" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">åœ¨<code class="fe lf lg lh li b">parseGuard</code>ä¸­å®é™…åšçš„æ˜¯ç”¨<code class="fe lf lg lh li b">UnaryExpression</code> notåˆ›å»ºä¸€ä¸ªæ–°çš„<code class="fe lf lg lh li b">IfStatement</code>ï¼Œå®ƒå…·æœ‰ä»ä»£ç ä¸­è§£æçš„åŸå§‹è¡¨è¾¾å¼ã€‚</p><p id="08dc" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">å®ƒä¸åº”è¯¥æœ‰ä»»ä½•<code class="fe lf lg lh li b">else</code>ï¼Œæ‰€ä»¥<code class="fe lf lg lh li b">alternate</code>æ˜¯<code class="fe lf lg lh li b">null</code>ï¼Œ<code class="fe lf lg lh li b">consequent</code>æ˜¯ä¼ é€’ç»™<code class="fe lf lg lh li b">guard</code>çš„åŸå§‹è¯­å¥ã€‚</p><p id="7822" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">æ•´ä¸ªä»£ç å°†æ˜¯è¿™æ ·çš„:</p><pre class="lj lk ll lm gt ln li lo lp aw lq bi"><span id="65fd" class="lr ls in li b gy lt lu l lv lw">const {TokenType, tokTypes: tt} = require(<a class="ae jz" href="https://github.com/acornjs/acorn" rel="noopener ugc nofollow" target="_blank">'acorn'</a>);</span><span id="a0fb" class="lr ls in li b gy mz lu l lv lw">const {print} = require(<a class="ae jz" href="https://github.com/coderaiser/putout" rel="noopener ugc nofollow" target="_blank">'putout'</a>);<br/>const {Parser} = require('acorn');</span><span id="62dd" class="lr ls in li b gy mz lu l lv lw">function newSpeak(Parser) {<br/>    Parser.acorn.keywordTypes.fn = new TokenType('fn', {<br/>        keyword: 'fn',<br/>    });<br/>    <br/>    Parser.acorn.keywordTypes.guard = new TokenType('guard', {<br/>        keyword: 'guard',<br/>    });<br/>    <br/>    return class extends Parser {<br/>        parse() {<br/>            const keywords = addKeyword('fn', this.keywords);<br/>            this.keywords = addKeyword('guard', keywords);<br/>            <br/>            return super.parse();<br/>        }<br/>        parseStatement(context, topLevel, exports) {<br/>            if (this.type === Parser.acorn.keywordTypes.fn) {<br/>                this.type = Parser.acorn.keywordTypes.function;<br/>            }<br/>            <br/>            if (this.type === Parser.acorn.keywordTypes.guard) {<br/>                return this.parseGuard(context, topLevel, exports);<br/>            }<br/><br/>            return super.parseStatement(context, topLevel, exports);<br/>        }<br/>        <br/>        parseGuard() {<br/>            this.next();<br/><br/>            const node = this.startNode();<br/>            <br/>            this.expect(tt.parenL);<br/>            <br/>            node.test = {<br/>                type: 'UnaryExpression',<br/>                operator: '!',<br/>                prefix: true,<br/>                argument: this.parseExpression(),<br/>            };<br/>            this.expect(tt.parenR);<br/>            this.expect(tt._else);<br/>    <br/>            node.consequent = this.parseStatement();<br/>            node.alternate = null;<br/>            <br/>            return this.finishNode(node, 'IfStatement');<br/>        }<br/>    };<br/>};<br/><br/>function addKeyword(keyword, keywords) {<br/>    const str = keywords<br/>        .toString()<br/>        .replace(')$', `|${keyword})$`)<br/>        .slice(1, -1);<br/>    <br/>    return RegExp(str);<br/>}<br/><br/>const {stringify} = JSON;<br/><br/>const MyParser = Parser.extend(<br/>    newSpeak,<br/>);<br/><br/>const ast = MyParser.parse(`<br/>    fn hello() {<br/>        guard (text !== "world") else {<br/>            return ""<br/>        }<br/>        <br/>        return "Hello " + text<br/>    }<br/>`);<br/><br/>console.log(stringify(ast, null, 4));<br/><br/>console.log(print(ast));<br/>// returns<br/>`<br/>function hello() {<br/>    if (!(text !== 'world')) {<br/>        return '';<br/>    }<br/><br/>    return 'Hello ' + text;<br/>}<br/>`</span></pre><p id="fac0" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">ä»Šå¤©å°±åˆ°è¿™é‡Œå§ï¼å¦‚æœä½ æœ‰å…³äºæ–°ä»£ç æ„é€ çš„æƒ³æ³•ï¼Œåªéœ€åœ¨<a class="ae jz" href="https://github.com/coderaiser/goldstein" rel="noopener ugc nofollow" target="_blank"><strong class="kg io">Goldstein</strong></a><strong class="kg io"/>èµ„æºåº“ä¸­åˆ›å»ºä¸€ä¸ªé—®é¢˜ï¼Œå®ƒåŒ…å«ä¸€ä¸ªæ–°çš„<strong class="kg io"> JavaScript </strong>ç¼–è¯‘å™¨ï¼Œæ²¡æœ‰é™åˆ¶ğŸ˜ã€‚</p><p id="ccfd" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated"><em class="kf">æ›´å¤šå†…å®¹è¯·çœ‹</em><a class="ae jz" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kg io"><em class="kf">plain English . io</em></strong></a><em class="kf">ã€‚æŠ¥åå‚åŠ æˆ‘ä»¬çš„</em> <a class="ae jz" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kg io"> <em class="kf">å…è´¹å‘¨æŠ¥</em> </strong> </a> <em class="kf">ã€‚å…³æ³¨æˆ‘ä»¬å…³äº</em><a class="ae jz" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="kg io"><em class="kf">Twitter</em></strong></a><em class="kf">å’Œ</em><a class="ae jz" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kg io"><em class="kf">LinkedIn</em></strong></a><em class="kf">ã€‚æŸ¥çœ‹æˆ‘ä»¬çš„</em> <a class="ae jz" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kg io"> <em class="kf">ç¤¾åŒºä¸å’Œè°</em> </strong> </a> <em class="kf">åŠ å…¥æˆ‘ä»¬çš„</em> <a class="ae jz" href="https://inplainenglish.pallet.com/talent/welcome" rel="noopener ugc nofollow" target="_blank"> <strong class="kg io"> <em class="kf">äººæ‰é›†ä½“</em> </strong> </a> <em class="kf">ã€‚</em></p></div></div>    
</body>
</html>