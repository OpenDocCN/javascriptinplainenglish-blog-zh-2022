<html>
<head>
<title>Patterns of JavaScript: Abstract Factory Pattern Explained By Tower Defense</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript模式:塔防解释的抽象工厂模式</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/patterns-of-javascript-abstract-factory-pattern-explained-by-tower-defense-46a36776a391?source=collection_archive---------4-----------------------#2022-11-22">https://javascript.plainenglish.io/patterns-of-javascript-abstract-factory-pattern-explained-by-tower-defense-46a36776a391?source=collection_archive---------4-----------------------#2022-11-22</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="47f7" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">用塔防深入解释抽象工厂</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/ba483b8184fe1976c219c6612fd1e879.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*BZxX63e2ZiYYU4Gpa2lUvQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Image made by the <a class="ae kv" href="http://www.arnoldcode.com/" rel="noopener ugc nofollow" target="_blank">Author</a> via Canva.com</figcaption></figure><p id="fe1d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="ls">抽象工厂</em> </strong>允许你从代码的任何其他部分(客户端)创建具有共同概念的对象。</p><p id="476e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所有的模式分为三类:<em class="ls">创造型</em>，<em class="ls">结构型</em> &amp; <em class="ls">行为型</em>。这种模式被归类为创造性的。你会看到<em class="ls">为什么。</em></p><p id="f566" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">抽象工厂允许您的代码委托对象创建，同时将更广泛的逻辑封装到工厂控件中。</p><p id="da42" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不是通过调用<code class="fe lt lu lv lw b">new</code>操作符来创建对象，而是由工厂来调用与实例化相关的函数。例如，对象缓存、对象的共享或重用、复杂逻辑、维护对象和类型计数的应用程序，以及与不同资源或设备交互的对象。</p><h1 id="1381" class="lx ly iq bd lz ma mb mc md me mf mg mh jw mi jx mj jz mk ka ml kc mm kd mn mo bi translated">简而言之，抽象工厂</h1><p id="d030" class="pw-post-body-paragraph kw kx iq ky b kz mp jr lb lc mq ju le lf mr lh li lj ms ll lm ln mt lp lq lr ij bi translated">这就像一个工厂方法(<a class="ae kv" href="https://medium.com/p/402c69426650" rel="noopener">深度文章</a>)，但是它创建了共享一个公共概念的对象。在表面之下，它对多个对象有一个抽象的概念。换句话说，“工厂是创建对象的代理”</p></div><div class="ab cl mu mv hu mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="ij ik il im in"><h1 id="4881" class="lx ly iq bd lz ma nb mc md me nc mg mh jw nd jx mj jz ne ka ml kc nf kd mn mo bi translated">何时&amp;为什么使用抽象工厂</h1><p id="a327" class="pw-post-body-paragraph kw kx iq ky b kz mp jr lb lc mq ju le lf mr lh li lj ms ll lm ln mt lp lq lr ij bi translated">抽象工厂模式用于创建相似的对象，但是它们的行为不同。<a class="ae kv" href="https://medium.com/p/402c69426650" rel="noopener">工厂方法</a>和抽象工厂已经合并成一个更通用的模式，叫做工厂。</p><p id="cfc4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">调用另一个函数(工厂)而不是用<code class="fe lt lu lv lw b">new()</code>操作符实例化一个对象可能过于复杂。但是构造函数对创建过程的控制是有限的(T21)。所以你会想把控制权交给一个拥有更广泛知识的工厂。</p><p id="cc89" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">什么是更广泛的知识，哪里需要？</p><p id="70f7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在创建过程与其他操作(如缓存、共享或重用以及复杂逻辑)相关的场景中。</p><p id="98a5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">简而言之，维护对象计数的应用程序和与不同资源或设备交互的对象。</p><p id="81b3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">经验法则:如果你的应用需要控制对象的创建，就使用工厂。</p></div><div class="ab cl mu mv hu mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="ij ik il im in"><h1 id="aebc" class="lx ly iq bd lz ma nb mc md me nc mg mh jw nd jx mj jz ne ka ml kc nf kd mn mo bi translated">模式概述</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ng"><img src="../Images/429ac5adce4245e960b5d0a305ec4bd4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*JXG_IHN5NSFUWJbdMBC21w.png"/></div></div></figure><p id="15a9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这种模式包括:</p><ul class=""><li id="6732" class="nh ni iq ky b kz la lc ld lf nj lj nk ln nl lr nm nn no np bi translated"><strong class="ky ir"><em class="ls">AbstractFactory:</em></strong>JavaScript并没有为你提供创建abstract factory的工具。它通常是一个产品界面。</li><li id="ed12" class="nh ni iq ky b kz nq lc nr lf ns lj nt ln nu lr nm nn no np bi translated"><strong class="ky ir"> <em class="ls">混凝土工厂:</em> </strong> <code class="fe lt lu lv lw b">EnemyFactory</code>，<code class="fe lt lu lv lw b">TowerFactory</code>都是混凝土工厂的例子。新的敌人/塔(产品)是由工厂对象“制造”的。新产品通过<code class="fe lt lu lv lw b">create</code>方式退货。</li><li id="ae2e" class="nh ni iq ky b kz nq lc nr lf ns lj nt ln nu lr nm nn no np bi translated"><strong class="ky ir"> <em class="ls">产品:</em> </strong>工厂创建产品实例。在示例代码中:<code class="fe lt lu lv lw b">Enemy</code>，<code class="fe lt lu lv lw b">Tower</code></li><li id="72af" class="nh ni iq ky b kz nq lc nr lf ns lj nt ln nu lr nm nn no np bi translated"><strong class="ky ir"><em class="ls">AbstractProduct:</em></strong>JavaScript也没有设置abstract product的工具。它们通常用于创建产品界面。</li></ul><p id="1938" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">虽然JavaScript不支持所有部分，但我们仍然可以构建这种模式。请看下面成功使用这种模式的例子。</p><blockquote class="nv nw nx"><p id="2687" class="kw kx ls ky b kz la jr lb lc ld ju le ny lg lh li nz lk ll lm oa lo lp lq lr ij bi translated">如果您想使用整个模式(包括接口)，您需要切换到TypesScript。</p></blockquote></div><div class="ab cl mu mv hu mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="ij ik il im in"><h1 id="3b2b" class="lx ly iq bd lz ma nb mc md me nc mg mh jw nd jx mj jz ne ka ml kc nf kd mn mo bi translated">示例1:简单的抽象工厂</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ob"><img src="../Images/8f8635f28d663879f7d31fa9f508dcbb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*U3Mx8l1LCOZiRNYY.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Captures from <a class="ae kv" href="https://forum.unity.com/members/ordinarydev83.623548/" rel="noopener ugc nofollow" target="_blank"><strong class="bd oc">OrdinaryDev83</strong></a><strong class="bd oc"> — </strong><a class="ae kv" href="https://play.google.com/store/apps/details?id=com.Char3Studio.TomsTD&amp;pli=1" rel="noopener ugc nofollow" target="_blank"><strong class="bd oc">TomsTD</strong></a></figcaption></figure><p id="d8c9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">假设您想要构建该功能:</p><ul class=""><li id="2c4f" class="nh ni iq ky b kz la lc ld lf nj lj nk ln nl lr nm nn no np bi translated">点击按钮A建造一座塔</li><li id="0ce6" class="nh ni iq ky b kz nq lc nr lf ns lj nt ln nu lr nm nn no np bi translated">点击按钮B产生一个敌人</li><li id="045b" class="nh ni iq ky b kz nq lc nr lf ns lj nt ln nu lr nm nn no np bi translated">关于已经创建的内容及其统计的日志信息</li></ul><p id="198f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">由于JavaScript的原因，JavaScript示例不能使用抽象类。</p><h2 id="d518" class="od ly iq bd lz oe of dn md og oh dp mh lf oi oj mj lj ok ol ml ln om on mn oo bi translated">产品</h2><p id="97fd" class="pw-post-body-paragraph kw kx iq ky b kz mp jr lb lc mq ju le lf mr lh li lj ms ll lm ln mt lp lq lr ij bi translated">抽象类和接口确保派生类有一致的接口。在JavaScript中，我们负责确保每个“具体”对象都有相同的接口定义。您可以通过确保您的对象具有相同的属性和方法来实现这一点。</p><p id="a3a7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="ls">产品—敌人</em> </strong></p><pre class="kg kh ki kj gt op lw oq bn or os bi"><span id="de9b" class="ot ly iq lw b be ou ov l ow ox">function Enemy(movementSpeed) {<br/>    this.movementSpeed = movementSpeed;<br/>    this.info = function () {<br/>        console.log("I am an Enemy and I move " + movementSpeed + ' tiles/s.');<br/>    };<br/>}</span></pre><p id="bb39" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="ls">混凝土成品-塔</em> </strong></p><pre class="kg kh ki kj gt op lw oq bn or os bi"><span id="5c3c" class="ot ly iq lw b be ou ov l ow ox">function Tower(firingSpeed) {<br/>    this.firingSpeed = firingSpeed;<br/>    this.info = function () {<br/>        console.log("I am a Tower and I shoot " + firingSpeed + ' bullets/s.');<br/>    };<br/>}</span></pre><p id="862d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">两者都有一个速度和一个叫做<code class="fe lt lu lv lw b">info</code>的方法。</p><h2 id="2ef2" class="od ly iq bd lz oe of dn md og oh dp mh lf oi oj mj lj ok ol ml ln om on mn oo bi translated">工厂</h2><p id="4bcf" class="pw-post-body-paragraph kw kx iq ky b kz mp jr lb lc mq ju le lf mr lh li lj ms ll lm ln mt lp lq lr ij bi translated">这个例子需要两个具体的工厂:<code class="fe lt lu lv lw b">EnemyFactory</code>和<code class="fe lt lu lv lw b">TowerFactory</code>。<code class="fe lt lu lv lw b">Enemy</code>实例在第一个中创建，而<code class="fe lt lu lv lw b">Tower</code>实例在第二个中创建。</p><p id="31d8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="ls">混凝土工厂——敌人</em> </strong></p><pre class="kg kh ki kj gt op lw oq bn or os bi"><span id="6169" class="ot ly iq lw b be ou ov l ow ox">function EnemyFactory() {<br/><br/>    this.create = function (movementSpeed) {<br/>        return new Enemy(movementSpeed);<br/>    };<br/>}</span></pre><p id="175e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="ls">混凝土工厂—塔楼</em> </strong></p><pre class="kg kh ki kj gt op lw oq bn or os bi"><span id="0378" class="ot ly iq lw b be ou ov l ow ox">function TowerFactory() {<br/><br/>    this.create = function (firingSpeed) {<br/>        return new Tower(firingSpeed);<br/>    };<br/>}</span></pre><h2 id="fdce" class="od ly iq bd lz oe of dn md og oh dp mh lf oi oj mj lj ok ol ml ln om on mn oo bi translated">运行代码和给工厂打电话</h2><p id="89e3" class="pw-post-body-paragraph kw kx iq ky b kz mp jr lb lc mq ju le lf mr lh li lj ms ll lm ln mt lp lq lr ij bi translated">两个产品都是<code class="fe lt lu lv lw b">entity</code>类型(具有相同的接口)，所以客户端可以用相同的方式对待它们。</p><p id="98de" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们创建了一个有两个敌人和两座塔的阵列。然后我们询问每个实体它们是什么，它们的速度是多少。</p><p id="1d6f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"><em class="ls">-客户端(呼叫者)</em>代码</strong></p><pre class="kg kh ki kj gt op lw oq bn or os bi"><span id="5849" class="ot ly iq lw b be ou ov l ow ox">function run() {<br/>    var entities = [];<br/>    var enemyFactory = new EnemyFactory();<br/>    var vendorFactory = new TowerFactory();<br/><br/>    entities.push(enemyFactory.create(5));<br/>    entities.push(enemyFactory.create(7));<br/>    entities.push(vendorFactory.create(2));<br/>    entities.push(vendorFactory.create(5));<br/><br/>    for (var i = 0, len = entities.length; i &lt; len; i++) {<br/>        entities[i].info();<br/>    }<br/>}<br/><br/>run()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oy"><img src="../Images/99b7c7c398da4d671b4e1f4cf37add55.png" data-original-src="https://miro.medium.com/v2/resize:fit:672/format:webp/1*pIUyX6-xUh0P4aqY1BJcPA.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Console Output of Example 1</figcaption></figure></div><div class="ab cl mu mv hu mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="ij ik il im in"><h1 id="6035" class="lx ly iq bd lz ma nb mc md me nc mg mh jw nd jx mj jz ne ka ml kc nf kd mn mo bi translated">示例2:带有抽象产品的Fullborn模式</h1><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi oz"><img src="../Images/fcf4146edf2383257f8e0fc71edca598.png" data-original-src="https://miro.medium.com/v2/resize:fit:1320/0*UjDMdhXhpRK4vuNy.gif"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk"><a class="ae kv" href="https://tearascal.tumblr.com/post/159804371478/wip-animation-for-monsters-monocles-new" rel="noopener ugc nofollow" target="_blank">All Rights Reserved to Craig's Art blog</a></figcaption></figure><p id="8221" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你真的希望有一个名为<code class="fe lt lu lv lw b">Entity</code>的类来启用一种模式，你可以在游戏中的实体的所有创建过程中使用这种模式。</p><p id="ddf0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你可以很容易地为你的游戏实现统计/成就/排名列表。使用JavaScript类语法，您可以创建一个类似于<em class="ls">抽象产品的基类。</em></p><h2 id="08e6" class="od ly iq bd lz oe of dn md og oh dp mh lf oi oj mj lj ok ol ml ln om on mn oo bi translated"><strong class="ak"> <em class="pa">基类，又名</em>抽象工厂</strong></h2><pre class="kg kh ki kj gt op lw oq bn or os bi"><span id="b7cc" class="ot ly iq lw b be ou ov l ow ox">class Entity {<br/><br/>    type;<br/>    speed;<br/>    speedRelation = 'move' |'shoot';<br/>    what = 'tiles' | 'bullets'<br/><br/><br/>    info = function() {<br/>        console.log(`I am ${this.type} and I ${this.speedRelation} ${this.speed} ${this.what}/s.`);<br/>    }<br/><br/>    init = function(){<br/>        console.log(`There is no init-function for ${this.constructor.name}.`);<br/>    }<br/>}</span></pre><p id="d8d1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这必须包含所有其他混凝土产品必须满足的最小重叠属性。您需要有以下字段:</p><ul class=""><li id="9ef6" class="nh ni iq ky b kz la lc ld lf nj lj nk ln nl lr nm nn no np bi translated"><code class="fe lt lu lv lw b">type</code>:已经创建了什么混凝土类型(混凝土产品)</li><li id="f949" class="nh ni iq ky b kz nq lc nr lf ns lj nt ln nu lr nm nn no np bi translated"><code class="fe lt lu lv lw b">speed</code>:这个实体有多快</li><li id="f86d" class="nh ni iq ky b kz nq lc nr lf ns lj nt ln nu lr nm nn no np bi translated"><code class="fe lt lu lv lw b">speedRelation</code>:参考移动(敌人)或射击(塔)的速度值</li><li id="bdf6" class="nh ni iq ky b kz nq lc nr lf ns lj nt ln nu lr nm nn no np bi translated"><code class="fe lt lu lv lw b">what</code>:与<code class="fe lt lu lv lw b">speedRelation</code>的关系不是<em class="ls">瓦片</em>(敌人)就是<em class="ls">子弹</em>(塔)</li></ul><p id="390d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">以及以下方法:</p><ul class=""><li id="97f7" class="nh ni iq ky b kz la lc ld lf nj lj nk ln nl lr nm nn no np bi translated"><code class="fe lt lu lv lw b">info</code>:打印一个实体的多条信息(<code class="fe lt lu lv lw b">type</code>、<code class="fe lt lu lv lw b">speed</code>、<code class="fe lt lu lv lw b">speedRelation</code>、<code class="fe lt lu lv lw b">what</code>)</li><li id="bb35" class="nh ni iq ky b kz nq lc nr lf ns lj nt ln nu lr nm nn no np bi translated"><code class="fe lt lu lv lw b">init</code>:调用具体产品的初始化例程。如果没有，调用类<code class="fe lt lu lv lw b">Entity</code>中的默认值。</li></ul><h2 id="9dd8" class="od ly iq bd lz oe of dn md og oh dp mh lf oi oj mj lj ok ol ml ln om on mn oo bi translated">混凝土产品</h2><p id="8edb" class="pw-post-body-paragraph kw kx iq ky b kz mp jr lb lc mq ju le lf mr lh li lj ms ll lm ln mt lp lq lr ij bi translated">每个具体的产品需要通过<code class="fe lt lu lv lw b">extends</code>从你的基类继承。</p><p id="b7b9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="ls">混凝土产品——敌人</em> </strong></p><pre class="kg kh ki kj gt op lw oq bn or os bi"><span id="4040" class="ot ly iq lw b be ou ov l ow ox">class Enemy extends Entity {<br/>    constructor(speed) {<br/>        super();<br/>        this.type = 'Enemy';<br/>        this.speed = speed;<br/>        this.speedRelation = 'move';<br/>        this.what = 'tiles';<br/>    }<br/><br/>    init = function () {<br/>        this.run();<br/>    }<br/><br/>    run = function () {<br/>        console.log('Enemy starts to run.');<br/>    }<br/>}</span></pre><p id="9758" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="ls">混凝土产品—塔</em> </strong></p><p id="3028" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如您所见，该塔没有init类。稍后调用<code class="fe lt lu lv lw b">init</code>，将使用<code class="fe lt lu lv lw b">Entity</code>类中的回退并打印出简单信息。</p><pre class="kg kh ki kj gt op lw oq bn or os bi"><span id="af7a" class="ot ly iq lw b be ou ov l ow ox">class Tower extends Entity {<br/>    constructor(speed) {<br/>        super();<br/>        this.type = 'Tower';<br/>        this.speed = speed;<br/>        this.speedRelation = 'shoot';<br/>        this.what = 'bullets';<br/>    }<br/>}</span></pre><h2 id="2466" class="od ly iq bd lz oe of dn md og oh dp mh lf oi oj mj lj ok ol ml ln om on mn oo bi translated">混凝土工厂</h2><p id="b48e" class="pw-post-body-paragraph kw kx iq ky b kz mp jr lb lc mq ju le lf mr lh li lj ms ll lm ln mt lp lq lr ij bi translated">这些只需要很小的重构就可以将<code class="fe lt lu lv lw b">speed</code>转发给期望的构造函数。</p><p id="2c05" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="ls">混凝土工厂——敌人</em> </strong></p><pre class="kg kh ki kj gt op lw oq bn or os bi"><span id="1728" class="ot ly iq lw b be ou ov l ow ox">function EnemyFactory() {<br/>        this.create = function (speed) {<br/>        return new Enemy(speed);<br/>    };<br/>}</span></pre><p id="b021" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="ls">混凝土工厂—塔楼</em> </strong></p><pre class="kg kh ki kj gt op lw oq bn or os bi"><span id="6552" class="ot ly iq lw b be ou ov l ow ox">function TowerFactory() {<br/><br/>    this.create = function (speed) {<br/>        return new Tower(speed);<br/>    };<br/>}</span></pre><h2 id="a8d8" class="od ly iq bd lz oe of dn md og oh dp mh lf oi oj mj lj ok ol ml ln om on mn oo bi translated">运行代码和给工厂打电话</h2><p id="fb92" class="pw-post-body-paragraph kw kx iq ky b kz mp jr lb lc mq ju le lf mr lh li lj ms ll lm ln mt lp lq lr ij bi translated"><strong class="ky ir"><em class="ls">-客户端(调用者)</em>-代码</strong></p><pre class="kg kh ki kj gt op lw oq bn or os bi"><span id="dcf2" class="ot ly iq lw b be ou ov l ow ox">function run() {<br/>    var entities = [];<br/>    var enemyFactory = new EnemyFactory();<br/>    var vendorFactory = new TowerFactory();<br/><br/>    entities.push(enemyFactory.create(5));<br/>    entities.push(enemyFactory.create(7));<br/>    entities.push(vendorFactory.create(2));<br/>    entities.push(vendorFactory.create(5));<br/><br/>    for (var i = 0, len = entities.length; i &lt; len; i++) {<br/>        entities[i].info();<br/>        entities[i].init();<br/>    }<br/>}<br/><br/>run()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pb"><img src="../Images/0b45fb50819f9ca51c62cf4d4d33071f.png" data-original-src="https://miro.medium.com/v2/resize:fit:656/format:webp/1*XK-Y_Ku4GcOGFGtNMpY9Xg.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">The output of Example 2</figcaption></figure><p id="0a07" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，您有两个工厂来创建共享一个公共库的不同对象，它们得到相同的处理(<code class="fe lt lu lv lw b">info()</code> &amp; <code class="fe lt lu lv lw b">init()</code>，如果具体产品中没有对象，还有一个后备)。</p></div><div class="ab cl mu mv hu mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="ij ik il im in"><h1 id="9b92" class="lx ly iq bd lz ma nb mc md me nc mg mh jw nd jx mj jz ne ka ml kc nf kd mn mo bi translated">一个开放点:“更广泛的知识？”</h1><p id="1a9c" class="pw-post-body-paragraph kw kx iq ky b kz mp jr lb lc mq ju le lf mr lh li lj ms ll lm ln mt lp lq lr ij bi translated">我说:<em class="ls">“所以你会想把控制权交给一个拥有更广泛知识的工厂。”</em></p><p id="d2b1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ls">你不想在</em>一个具体的产品中实现这个，而是在工厂中实现。</p><p id="ef1c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">此外，这是你可以快速实现游戏的统计数据、成就和排名列表的时候。</p><p id="6788" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这个例子实现了保存当前情况的统计数据:</p><ul class=""><li id="d58e" class="nh ni iq ky b kz la lc ld lf nj lj nk ln nl lr nm nn no np bi translated">建了多少座塔？</li><li id="9b9d" class="nh ni iq ky b kz nq lc nr lf ns lj nt ln nu lr nm nn no np bi translated">滋生了多少敌人？</li></ul><h2 id="11fa" class="od ly iq bd lz oe of dn md og oh dp mh lf oi oj mj lj ok ol ml ln om on mn oo bi translated">Stats对象</h2><pre class="kg kh ki kj gt op lw oq bn or os bi"><span id="c8a2" class="ot ly iq lw b be ou ov l ow ox">const MAP_STATS = {<br/>    enemiesCount: 0,<br/>    towerCount: 0,<br/>}</span></pre><h2 id="7320" class="od ly iq bd lz oe of dn md og oh dp mh lf oi oj mj lj ok ol ml ln om on mn oo bi translated">写入Stats对象—编辑工厂，而不是产品</h2><p id="2b71" class="pw-post-body-paragraph kw kx iq ky b kz mp jr lb lc mq ju le lf mr lh li lj ms ll lm ln mt lp lq lr ij bi translated"><strong class="ky ir"> <em class="ls">混凝土工厂—塔楼</em> </strong></p><pre class="kg kh ki kj gt op lw oq bn or os bi"><span id="ef32" class="ot ly iq lw b be ou ov l ow ox">function TowerFactory() {<br/><br/>    this.create = function (speed) {<br/>        // add following line<br/>        MAP_STATS.towerCount++;<br/>        return new Tower(speed);<br/>    };<br/>}</span></pre><p id="7f80" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> <em class="ls">混凝土工厂——敌人</em> </strong></p><pre class="kg kh ki kj gt op lw oq bn or os bi"><span id="73d8" class="ot ly iq lw b be ou ov l ow ox">function EnemyFactory() {<br/><br/>    this.create = function (speed) {<br/>        // add following line<br/>        MAP_STATS.enemiesCount++;<br/>        return new Enemy(speed);<br/>    };<br/>}</span></pre><h2 id="da29" class="od ly iq bd lz oe of dn md og oh dp mh lf oi oj mj lj ok ol ml ln om on mn oo bi translated">运行代码和给工厂打电话</h2><p id="b13c" class="pw-post-body-paragraph kw kx iq ky b kz mp jr lb lc mq ju le lf mr lh li lj ms ll lm ln mt lp lq lr ij bi translated"><strong class="ky ir"><em class="ls">-客户端(呼叫者)-代码</em> </strong></p><pre class="kg kh ki kj gt op lw oq bn or os bi"><span id="cd93" class="ot ly iq lw b be ou ov l ow ox">function run() {<br/>    var entities = [];<br/>    var enemyFactory = new EnemyFactory();<br/>    var vendorFactory = new TowerFactory();<br/><br/>    entities.push(enemyFactory.create(5));<br/>    entities.push(enemyFactory.create(7));<br/>    entities.push(vendorFactory.create(2));<br/>    entities.push(vendorFactory.create(5));<br/><br/>    for (var i = 0, len = entities.length; i &lt; len; i++) {<br/>        entities[i].info();<br/>        entities[i].init();<br/>    }<br/><br/>    // add following line<br/>    console.log(`Map Stats: <br/>      Enemies: ${MAP_STATS.enemiesCount},<br/>      Towers: ${MAP_STATS.towerCount}`<br/>    );<br/>}<br/><br/>run()</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi pc"><img src="../Images/405ab28c31a196362e483c6ba2496c6b.png" data-original-src="https://miro.medium.com/v2/resize:fit:618/format:webp/1*ummtBMbuGRpU8XUh6URpMw.png"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">The output Example 2 With MAP_STATS</figcaption></figure><p id="b089" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你现在有两个工厂，每当一个新的敌人或塔被创造出来的时候，它们就会写入你的全球统计数据。你可以开发一个特性，每当有敌人死亡，死亡计数器就会上升。</p><h1 id="3302" class="lx ly iq bd lz ma mb mc md me mf mg mh jw mi jx mj jz mk ka ml kc mm kd mn mo bi translated">少了什么？正确！抽象工厂</h1><p id="77f7" class="pw-post-body-paragraph kw kx iq ky b kz mp jr lb lc mq ju le lf mr lh li lj ms ll lm ln mt lp lq lr ij bi translated"><em class="ls">如何实现？</em></p><p id="d2b8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">使用同样的技术，您可以创建一个基本工厂作为抽象工厂，而不需要接口的支持。</p><p id="25e4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">既然你现在对抽象工厂模式有信心，我相信你也能实现一个没有接口的抽象工厂😉</p><p id="5671" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><a class="ae kv" href="https://arnoldcodeacademy.ck.page/26-web-dev-cheat-sheets" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="ls">节省你和网络开发人员的时间，专注于重要的主题。</em> </strong> </a></p><p id="4b04" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ls">更多内容请看</em> <a class="ae kv" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="ls">说白了就是</em> </strong> </a> <em class="ls">。报名参加我们的</em> <a class="ae kv" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="ls">免费每周简讯</em> </strong> </a> <em class="ls">。关注我们关于</em><a class="ae kv" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="ls">Twitter</em></strong></a>，<a class="ae kv" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="ls">LinkedIn</em></strong></a><em class="ls">，</em><a class="ae kv" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="ls">YouTube</em></strong></a><em class="ls">，以及</em> <a class="ae kv" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="ls">不和</em></strong></a><em class="ls"><em class="ls">。对增长黑客感兴趣？检查出</em> <a class="ae kv" href="https://circuit.ooo/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="ls">电路</em> </strong> </a> <em class="ls">。</em></em></p></div></div>    
</body>
</html>