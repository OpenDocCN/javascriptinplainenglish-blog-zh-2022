<html>
<head>
<title>7 Component Communications in Vue 3</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Vue 3中的7个组件通信</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/7-component-communications-in-vue-3-f4d2d795481d?source=collection_archive---------2-----------------------#2022-02-21">https://javascript.plainenglish.io/7-component-communications-in-vue-3-f4d2d795481d?source=collection_archive---------2-----------------------#2022-02-21</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="5a97" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">这里所有的通讯手段都可以使用</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/fbd3f905368a1dfaeee9961b0793f2a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7xiGuAXSS9lnZleA3Fy_XA.png"/></div></div></figure><h1 id="4e80" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">写在前面</h1><p id="4007" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">本文采用<code class="fe mf mg mh mi b">&lt;script setup /&gt;</code>的编写方式，比options API更自由。那么我们就来说说以下七种组件通信方式:</p><ol class=""><li id="dab9" class="mj mk iq ll b lm ml lp mm ls mn lw mo ma mp me mq mr ms mt bi translated">小道具</li><li id="87ab" class="mj mk iq ll b lm mu lp mv ls mw lw mx ma my me mq mr ms mt bi translated">发射</li><li id="6304" class="mj mk iq ll b lm mu lp mv ls mw lw mx ma my me mq mr ms mt bi translated">v型车</li><li id="8213" class="mj mk iq ll b lm mu lp mv ls mw lw mx ma my me mq mr ms mt bi translated">参考文献</li><li id="5266" class="mj mk iq ll b lm mu lp mv ls mw lw mx ma my me mq mr ms mt bi translated">提供/注入</li><li id="aa29" class="mj mk iq ll b lm mu lp mv ls mw lw mx ma my me mq mr ms mt bi translated">事件总线</li><li id="0b9e" class="mj mk iq ll b lm mu lp mv ls mw lw mx ma my me mq mr ms mt bi translated">vuex/皮尼亚</li></ol><h1 id="7bb3" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">举个例子</h1><p id="e59e" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">本文将使用如下演示，如下图所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="ab gu cl mz"><img src="../Images/52649308c615a13ea3dc783d6a252422.png" data-original-src="https://miro.medium.com/v2/format:webp/1*U8DJPgX5S7kwWARddCDvmw.png"/></div></figure><p id="c6de" class="pw-post-body-paragraph lj lk iq ll b lm ml jr lo lp mm ju lr ls na lu lv lw nb ly lz ma nc mc md me ij bi translated">在上图中，列表和输入框分别是父组件和子组件。根据不同的沟通方式，父子组件会有所调整。</p><h1 id="5ac7" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">1.小道具</h1><p id="a4f4" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">道具是Vue中最常见的亲子交流方式，使用起来也相对简单。</p><p id="2d10" class="pw-post-body-paragraph lj lk iq ll b lm ml jr lo lp mm ju lr ls na lu lv lw nb ly lz ma nc mc md me ij bi translated">根据上面的演示，我们在父组件中定义了数据和对数据的操作，子组件只呈现一个列表。</p><p id="507c" class="pw-post-body-paragraph lj lk iq ll b lm ml jr lo lp mm ju lr ls na lu lv lw nb ly lz ma nc mc md me ij bi translated"><code class="fe mf mg mh mi b">The parent component code is as follows:</code></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="4e5e" class="pw-post-body-paragraph lj lk iq ll b lm ml jr lo lp mm ju lr ls na lu lv lw nb ly lz ma nc mc md me ij bi translated">子组件只需要呈现父组件传递的值。</p><p id="d393" class="pw-post-body-paragraph lj lk iq ll b lm ml jr lo lp mm ju lr ls na lu lv lw nb ly lz ma nc mc md me ij bi translated"><code class="fe mf mg mh mi b">The code is as follows:</code></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><h1 id="a223" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">2.发射</h1><p id="23af" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">Emit也是Vue中最常见的组件通信方式，用于子组件向父组件传递消息。</p><p id="76c6" class="pw-post-body-paragraph lj lk iq ll b lm ml jr lo lp mm ju lr ls na lu lv lw nb ly lz ma nc mc md me ij bi translated">我们在父组件中定义列表，子组件只需要传递添加的值。</p><p id="88cf" class="pw-post-body-paragraph lj lk iq ll b lm ml jr lo lp mm ju lr ls na lu lv lw nb ly lz ma nc mc md me ij bi translated"><code class="fe mf mg mh mi b">The child component code is as follows:</code></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="1b30" class="pw-post-body-paragraph lj lk iq ll b lm ml jr lo lp mm ju lr ls na lu lv lw nb ly lz ma nc mc md me ij bi translated">单击子组件中的[Add]按钮后，我们发出一个自定义事件，并将添加的值作为参数传递给父组件。</p><p id="d8fc" class="pw-post-body-paragraph lj lk iq ll b lm ml jr lo lp mm ju lr ls na lu lv lw nb ly lz ma nc mc md me ij bi translated"><code class="fe mf mg mh mi b">The parent component code is as follows:</code></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="c0e1" class="pw-post-body-paragraph lj lk iq ll b lm ml jr lo lp mm ju lr ls na lu lv lw nb ly lz ma nc mc md me ij bi translated">在父组件中，只需要监听子组件的自定义事件，然后执行相应的加法逻辑。</p><h1 id="db9c" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">3.v型车</h1><p id="6856" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">v-model是Vue中优秀的语法糖，比如下面的代码。</p><pre class="kg kh ki kj gt nf mi ng nh aw ni bi"><span id="3073" class="nj ks iq mi b gy nk nl l nm nn">&lt;ChildComponent v-model:title="pageTitle" /&gt;</span></pre><p id="7e43" class="pw-post-body-paragraph lj lk iq ll b lm ml jr lo lp mm ju lr ls na lu lv lw nb ly lz ma nc mc md me ij bi translated">这是以下代码的简写形式</p><pre class="kg kh ki kj gt nf mi ng nh aw ni bi"><span id="bf67" class="nj ks iq mi b gy nk nl l nm nn">&lt;ChildComponent :title="pageTitle" @update:title="pageTitle = $event" /&gt;</span></pre><p id="150b" class="pw-post-body-paragraph lj lk iq ll b lm ml jr lo lp mm ju lr ls na lu lv lw nb ly lz ma nc mc md me ij bi translated">这确实容易多了。现在我们将使用v-model来实现上面的例子。</p><p id="4e2b" class="pw-post-body-paragraph lj lk iq ll b lm ml jr lo lp mm ju lr ls na lu lv lw nb ly lz ma nc mc md me ij bi translated"><code class="fe mf mg mh mi b">child component</code></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="8e58" class="pw-post-body-paragraph lj lk iq ll b lm ml jr lo lp mm ju lr ls na lu lv lw nb ly lz ma nc mc md me ij bi translated">在子组件中，我们先定义props和emits，在添加完成后再发出指定的事件。</p><blockquote class="no np nq"><p id="17e9" class="lj lk nr ll b lm ml jr lo lp mm ju lr ns na lu lv nt nb ly lz nu nc mc md me ij bi translated"><strong class="ll ir"> <em class="iq">注:</em> </strong> <em class="iq">更新:*是Vue中固定的写法，*代表道具中的一个属性名。</em></p></blockquote><p id="d269" class="pw-post-body-paragraph lj lk iq ll b lm ml jr lo lp mm ju lr ls na lu lv lw nb ly lz ma nc mc md me ij bi translated">它在父组件中使用相对简单，代码如下:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><h1 id="d982" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">4.参考文献</h1><p id="de4d" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">当使用option API时，我们可以通过这个获得指定的元素或组件。$refs.name，但不在组合API中。如果要通过ref获取，需要定义一个同名的Ref对象，在组件挂载后可以访问。</p><p id="55fc" class="pw-post-body-paragraph lj lk iq ll b lm ml jr lo lp mm ju lr ls na lu lv lw nb ly lz ma nc mc md me ij bi translated"><code class="fe mf mg mh mi b">The sample code is as follows:</code></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="0297" class="pw-post-body-paragraph lj lk iq ll b lm ml jr lo lp mm ju lr ls na lu lv lw nb ly lz ma nc mc md me ij bi translated"><code class="fe mf mg mh mi b">The child component code is as follows:</code></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><blockquote class="no np nq"><p id="c22b" class="lj lk nr ll b lm ml jr lo lp mm ju lr ns na lu lv nt nb ly lz nu nc mc md me ij bi translated"><strong class="ll ir"> <em class="iq">注意:</em> </strong> <em class="iq">默认关闭设置组件，通过模板ref获取组件的公共实例。如果需要曝光，需要通过</em><strong class="ll ir"><em class="iq">define expose API</em></strong><em class="iq">进行曝光。</em></p></blockquote><h1 id="258a" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">5.提供/注入</h1><p id="1d4a" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">Provide和inject是Vue中提供的一对API。无论层次有多深，API都可以实现数据从父组件到子组件的传递。</p><p id="2a8a" class="pw-post-body-paragraph lj lk iq ll b lm ml jr lo lp mm ju lr ls na lu lv lw nb ly lz ma nc mc md me ij bi translated"><code class="fe mf mg mh mi b">The sample code looks like this:</code></p><p id="fa05" class="pw-post-body-paragraph lj lk iq ll b lm ml jr lo lp mm ju lr ls na lu lv lw nb ly lz ma nc mc md me ij bi translated"><code class="fe mf mg mh mi b">parent component</code></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="34fc" class="pw-post-body-paragraph lj lk iq ll b lm ml jr lo lp mm ju lr ls na lu lv lw nb ly lz ma nc mc md me ij bi translated"><code class="fe mf mg mh mi b">child component</code></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><blockquote class="no np nq"><p id="464b" class="lj lk nr ll b lm ml jr lo lp mm ju lr ns na lu lv nt nb ly lz nu nc mc md me ij bi translated"><strong class="ll ir"> <em class="iq">注意:</em> </strong> <em class="iq">使用provide进行数据传输时，尽量用readonly封装数据，避免子组件修改父组件传递的数据。</em></p></blockquote><h1 id="2d2a" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">6.事件总线</h1><p id="85ae" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">在Vue 3中删除了eventBus，但是可以在第三方工具的帮助下完成。Vue官方推荐mitt或微型发射器。在大多数情况下，不建议使用全局事件总线来实现组件通信。虽然比较简单粗暴，但是从长远来看维护事件总线是个大问题，这里就不解释了。有关详细信息，您可以阅读特定工具的文档。</p><h1 id="9374" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">7.Vuex &amp;&amp; Pinia</h1><p id="0427" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">Vuex和Pinia是Vue 3中的状态管理工具。使用这两个工具可以很容易地实现组件通信。由于这两个工具都比较强大，这里就不展示了。有关详细信息，请参考文档。</p><h1 id="c75d" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">最后</h1><p id="ea1c" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">本文到此结束，没什么复杂的。</p><p id="399b" class="pw-post-body-paragraph lj lk iq ll b lm ml jr lo lp mm ju lr ls na lu lv lw nb ly lz ma nc mc md me ij bi translated">感谢阅读。</p><p id="4abe" class="pw-post-body-paragraph lj lk iq ll b lm ml jr lo lp mm ju lr ls na lu lv lw nb ly lz ma nc mc md me ij bi translated"><em class="nr">更多内容请看</em> <a class="ae nv" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ll ir"> <em class="nr">说白了就是</em> </strong> </a> <em class="nr">。报名参加我们的</em> <a class="ae nv" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ll ir"> <em class="nr">免费每周简讯</em> </strong> </a> <em class="nr">。在我们的</em> <a class="ae nv" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="ll ir"> <em class="nr">社区不和谐</em> </strong> </a> <em class="nr">获取独家写作机会和建议。</em></p></div></div>    
</body>
</html>