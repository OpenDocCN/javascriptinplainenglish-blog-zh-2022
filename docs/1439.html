<html>
<head>
<title>How to Implement Verification Code With Vue 3 &amp; TypeScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Vue 3 &amp; TypeScript实现验证码</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/verification-code-with-vue-3-typescript-befd9857523a?source=collection_archive---------4-----------------------#2022-03-24">https://javascript.plainenglish.io/verification-code-with-vue-3-typescript-befd9857523a?source=collection_archive---------4-----------------------#2022-03-24</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="0920" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">如何用Vue 3和TypeScript实现验证码的教程。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/2ed923c873c1850d3505831502461b2e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*gfoZ1ae0MoUuTyYsZxBCkQ.gif"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">verification-code component</figcaption></figure><h1 id="8a2d" class="ks kt in bd ku kv kw kx ky kz la lb lc jt ld ju le jw lf jx lg jz lh ka li lj bi translated">介绍</h1><p id="a480" class="pw-post-body-paragraph lk ll in lm b ln lo jo lp lq lr jr ls lt lu lv lw lx ly lz ma mb mc md me mf ig bi translated">双因素认证(2FA)方法之一是带有<strong class="lm io"> 4/6数字</strong> s的<strong class="lm io">验证码</strong>，验证码是用于确认用户帐户的附加保护层。许多应用程序，如银行应用程序，现在采用这种方法来验证用户，通过短信、电话或电子邮件向他们的设备发送一次性密码(OTP)/代码。然后，用户必须将OTP /代码键入或粘贴到应用程序中才能获得访问权限。</p><h2 id="a5e0" class="mg kt in bd ku mh mi dn ky mj mk dp lc lt ml mm le lx mn mo lg mb mp mq li mr bi translated">项目先决条件和要求</h2><p id="93ca" class="pw-post-body-paragraph lk ll in lm b ln lo jo lp lq lr jr ls lt lu lv lw lx ly lz ma mb mc md me mf ig bi translated">这个项目是使用Vite创建的。而且我用Vue 3 <strong class="lm io">复合API </strong>，Typescript，CSS。</p><p id="b423" class="pw-post-body-paragraph lk ll in lm b ln ms jo lp lq mt jr ls lt mu lv lw lx mv lz ma mb mw md me mf ig bi translated">为了在web和android浏览器中运行，我为我的项目定义了这个组件的几个要求:</p><ul class=""><li id="d7cf" class="mx my in lm b ln ms lq mt lt mz lx na mb nb mf nc nd ne nf bi translated">只能是<strong class="lm io">数字</strong>。</li><li id="ee77" class="mx my in lm b ln ng lq nh lt ni lx nj mb nk mf nc nd ne nf bi translated">能够使用【退格键】删除代码</li><li id="33a3" class="mx my in lm b ln ng lq nh lt ni lx nj mb nk mf nc nd ne nf bi translated">能够<strong class="lm io">粘贴</strong>代码。</li><li id="9628" class="mx my in lm b ln ng lq nh lt ni lx nj mb nk mf nc nd ne nf bi translated"><strong class="lm io">在任何输入元素中替换</strong>一个新值。</li></ul><p id="7225" class="pw-post-body-paragraph lk ll in lm b ln ms jo lp lq mt jr ls lt mu lv lw lx mv lz ma mb mw md me mf ig bi translated">如果你有任何进一步的要求，请留言告诉我。我们开始吧！</p><p id="5e2a" class="pw-post-body-paragraph lk ll in lm b ln ms jo lp lq mt jr ls lt mu lv lw lx mv lz ma mb mw md me mf ig bi translated">首先，定义一个输入类型为<code class="fe nl nm nn no b">number</code>并验证输入值。我们需要监听键盘事件，即<strong class="lm io">按键</strong>事件，以验证来自键盘的输入值。这里，声明一个数组变量来允许输入哪些键。</p><pre class="kd ke kf kg gt np no nq nr aw ns bi"><span id="b533" class="mg kt in no b gy nt nu l nv nw">const keysAllowed: string[] =["0","1","2","3","4","5","6","7","8","9",];</span><span id="31f9" class="mg kt in no b gy nx nu l nv nw">function <strong class="no io">isNumber</strong>(event: Event) {<br/>const keyPressed: string = (event as KeyboardEvent).key;</span><span id="84ba" class="mg kt in no b gy nx nu l nv nw">if (!keysAllowed.includes(keyPressed)) {<br/>    event.preventDefault();<br/>  }<br/>}</span></pre><p id="3b0a" class="pw-post-body-paragraph lk ll in lm b ln ms jo lp lq mt jr ls lt mu lv lw lx mv lz ma mb mw md me mf ig bi translated">然后，移动焦点到下一个HTML元素，直到最后一个HTML元素，一旦输入元素有一个数字。因此，我们需要监听组件的<code class="fe nl nm nn no b">input</code>事件。<code class="fe nl nm nn no b">@input</code>是<code class="fe nl nm nn no b">v-on:input</code>的简称。当输入元素获取值或输入值更改时，会发生此事件。</p><p id="4d9a" class="pw-post-body-paragraph lk ll in lm b ln ms jo lp lq mt jr ls lt mu lv lw lx mv lz ma mb mw md me mf ig bi translated">注意:我在这里没有使用<code class="fe nl nm nn no b">@change</code>事件，因为这个事件发生在输入元素失去焦点的时候。</p><pre class="kd ke kf kg gt np no nq nr aw ns bi"><span id="8542" class="mg kt in no b gy nt nu l nv nw">function <strong class="no io">handleInput</strong>(event: Event) {</span><span id="b102" class="mg kt in no b gy nx nu l nv nw">const inputType = (event as InputEvent).inputType;<br/>let currentActiveElement = event.target as HTMLInputElement;</span><span id="62d6" class="mg kt in no b gy nx nu l nv nw">if (inputType === "insertText")(currentActiveElement.nextElementSibling as HTMLElement)?.focus();<br/>}</span></pre></div><div class="ab cl ny nz hr oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="ig ih ii ij ik"><p id="f614" class="pw-post-body-paragraph lk ll in lm b ln ms jo lp lq mt jr ls lt mu lv lw lx mv lz ma mb mw md me mf ig bi translated">接下来，让我们实现<strong class="lm io">退格键</strong>来从输入元素中删除输入值。我们需要监听另一个键盘事件，即<code class="fe nl nm nn no b">@keydown.delete</code>事件。对于这个要求，有一点棘手。我们必须检查输入元素是否有值。如果input元素有一个值，那么我们需要先删除这个值，然后继续关注当前的HTML元素。但是，如果input元素没有值，则移动到前一个input元素并删除值。</p><pre class="kd ke kf kg gt np no nq nr aw ns bi"><span id="2e3e" class="mg kt in no b gy nt nu l nv nw">function <strong class="no io">handleDelete</strong>(event: Event) {<br/>  let value = (event.target as HTMLInputElement).value;<br/>  let currentActiveElement = event.target as HTMLInputElement; </span><span id="1f79" class="mg kt in no b gy nx nu l nv nw">  if (!value) {<br/>          (currentActiveElement.previousElementSibling as         HTMLElement)?.focus(); <br/>   }<br/>}</span></pre></div><div class="ab cl ny nz hr oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="ig ih ii ij ik"><p id="e258" class="pw-post-body-paragraph lk ll in lm b ln ms jo lp lq mt jr ls lt mu lv lw lx mv lz ma mb mw md me mf ig bi translated">现在，让我们转到粘贴功能。我们需要验证我们复制的代码，以确保它只包含数字<strong class="lm io"><em class="of"/></strong>和<strong class="lm io"> <em class="of">来删除代码两边的空格</em> </strong>。</p><p id="9d0a" class="pw-post-body-paragraph lk ll in lm b ln ms jo lp lq mt jr ls lt mu lv lw lx mv lz ma mb mw md me mf ig bi translated">粘贴事件是剪贴板的修改，归类为<strong class="lm io"> ClipboardEvent </strong>接口。通过调用事件的<code class="fe nl nm nn no b">clipboardData</code>属性上的<code class="fe nl nm nn no b"><a class="ae og" href="https://developer.mozilla.org/en-US/docs/Web/API/DataTransfer/getData" rel="noopener ugc nofollow" target="_blank">getData()</a></code>来访问剪贴板内容(数据)。</p><pre class="kd ke kf kg gt np no nq nr aw ns bi"><span id="a810" class="mg kt in no b gy nt nu l nv nw">function <strong class="no io">onPaste</strong>(event: Event) {</span><span id="538f" class="mg kt in no b gy nx nu l nv nw">  dataFromPaste = (event as ClipboardEvent).clipboardData?.getData("text").trim().split("");</span><span id="492d" class="mg kt in no b gy nx nu l nv nw">if (dataFromPaste) {<br/>   for (const num of dataFromPaste) {<br/>       if (!keysAllowed.includes(num)) event.preventDefault();<br/>   }<br/>  }<br/>}</span></pre><p id="611d" class="pw-post-body-paragraph lk ll in lm b ln ms jo lp lq mt jr ls lt mu lv lw lx mv lz ma mb mw md me mf ig bi translated">一旦我们得到了“干净”的代码，我们就可以将值循环到输入元素中。我在<code class="fe nl nm nn no b">@input</code>事件中做了这个逻辑，因为这个事件将在粘贴事件发生后触发。</p><pre class="kd ke kf kg gt np no nq nr aw ns bi"><span id="1b70" class="mg kt in no b gy nt nu l nv nw">function <strong class="no io">handleInput</strong>(event: Event) {<br/>  const inputType = (event as InputEvent).inputType;<br/>   ....<br/>   ....</span><span id="f328" class="mg kt in no b gy nx nu l nv nw">  if (inputType === "<strong class="no io">insertFromPaste</strong>" &amp;&amp; dataFromPaste) {<br/>   for (const num of dataFromPaste) {<br/>   let id: number = parseInt(currentActiveElement.id.split("_")[1]);<br/>   currentActiveElement.value = num;<br/>   code[id] = num;<br/>  <br/>   if (currentActiveElement.nextElementSibling) <br/>     currentActiveElement = currentActiveElement.nextElementSibling as HTMLInputElement;<br/> (currentActiveElement.nextElementSibling as HTMLElement)?.focus();<br/>      }<br/>    }<br/>  }<br/>}</span></pre><p id="146b" class="pw-post-body-paragraph lk ll in lm b ln ms jo lp lq mt jr ls lt mu lv lw lx mv lz ma mb mw md me mf ig bi translated">最后一个要求，当重新键入任何数字时，新值将替换以前的值。我的解决方案是先清除输入元素，然后输入一个新值。</p><p id="8e8d" class="pw-post-body-paragraph lk ll in lm b ln ms jo lp lq mt jr ls lt mu lv lw lx mv lz ma mb mw md me mf ig bi translated">注意:使用<code class="fe nl nm nn no b"><em class="of">event.currentTarget</em></code>而不是<code class="fe nl nm nn no b"><em class="of">event.target</em></code>的<strong class="lm io"> </strong>，因为<code class="fe nl nm nn no b">event.currentTarget</code>是事件监听器附加的元素。另外，如果利用<code class="fe nl nm nn no b"><em class="of">event.target</em></code>，最后一个要求在Android浏览器中就不起作用了。</p><pre class="kd ke kf kg gt np no nq nr aw ns bi"><span id="73b1" class="mg kt in no b gy nt nu l nv nw">function isNumber(event: Event) {</span><span id="e062" class="mg kt in no b gy nx nu l nv nw"> <strong class="no io"> (event.currentTarget as HTMLInputElement).value = "";</strong></span><span id="6fdb" class="mg kt in no b gy nx nu l nv nw">  const keyPressed: string = (event as KeyboardEvent).key;<br/>   if (!keysAllowed.includes(keyPressed)) {<br/>      event.preventDefault();<br/>   }<br/>}</span></pre><p id="899e" class="pw-post-body-paragraph lk ll in lm b ln ms jo lp lq mt jr ls lt mu lv lw lx mv lz ma mb mw md me mf ig bi translated">演示:</p><div class="oh oi gp gr oj ok"><a href="https://waltzhao.github.io/verification-code/" rel="noopener  ugc nofollow" target="_blank"><div class="ol ab fo"><div class="om ab on cl cj oo"><h2 class="bd io gy z fp op fr fs oq fu fw im bi translated">Vite应用</h2><div class="or l"><h3 class="bd b gy z fp op fr fs oq fu fw dk translated">编辑描述</h3></div><div class="os l"><p class="bd b dl z fp op fr fs oq fu fw dk translated">waltzhao.github.io</p></div></div></div></a></div><p id="470d" class="pw-post-body-paragraph lk ll in lm b ln ms jo lp lq mt jr ls lt mu lv lw lx mv lz ma mb mw md me mf ig bi translated">资源代码:</p><div class="oh oi gp gr oj ok"><a href="https://github.com/waltzHao/verification-code" rel="noopener  ugc nofollow" target="_blank"><div class="ol ab fo"><div class="om ab on cl cj oo"><h2 class="bd io gy z fp op fr fs oq fu fw im bi translated">GitHub-waltz Hao/验证码</h2><div class="or l"><h3 class="bd b gy z fp op fr fs oq fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="os l"><p class="bd b dl z fp op fr fs oq fu fw dk translated">github.com</p></div></div><div class="ot l"><div class="ou l ov ow ox ot oy km ok"/></div></div></a></div><h2 id="3fa6" class="mg kt in bd ku mh mi dn ky mj mk dp lc lt ml mm le lx mn mo lg mb mp mq li mr bi translated">结论</h2><p id="f991" class="pw-post-body-paragraph lk ll in lm b ln lo jo lp lq lr jr ls lt lu lv lw lx ly lz ma mb mc md me mf ig bi translated">希望我的指南对你有用。如果您有任何想法或建议，请留言。感谢您的阅读，并享受您的编码！</p><p id="79ae" class="pw-post-body-paragraph lk ll in lm b ln ms jo lp lq mt jr ls lt mu lv lw lx mv lz ma mb mw md me mf ig bi translated"><em class="of">更多内容看</em> <a class="ae og" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="lm io"> <em class="of">说白了就是</em> </strong> </a> <em class="of">。报名参加我们的</em> <a class="ae og" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="lm io"> <em class="of">免费周报</em> </strong> </a> <em class="of">。关注我们</em> <a class="ae og" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"> <strong class="lm io"> <em class="of">推特</em> </strong> </a> <em class="of">和</em><a class="ae og" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="lm io"><em class="of">LinkedIn</em></strong></a><em class="of">。加入我们的</em> <a class="ae og" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="lm io"> <em class="of">社区不和谐</em> </strong> </a> <em class="of">。</em></p></div></div>    
</body>
</html>