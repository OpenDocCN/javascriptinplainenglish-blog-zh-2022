<html>
<head>
<title>Vue 3 Programmatic Component Design</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Vue 3编程组件设计</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/vue-3-programmatic-component-design-a1a20f853a4b?source=collection_archive---------0-----------------------#2022-01-22">https://javascript.plainenglish.io/vue-3-programmatic-component-design-a1a20f853a4b?source=collection_archive---------0-----------------------#2022-01-22</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="1a54" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">创建动态组件模板</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/265b85fe5014f114acfa4bc77fcacf6c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*U925sO--bWIX156oxxSZCw.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Vue 3 Programmatic Component Design</figcaption></figure><p id="3537" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">如果你曾经使用过任何一个设计系统库，它们都提供了一个与<em class="lo">排版</em>相关的通用组件。它将提供一个<em class="lo">道具</em>，在这里你可以将标签行<em class="lo">定义为</em>或<em class="lo">变体。接下来你看到的是它呈现了你在道具中定义的元素。</em></p><p id="f368" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">这种模式通常被称为以编程方式创建组件实例。这有助于我们创建一个组件，该组件去除了条件模板呈现，并增加了可重用性，因为它是灵活的。</p><p id="5207" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">让我们把下面的代码转换成一个灵活的自定义排版组件，模板是动态生成的。</p><pre class="kd ke kf kg gt lp lq lr ls aw lt bi"><span id="7904" class="lu lv in lq b gy lw lx l ly lz">&lt;template&gt;<br/>&lt;h1 v-if="$props.as === 'h1'" :class="classes" :style="$props.style"&gt;<br/> &lt;slot&gt;&lt;/slot&gt;<br/>&lt;/h1&gt;<br/>&lt;h2 v-if="$props.as === 'h2'" :class="classes" :style="$props.style"&gt;<br/> &lt;slot&gt;&lt;/slot&gt;<br/>&lt;/h2&gt;<br/>&lt;p v-if="$props.as === 'p'" :class="classes" :style="$props.style"&gt;<br/> &lt;slot&gt;&lt;/slot&gt;<br/>&lt;/p&gt;<br/>&lt;/template&gt;</span></pre><p id="1e1a" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated"><em class="lo">注意:我将介绍函数和有状态风格，让你决定你想要什么。</em></p><h2 id="d81a" class="lu lv in bd ma mb mc dn md me mf dp mg lb mh mi mj lf mk ml mm lj mn mo mp mq bi translated">功能组件模式</h2><p id="5159" class="pw-post-body-paragraph ks kt in ku b kv mr jo kx ky ms jr la lb mt ld le lf mu lh li lj mv ll lm ln ig bi translated">这使用选项API的一部分<strong class="ku io"> <em class="lo">渲染函数</em> </strong>来渲染组件。这将要求您了解组件实例属性，以便编写更好的代码。并且tbh你将会用功能组件显著地影响代码的可读性。</p><p id="9aee" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">在<em class="lo"> Vue2 </em>中，功能组件是提高性能和减少重渲染的一种方式，但是根据<a class="ae mw" href="https://v3.vuejs.org/guide/migration/functional-components.html" rel="noopener ugc nofollow" target="_blank">官方文档</a>的规定，使用<em class="lo"> Vue3 </em>时，功能组件和有状态组件之间的性能可以忽略不计，因此建议使用有状态组件。</p><p id="9175" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">让我们来看一下组件并进行分解:</p><pre class="kd ke kf kg gt lp lq lr ls aw lt bi"><span id="30c6" class="lu lv in lq b gy lw lx l ly lz">&lt;script lang="ts"&gt;<br/>import { computed, CSSProperties, defineComponent, h, PropType } from "vue";</span><span id="154a" class="lu lv in lq b gy mx lx l ly lz">export default defineComponent({<br/>name: "TypographyFunctional",<br/>props: {<br/>as: {type: String as PropType&lt;"h1" | "h2" | "h3" | "h4" | "h5" | "h6" | "p"&gt;, default: "p"},</span><span id="5ae6" class="lu lv in lq b gy mx lx l ly lz">style: { type: String as PropType&lt;CSSProperties&gt;, default:()=&gt;{})},</span><span id="ffb4" class="lu lv in lq b gy mx lx l ly lz">class: {type: String,default: ""},</span><span id="ff91" class="lu lv in lq b gy mx lx l ly lz">fontWeight: {type: String as PropType&lt;"bold" | "light"&gt;,default:"light"}},</span><span id="9a79" class="lu lv in lq b gy mx lx l ly lz">setup(props) {<br/>const classes = computed(() =&gt; {<br/>return `${props.fontWeight==="light"? "light" : "bold"} ${props.class}`;});</span><span id="4ae0" class="lu lv in lq b gy mx lx l ly lz">return { classes };<br/>},<br/>render() {<br/> return h(this.as,<br/>  { class: this.classes, style: this.style,},<br/>  this.$slots.default?.()<br/> );<br/>},<br/>});<br/>&lt;/script&gt;</span></pre><p id="8bcb" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">那么，让我们来理解一下<strong class="ku io"> h </strong>函数，它也被称为<em class="lo"> createElement </em>函数。它接受以下参数:</p><ol class=""><li id="856a" class="my mz in ku b kv kw ky kz lb na lf nb lj nc ln nd ne nf ng bi translated"><strong class="ku io">标签名</strong>:可以是字符串、对象、函数。在上面的例子中，它是<em class="lo"> prop.as，</em>，我使用一个字符串来定义元素类型。</li><li id="4e6d" class="my mz in ku b kv nh ky ni lb nj lf nk lj nl ln nd ne nf ng bi translated"><strong class="ku io"> props </strong>:这是一个对象，用于定义该元素的属性、属性和事件。在上面的例子中，<em class="lo"> props.style </em>和<em class="lo">class</em>是一个计算值。</li><li id="b861" class="my mz in ku b kv nh ky ni lb nj lf nk lj nl ln nd ne nf ng bi translated"><strong class="ku io"> children </strong>:这些是可用于向元素添加子节点的VNodes。在上面的例子中是缺省槽(这。$slots.default？。()是实例属性)</li></ol><p id="7c36" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">这样，我们现在可以通过编程创建一个定制的排版组件。让我们看一个例子，看看它是如何工作的:</p><pre class="kd ke kf kg gt lp lq lr ls aw lt bi"><span id="06aa" class="lu lv in lq b gy lw lx l ly lz">&lt;template&gt;<br/>&lt;TypographyFunctionalVue :as="'h1'" class="border margin" <br/>:font-weight="'bold'" :style="{ color: 'green' }"&gt;<br/>This is a functional component<br/>&lt;/TypographyFunctionalVue&gt;</span><span id="f0d3" class="lu lv in lq b gy mx lx l ly lz">&lt;TypographyFunctionalVue :as="'h2'" class="border margin" <br/>:font-weight="'bold'" :style="{ color: 'green' }"&gt;<br/>This is a functional component<br/>&lt;/TypographyFunctionalVue&gt;</span><span id="c534" class="lu lv in lq b gy mx lx l ly lz">&lt;TypographyFunctionalVue :as="'h3'" class="border margin" <br/>:font-weight="'bold'" :style="{ color: 'green' }"&gt;<br/>This is a functional component<br/>&lt;/TypographyFunctionalVue&gt;</span><span id="57fa" class="lu lv in lq b gy mx lx l ly lz">&lt;TypographyFunctionalVue :as="'h4'" class="border margin" <br/>:font-weight="'bold'" :style="{ color: 'green' }"&gt;<br/>This is a functional component<br/>&lt;/TypographyFunctionalVue&gt;</span><span id="bda6" class="lu lv in lq b gy mx lx l ly lz">&lt;TypographyFunctionalVue :as="'h5'" class="border margin" <br/>:font-weight="'bold'" :style="{ color: 'green' }"&gt;<br/>This is a functional component<br/>&lt;/TypographyFunctionalVue&gt;</span><span id="609e" class="lu lv in lq b gy mx lx l ly lz">&lt;TypographyFunctionalVue class="border margin" <br/>:font-weight="'bold'" :style="{ color: 'green' }"&gt;<br/>This is a functional component<br/>&lt;/TypographyFunctionalVue&gt;</span><span id="6713" class="lu lv in lq b gy mx lx l ly lz">&lt;/template&gt;</span></pre><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nm"><img src="../Images/97581f26ab92b57e91e17b2a40f1d2ed.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*weFClP5UHx-304RtGvGiuA.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">rendered HTML</figcaption></figure><h2 id="ed5d" class="lu lv in bd ma mb mc dn md me mf dp mg lb mh mi mj lf mk ml mm lj mn mo mp mq bi translated"><strong class="ak"> <em class="nn">有状态组件特征码</em> </strong></h2><p id="496d" class="pw-post-body-paragraph ks kt in ku b kv mr jo kx ky ms jr la lb mt ld le lf mu lh li lj mv ll lm ln ig bi translated">这依赖于Vue提供的<strong class="ku io"> <em class="lo">组件</em> </strong>元素，其非常特殊的指令<strong class="ku io">是。</strong></p><pre class="kd ke kf kg gt lp lq lr ls aw lt bi"><span id="845e" class="lu lv in lq b gy lw lx l ly lz">&lt;component is="tag-name"&gt;&lt;/component&gt;</span></pre><p id="879d" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">组件可以被认为是模板中的一个动态占位符元素。为了使用它的全部功能，我们需要将<strong class="ku io"> <em class="lo">定义为</em> </strong>指令，它接受两种类型的输入<em class="lo">字符串</em>或<em class="lo">对象</em>(用于自定义Vue组件)。我们可以根据条件动态地呈现HTML元素，如h1、h2、li和定制组件，或者在我们的例子中作为道具。</p><p id="1570" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">让我们来看一下组件并进行分解:</p><pre class="kd ke kf kg gt lp lq lr ls aw lt bi"><span id="4266" class="lu lv in lq b gy lw lx l ly lz">&lt;template&gt;<br/> &lt;component :is="$props.as" :class="classes" :style="$props.style"<br/>  &lt;slot&gt;&lt;/slot&gt;<br/> &lt;/component&gt;<br/>&lt;/template&gt;</span><span id="859c" class="lu lv in lq b gy mx lx l ly lz">&lt;script lang="ts"&gt;<br/>import { computed, CSSProperties, defineComponent, h, PropType } from "vue";</span><span id="fc92" class="lu lv in lq b gy mx lx l ly lz">export default defineComponent({<br/> name: "Typography",<br/> props: {<br/>as: {type: String as PropType&lt;"h1" | "h2" | "h3" | "h4" | "h5" | "h6" | "p"&gt;, default: "p"},</span><span id="9c61" class="lu lv in lq b gy mx lx l ly lz">style: { type: String as PropType&lt;CSSProperties&gt;, default:()=&gt;{})},</span><span id="7dbb" class="lu lv in lq b gy mx lx l ly lz">class: {type: String,default: ""},</span><span id="e7e9" class="lu lv in lq b gy mx lx l ly lz">fontWeight: {type: String as PropType&lt;"bold" | "light"&gt;,default:"light"}},</span><span id="9219" class="lu lv in lq b gy mx lx l ly lz">setup(props) {<br/>const classes = computed(() =&gt; {<br/>return `${props.fontWeight==="light"? "light" : "bold"} ${props.class}`;});</span><span id="7cdb" class="lu lv in lq b gy mx lx l ly lz">return { classes };<br/>},</span><span id="23c6" class="lu lv in lq b gy mx lx l ly lz">});</span><span id="ee9a" class="lu lv in lq b gy mx lx l ly lz">&lt;/script&gt;</span></pre><p id="74f5" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated"><strong class="ku io">是<strong class="ku io"> <em class="lo">组件的</em></strong>指令， </strong>作为一个道具被绑定到，一个未命名的槽用于呈现排版组件的默认子组件。</p></div><div class="ab cl no np hr nq" role="separator"><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt nu"/><span class="nr bw bk ns nt"/></div><div class="ig ih ii ij ik"><p id="3a51" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">由于有状态组件和功能组件之间的性能提升并不显著，所以这完全取决于您的个人偏好。</p><p id="a1a0" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated">你可以在这里找到上面例子<a class="ae mw" href="https://github.com/devAbhimanyu/vue3-design-patterns/tree/programatic-component-design" rel="noopener ugc nofollow" target="_blank">的代码。请尝试，并让我知道我是否可以重构或改进这个设计。</a></p><p id="2bb5" class="pw-post-body-paragraph ks kt in ku b kv kw jo kx ky kz jr la lb lc ld le lf lg lh li lj lk ll lm ln ig bi translated"><em class="lo">更多内容看</em> <a class="ae mw" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ku io"> <em class="lo">说白了。报名参加我们的</em> <a class="ae mw" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ku io"> <em class="lo">免费每周简讯</em> </strong> </a> <em class="lo">。在我们的</em> <a class="ae mw" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="ku io"> <em class="lo">社区不和谐</em> </strong> </a> <em class="lo">获得独家获得写作机会和建议。</em></strong></a></p></div></div>    
</body>
</html>