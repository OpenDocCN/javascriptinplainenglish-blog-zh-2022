# E2E æµ‹è¯•å’Œé›†æˆ Cypress ä¸ Next.js çš„åŸºç¡€

> åŸæ–‡ï¼š<https://javascript.plainenglish.io/the-basics-of-e2e-testing-and-integrating-cypress-with-next-js-4010160b6c9e?source=collection_archive---------10----------------------->

![](img/81ccd8f0ddd748d030b881bbd064a58e.png)

ğŸ‘‹ä½ ä»¬å¥½ï¼Œä¼™è®¡ä»¬ï¼å·²ç»æœ‰ä¸€æ®µæ—¶é—´æ²¡å‘æ–‡ç« äº†ã€‚

ä½œä¸ºå¼€å‘è€…ï¼Œæˆ‘ä»¬æ€»æ˜¯æƒ³æŠŠæœ€å¥½çš„äº§å“äº¤ä»˜ç»™ç”¨æˆ·ã€‚æµ‹è¯•æ˜¯è¿™ä¸ªè¿‡ç¨‹ä¸­è‡³å…³é‡è¦çš„ä¸€éƒ¨åˆ†ã€‚ä¸€ç§å¸¸ç”¨çš„æµ‹è¯•æŠ€æœ¯æ˜¯ E2E æµ‹è¯•ã€‚

# ğŸ’¡E2E æµ‹è¯•â€”åŸºç¡€çŸ¥è¯†

ç«¯åˆ°ç«¯æµ‹è¯•(æˆ–ç®€ç§°ä¸º E2E æµ‹è¯•)æ˜¯ä¸€ç§ä»å¤´åˆ°å°¾æµ‹è¯•æ•´ä¸ªè½¯ä»¶äº§å“çš„æŠ€æœ¯ï¼Œä»¥ç¡®ä¿åº”ç”¨ç¨‹åºæµçš„è¡Œä¸ºç¬¦åˆé¢„æœŸã€‚

E2E æµ‹è¯•çš„ä¸»è¦ç›®çš„æ˜¯æ¨¡æ‹ŸçœŸå®çš„ç”¨æˆ·åœºæ™¯ï¼Œå¹¶æ ¹æ®æœ€ç»ˆç”¨æˆ·çš„ä½“éªŒè¿›è¡Œæµ‹è¯•ã€‚

## ğŸ“ƒE2E æµ‹è¯•çš„ä¼˜åŠ¿

*   é™ä½é£é™©
*   å¢å¼ºä¿¡å¿ƒ
*   é™ä½çš„ä»·æ ¼

# âš¡ E2E æµ‹è¯•æ–¹æ³•

## æ°´å¹³ E2E æµ‹è¯•

æ°´å¹³æµ‹è¯•æ˜¯ä»æœ€ç»ˆç”¨æˆ·çš„è§’åº¦è¿›è¡Œçš„ã€‚å®ƒè¯„ä¼°ç”¨æˆ·æ˜¯å¦èƒ½å¤Ÿå¯¼èˆªè½¯ä»¶å¹¶æ­£ç¡®ä½¿ç”¨å…¶åŠŸèƒ½ã€‚å®ƒè¿˜æœ‰åŠ©äºæ£€æµ‹å¯èƒ½é˜»æ­¢ç”¨æˆ·ä½¿ç”¨æŸäº›è½¯ä»¶åŠŸèƒ½çš„é”™è¯¯ã€‚

## å‚ç›´ E2E æµ‹è¯•

è¿™ç§æ–¹æ³•æŒ‡çš„æ˜¯åˆ†å±‚æµ‹è¯•ï¼Œä¹Ÿå°±æ˜¯è¯´æµ‹è¯•æ˜¯ä»¥è¿ç»­çš„ã€å±‚æ¬¡åŒ–çš„é¡ºåºè¿›è¡Œçš„ã€‚ç³»ç»Ÿçš„æ¯ä¸ªå­ç»„ä»¶ä»å¤´åˆ°å°¾éƒ½ç»è¿‡æµ‹è¯•ï¼Œä»¥ç¡®ä¿è´¨é‡ã€‚

å½“ç³»ç»Ÿæ²¡æœ‰ç”¨æˆ·ç•Œé¢æˆ–è€…ç”¨æˆ·ç•Œé¢æœ‰å¾ˆé«˜çš„æŠ€æœ¯æ€§å¹¶ä¸”ç”¨äºæµ‹è¯•å…³é”®ç»„ä»¶æ—¶ï¼Œé€šå¸¸ä¼šè¿™æ ·åšã€‚

# â“å¦‚ä½•è¿›è¡Œ E2E æµ‹è¯•ï¼Ÿ

*   åˆ†ææ‰€æœ‰éœ€æ±‚ã€‚å¯¹åº”ç”¨ç¨‹åºåº”è¯¥åšä»€ä¹ˆæœ‰ä¸€ä¸ªæ¸…æ™°çš„æƒ³æ³•ã€‚
*   æ ¹æ®è¦æ±‚è®¾ç½®æµ‹è¯•ç¯å¢ƒã€‚
*   åˆ—å‡ºæµ‹è¯•è¿™äº›ååº”æ‰€éœ€çš„æ‰€æœ‰æµ‹è¯•æ–¹æ³•ã€‚
*   è®¾è®¡æµ‹è¯•ç”¨ä¾‹ã€‚
*   è¿è¡Œæµ‹è¯•å¹¶è®°å½•ç»“æœã€‚

# âš¡ E2E æµ‹è¯•æ¡†æ¶

E2E æµ‹è¯•æ¡†æ¶ç”¨äºç¡®ä¿åº”ç”¨ç¨‹åºä¸­çš„æ‰€æœ‰æ´»åŠ¨éƒ¨åˆ†éƒ½é…ç½®æ­£ç¡®ã€‚

ä»¥ä¸‹æ˜¯ä¸€äº›æœ€å—æ¬¢è¿çš„:

*   ç¡’
*   æŸæ ‘
*   é»„ç“œ
*   Testim

ç°åœ¨æ‚¨å·²ç»ç†Ÿæ‚‰äº† E2E æµ‹è¯•çš„åŸºæœ¬æ¦‚å¿µï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•åœ¨ Next.js ä¸­ä½¿ç”¨ Cypress é›†æˆ E2E æµ‹è¯•..

# ğŸ‘¨â€ğŸ’»é›†æˆ Cypress å’Œ Next.js è¿›è¡Œ E2E æµ‹è¯•

ç°åœ¨æ‚¨å·²ç»ç†Ÿæ‚‰äº† E2E æµ‹è¯•çš„åŸºç¡€ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•åœ¨ Next.js ä¸­å¼€å§‹ä½¿ç”¨ Cypress

**Next.js**

å¦‚æœæ‚¨ä¸ç†Ÿæ‚‰ Next.jsï¼Œå®ƒæ˜¯ä¸€ä¸ª React æ¡†æ¶ï¼ŒåŒ…å«ä¸€äº›é¢å¤–çš„åŠŸèƒ½æ¥å¸®åŠ©å¼€å‘äººå‘˜å’Œå®¢æˆ·ã€‚

**æŸæ ‘**

èµ›æ™®æ‹‰æ–¯æ˜¯ E2E ç½‘ç»œæµ‹è¯•çš„æµ‹è¯•å‘˜ã€‚

## è®¾ç½®é¡¹ç›®

ä½ å¯ä»¥ç”¨â€œåˆ›å»ºä¸‹ä¸€ä¸ªåº”ç”¨â€å’Œâ€œcypressâ€ä¾‹å­æ¥å¿«é€Ÿå¼€å§‹ã€‚

```
npx create-next-app@latest â€” example with-cypress with-cypress-app 
```

å¯¹äºç°æœ‰çš„é¡¹ç›®ï¼Œæ‚¨å¯ä»¥ä»å®‰è£…â€œcypressâ€åŒ…å¼€å§‹ã€‚

```
npm install â€” save-dev cypress
```

ç„¶åï¼Œå°† Cypress æ·»åŠ åˆ°â€œpackage.jsonâ€æ–‡ä»¶çš„â€œscriptsâ€éƒ¨åˆ†ã€‚

```
// package.json
â€œscriptsâ€: {
 â€œdevâ€: â€œnext devâ€,
 â€œbuildâ€: â€œnext buildâ€,
 â€œstartâ€: â€œnext startâ€,
 â€œcypressâ€: â€œcypress openâ€,
}
```

æ¥ä¸‹æ¥ï¼Œè¿è¡Œ Cypress æ¥ç”Ÿæˆä½¿ç”¨æ¨èçš„æ–‡ä»¶å¤¹ç»“æ„çš„ä¾‹å­ã€‚

```
npm run cypress
```

## åˆ›å»ºæ‚¨çš„ç¬¬ä¸€ä¸ª Cypress é›†æˆæµ‹è¯•

å‡è®¾æ‚¨æœ‰ä¸¤é¡µ:

```
// pages/index.jsimport Link from â€˜next/linkâ€™export default function Home() {
 return (
 <nav>
 <Link href=â€/aboutâ€>
 <a>About</a>
 </Link>
 </nav>
 )
}
``````jsx
// pages/about.js
export default function About() {
 return (
 <div>
 <h1>About Page</h1>
 </div>
 )
}
```
```

ç„¶åï¼Œä¸ºäº†æµ‹è¯•æ‚¨çš„å¯¼èˆªæ˜¯å¦æ­£å¸¸å·¥ä½œ:

```
// cypress/integration/app.spec.jsdescribe(â€˜Navigationâ€™, () => {
 it(â€˜should navigate to the about pageâ€™, () => {
 // Start from the index page
 cy.visit(â€˜[http://localhost:3000/'](http://localhost:3000/'))// Find a link with an href attribute containing â€œaboutâ€ and click it
 cy.get(â€˜a[href*=â€aboutâ€]â€™).click()// The new url should include â€œ/aboutâ€
 cy.url().should(â€˜includeâ€™, â€˜/aboutâ€™)// The new page should contain an h1 with â€œAbout pageâ€
 cy.get(â€˜h1â€™).contains(â€˜About Pageâ€™)
 })
})
```

**æç¤º**:ä¸ç”¨åš***` cy . visit(***[***http://localhost:3000/')`***](http://localhost:3000/')`)ï¼Œåªè¦æŠŠ ***`baseUrl`*** è®¾ä¸º ***`*** å°±å¯ä»¥äº†

```
// cypress.json {
 â€œbaseUrlâ€: â€œ[http://localhost:3000](http://localhost:3000)"
}
```

è‡³æ­¤ï¼Œæ‚¨å°†æ‹¥æœ‰ä¸€ä¸ªç®€å•çš„æµ‹è¯•è®¾ç½®ã€‚å› ä¸º cypress æ­£åœ¨æµ‹è¯•ä¸€ä¸ªçœŸæ­£çš„ Next.js åº”ç”¨ç¨‹åºï¼Œæ‰€ä»¥å®ƒè¦æ±‚åœ¨å¯åŠ¨ Cypress ä¹‹å‰è¿è¡Œ Next.js æœåŠ¡å™¨ã€‚

é¦–å…ˆè¿è¡Œ`npm run build`å’Œ`npm run start`ï¼›ç„¶åï¼Œåœ¨å¦ä¸€ä¸ªç»ˆç«¯çª—å£è¿è¡Œ`npm run cypress`æ¥å¯åŠ¨ Cypressã€‚

ç°åœ¨ï¼Œcypress å°†å¯åŠ¨ï¼Œæ‚¨å¯ä»¥æŸ¥çœ‹ç»“æœã€‚

## æŒç»­é›†æˆ(CI)çš„è¿›ä¸€æ­¥æ­¥éª¤

æ­¤æ—¶ï¼Œæ‚¨å¯èƒ½å·²ç»æ³¨æ„åˆ°ï¼Œåˆ°ç›®å‰ä¸ºæ­¢è¿è¡Œ Cypress å·²ç»æ‰“å¼€äº†ä¸€ä¸ªäº¤äº’å¼æµè§ˆå™¨ï¼Œè¿™å¯¹äº CI ç¯å¢ƒæ¥è¯´å¹¶ä¸ç†æƒ³ã€‚

æ‚¨å¯ä»¥ä½¿ç”¨`cypress run`å‘½ä»¤è¿è¡Œ Cypressã€‚

åœ¨***` package . JSON `***æ–‡ä»¶ä¸­:

```
// package.jsonâ€œscriptsâ€: {
 // â€¦
 â€œcypressâ€: â€œcypress openâ€,
 â€œcypress:headlessâ€: â€œcypress runâ€
}
```

æœ¬æ–‡åˆ°æ­¤ä¸ºæ­¢ï¼ä½ å¯ä»¥åœ¨è¿™é‡Œæ”¾ä¸‹ä¸€äº›ååº”æ¥è¡¨ç¤ºä½ çš„æ”¯æŒï¼

**å…³äºä½œè€…**

*   [**æŠ•èµ„ç»„åˆ**](https://anurag.tech)
*   [**åšå®¢**](https://blog.anurag.tech)

*æ›´å¤šå†…å®¹è¯·çœ‹*[***plain English . io***](https://plainenglish.io/)*ã€‚æŠ¥åå‚åŠ æˆ‘ä»¬çš„* [***å…è´¹å‘¨æŠ¥***](http://newsletter.plainenglish.io/) *ã€‚å…³æ³¨æˆ‘ä»¬å…³äº*[***Twitter***](https://twitter.com/inPlainEngHQ)*å’Œ*[***LinkedIn***](https://www.linkedin.com/company/inplainenglish/)*ã€‚åŠ å…¥æˆ‘ä»¬çš„* [***ç¤¾åŒºä¸å’Œè°***](https://discord.gg/GtDtUAvyhW) *ã€‚*