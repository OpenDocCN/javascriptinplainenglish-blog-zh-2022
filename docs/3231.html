<html>
<head>
<title>JavaScript Basics: Understand the Scope</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript基础:理解范围</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/js-basics-understand-the-scope-547c5d7ca1c7?source=collection_archive---------11-----------------------#2022-08-10">https://javascript.plainenglish.io/js-basics-understand-the-scope-547c5d7ca1c7?source=collection_archive---------11-----------------------#2022-08-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="7da3" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">用简单的例子掌握JavaScript的一个基本概念。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/38871a12c2b0dad2c95cf1306385cb38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rUGoQy5QkYLFssYmhJ6tqA.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://www.pexels.com/@markusspiske?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">Markus Spiske</a> from <a class="ae kv" href="https://www.pexels.com/photo/a-laptop-screen-with-text-4439901/?utm_content=attributionCopyText&amp;utm_medium=referral&amp;utm_source=pexels" rel="noopener ugc nofollow" target="_blank">Pexels</a></figcaption></figure><p id="5aea" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你现在已经使用JS有一段时间了，你一定至少听说过一次<strong class="ky ir"> <em class="ls">范围</em> </strong>这个词。</p><p id="dfc1" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是这个词到底是什么意思呢？</p><blockquote class="lt"><p id="fa98" class="lu lv iq bd lw lx ly lz ma mb mc lr dk translated">作用域是一组确定变量可访问性的规则。</p></blockquote><p id="a76c" class="pw-post-body-paragraph kw kx iq ky b kz md jr lb lc me ju le lf mf lh li lj mg ll lm ln mh lp lq lr ij bi translated">在JavaScript中，我们有三个不同的范围:</p><ul class=""><li id="be33" class="mi mj iq ky b kz la lc ld lf mk lj ml ln mm lr mn mo mp mq bi translated">块范围</li><li id="24a4" class="mi mj iq ky b kz mr lc ms lf mt lj mu ln mv lr mn mo mp mq bi translated">功能范围</li><li id="3243" class="mi mj iq ky b kz mr lc ms lf mt lj mu ln mv lr mn mo mp mq bi translated">全球范围</li></ul><p id="d2c8" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">来说说他们吧。</p></div><div class="ab cl mw mx hu my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="ij ik il im in"><h1 id="727b" class="nd ne iq bd nf ng nh ni nj nk nl nm nn jw no jx np jz nq ka nr kc ns kd nt nu bi translated">块范围</h1><p id="3979" class="pw-post-body-paragraph kw kx iq ky b kz nv jr lb lc nw ju le lf nx lh li lj ny ll lm ln nz lp lq lr ij bi translated">让我们从<strong class="ky ir">最简单的</strong>开始，块作用域。</p><p id="b77c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">块范围是仅在代码块内可访问的范围<strong class="ky ir">。换句话说，<strong class="ky ir">代码块是一段用花括号括起来的代码。</strong></strong></p><blockquote class="oa ob oc"><p id="48d8" class="kw kx ls ky b kz la jr lb lc ld ju le od lg lh li oe lk ll lm of lo lp lq lr ij bi translated">函数不适合这种类型的范围(即使它们使用了括号),因为它们有自己的范围和规则集</p></blockquote><p id="1a24" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们有不同的方法来定义一个块，但是最简单的方法是在if/else语句或循环中。</p><blockquote class="oa ob oc"><p id="5077" class="kw kx ls ky b kz la jr lb lc ld ju le od lg lh li oe lk ll lm of lo lp lq lr ij bi translated">对于本文的第一部分，我将只使用<code class="fe og oh oi oj b">const</code>来声明变量。请参考本文第二部分的<strong class="ky ir">部分，了解<code class="fe og oh oi oj b">let/var</code>如何对范围产生影响</strong></p></blockquote><h2 id="6aa1" class="ok ne iq bd nf ol om dn nj on oo dp nn lf op oq np lj or os nr ln ot ou nt ov bi translated">if/else</h2><p id="cf93" class="pw-post-body-paragraph kw kx iq ky b kz nv jr lb lc nw ju le lf nx lh li lj ny ll lm ln nz lp lq lr ij bi translated">让我们从if/else语句开始吧！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ow"><img src="../Images/fb47a249610d0eb81a394d0b3a64b44c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0MLjzj4VgrNPgWtVgKAM0Q.png"/></div></div></figure><p id="ac26" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是我们的第一个例子。这里我们要关心两个变量:</p><ul class=""><li id="1ef3" class="mi mj iq ky b kz la lc ld lf mk lj ml ln mm lr mn mo mp mq bi translated"><code class="fe og oh oi oj b"><strong class="ky ir">myVar</strong></code>:在函数开始时声明</li><li id="243f" class="mi mj iq ky b kz mr lc ms lf mt lj mu ln mv lr mn mo mp mq bi translated"><code class="fe og oh oi oj b"><strong class="ky ir">myVar2</strong></code>:在if块中声明</li></ul><p id="4a1a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果我们从<code class="fe og oh oi oj b"><strong class="ky ir">myVar</strong></code>开始，我们可以看到我们正在If块中打印它<strong class="ky ir">并且它正在工作</strong>。原因是<code class="fe og oh oi oj b"><strong class="ky ir">myVar</strong></code>在函数作用域内<strong class="ky ir">(详见本文)，因此<strong class="ky ir">可以被函数</strong>内的所有东西访问。</strong></p><p id="edb4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在对于<code class="fe og oh oi oj b"><strong class="ky ir">myVar2</strong></code>，就有点不一样了。变量在if程序块内创建<strong class="ky ir">，而<strong class="ky ir">属于该特定程序块</strong>。<strong class="ky ir">一旦我们离开这个程序块，我们就失去了对变量</strong>的访问(因此在第二次打印时出现错误)</strong></p><h2 id="fd2a" class="ok ne iq bd nf ol om dn nj on oo dp nn lf op oq np lj or os nr ln ot ou nt ov bi translated">for/while循环</h2><p id="8693" class="pw-post-body-paragraph kw kx iq ky b kz nv jr lb lc nw ju le lf nx lh li lj ny ll lm ln nz lp lq lr ij bi translated">现在我们来看看一个<strong class="ky ir">循环</strong>。<code class="fe og oh oi oj b">For</code>和<code class="fe og oh oi oj b">while</code>循环的工作方式相同，我们将只使用一个<code class="fe og oh oi oj b">while</code>循环。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ox"><img src="../Images/18109d7627f78b135acd0bd8e2557a1d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VmTG8WJSbET_kgNF46VEPg.png"/></div></div></figure><p id="3d54" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们不打算在这里花太多时间，因为它的工作方式与 <code class="fe og oh oi oj b"><strong class="ky ir">if</strong></code> <strong class="ky ir">语句</strong>完全相同！我们是c语言<strong class="ky ir">在</strong> <code class="fe og oh oi oj b"><strong class="ky ir">while</strong></code> <strong class="ky ir">循环</strong>和<strong class="ky ir">里面创建一个块，一旦到了外面，访问</strong> <code class="fe og oh oi oj b"><strong class="ky ir">myVar2</strong></code> <strong class="ky ir">就会触发错误</strong>！</p><h2 id="678d" class="ok ne iq bd nf ol om dn nj on oo dp nn lf op oq np lj or os nr ln ot ou nt ov bi translated">花括号块</h2><p id="9990" class="pw-post-body-paragraph kw kx iq ky b kz nv jr lb lc nw ju le lf nx lh li lj ny ll lm ln nz lp lq lr ij bi translated">现在，这一个，尽管它与前两个非常相似<strong class="ky ir">，却非常有趣！你们中的一些人可能甚至不知道这是可能的。虽然我对那个没什么兴趣，还是来看看吧。</strong></p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ox"><img src="../Images/f089728339df14330873b70711974863.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aZo9oPSTpKYXT6VNT0N2iQ.png"/></div></div></figure><p id="50d0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果你仔细看看这段代码，你会发现既没有条件也没有循环！我们只是把代码放在一些花括号里，JS会创建一个新的作用域。</p><p id="bd62" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这里没什么要分析的了，我只是觉得你会喜欢看这个！</p><h1 id="6e2d" class="nd ne iq bd nf ng oy ni nj nk oz nm nn jw pa jx np jz pb ka nr kc pc kd nt nu bi translated">功能范围</h1><p id="1be8" class="pw-post-body-paragraph kw kx iq ky b kz nv jr lb lc nw ju le lf nx lh li lj ny ll lm ln nz lp lq lr ij bi translated">现在，让我们进入<strong class="ky ir">一个更高的范围</strong>，并对<strong class="ky ir">功能范围</strong>感兴趣。</p><p id="5c53" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当谈到函数作用域时，我们考虑的是在函数作用域内声明的每个变量。如果我们看看前面的3个例子，<code class="fe og oh oi oj b">myVar</code>是在函数作用域内声明的，而<strong class="ky ir">没有被包装到更低的作用域</strong>中。</p><p id="2ab4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而，在函数中声明的变量<strong class="ky ir">只能在它所属的函数</strong>和<strong class="ky ir">中访问，每个额外的函数都在</strong>中创建。</p><p id="eb69" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">让我们看一个简单的例子来更好地理解这个问题:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pd"><img src="../Images/6c0cc45d45e20f2f97d9eb487809e72c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pRXeAk4w5qc1RsUe30MbTg.png"/></div></div></figure><p id="f4b6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所以我们先来描述这段代码。我们有两个功能，一个在另一个中。<code class="fe og oh oi oj b"><strong class="ky ir">myFunc</strong></code>是<strong class="ky ir">的第一个函数</strong>，我们在其中声明变量<code class="fe og oh oi oj b"><strong class="ky ir">myVar</strong></code>。然后这个函数中的<strong class="ky ir">被声明为第二个函数</strong>，名为<code class="fe og oh oi oj b"><strong class="ky ir">myFunc2</strong></code>。在<code class="fe og oh oi oj b"><strong class="ky ir">myFunc2</strong></code>内部，我们声明了变量<code class="fe og oh oi oj b"><strong class="ky ir">myVar2</strong></code>。我们最终在打印<code class="fe og oh oi oj b"><strong class="ky ir">myVar2</strong></code>之前调用<code class="fe og oh oi oj b"><strong class="ky ir">myFunc2</strong></code>。</p><p id="7a3b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">现在，如果你看一下注释，你会发现从<code class="fe og oh oi oj b"><strong class="ky ir">myFunc2</strong></code>内部可以访问<code class="fe og oh oi oj b"><strong class="ky ir">myVar</strong></code>。<code class="fe og oh oi oj b"><strong class="ky ir">myVar2</strong></code>当然也可以访问，但是<code class="fe og oh oi oj b"><strong class="ky ir">myVar2</strong></code>不能从myFunc访问。</p><h1 id="6de6" class="nd ne iq bd nf ng oy ni nj nk oz nm nn jw pa jx np jz pb ka nr kc pc kd nt nu bi translated">全球范围</h1><p id="4d09" class="pw-post-body-paragraph kw kx iq ky b kz nv jr lb lc nw ju le lf nx lh li lj ny ll lm ln nz lp lq lr ij bi translated">我希望你一切都好，你还没有得到一些扑热息痛。我们快到了！我保证！</p><p id="7cc2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们现在将对<strong class="ky ir">全局范围</strong>感兴趣。使用关键字<code class="fe og oh oi oj b"><strong class="ky ir">global</strong></code> (nodejs)或<code class="fe og oh oi oj b"><strong class="ky ir">window</strong></code>(浏览器)或<strong class="ky ir">可以从任何地方</strong>访问全局范围<strong class="ky ir">，只需使用变量名</strong>就可以从同一个文件访问全局范围。</p><p id="116c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而，全局作用域<strong class="ky ir">无法访问从较低作用域</strong>声明的任何变量！(功能或块)</p><h1 id="eb30" class="nd ne iq bd nf ng oy ni nj nk oz nm nn jw pa jx np jz pb ka nr kc pc kd nt nu bi translated">结论</h1><p id="e436" class="pw-post-body-paragraph kw kx iq ky b kz nv jr lb lc nw ju le lf nx lh li lj ny ll lm ln nz lp lq lr ij bi translated">总而言之，我们可以说<strong class="ky ir">作用域遵循某种从全局作用域到块作用域</strong>的层次结构。</p><p id="dd37" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">块范围可以访问存在于它上面的所有东西</strong>(函数和全局)</p><p id="1e4a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir">函数作用域位于中间，只能访问更高级函数或全局作用域的变量。</strong></p><p id="6e91" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">最后，<strong class="ky ir">全局作用域不能访问任何更高的级别</strong>(因为它已经是最高级别了)，并且<strong class="ky ir">也不能访问更低的作用域</strong>。</p><p id="c4e7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是所有这些都有一个例外<strong class="ky ir"/>！我们现在就来谈谈！</p></div><div class="ab cl mw mx hu my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="ij ik il im in"><h1 id="a102" class="nd ne iq bd nf ng nh ni nj nk nl nm nn jw no jx np jz nq ka nr kc ns kd nt nu bi translated">var/let/const对范围的影响</h1><p id="6008" class="pw-post-body-paragraph kw kx iq ky b kz nv jr lb lc nw ju le lf nx lh li lj ny ll lm ln nz lp lq lr ij bi translated">我说过了！有一个例外，关键字<code class="fe og oh oi oj b"><strong class="ky ir">var</strong></code>的用法</p><p id="a6e6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">快速提醒一下，<code class="fe og oh oi oj b"><strong class="ky ir">const</strong></code>和<code class="fe og oh oi oj b"><strong class="ky ir">let</strong></code> <strong class="ky ir"> </strong>与<strong class="ky ir">对作用域</strong>有着相同的影响。唯一不同的是<code class="fe og oh oi oj b"><strong class="ky ir">const</strong></code>是<strong class="ky ir">只读</strong>而<code class="fe og oh oi oj b">let</code>可以被<strong class="ky ir">重新分配</strong>。</p><p id="823f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然而，<code class="fe og oh oi oj b"><strong class="ky ir">var</strong></code> <strong class="ky ir">也可以</strong>重新分配，并且<strong class="ky ir">几乎可以在每个范围</strong>中访问！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi pd"><img src="../Images/916ed171cdec4cda70419e5d314a2b51.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*j0C9cqZ4nhjVv_ZtGstBLg.png"/></div></div></figure><blockquote class="lt"><p id="220a" class="lu lv iq bd lw lx pe pf pg ph pi lr dk translated">等等，但是那个代码没有意义？？？</p></blockquote><p id="9815" class="pw-post-body-paragraph kw kx iq ky b kz md jr lb lc me ju le lf mf lh li lj mg ll lm ln mh lp lq lr ij bi translated">这个例子基本上使用了JS 的<strong class="ky ir">两个不同的规则。本文所说的<strong class="ky ir">范围</strong>和<strong class="ky ir">闭包</strong>！</strong></p><p id="057b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">先说范围。正如我所说的，<code class="fe og oh oi oj b"><strong class="ky ir">var</strong></code>声明了一个与作用域无关的变量，可以从任何作用域访问它。这解释了为什么第一个console.log可以工作。</p><p id="635a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">但是，为什么第二个失败了？原因是函数内部的这段代码正在创建一个被称为闭包的<strong class="ky ir">封闭范围。每个函数都在创建自己的作用域</strong>，在它们内部发生的一切<strong class="ky ir">都与其余的</strong>相隔离！</p><blockquote class="oa ob oc"><p id="81c2" class="kw kx ls ky b kz la jr lb lc ld ju le od lg lh li oe lk ll lm of lo lp lq lr ij bi translated">要了解更多关于closure的信息，请继续关注我的下一篇文章！</p></blockquote></div><div class="ab cl mw mx hu my" role="separator"><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb nc"/><span class="mz bw bk na nb"/></div><div class="ij ik il im in"><p id="c7fa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">希望这篇文章有所帮助！不要犹豫，与其他可能需要它的开发人员分享它！</p><p id="d925" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="ls">更多内容看</em> <a class="ae kv" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="ls">说白了就是</em> </strong> </a> <em class="ls">。报名参加我们的</em> <a class="ae kv" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="ls">免费周报</em> </strong> </a> <em class="ls">。关注我们</em> <a class="ae kv" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="ls">推特</em> </strong> </a>，<a class="ae kv" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="ls">LinkedIn</em></strong></a><em class="ls">，</em><a class="ae kv" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="ls">YouTube</em></strong></a><em class="ls">，</em><a class="ae kv" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"><em class="ls">不和</em>  </a> <em class="ls">。</em></p></div></div>    
</body>
</html>