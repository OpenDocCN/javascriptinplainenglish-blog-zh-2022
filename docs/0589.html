<html>
<head>
<title>What’s Wrong with the forEach loop?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">forEach循环有什么问题？</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/whats-wrong-with-the-foreach-loop-c8d19d840750?source=collection_archive---------21-----------------------#2022-02-01">https://javascript.plainenglish.io/whats-wrong-with-the-foreach-loop-c8d19d840750?source=collection_archive---------21-----------------------#2022-02-01</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/813838fd1701125229a68d0c9193a582.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SiscRtnQftKSX7JAHnB0Fg.jpeg"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/@priscilladupreez?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Priscilla Du Preez</a> on <a class="ae jz" href="https://unsplash.com/s/photos/loops?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="b7f2" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">循环是每个人在开始编程时最先学习的概念之一。在大多数编程语言中，我们有for循环、while循环、do-while循环等。</p><p id="8e95" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在JavaScript中你知道哪种for循环？</p><p id="d071" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们有传统的for循环、forEach循环、for…of循环和for…in循环。</p><p id="a3a2" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">有没有尝试过用forEach循环执行异步操作？</p><p id="ddb9" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">首先，什么是异步和同步？</p><p id="f09d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">异步意味着非阻塞。简单认识一下吧。它不会等到一项任务完成后再去执行另一项任务。同步与此相反。一旦当前任务完成，它将进入下一个任务。</p><p id="28f3" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在JavaScript中，数据库调用、设置超时等行为是异步的。</p><p id="f4de" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">让我们进入正题。异步操作中的forEach循环有什么问题？</p><p id="cace" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们举个例子来看。</p><p id="26b2" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们有一个数字数组。我们要做的是为每个数字加2，并将其推送到另一个数组。为了模拟异步的本质，我们在setTimeout中添加了。</p><figure class="ky kz la lb gt jo"><div class="bz fp l di"><div class="lc ld l"/></div></figure><p id="ef26" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">你认为输出会是什么？</p><p id="fb89" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">它会打印一个空数组</strong>，用<strong class="kc io">arr</strong>初始化。但是为什么呢？为了理解它，让我们在循环中添加一个控制台，如下所示。</p><figure class="ky kz la lb gt jo"><div class="bz fp l di"><div class="lc ld l"/></div></figure><p id="7793" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这是输出。</p><pre class="ky kz la lb gt le lf lg lh aw li bi"><span id="100b" class="lj lk in lf b gy ll lm l ln lo">[]<br/>3<br/>4<br/>5<br/>6</span></pre><p id="df87" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">发生的情况是，它在循环完成之前运行了console.log(arr)(第19行)。</p><p id="d167" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">为了克服这一点，我们可以使用for…of循环。</p><figure class="ky kz la lb gt jo"><div class="bz fp l di"><div class="lc ld l"/></div></figure><p id="a869" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们得到了预期的输出。</p><pre class="ky kz la lb gt le lf lg lh aw li bi"><span id="2fd9" class="lj lk in lf b gy ll lm l ln lo">[ 3, 4, 5, 6 ]</span></pre><p id="c97a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">因此，如果你在迭代地进行异步操作，总是倾向于使用for… of循环来避免意外。</p><p id="a849" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">希望这对您有所帮助。</p><p id="9e37" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">编码快乐！</p><p id="c86c" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="lp">更多内容看</em> <a class="ae jz" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kc io"> <em class="lp">说白了就是</em> </strong> </a> <em class="lp">。报名参加我们的</em> <a class="ae jz" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kc io"> <em class="lp">免费周报</em> </strong> </a> <em class="lp">。在我们的</em> <a class="ae jz" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kc io"> <em class="lp">社区获得独家访问写作机会和建议</em> </strong> </a> <em class="lp">。</em></p></div></div>    
</body>
</html>