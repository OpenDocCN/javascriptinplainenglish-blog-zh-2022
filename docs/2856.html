<html>
<head>
<title>Why Refactoring Breaks Your Code</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么重构会破坏你的代码</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/why-refactoring-breaks-your-code-d03537d832eb?source=collection_archive---------1-----------------------#2022-07-10">https://javascript.plainenglish.io/why-refactoring-breaks-your-code-d03537d832eb?source=collection_archive---------1-----------------------#2022-07-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="4b77" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何在不破坏一切的情况下进行重构。</h2></div><figure class="kh ki kj kk gt kl gh gi paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gh gi kg"><img src="../Images/09f45beb44c515066ff1d036542c693f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*g7MViKOI6df3oMbX"/></div></div><figcaption class="ks kt gj gh gi ku kv bd b be z dk">Photo by <a class="ae kw" href="https://unsplash.com/@ar1428?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Andrew Roberts</a> on <a class="ae kw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="8438" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">重构是软件开发人员的一项重要技能。尤其是在实现应用程序的时间敏感部分时，通常没有足够的时间来考虑架构的每个细节。此外，用不熟悉的需求开发特性是糟糕代码的常见来源。最重要的是，代码的质量取决于团队的整体技能水平。我们必须和初级员工一起工作，有时甚至要继承他们的代码库。不要误解我:我们都有开始的时候。但不幸的是，这并不总是我们能够解释的事情。</p><p id="df54" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">然后，我们坐在一起计划如何改进我们的代码。每个人都被炒作。最初的动机迟早会屈服于彻底的放弃，原因有几个:</p><ul class=""><li id="a1e7" class="lt lu iq kz b la lb ld le lg lv lk lw lo lx ls ly lz ma mb bi translated">要重构的东西太多了；你不知道从哪里开始，如何开始。</li><li id="b1c2" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">你的重构产生了错误。</li><li id="ef63" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">在重构的时候，你仍然需要改进代码库。所以你必须在改进代码库的同时编写新的特性。</li><li id="35d3" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ly lz ma mb bi translated">重构不知何故让一切变得更糟。</li></ul><p id="479d" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">如果这听起来对你来说很熟悉，让我们一个一个地检查问题，并找出下次如何做得更好。</p><h2 id="2a60" class="mh mi iq bd mj mk ml dn mm mn mo dp mp lg mq mr ms lk mt mu mv lo mw mx my mz bi translated">从哪里开始重构？</h2><p id="7cfd" class="pw-post-body-paragraph kx ky iq kz b la na jr lc ld nb ju lf lg nc li lj lk nd lm ln lo ne lq lr ls ij bi translated">我能理解那些试图以任务的形式协调重构的团队。然而，在进行过程中进行重构是有益的。Robert C. Martin说最好应用探路者原则:让代码比你发现时更干净。换句话说，让重构成为一种习惯，成为你日常工作的一部分。当第一次开始适应重构时，尝试一下子重构所有的东西是很诱人的。不要那样做。它很可能会失败。</p><p id="13d8" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">在开始重构你的代码之前，确保你<em class="nf">满足需求，</em>这意味着:你的代码应该被自动化测试覆盖。</p><p id="d480" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">你可能会问:“为什么我需要测试？我自己考。”<br/>测试确保你的项目的商业价值得到满足。例如，如果你在你的网站上卖书，你想确保购买你的产品的过程是有效的。因此，您创建用户测试(端到端测试)来覆盖真实的用例。这将确保你的用例保持完整，不管你做了什么改变。否则，您将不得不一次又一次地手动测试整个应用程序。根据项目的规模和复杂程度，这是不现实的。然后你<em class="nf">需要</em>自动化测试就位。</p><p id="ccfd" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">这也是为什么测试是重构的一个需求。他们将确保你的代码<em class="nf">不会破坏</em>。所以，如果你还没有测试，那么在重构之前<strong class="kz ir">覆盖你的代码</strong>。这将确保商业价值不受影响。</p><p id="1444" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">拥有一个经过良好测试的代码仍然不意味着你可以马上重构。还有一些问题需要回答:你想改善什么？涉及哪些文件？所有相关文件/模块/组件的总体目标是什么(例如，目标体系结构)？诸如此类。不要急于求成，尤其是在你还没有任何经验的时候。相反，创建一个所有人都同意的计划，这样就没有一个人对重构的内容承担所有责任。这里有一个例子:</p><ol class=""><li id="7437" class="lt lu iq kz b la lb ld le lg lv lk lw lo lx ls ng lz ma mb bi translated">根据用例对文件中的所有功能进行分组(例如，使用区域)。我建议这样做，尤其是对于大文件。</li><li id="a92d" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ng lz ma mb bi translated">现在您应该有一个包含不止一个用例的文件。您可以与您的团队讨论这一点，并采取以下行动。</li><li id="110c" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ng lz ma mb bi translated">这可能意味着您选择一个用例，并将其提取到它自己的文件中。</li><li id="19b2" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ng lz ma mb bi translated">完成一个模块后，你可以与你的团队讨论结果。有什么收获吗？一切顺利吗？</li><li id="71cd" class="lt lu iq kz b la mc ld md lg me lk mf lo mg ls ng lz ma mb bi translated">然后，您可以继续从该文件中选择下一个用例，或者获取下一个文件。</li></ol><p id="665a" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">对于包含大量文件的复杂项目，这是我最喜欢的例程之一。</p><p id="41fb" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">TLDR，尤其是在团队工作时，不要独自重构。做结对。利用你团队的专业知识。让每个人都参与进来。这是一种可以改变整个团队对代码质量态度的学习。</p><h2 id="886e" class="mh mi iq bd mj mk ml dn mm mn mo dp mp lg mq mr ms lk mt mu mv lo mw mx my mz bi translated">你的重构会产生错误</h2><p id="cbef" class="pw-post-body-paragraph kx ky iq kz b la na jr lc ld nb ju lf lg nc li lj lk nd lm ln lo ne lq lr ls ij bi translated">正如上一章提到的，重构的一个要求是测试到位。如果你在测试和重构方面没有经验，你仍然会产生错误。这很常见，所以不要因此而沮丧。你<em class="nf">需要</em>套路。评估这些错误，并找出如何避免它们。不要只是修复和忽略它的发生。接受学习需要时间；没有人第一次做得完美。</p><p id="1543" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">如果你在一家没有错误文化的公司工作，也不会给错误提供任何空间，赶紧离开那里。如果你因为害怕犯错而从不采取行动，你会停滞不前，什么也学不到。</p><h2 id="2834" class="mh mi iq bd mj mk ml dn mm mn mo dp mp lg mq mr ms lk mt mu mv lo mw mx my mz bi translated">在重构的时候，你仍然需要在项目上取得进展</h2><p id="ade8" class="pw-post-body-paragraph kx ky iq kz b la na jr lc ld nb ju lf lg nc li lj lk nd lm ln lo ne lq lr ls ij bi translated">项目经理不喜欢重构，因为它们通常意味着项目没有进展。作为一名开发人员，在重构完成之前，你通常不会有机会暂停整个项目。所以，你必须在改进代码的同时处理一个正在进行的项目。</p><p id="47f2" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">为了解决这个问题，你必须让整个团队适应重构的习惯。探路者原则是解决这个问题的一种方法。为了支持这一点，您还应该有一个适当的代码审查实践。代码评审应该有一个目标:支持开发人员尽快部署特性，尊重一致同意的代码质量度量。不要在代码评审中讲授(记住它，在正确的时间做)，不要不必要地停止开发，不要责怪任何人。失败的代码审查是过程的问题，而不是开发人员的问题。改进流程；开发者会自动变得更好。代码审查的结果应该是可预测的。代码审查是检查每个团队成员是否适应探路者原则的一个很好的方法。</p><p id="3032" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">取决于你的团队，这可能需要一段时间，并伴随着一些起伏。但是，最终，这是值得的。</p><p id="7816" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">就这些了，伙计们。</p><p id="833e" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated">感谢您的阅读。</p><p id="8282" class="pw-post-body-paragraph kx ky iq kz b la lb jr lc ld le ju lf lg lh li lj lk ll lm ln lo lp lq lr ls ij bi translated"><em class="nf">更多内容请看</em><a class="ae kw" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kz ir"><em class="nf">plain English . io</em></strong></a><em class="nf">。报名参加我们的</em> <a class="ae kw" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kz ir"> <em class="nf">免费周报</em> </strong> </a> <em class="nf">。关注我们关于</em><a class="ae kw" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="kz ir"><em class="nf">Twitter</em></strong></a><em class="nf">和</em><a class="ae kw" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kz ir"><em class="nf">LinkedIn</em></strong></a><em class="nf">。查看我们的</em> <a class="ae kw" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kz ir"> <em class="nf">社区不和谐</em> </strong> </a> <em class="nf">加入我们的</em> <a class="ae kw" href="https://inplainenglish.pallet.com/talent/welcome" rel="noopener ugc nofollow" target="_blank"> <strong class="kz ir"> <em class="nf">人才集体</em> </strong> </a> <em class="nf">。</em></p></div></div>    
</body>
</html>