<html>
<head>
<title>Arrange, Act and Assert</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">安排、行动和断言</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/arrange-act-and-assert-464219722a51?source=collection_archive---------3-----------------------#2022-12-28">https://javascript.plainenglish.io/arrange-act-and-assert-464219722a51?source=collection_archive---------3-----------------------#2022-12-28</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><div class=""><h2 id="e921" class="pw-subtitle-paragraph jo iq ir bd b jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dk translated">如何正确地组织你的测试(一个完整的例子)</h2></div><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj kg"><img src="../Images/092734c9f8ef22ed2c92eee4502b0411.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*HsOJCAoxD5UkU8XT"/></div></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">Photo by <a class="ae kw" href="https://unsplash.com/fr/@nitram509?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Martin W. Kirst</a> on <a class="ae kw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="c696" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">当在编程中编写测试时，我们希望能够理解测试。不仅仅是为了我们自己，也是为了其他遇到我们代码的开发者。</p><p id="c037" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">编写适当组织的测试可以确保我们的代码被很好地记录，并且它应该是这样的，一个新的开发人员仅仅通过通读测试就能够理解我们的代码在做什么。</p><p id="6520" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">构建我们的测试的最有效的方法之一是使用<strong class="kz is">安排、动作和断言方法</strong>。我喜欢这种技术，因为它简单并且允许我们一次只关注一个测试。</p><p id="5a4a" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">我以前写过，测试代码的最佳实践之一是避免在一次测试中有太多的断言。您可以点击<a class="ae kw" href="https://medium.com/javascript-in-plain-english/7-testing-best-practices-i-have-learned-as-a-developer-b8f469778443" rel="noopener">此链接</a>阅读其余的最佳实践。</p><p id="b0ee" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">在这篇文章中，我将使用一个简单的例子来快速解释这种技术。</p><p id="3453" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated"><em class="lt">注意:本例中选择的库是react测试库。</em></p><h2 id="c693" class="lu lv ir bd lw lx ly dn lz ma mb dp mc lg md me mf lk mg mh mi lo mj mk ml mm bi translated">我们将测试的示例组件</h2><p id="f5d7" class="pw-post-body-paragraph kx ky ir kz b la mn js lc ld mo jv lf lg mp li lj lk mq lm ln lo mr lq lr ls ik bi translated">假设我们有一个按钮组件，我们想测试它的点击动作。</p><pre class="kh ki kj kk gu ms mt mu bn mv mw bi"><span id="925e" class="mx lv ir mt b be my mz l na nb">// The component<br/>import Button from '...'<br/><br/>type MyButtonProps = {<br/>  onClick: () =&gt; void,<br/>  buttonText: string,<br/>  testID: string,<br/>}<br/><br/>const MyButton = ({ onClick, buttonText, testID }: MyButtonProps) =&gt; (<br/>  &lt;Button<br/>    onClick={onClick}<br/>    testID={testID}<br/>    accessibilityRole='button'<br/>  &gt;<br/>    {buttonText}<br/>  &lt;/Button&gt;<br/>)</span></pre><h2 id="e634" class="lu lv ir bd lw lx ly dn lz ma mb dp mc lg md me mf lk mg mh mi lo mj mk ml mm bi translated">编写测试(一步一步)</h2><p id="0713" class="pw-post-body-paragraph kx ky ir kz b la mn js lc ld mo jv lf lg mp li lj lk mq lm ln lo mr lq lr ls ik bi translated">为了开始编写测试，我们需要建立一个测试文件。这可能是类似于<code class="fe nc nd ne mt b">MyButton.spec.tsx</code>或<code class="fe nc nd ne mt b">MyButton.test.tsx</code>的东西。做完这个我们就可以开始测试了。</p><p id="bfa2" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated"><strong class="kz is"> (1)第一步是安排我们的考试。</strong></p><p id="e54c" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">这意味着我们需要建立一个测试用例，并从用户的角度回答一些问题。我们可以问的第一个问题是，组件是用它的道具渲染的吗？</p><pre class="kh ki kj kk gu ms mt mu bn mv mw bi"><span id="dd85" class="mx lv ir mt b be my mz l na nb">describe('MyButton component', () =&gt; {<br/>  it('renders successfully with props', () =&gt; {<br/>    // Arrange &lt;--- We are here<br/>    const props = {<br/>      buttonText: 'My Button',<br/>      testID: 'my-button-component'<br/>    }<br/>  })<br/><br/>  it('fires an on click action when clicked', () =&gt; {<br/>    // Arrange &lt;--- We are here<br/>    const onClickMockFunction = jest.fn();<br/>    const props = {<br/>      buttonText: 'My Button',<br/>      onClick: onClickMockFunction,<br/>      testID: 'my-button-component'<br/>    }<br/>  })<br/>})</span></pre><p id="a1b3" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">在上面的代码片段中，我们已经安排了测试。也就是说，我们已经建立了我们的测试用例，现在我们可以继续与组件进行实际的交互。</p><p id="f86a" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated"><strong class="kz is"> (2)第二步，按照我们安排好的测试用例行动。</strong></p><p id="20bb" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">这意味着我们需要针对特定的行为。在本例中，我们将针对两种类型的行为；(1)它应该显示按钮文本prop ,( 2)单击按钮时应该调用click函数。</p><pre class="kh ki kj kk gu ms mt mu bn mv mw bi"><span id="aa6e" class="mx lv ir mt b be my mz l na nb">describe('MyButton component', () =&gt; {<br/>  it('renders successfully with props', () =&gt; {<br/>    // Arrange<br/>    const props = {<br/>      buttonText: 'My Button',<br/>      testID: 'my-button-component'<br/>    }<br/><br/>    // Act &lt;--- We are here<br/>    const { getByText } = render(&lt;MyButton {...props} /&gt;)<br/>    fireEvent.click(screen.getByText(/my button/i))<br/>  })<br/><br/>  it('fires an on click action when clicked', () =&gt; {<br/>    // Arrange<br/>    const onClickMockFunction = jest.fn();<br/>    const props = {<br/>      buttonText: 'My Button',<br/>      onClick: onClickMockFunction,<br/>      testID: 'my-button-component'<br/>    }<br/><br/>    // Act &lt;--- We are here<br/>    const { getByText } = render(&lt;MyButton {...props} /&gt;)<br/>    fireEvent.click(screen.getByText(/my button/i))<br/>  })<br/>})</span></pre><p id="6a9a" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">在上面的例子中，我们通过组件的文本内容来定位组件。我们也可以用其他方式来瞄准它:</p><pre class="kh ki kj kk gu ms mt mu bn mv mw bi"><span id="3866" class="mx lv ir mt b be my mz l na nb">const { getByTestID } = render(&lt;MyButton {...props} /&gt;) // we would use 'my-button-component'<br/>const { getByRole } = render(&lt;MyButton {...props} /&gt;) // we would use 'button'<br/><br/>// For multiple buttons on the screen you can differentiate them like this:<br/><br/>screen.getByRole('button', { name: 'My Button 1' })<br/>screen.getByRole('button', { name: 'My Button 2' })</span></pre><p id="605d" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated"><strong class="kz is"> (3)第三步，也是最后一步，做断言。</strong></p><p id="9fcc" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">这意味着我们需要告诉我们的测试期望一个特定的结果。这将告诉我们测试是通过了还是失败了。我们使用<code class="fe nc nd ne mt b">expect</code>关键字来做这件事。</p><pre class="kh ki kj kk gu ms mt mu bn mv mw bi"><span id="120c" class="mx lv ir mt b be my mz l na nb">describe('MyButton component', () =&gt; {<br/>  it('renders successfully with props', () =&gt; {<br/>    // Arrange<br/>    const props = {<br/>      buttonText: 'My Button',<br/>      testID: 'my-button-component'<br/>    }<br/><br/>    // Act<br/>    const { getByText } = render(&lt;MyButton {...props} /&gt;)<br/><br/>    // Assert &lt;--- We are here<br/>    expect(screen.getByText(/my button/i)).toBeDefined()<br/>  })<br/><br/>  it('fires an on click action when clicked', () =&gt; {<br/>    // Arrange<br/>    const onClickMockFunction = jest.fn();<br/>    const props = {<br/>      buttonText: 'My Button',<br/>      onClick: onClickMockFunction,<br/>      testID: 'my-button-component'<br/>    }<br/><br/>    // Act<br/>    const { getByText } = render(&lt;MyButton {...props} /&gt;)<br/>    fireEvent.click(screen.getByText(/my button/i))<br/><br/>    // Assert &lt;--- We are here<br/>    expect(onClickMockFunction).toHaveBeenCalled()<br/>  })<br/>})</span></pre></div><div class="ab cl nf ng hv nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="ik il im in io"><p id="3484" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">感谢阅读！</p><p id="dfb4" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">如果这是有帮助的，如果你给这篇文章一个👏在你的社交网络中分享，如果你还没有，关注一下会很好。</p><p id="f284" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">也请考虑通过我的<a class="ae kw" href="https://mazaher-muraj.medium.com/membership" rel="noopener">推荐</a>链接订阅Medium。Medium是一个很好的学习平台，我用它来了解技术领域的最新动态，并学习其他开发人员的经验。</p><p id="d1f0" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">你的订阅将直接支持我和许多其他媒体作家。</p><div class="nm nn gq gs no np"><a href="https://mazaher-muraj.medium.com/membership" rel="noopener follow" target="_blank"><div class="nq ab fp"><div class="nr ab ns cl cj nt"><h2 class="bd is gz z fq nu fs ft nv fv fx iq bi translated">通过我的推荐链接加入媒体</h2><div class="nw l"><h3 class="bd b gz z fq nu fs ft nv fv fx dk translated">阅读Mazaher Muraj(以及媒体上成千上万的其他作家)的每一个故事。您的会员费直接支持…</h3></div><div class="nx l"><p class="bd b dl z fq nu fs ft nv fv fx dk translated">mazaher-muraj.medium.co</p></div></div><div class="ny l"><div class="nz l oa ob oc ny od kq np"/></div></div></a></div><h2 id="0a1e" class="lu lv ir bd lw lx ly dn lz ma mb dp mc lg md me mf lk mg mh mi lo mj mk ml mm bi translated">更多内容请访问<a class="ae kw" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> PlainEnglish.io </a>。</h2><p id="e8a0" class="pw-post-body-paragraph kx ky ir kz b la mn js lc ld mo jv lf lg mp li lj lk mq lm ln lo mr lq lr ls ik bi translated"><em class="lt">报名参加我们的</em> <a class="ae kw" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kz is"> <em class="lt">免费每周简讯</em> </strong> </a> <em class="lt">。关注我们关于</em><a class="ae kw" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="kz is"><em class="lt">Twitter</em></strong></a>，<a class="ae kw" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kz is"><em class="lt">LinkedIn</em></strong></a><strong class="kz is"><em class="lt">，</em></strong><a class="ae kw" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"><strong class="kz is"><em class="lt">YouTube</em></strong></a><strong class="kz is"><em class="lt">，以及</em></strong><em class="lt"/><a class="ae kw" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"><strong class="kz is"><em class="lt">不和</em> </strong> </a>T51】</p><h2 id="9278" class="lu lv ir bd lw lx ly dn lz ma mb dp mc lg md me mf lk mg mh mi lo mj mk ml mm bi translated">想扩大你的软件创业规模吗？检查<a class="ae kw" href="https://circuit.ooo/?utm=publication-post-cta" rel="noopener ugc nofollow" target="_blank">电路</a>。</h2></div></div>    
</body>
</html>