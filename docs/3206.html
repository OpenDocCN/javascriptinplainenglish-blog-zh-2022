<html>
<head>
<title>As a Front-End Developer, How Much Do You Understand NGINX?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">作为一名前端开发者，你对NGINX了解多少？</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/as-a-front-end-developer-how-much-do-you-understand-nginx-45e06c9f7dd9?source=collection_archive---------0-----------------------#2022-08-09">https://javascript.plainenglish.io/as-a-front-end-developer-how-much-do-you-understand-nginx-45e06c9f7dd9?source=collection_archive---------0-----------------------#2022-08-09</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="f16d" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">我一个前端朋友去面试的时候被问到这样一个问题。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/f1ad5055959b7c7eb61405bc632eeb71.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*5OGl_Lh1zW-Xrh_8.png"/></div></div></figure><p id="5594" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我一个前端朋友去面试的时候被问到这样一个问题。他只回答了一部分，想让我回来给他科普一下，所以我写了这篇文章。</p><h1 id="0166" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">NGINX是什么？</h1><p id="0ac9" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">NGINX (engine x)是一个<strong class="kt ir">轻量级</strong>、<strong class="kt ir">高性能HTTP </strong>和<strong class="kt ir">反向代理服务器</strong>，也是一个通用代理服务器(TCP/UDP/IMAP/POP3/SMTP)，最初由俄罗斯人<code class="fe mk ml mm mn b">Игорь Сысоев.</code>编写</p><p id="c9ed" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">NGINX是一个高性能的HTTP和反向代理服务器，特点是内存占用低，并发能力强。现实中NGINX的并发能力比同类型的web服务器要好。</p><p id="5c61" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">NGINX是专门为性能优化而开发的。最重要的要求是性能，非常注重效率。据悉，NGINX最多可以支持50000个并发连接。</p><h1 id="d109" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">正向代理和反向代理</h1><p id="9dd6" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">NGINX是反向代理服务器，那么什么是反向代理呢？让我们首先来看看什么叫做正向代理</p><p id="5784" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">转发代理</strong>:局域网内的计算机用户直接访问网络是不可行的，只能通过代理服务器(server)访问。这种代理服务称为转发代理。</p><p id="4fe0" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">反向代理</strong>:客户端无法感知代理，因为客户端访问网络不需要配置网络，只要向反向代理服务器发送请求，反向代理服务器选择目标服务器获取数据，然后返回给客户端。反向代理服务器和目标服务器对外只是一个服务器，暴露了代理服务器地址，隐藏了真实的服务器IP地址。</p><h1 id="5bc8" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">负载平衡</h1><p id="785f" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated"><strong class="kt ir">负载平衡</strong>:高可用性网络基础设施的关键组件，通常用于在多个服务器之间分配工作负载，以提高网站、应用程序、数据库或其他服务的性能和可靠性。</p><p id="e603" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果没有负载均衡，客户端和服务器之间的操作通常是:客户端向服务器请求，然后服务器去数据库查询数据，把返回的数据带给客户端:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mo"><img src="../Images/79d632111dc6e979aedffb69999c9db9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*pTHaP5bniiETvrck.png"/></div></div></figure><p id="2b25" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">然而，随着客户端数量的不断增加以及数据和流量的快速增长，这种情况并不令人满意。从上图我们可以看到，客户端的请求和响应都是通过服务器的，所以我们增加服务器的量来允许是不是可以通过共享多台服务器来解决这个问题？</p><p id="184c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">但是这个时候对于客户端来说，他访问这个地址是固定的，所以他不会在意服务器的时间。你只需要把数据返回给我就OK了，所以我们需要一个“经理”，找到这些服务器的老板，客户端直接找到老板，然后老板指派谁处理谁的数据，从而减轻服务器的压力，而这个“老板”就是反向代理服务器，端口号就是这些服务器的员工。号码</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mo"><img src="../Images/680522234cba37a0ed0e74f349c6695d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*f6gJwwZQAxORrcut.png"/></div></div></figure><p id="1d83" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">像这样，当有120个请求时，反向代理服务器会平均分配给服务器，即每个会处理40个请求。这个过程叫做:负载均衡。当然，实现分配的方式有很多种，我只是简单介绍一种。</p><h1 id="6fe3" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">动静分离</h1><p id="44f3" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">当客户端发起请求时，正常情况是这样的:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mo"><img src="../Images/42f89c1da51be79f35445cef5c1770f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*13l-FDZmHo0jbD-D.png"/></div></div></figure><p id="5ecf" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">静态资源:如HTML、CSS</p><p id="25f1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">动态资源:作为Java</p><p id="12e1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了减轻服务器的压力，我们把动态资源和静态资源分开，交给不同的服务器解析，这样既加快了解析的速度，又减轻了单台服务器的压力。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mo"><img src="../Images/7a40b02acc15506c6abf54e2922266e6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*d5_2ZnjmzEBX_3HX.png"/></div></div></figure><h1 id="07dd" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">安装NGINX</h1><p id="3f5e" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">要安装NGINX，可以参考在线教程，或者我写下一篇文章</p><p id="68a9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这里我列出了一些常用的命令:</p><ul class=""><li id="2a3f" class="mp mq iq kt b ku kv kx ky la mr le ms li mt lm mu mv mw mx bi translated">查看版本:<code class="fe mk ml mm mn b">nginx -v</code></li><li id="3f3f" class="mp mq iq kt b ku my kx mz la na le nb li nc lm mu mv mw mx bi translated">开始:<code class="fe mk ml mm mn b">nginx</code></li><li id="d309" class="mp mq iq kt b ku my kx mz la na le nb li nc lm mu mv mw mx bi translated">关机:<code class="fe mk ml mm mn b">nginx -s stop</code></li><li id="52ce" class="mp mq iq kt b ku my kx mz la na le nb li nc lm mu mv mw mx bi translated">确定配置文件是否正确:<code class="fe mk ml mm mn b">nginx -t</code></li><li id="62a4" class="mp mq iq kt b ku my kx mz la na le nb li nc lm mu mv mw mx bi translated">重装配置:<code class="fe mk ml mm mn b">nginx -s reload</code></li></ul><p id="f0ee" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"> NGINX配置文件</strong></p><p id="1bff" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">配置文件分为三个模块:</p><p id="8bfe" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">全局块</strong>:从配置文件开始到events块，主要是设置一些影响NGINX服务器整体运行的配置指令。(按理说在配置并发处理服务的时候，值越大越能支持并发处理，但此时会受到硬件、软件、其他设备的限制)。</p><p id="06c2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir">事件阻塞</strong>:影响NGINX服务器和用户之间的网络连接。常见的设置包括是否在多个工作进程下启用网络连接的序列化，是否允许同时接收多个网络连接等。</p><p id="7418" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><strong class="kt ir"> HTTP block </strong>:比如这里配置了反向代理和负载均衡。</p><h1 id="1939" class="ln lo iq bd lp lq lr ls lt lu lv lw lx jw ly jx lz jz ma ka mb kc mc kd md me bi translated">位置匹配规则</h1><p id="2a13" class="pw-post-body-paragraph kr ks iq kt b ku mf jr kw kx mg ju kz la mh lc ld le mi lg lh li mj lk ll lm ij bi translated">有四种方法:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nd ne l"/></div></figure><p id="4f7b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe mk ml mm mn b">=</code>:精确匹配，用于没有正则表达式的URL，要求字符串与URL严格匹配，只有完全相等才能停止向下搜索和请求过程。</p><p id="3f91" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe mk ml mm mn b">^~</code>:NGINX服务器在用于没有正则表达式的URL之前，需要找到URL和字符串匹配度最高的位置，然后使用这个位置立即处理请求，不再进行匹配。</p><p id="0e16" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe mk ml mm mn b">~</code>:最佳匹配，用于表示URL包含正则表达式，区分大小写。</p><p id="8832" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><code class="fe mk ml mm mn b">~*</code>:与<code class="fe mk ml mm mn b">~</code>相同，除了不区分大小写。</p></div><div class="ab cl nf ng hu nh" role="separator"><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk nl"/><span class="ni bw bk nj nk"/></div><div class="ij ik il im in"><p id="56db" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><em class="nm">更多内容看</em> <a class="ae nn" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir"> <em class="nm">说白了就是</em> </strong> </a> <em class="nm">。报名参加我们的</em> <a class="ae nn" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir"> <em class="nm">免费周报</em> </strong> </a> <em class="nm">。关注我们关于</em> <a class="ae nn" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir"> <em class="nm">推特</em> </strong> </a>，<a class="ae nn" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir"> <em class="nm">领英</em> </strong> </a> <em class="nm">，以及</em> <a class="ae nn" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir"> <em class="nm">不和</em> </strong> </a> <em class="nm">。</em></p></div></div>    
</body>
</html>