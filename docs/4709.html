<html>
<head>
<title>Magic strings or constants?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">魔弦还是常数？</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/magic-strings-or-constants-a0fdcdda197c?source=collection_archive---------2-----------------------#2022-12-25">https://javascript.plainenglish.io/magic-strings-or-constants-a0fdcdda197c?source=collection_archive---------2-----------------------#2022-12-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/cb3b2798d3b8cb455426985d3132599f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*K_rhWEqh33XVfJtz"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@steve_j?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Steve Johnson</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="1d40" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">神奇字符串(或数字)的定义非常清楚——它是一个<strong class="kf ir">硬编码的值，决定了你的程序如何工作</strong>。<br/>使用起来方便快捷；不需要额外的代码或导入，如果您知道代码库，您就知道使用什么值。</p><p id="b405" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb">那又怎么了？为什么还要考虑替代方案呢？</em></p><p id="566d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">人们可以说魔术字符串是一种不好的实践或者反模式。让我们假设这是真的，但问题仍然是“为什么？”。我希望我的解释、论据和例子能帮助你做出决定。我不认为<code class="fe lc ld le lf b">const</code>总是任何规模的任何项目的解决方案，但是我想分享一些使用它们的理由。</p><p id="2d9f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">Identity</strong><br/>Magic string仅仅是一个在编写代码时对代码作者有意义的词(我保证，几个月后你将不得不花额外的一分钟去理解它的意思)。当直接作为一个神奇的字符串使用时，value可能会与其他东西混淆，尤其是在大规模应用程序中，而const更清楚地表明它是什么。</p><p id="765d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如:<em class="lb"> </em> <code class="fe lc ld le lf b">'personal'</code>对<code class="fe lc ld le lf b">const USER_PROFILE_TYPE = 'personal';</code></p><p id="03de" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">而修正这一点，如果同一个词在不同的成分中代表不同的东西，很容易被误替换。</p><p id="e75e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">使用幻数会带来额外的缺点。虽然单词可以不言自明(至少在某种程度上)，但数字很难，偶然替换它们甚至更容易。</p><p id="adff" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">例如:<em class="lb"> </em> <code class="fe lc ld le lf b">'1024'</code>对<code class="fe lc ld le lf b">const MAX_FILE_SIZE = '1024';</code></p><p id="5a9d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">正因为如此，我建议在你的代码中避免使用魔法，但这还不是全部…</p><p id="f189" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">上下文和代码组织</strong> <br/>谈到常量，人们可能会想到一些非常多余的东西——给<code class="fe lc ld le lf b">const</code>分配一个同名的字符串，更像这样:</p><pre class="lg lh li lj gt lk lf ll bn lm ln bi"><span id="5112" class="lo lp iq lf b be lq lr l ls lt">const small = 'small';<br/>const medium = 'medium';<br/>const large = 'large';</span></pre><p id="202e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">没错，这没什么意义。但是，如果您有多个属于一起或共享上下文的值，您有以下选择:</p><pre class="lg lh li lj gt lk lf ll bn lm ln bi"><span id="e823" class="lo lp iq lf b be lq lr l ls lt">const SIZES = {<br/>  small: 'small';<br/>  medium: 'medium';<br/>  large: 'large';<br/>}</span></pre><p id="6b32" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们可以更进一步，组织我们的代码以进一步提高可读性:</p><pre class="lg lh li lj gt lk lf ll bn lm ln bi"><span id="4576" class="lo lp iq lf b be lq lr l ls lt">const COLORS = {<br/>  primary: 'FF9933';<br/>  secondary: '138808';<br/>  tertiary: '000080';<br/>}<br/><br/>const GRAYSCALE = {<br/>  white: 'FFFFFF';<br/>  ink: '333';<br/>}<br/><br/>const COLOR_PALETTE = {<br/>  COLORS,<br/>  GRAYSCALE,<br/>}</span></pre><p id="886a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">重用<br/> </strong>这一点值得商榷。当然你不会重用一个神奇的字符串，但是你也不会总是重用常量。尽管如此，为了保持一致性，在文件顶部定义<code class="fe lc ld le lf b">const</code>还是很方便的。</p><p id="2d8c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当然，当你需要在多个地方使用同一个值时，甚至在同一个文件中，你应该使用<code class="fe lc ld le lf b">const</code>。</p><p id="8e0b" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最简单的例子就是当你使用一个组件库的时候。当你用它们做积木的时候，你会用很多。在替换所选选项的值时，有很多机会出现输入错误，以及大量额外的工作。</p><p id="583e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">以下是如何避免前者并将后者最小化:</p><pre class="lg lh li lj gt lk lf ll bn lm ln bi"><span id="6298" class="lo lp iq lf b be lq lr l ls lt">const COMPONENT_SIZE = {<br/>  sm: 'small'<br/>  md: 'medium'<br/>};<br/><br/>&lt;ui-button<br/>  :size="COMPONENT_SIZE.sm"<br/>/&gt;<br/><br/>&lt;ui-button<br/>  :size="COMPONENT_SIZE.md"<br/>/&gt;</span></pre><p id="9c61" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir">事实的来源<br/> </strong>如果您决定在应用程序的多个域之间共享上下文，它会提供可用值的“事实的来源”。<br/>当你需要改变全局的值时，你需要做的就是在一个地方更新它，而不是一个接一个地在你的代码中做所有的魔术，再次冒着出错的风险。</p><p id="a617" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> Intellisense <br/> </strong>琐碎，但相当有用。拥有常量可以让你总是从有效的选项中选择，而不是冒打错字的风险。</p></div><div class="ab cl lu lv hu lw" role="separator"><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz ma"/><span class="lx bw bk ly lz"/></div><div class="ij ik il im in"><p id="a543" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">总结一下，是的，我建议我的同事使用常数，是的，问题相对简单，但是我发现自己经常解释它们的好处。如果以上都不能说明问题，那么我的最后一个观点就是组织代码，让你可以跟踪选项。</p><p id="f91e" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">编码快乐！</p><p id="df90" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="lb">更多内容看</em> <a class="ae kc" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir"> <em class="lb">说白了。报名参加我们的</em> <a class="ae kc" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir"> <em class="lb">免费周报</em> </strong> </a> <em class="lb">。关注我们关于</em> <a class="ae kc" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir"> <em class="lb">推特</em> </strong> </a>，<a class="ae kc" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir"><em class="lb">LinkedIn</em></strong></a><em class="lb">，</em><a class="ae kc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir"><em class="lb">YouTube</em></strong></a><em class="lb">，以及</em> <a class="ae kc" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir"> <em class="lb">不和</em> </strong> </a> <strong class="kf ir"> <em class="lb">。</em>T57】</strong></strong></a></p><p id="c34f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><strong class="kf ir"> <em class="lb">有兴趣缩放你的软件启动</em> </strong> <em class="lb">？检查出</em> <a class="ae kc" href="https://circuit.ooo/?utm=publication-post-cta" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir"> <em class="lb">电路</em> </strong> </a> <em class="lb">。</em></p></div></div>    
</body>
</html>