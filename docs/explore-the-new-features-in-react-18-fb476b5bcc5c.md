# æ¢ç´¢ React 18 ä¸­çš„æ–°åŠŸèƒ½

> åŸæ–‡ï¼š<https://javascript.plainenglish.io/explore-the-new-features-in-react-18-fb476b5bcc5c?source=collection_archive---------8----------------------->

![](img/fb76fbda506fb045c49e27f4e14ad20e.png)

çœ‹æ¥åˆåˆ°äº†ä¸€å¹´ä¸­çš„è¿™ä¸ªæ—¶å€™äº†ã€‚React åˆšåˆšå‘å¸ƒäº†å…¶æœ€æ–°ç‰ˆæœ¬ 18ï¼Œå®ƒåŒ…å«äº†ä¸€ç³»åˆ—ä¸ºæ‚¨çš„å¼€å‘å¢æ·»å·¨å¤§æ¨åŠ¨åŠ›çš„åŠŸèƒ½ã€‚åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘å°†å¸¦æ‚¨äº†è§£è¿™äº›ç‰¹æ€§ã€‚

ä»¥ä¸‹æ˜¯æˆ‘ä»¬å°†åœ¨æœ¬æ–‡ä¸­æ¶‰åŠçš„å†…å®¹ã€‚

## **æ¦‚è¿°**:

*   ***ååº” 18 å¹¶å‘æ¸²æŸ“***
*   ***ååº”è¿‡æ¸¡***
*   ***ååº”è‡ªåŠ¨é…æ–™***
*   ***åœ¨æœåŠ¡å™¨ç«¯ååº”æ‚¬å¿µ***
*   ***ç»“è®º***

# ç¯å¢ƒè®¾ç½®:

é¦–å…ˆï¼Œè®©æˆ‘ä»¬ä½¿ç”¨ create-react-app æ¥è®¾ç½®æˆ‘ä»¬çš„å¼€å‘ç¯å¢ƒå¹¶æ¢ç´¢æ–°ç‰¹æ€§ã€‚

```
npx create-react-app react-18
```

è¿™å°†è‡ªåŠ¨å®‰è£…æœ€æ–°çš„ react18 ç‰ˆæœ¬ã€‚ç°åœ¨è¿è¡Œ`npm start`ï¼ŒReact åº”ç”¨åº”è¯¥å¼€å§‹è¿è¡Œã€‚å¾€ä¸‹çœ‹ **index.js** æ–‡ä»¶ï¼Œä¸€çœ¼å°±èƒ½çœ‹åˆ°å‘ˆç°è¯­æ³•çš„ç»†å¾®å˜åŒ–ã€‚

**ååº” 17:**

![](img/23ee1bc076bd1e8f758acba133ad3f45.png)

**ååº” 18:**

![](img/def9ffc3a84a8d289253e66979239a33.png)

åœ¨ React18 ä¸­ï¼Œ***react DOM . render***è¢«æ›¿æ¢ä¸º***react DOM . create root***ç”¨äºåˆ›å»ºä½ çš„ app çš„æ ¹ï¼Œç„¶åè°ƒç”¨ render æ–¹æ³•æ¸²æŸ“æ ¹ã€‚è¿™ä¸ª ***createRoot*** æ˜¯å¹¶å‘æ¸²æŸ“æœºåˆ¶çš„ä¸€éƒ¨åˆ†ï¼Œç”¨äºä¸»åŠ¨å¹¶å‘æ¸²æŸ“ã€‚

# ***ååº” 18 å¹¶å‘æ¸²æŸ“***

React 18 çš„ç¬¬ä¸€ä¸ªæ›´æ–°æ˜¯å¹¶å‘æ€§ã€‚React çš„æ ¸å¿ƒæ˜¯å¹¶å‘ç®—æ³•ï¼Œå®ƒæ˜¯ React ç”Ÿæ€ç³»ç»Ÿçš„ä¸»è¦éƒ¨åˆ†ã€‚React 18 å¼•å…¥äº†ä¸€ä¸ªç‰¹æ€§ï¼Œå…è®¸æˆ‘ä»¬ä¸­æ–­å½“å‰çš„å¹¶å‘ä»»åŠ¡ï¼Œç¨åå†ç»§ç»­ã€‚

åœ¨ React 18 ä¹‹å‰ï¼Œä¸€æ—¦å¹¶å‘æ¸²æŸ“ä»»åŠ¡å¼€å§‹ï¼Œå°±æ²¡æœ‰åŠæ³•åœæ­¢å®ƒï¼Œç›´åˆ°å®ƒå®Œæˆæ‰§è¡Œã€‚è¿™å®é™…ä¸Šæ˜¯ä¸€ä¸ªå•ä¸€çš„åŒæ­¥ä»»åŠ¡ï¼Œæ­£å¦‚æˆ‘ä»¬å·²ç»çŸ¥é“çš„ï¼ŒåŒæ­¥ä»»åŠ¡ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°è¿›è¡Œã€‚

éšç€ React18 çš„å‡ºç°ï¼Œå¹¶å‘æœºåˆ¶å¾—åˆ°äº†æ”¹è¿›ï¼Œç°åœ¨å…è®¸ React ä¸­æ–­æ¸²æŸ“ã€‚å¹¶å‘æ¸²æŸ“å¸¦æ¥äº†ä¸€äº›æ–°åŠŸèƒ½ï¼Œå¦‚æ‚¬å¿µã€æµæœåŠ¡å™¨æ¸²æŸ“å’Œç”±å¹¶å‘æ¸²æŸ“é©±åŠ¨çš„è¿‡æ¸¡ã€‚è¿™æ˜¯ React æ ¸å¿ƒæ¸²æŸ“æ¨¡å‹çš„åŸºç¡€æ›´æ–°ï¼Œä½†åªéœ€è¦å¯¹å®ƒæœ‰é«˜å±‚æ¬¡çš„ç†è§£ï¼Œå› ä¸ºå®ƒæ˜¯åœ¨åœºæ™¯æœ¬èº«çš„èƒŒåå¤„ç†çš„ã€‚å¹¶å‘æ¨¡å¼ä»ç„¶æ˜¯ä¸€ä¸ªå®éªŒæ€§çš„ç‰¹æ€§ï¼Œæ­£åœ¨æ…¢æ…¢é€‚åº” React API çš„å…¶ä»–éƒ¨åˆ†ã€‚

# æ–°åŠŸèƒ½

## 1.ååº”è½¬æ¢

React ä¸­çš„æ›´æ–°æœ‰ä¸¤ç§ç±»å‹ã€‚DOM äº‹ä»¶æ›´æ–°å’Œè½¬æ¢æ›´æ–°ã€‚DOM äº‹ä»¶æ›´æ–°åœ¨äº‹ä»¶è§¦å‘å™¨ä¸Šéå¸¸æ˜æ˜¾ï¼Œè€Œè½¬æ¢æ›´æ–°éœ€è¦ç­‰å¾…ä¸€æ®µæ—¶é—´æ‰èƒ½åœ¨è§†å›¾ä¸­çœ‹åˆ°ã€‚

æœ‰äº† React å¹¶å‘ï¼Œæˆ‘ä»¬ç°åœ¨å¯ä»¥å°†ç´§æ€¥æ›´æ–°ä¼˜å…ˆäºè¿‡æ¸¡æ›´æ–°ï¼Œè¿™æ ·ç”¨æˆ·å°±ä¸ä¼šæœ‰ç”¨æˆ·ä½“éªŒä¸ä½³çš„æ„Ÿè§‰ã€‚

ä¸ºäº†ä½¿ç”¨è¿™ä¸ªç‰¹æ€§ï¼ŒReact åˆ¶ä½œäº†ä¸€ä¸ª`**startTransition**` API æ¥é€šçŸ¥ React å“ªäº›æ›´æ–°å…·æœ‰æ›´é«˜çš„ä¼˜å…ˆçº§/ç´§æ€¥æ€§ï¼Œå“ªäº›æ˜¯è¿‡æ¸¡ã€‚

ä¸ºäº†è®¿é—®è¿™ä¸ªï¼Œæˆ‘ä»¬å°†ä½¿ç”¨ ***useTransition*** é’©å­ã€‚æˆ‘ä»¬å¯ä»¥ä»é’©å­æˆ–è€…ç›´æ¥ä»åŸºäºç±»çš„ç»„ä»¶ä¸­çš„ React è®¿é—®`**startTransition**`ã€‚

## ä½¿ç”¨è¿‡æ¸¡æŒ‚é’©:

***use transition***è¿”å›ä¸€ä¸ªè¿‡æ¸¡çŠ¶æ€ï¼Œå’Œä¸€ä¸ªå‡½æ•°ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ isPending æ¥çŸ¥é“è½¬æ¢ä½•æ—¶è¿›è¡Œã€‚

```
const [isPending, startTransition] = useTransition();
```

åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæœ‰ä¸€ä¸ªæŒ‰é’®éœ€è¦ç´§æ€¥åæ˜ ç»“æœï¼Œè¿˜æœ‰ä¸€ä¸ª transitionValue æ˜¾ç¤º 1k+æ•°æ®çš„åˆ—è¡¨ã€‚æˆ‘ä»¬å¸Œæœ›åœ¨æŒ‰é’®ç‚¹å‡»æ—¶æ›´æ–°åˆ—è¡¨ï¼Œå¹¶å¢åŠ è®¡æ•°ã€‚

*   ç‚¹å‡»æŒ‰é’®å°†å¢åŠ `urgentValue`ï¼Œç„¶åè°ƒç”¨`startTransition`æ–¹æ³•è®© React çŸ¥é“`transitionValue`ä¸ç´§æ€¥ï¼Œå› æ­¤å®ƒå°†ç»§ç»­æ…¢æ…¢æ›´æ–°å®ƒï¼Œç»™`urgentValue`æ›´å¤šçš„ä¼˜å…ˆæƒã€‚
*   åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥æ·»åŠ ä¸€ä¸ªå¸¦æœ‰`isPending`çŠ¶æ€çš„åŠ è½½æ•ˆæœï¼Œå‘ç”¨æˆ·æ˜¾ç¤ºåˆ—è¡¨å¤„äºæŒ‚èµ·çŠ¶æ€ã€‚
*   å¦‚æœæˆ‘ä»¬ä» click äº‹ä»¶ä¸­ç§»é™¤`startTransition`æ–¹æ³•ï¼Œç„¶åç»§ç»­å¢åŠ è®¡æ•°å™¨ï¼Œæˆ‘ä»¬å¯ä»¥è§‚å¯Ÿåˆ°å±å¹•ä¸Šæœ‰è½»å¾®çš„å»¶è¿Ÿï¼Œè¿™ç»™äººä¸€ç§ç”¨æˆ·ä½“éªŒä¸ä½³çš„å°è±¡ã€‚

æˆ‘ä»¬ä¹Ÿå¯ä»¥åœ¨åŸºäºç±»çš„ç»„ä»¶ä¸­ä½¿ç”¨ startTransition APIï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚

```
import {startTransition} from 'react';
```

## 2.è‡ªåŠ¨é…æ–™

React åœ¨ React18 ä¸­å¼•å…¥äº†è‡ªåŠ¨æ‰¹å¤„ç†ã€‚React ä¸­çš„æ‰¹å¤„ç†æ˜¯ä»€ä¹ˆï¼Œæˆ‘ä»¬åˆ°åº•ä¸ºä»€ä¹ˆéœ€è¦å®ƒï¼Ÿå¥½å§ï¼Œæ— è®ºä½•æ—¶ï¼Œä½¿ç”¨`setState`åœ¨ React ä¸­æœ‰ä¸€ä¸ªçŠ¶æ€æ”¹å˜ï¼Œç»„ä»¶ç«‹å³é‡æ–°å‘ˆç°ã€‚React 17 å·²ç»ä¸ºæˆ‘ä»¬å¤„ç†é…æ–™äº†ã€‚ç„¶è€Œï¼Œå®ƒä»…é™äºäº‹ä»¶å¤„ç†ç¨‹åºã€‚è¯·å…è®¸æˆ‘è§£é‡Šã€‚

```
onHandleChange = (*event*) *=>* {
 setLoader();
 setValue(); 
 setCounter(); 
}
// Render at the end of event once
```

æ¯å½“äº‹ä»¶å¤„ç†ç¨‹åºä¸­æœ‰çŠ¶æ€æ›´æ”¹æ—¶ï¼Œå®ƒä»¬éƒ½è¢«è§†ä¸ºæ‰¹å¤„ç†ï¼Œå› æ­¤åœ¨äº‹ä»¶å®Œæˆæ‰§è¡Œååªå‘ˆç°ä¸€æ¬¡ã€‚ä½†æ˜¯äº‹ä»¶ä¹‹å¤–çš„ä»»ä½•çŠ¶æ€å˜åŒ–æ¯æ¬¡éƒ½ä¼šå•ç‹¬å‘ˆç°ã€‚

```
onHandleChange = (*event*) *=>* {
 this.apiCall().then(*res=>*{
  setLoader();  // 1 render
  setValue();  // 2 render
  setCounter(); // 3 render
 })
}
```

å¦‚ä½ æ‰€è§ï¼Œè¿™æ˜¯å¾ˆä¸æ°å½“çš„ã€‚å¹¸è¿çš„æ˜¯ï¼ŒReact 18 åœ¨æ‰€æœ‰å¾®ä»»åŠ¡(å¦‚æ‰¿è¯ºå’Œ`setTimeout`å‡½æ•°)ä¸­éƒ½è‡ªåŠ¨æ‰¹å¤„ç†ã€‚æˆ‘ä»¬å¯ä»¥éšæ—¶ä½¿ç”¨`flushSync`é€€å‡ºè¯¥åŠŸèƒ½ã€‚

## 3.åœ¨æœåŠ¡å™¨ä¸Šååº”æ‚¬å¿µ

React 18 åœ¨æœåŠ¡å™¨ç«¯å¼•å…¥äº†æ‚¬å¿µã€‚åœ¨ä¸æ¶‰åŠå¤ªå¤šç»†èŠ‚çš„æƒ…å†µä¸‹ï¼Œè®©æˆ‘ç®€å•æ¦‚è¿°ä¸€ä¸‹ä»€ä¹ˆæ˜¯æœåŠ¡å™¨ç«¯ä»¥åŠå®ƒæ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚ç½‘é¡µå¯ä»¥é€šè¿‡ä¸¤ç§æ–¹å¼åŠ è½½ã€‚åœ¨å®¢æˆ·ç«¯ç§°ä¸ºå®¢æˆ·ç«¯å‘ˆç°(CSR ),æˆ–è€…åœ¨æœåŠ¡å™¨ç«¯ç§°ä¸ºæœåŠ¡å™¨ç«¯å‘ˆç°(SSR)ã€‚CSR åœ¨åŠ è½½æ—¶é—´ä¸Šå¾€å¾€å¾ˆæ…¢ï¼Œå› ä¸ºå®ƒä¸¥é‡ä¾èµ– JavaScriptï¼Œå¹¶ä¸”åŠ¨æ€åŠ è½½æ•°æ®ã€‚

ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½¿ç”¨æœåŠ¡å™¨ç«¯å‘ˆç°æ¥å¢å¼ºä¸€æ¬¡æ€§åŠ è½½é¡µé¢çš„ç”¨æˆ·ä½“éªŒï¼Œå¹¶å‡å°‘äº¤äº’é¡µé¢çš„æ—¶é—´ã€‚

å°½ç®¡è¿™æ˜¯ä¸€ç§æ›´å¥½ã€æ›´å¿«çš„åŠ è½½é¡µé¢çš„æ–¹æ³•ï¼Œä½†æ˜¯ React ä¸­å­˜åœ¨ä¸€ä¸ªç“¶é¢ˆï¼Œå¯¼è‡´é¡µé¢åœ¨ç­‰å¾…æ•°æ®åŠ è½½æ—¶æ²¡æœ‰å“åº”ã€‚

ä¾‹å¦‚ï¼Œå¦‚æœæˆ‘ä»¬æ­£åœ¨åŠ è½½ 3 ä¸ªç»„ä»¶ï¼Œå…¶ä¸­ä¸€ä¸ªç›¸å¯¹è¾ƒæ…¢ï¼Œè¿™å°†æŒ‚èµ·å±å¹•ï¼Œè€Œä¸æ˜¯åŠ è½½å…¶ä»–ç»„ä»¶ï¼Œä»è€Œç ´åç”¨æˆ·ä½“éªŒã€‚

![](img/95e020c091207c8d2e929f5a39667b87.png)

React SSR bottleneck

ä¸ºäº†å¤„ç†è¿™ä¸€ç‚¹ï¼ŒReact 18 å¼•å…¥äº†æ‚¬å¿µã€‚é€šè¿‡æ‚¬å¿µï¼Œæˆ‘ä»¬å¯ä»¥ç”¨æ‚¬å¿µç»„ä»¶åŒ…è£…åº”ç”¨ç¨‹åºçš„æ…¢é€Ÿéƒ¨åˆ†ï¼Œå®ƒä¼šå‘Šè¯‰ React å»¶è¿Ÿé‡ç»„ä»¶çš„æ¸²æŸ“ã€‚è¿™æ ·ï¼Œæœ€è½»çš„ç»„ä»¶ä¼šå…ˆåŠ è½½ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ç”¨æˆ·ä½“éªŒä¸ä¼šå—åˆ°å¹²æ‰°ã€‚

# ç»“è®ºğŸ‰

React 18 å¸¦æ¥äº†ä¸€ç³»åˆ—åº•å±‚çš„å˜åŒ–ï¼Œè¿™æ— ç–‘ä¼šåœ¨ React ä¸­å·¥ä½œæ—¶æœ‰æ‰€å¸®åŠ©ã€‚è™½ç„¶å…¶ä¸­ä¸€äº›æ˜¯å®éªŒæ€§çš„ï¼Œä½†å®ƒä»¬æœ€ç»ˆä¼šå®Œå…¨é›†æˆåˆ°åº“ä¸­ï¼Œå¸¦æ¥å®Œæ•´çš„ä½“éªŒã€‚

> *æˆ‘å¸Œæœ›è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰å¸®åŠ©ï¼Œå¦‚æœä½ æœ‰ï¼Œ* ***å…³æ³¨æˆ‘çš„*** [***ä¸­çš„***](https://medium.com/@mrahmedkhan019) ***å’Œ***[***Twitter***](https://twitter.com/50shadeofkhan)***è·å–æ›´å¤šè½¯ä»¶å¼€å‘æ–‡ç« çš„é€šçŸ¥ï¼Œåˆ«å¿˜äº†ç‚¹å‡»*** *ã€‚ç»ˆäºï¼æ„Ÿè°¢é˜…è¯»ï¼Œå¿«ä¹å­¦ä¹ ï¼*

*æ›´å¤šå†…å®¹è¯·çœ‹*[***plain English . io***](https://plainenglish.io/)*ã€‚æŠ¥åå‚åŠ æˆ‘ä»¬çš„* [***å…è´¹å‘¨æŠ¥***](http://newsletter.plainenglish.io/) *ã€‚å…³æ³¨æˆ‘ä»¬å…³äº*[***Twitter***](https://twitter.com/inPlainEngHQ)*å’Œ*[***LinkedIn***](https://www.linkedin.com/company/inplainenglish/)*ã€‚åŠ å…¥æˆ‘ä»¬çš„* [***ç¤¾åŒºä¸å’Œè°***](https://discord.gg/GtDtUAvyhW) *ã€‚*