<html>
<head>
<title>Decentralize Knowledge Graph with GUN</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带枪分散知识图</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/decentralize-knowledge-graph-with-gun-9e4b0b10a400?source=collection_archive---------13-----------------------#2022-02-15">https://javascript.plainenglish.io/decentralize-knowledge-graph-with-gun-9e4b0b10a400?source=collection_archive---------13-----------------------#2022-02-15</a></blockquote><div><div class="fc ic id ie if ig"/><div class="ih ii ij ik il"><div class=""/><div class=""><h2 id="8267" class="pw-subtitle-paragraph jl in io bd b jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc dk translated">建立一个分散的蛋白质相互作用字符串数据库</h2></div><figure class="ke kf kg kh gu ki gi gj paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gi gj kd"><img src="../Images/44d4ebe4cd6830b068ca8672b4865972.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*mx7DOGMO8ct90yt0"/></div></div><figcaption class="kp kq gk gi gj kr ks bd b be z dk">Photo by <a class="ae kt" href="https://unsplash.com/@theshubhamdhage?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Shubham Dhage</a> on <a class="ae kt" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><blockquote class="ku"><p id="c33f" class="kv kw io bd kx ky kz la lb lc ld le dk translated">狡兔三窟。</p><p id="7866" class="kv kw io bd kx ky lf lg lh li lj le dk translated">—中国习语</p></blockquote><p id="5b73" class="pw-post-body-paragraph lk ll io lm b ln lo jp lp lq lr js ls lt lu lv lw lx ly lz ma mb mc md me le ih bi translated">这句古老的中国习语说明了一切:不要把所有的鸡蛋放在一个篮子里。对一只狡猾的兔子来说是真的。对于我们这些数据科学家来说也是如此。</p><p id="e2b0" class="pw-post-body-paragraph lk ll io lm b ln mf jp lp lq mg js ls lt mh lv lw lx mi lz ma mb mj md me le ih bi translated">在我们的电子健康记录(EHR)聊天机器人Doctor.ai ( <a class="ae kt" href="https://towardsdatascience.com/doctor-ai-an-ai-powered-virtual-voice-assistant-for-health-care-8c09af65aabb" rel="noopener" target="_blank">这里</a>、<a class="ae kt" href="https://neo4j.com/blog/doctor-ai-a-voice-chatbot-for-healthcare-powered-by-neo4j-and-aws/" rel="noopener ugc nofollow" target="_blank">这里</a>、<a class="ae kt" href="https://towardsdatascience.com/transfer-knowledge-graphs-to-doctor-ai-cc21765fa8a6" rel="noopener" target="_blank">这里</a>和<a class="ae kt" href="https://medium.com/geekculture/from-symptoms-and-mutations-to-diagnoses-doctor-ai-as-a-diagnosis-tool-5b31ac7a16c3" rel="noopener">这里</a>)的开发过程中，出现了一个问题:我们应该把这些私人病历放在哪里？第一个选择是云。然而，随之而来的隐私泄露风险让患者权益倡导者感到不安。此外，云提供商有一天可能会关闭他们的业务，并带走我们的数据。</p><p id="836d" class="pw-post-body-paragraph lk ll io lm b ln mf jp lp lq mg js ls lt mh lv lw lx mi lz ma mb mj md me le ih bi translated">第二种选择是将数据存放在P2P网络中。也就是说，我们将数据分发到许多独立和自愿的计算机上。这与BitTorrent的工作方式非常相似。因此，没有人能够单独控制数据。拥有入口点和凭证的每个人都可以访问数据。</p><p id="7f02" class="pw-post-body-paragraph lk ll io lm b ln mf jp lp lq mg js ls lt mh lv lw lx mi lz ma mb mj md me le ih bi translated">这是一个有趣的想法。所以我想尝试一下。因为Doctor.ai的后端数据库是Neo4j图，所以我四处搜索了一个P2P图数据库。而我被奖励了<a class="ae kt" href="https://gun.eco/docs/Introduction" rel="noopener ugc nofollow" target="_blank">枪</a>。以下是官方描述:</p><blockquote class="mk ml mm"><p id="436e" class="lk ll mn lm b ln mf jp lp lq mg js ls mo mh lv lw mp mi lz ma mq mj md me le ih bi translated">它是一个图形数据库，可以存储<a class="ae kt" href="https://gun.eco/docs/Graphs" rel="noopener ugc nofollow" target="_blank">类似SQL的表、类似JSON的文档</a>、文件和直播视频，以及关系和超图数据！…通用枪图分布在参与网络的所有对等点上。浏览器对等体使用localStorage或IndexedDB来仅存储他们订阅的图的子集，使用WebRTC、Websockets或其他传输来同步。相同的浏览器代码也运行在NodeJS中，带有用于<code class="fe mr ms mt mu b">fs</code>的适配器插件、S3式存储备份、UDP多播和其他功能，这些功能使其仅处于“中继”模式或存储所有内容。</p></blockquote><p id="d37c" class="pw-post-body-paragraph lk ll io lm b ln mf jp lp lq mg js ls lt mh lv lw lx mi lz ma mb mj md me le ih bi translated">查看Fireship在YouTube上的两个介绍视频(另一个是<a class="ae kt" href="https://www.youtube.com/watch?v=J5x3OMXjgMc" rel="noopener ugc nofollow" target="_blank">这里是</a>):</p><figure class="ke kf kg kh gu ki"><div class="bz fq l di"><div class="mv mw l"/></div></figure><p id="06a5" class="pw-post-body-paragraph lk ll io lm b ln mf jp lp lq mg js ls lt mh lv lw lx mi lz ma mb mj md me le ih bi translated">这整个概念让我兴奋不已。尽管我对JavaScript非常生疏，但我还是亲自尝试了一下GUN，看看它是否是Doctor.ai的一个好后端。在本教程中，我将向您展示我自己的GUN之旅:我从STRING中导入了一种细菌的蛋白质-蛋白质相互作用—<a class="ae kt" href="https://pubmed.ncbi.nlm.nih.gov/16403882/" rel="noopener ugc nofollow" target="_blank"><em class="mn">Formosa agariphila</em></a><em class="mn"/>。我实现了一个示例查询脚本。所有这些都是用JavaScript编写的。本教程的代码在我的GitHub页面上:</p><div class="mx my gq gs mz na"><a href="https://github.com/dgg32/gun_STRING" rel="noopener  ugc nofollow" target="_blank"><div class="nb ab fp"><div class="nc ab nd cl cj ne"><h2 class="bd ip gz z fq nf fs ft ng fv fx in bi translated">GitHub - dgg32/gun_STRING</h2><div class="nh l"><h3 class="bd b gz z fq nf fs ft ng fv fx dk translated">这个存储库包含我的文章“用枪分散知识图”的代码和数据。import_node.js和…</h3></div><div class="ni l"><p class="bd b dl z fq nf fs ft ng fv fx dk translated">github.com</p></div></div><div class="nj l"><div class="nk l nl nm nn nj no kn na"/></div></div></a></div><h1 id="5a0d" class="np nq io bd nr ns nt nu nv nw nx ny nz ju oa jv ob jx oc jy od ka oe kb of og bi translated">1.将CSV文件导入GUN</h1><p id="3448" class="pw-post-body-paragraph lk ll io lm b ln oh jp lp lq oi js ls lt oj lv lw lx ok lz ma mb ol md me le ih bi translated">事实证明，将正常大小的CSV文件导入GUN并不简单。首先从STRING <a class="ae kt" href="https://string-db.org/cgi/download?sessionId=bDOqitWZB5WC&amp;species_text=Formosa+agariphila" rel="noopener ugc nofollow" target="_blank">这里</a>下载这个项目的两个CSV文件，或者你可以这样做:</p><figure class="ke kf kg kh gu ki gi gj paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gi gj om"><img src="../Images/5be05825ec0611e3e53661590a17307f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*I6vp7BI-bXjvO85ksxvQ8A.png"/></div></div><figcaption class="kp kq gk gi gj kr ks bd b be z dk">Figure 1. Download the CSV files for Formosa agariphila. Image by author.</figcaption></figure><p id="4e6a" class="pw-post-body-paragraph lk ll io lm b ln mf jp lp lq mg js ls lt mh lv lw lx mi lz ma mb mj md me le ih bi translated">“链接”文件包含蛋白质-蛋白质相互作用，而“信息”文件包含每个蛋白质的信息。经过一些实验，我决定用两个脚本分别导入。</p><p id="f6e5" class="pw-post-body-paragraph lk ll io lm b ln mf jp lp lq mg js ls lt mh lv lw lx mi lz ma mb mj md me le ih bi translated">我们只需要三个包裹。经过一些尝试和错误之后，我发现Papa Parse可以完成这项工作:</p><figure class="ke kf kg kh gu ki"><div class="bz fq l di"><div class="on mw l"/></div></figure><p id="097d" class="pw-post-body-paragraph lk ll io lm b ln mf jp lp lq mg js ls lt mh lv lw lx mi lz ma mb mj md me le ih bi translated">接下来是进口。原来GUN中的getters和setters是异步的。如果没有特殊措施，主事件循环将在导入完成之前结束。在这个项目中，我使用了承诺。例如，以下代码导入节点:</p><figure class="ke kf kg kh gu ki gi gj paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gi gj oo"><img src="../Images/29cef68490f43c4d9d5df49ad5360dd0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KFywxXC0puYZX5lJAHLxnw.png"/></div></div></figure><p id="f773" class="pw-post-body-paragraph lk ll io lm b ln mf jp lp lq mg js ls lt mh lv lw lx mi lz ma mb mj md me le ih bi translated"><code class="fe mr ms mt mu b">import_item</code>用它的<code class="fe mr ms mt mu b">gun.get().put()</code>链进行实际的导入。<code class="fe mr ms mt mu b">get()</code>函数返回一个指向节点的指针，而<code class="fe mr ms mt mu b">put()</code>函数设置该节点中的值。但是这个函数链是异步的。因为这个原因，我把它包在一个承诺周围。主循环<code class="fe mr ms mt mu b">Papa.parse</code>收集所有这些承诺，并通过<code class="fe mr ms mt mu b">Promise.all</code>等待它们的完成。因此，可以正确导入节点。</p><p id="aa66" class="pw-post-body-paragraph lk ll io lm b ln mf jp lp lq mg js ls lt mh lv lw lx mi lz ma mb mj md me le ih bi translated">链接导入的脚本类似。在GUN中，关系可以理解为节点的属性。在我们的例子中，这个属性是一个名为<code class="fe mr ms mt mu b">STRING</code>的集合。它包含了连接到这个特殊蛋白质节点的所有蛋白质的<code class="fe mr ms mt mu b">ids</code>和<code class="fe mr ms mt mu b">scores</code>。在这个项目中，只有结合分数高于800分的链接被保留。这里是<code class="fe mr ms mt mu b">import_edge.js</code>的<code class="fe mr ms mt mu b">import_item</code>功能。</p><figure class="ke kf kg kh gu ki gi gj paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gi gj op"><img src="../Images/77a9ff33bfee8b5181713d986a23d2ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*5okzbx7bOjjn0P3IEXSJQQ.png"/></div></div></figure><h1 id="2747" class="np nq io bd nr ns nt nu nv nw nx ny nz ju oa jv ob jx oc jy od ka oe kb of og bi translated">2.查询数据库</h1><p id="6812" class="pw-post-body-paragraph lk ll io lm b ln oh jp lp lq oi js ls lt oj lv lw lx ok lz ma mb ol md me le ih bi translated">数据导入后，我们可以在节点CLI或JavaScript中查询数据库。</p><h2 id="5eb0" class="oq nq io bd nr or os dn nv ot ou dp nz lt ov ow ob lx ox oy od mb oz pa of pb bi translated">2.1统计概述</h2><p id="fcbc" class="pw-post-body-paragraph lk ll io lm b ln oh jp lp lq oi js ls lt oj lv lw lx ok lz ma mb ol md me le ih bi translated">首先，我希望看到所有综合得分高于900的蛋白质-蛋白质相互作用。在控制台中键入<code class="fe mr ms mt mu b">node</code>打开节点CLI。然后逐一键入以下命令:</p><figure class="ke kf kg kh gu ki"><div class="bz fq l di"><div class="on mw l"/></div></figure><p id="1a08" class="pw-post-body-paragraph lk ll io lm b ln mf jp lp lq mg js ls lt mh lv lw lx mi lz ma mb mj md me le ih bi translated">前两行初始化GUN。第三行查询数据库。它首先使用<code class="fe mr ms mt mu b">map</code>函数获取<code class="fe mr ms mt mu b">proteindb</code>中的所有蛋白质。<code class="fe mr ms mt mu b">once</code>函数进入每个蛋白质，获取它们的<code class="fe mr ms mt mu b">STRING</code>属性，并使用<code class="fe mr ms mt mu b">map</code>函数打印出那些得分高于900的连接。</p><p id="04dc" class="pw-post-body-paragraph lk ll io lm b ln mf jp lp lq mg js ls lt mh lv lw lx mi lz ma mb mj md me le ih bi translated">您可以看到这样的输出:</p><figure class="ke kf kg kh gu ki"><div class="bz fq l di"><div class="on mw l"/></div></figure><h2 id="ac3b" class="oq nq io bd nr or os dn nv ot ou dp nz lt ov ow ob lx ox oy od mb oz pa of pb bi translated">2.2检查一种蛋白质</h2><p id="f720" class="pw-post-body-paragraph lk ll io lm b ln oh jp lp lq oi js ls lt oj lv lw lx ok lz ma mb ol md me le ih bi translated">我们也可以只检查一种特定的蛋白质<code class="fe mr ms mt mu b">1347342.BN863_5660</code>及其连接:</p><figure class="ke kf kg kh gu ki"><div class="bz fq l di"><div class="on mw l"/></div></figure><p id="a69a" class="pw-post-body-paragraph lk ll io lm b ln mf jp lp lq mg js ls lt mh lv lw lx mi lz ma mb mj md me le ih bi translated">控制台应该显示如下内容:</p><figure class="ke kf kg kh gu ki"><div class="bz fq l di"><div class="on mw l"/></div></figure><h2 id="f4f3" class="oq nq io bd nr or os dn nv ot ou dp nz lt ov ow ob lx ox oy od mb oz pa of pb bi translated">2.3聚合</h2><p id="6646" class="pw-post-body-paragraph lk ll io lm b ln oh jp lp lq oi js ls lt oj lv lw lx ok lz ma mb ol md me le ih bi translated">最后，让我们得到所有连接到<code class="fe mr ms mt mu b">1347342.BN863_5170</code>的蛋白质，并计算平均蛋白质大小:</p><figure class="ke kf kg kh gu ki"><div class="bz fq l di"><div class="on mw l"/></div></figure><p id="7109" class="pw-post-body-paragraph lk ll io lm b ln mf jp lp lq mg js ls lt mh lv lw lx mi lz ma mb mj md me le ih bi translated">因为函数链是异步的，我们无法提前知道数据何时会从对等点到达，所以我们只能在有数据点可用时对其求和并求平均值。结果是这样的运行记录:</p><figure class="ke kf kg kh gu ki"><div class="bz fq l di"><div class="on mw l"/></div></figure><p id="beb1" class="pw-post-body-paragraph lk ll io lm b ln mf jp lp lq mg js ls lt mh lv lw lx mi lz ma mb mj md me le ih bi translated">有趣的是，虽然我们可以将最后一行作为我们的最终答案，但我们不能100%确定它是这个实现中的正确答案！所以如果你有更好的解决办法，请告诉我。</p><h1 id="0fb5" class="np nq io bd nr ns nt nu nv nw nx ny nz ju oa jv ob jx oc jy od ka oe kb of og bi translated">3.分散</h1><p id="1f53" class="pw-post-body-paragraph lk ll io lm b ln oh jp lp lq oi js ls lt oj lv lw lx ok lz ma mb ol md me le ih bi translated">枪的主要卖点是它的P2P特性。它在我的电脑上跨两个不同的文件夹工作。不幸的是，当我根据官方<a class="ae kt" href="https://elements.heroku.com/buttons/amark/gun" rel="noopener ugc nofollow" target="_blank">指令</a>在Heroku或AWS EC2上设置中继对等体，并与它们连接GUN时，数据同步失败——只同步了一两片。</p></div><div class="ab cl pc pd hs pe" role="separator"><span class="pf bw bk pg ph pi"/><span class="pf bw bk pg ph pi"/><span class="pf bw bk pg ph"/></div><div class="ih ii ij ik il"><h1 id="0ce8" class="np nq io bd nr ns pj nu nv nw pk ny nz ju pl jv ob jx pm jy od ka pn kb of og bi translated">结论</h1><p id="a3f0" class="pw-post-body-paragraph lk ll io lm b ln oh jp lp lq oi js ls lt oj lv lw lx ok lz ma mb ol md me le ih bi translated">尽管我没能在这个项目中实现数据分散化，但这是一个非常吸引人的想法。在优化部署时，这种模式意味着高数据可用性。没有人可以完全控制数据集。尽管许多人都可以访问这些数据，但GUN可以通过其用户系统控制数据编辑。我在本文中还没有触及这个主题，但是我鼓励您进一步探索。</p><p id="df9b" class="pw-post-body-paragraph lk ll io lm b ln mf jp lp lq mg js ls lt mh lv lw lx mi lz ma mb mj md me le ih bi translated">作为图形数据库，GUN在我看来比Neo4j更难用。Neo4j有一个非常有表现力的查询语言，叫做Cypher。它的ASCII艺术风格语法简洁易懂。此外，Neo4j拥有大量的聚合函数、机器学习实用程序和可视化工具。它们使用户能够快速浏览数据并获得新的见解。这些特征是GUN所没有的。最后，对于同步思维来说，GUN的异步特性需要一些时间来适应。</p><p id="f2c8" class="pw-post-body-paragraph lk ll io lm b ln mf jp lp lq mg js ls lt mh lv lw lx mi lz ma mb mj md me le ih bi translated">在其官网上，可以看到很多有趣的带枪项目。网上社区非常活跃，反应也很快。但是我还是觉得这个好库的例子太少了。所以我希望你能继续学习它，并在你的项目中使用它。</p><h1 id="696b" class="np nq io bd nr ns nt nu nv nw nx ny nz ju oa jv ob jx oc jy od ka oe kb of og bi translated">许可证</h1><p id="8c5c" class="pw-post-body-paragraph lk ll io lm b ln oh jp lp lq oi js ls lt oj lv lw lx ok lz ma mb ol md me le ih bi translated"><a class="ae kt" href="https://string-db.org/cgi/access" rel="noopener ugc nofollow" target="_blank"> <em class="mn">字符串是在一个‘知识共享4.0’许可下免费提供的</em> </a> <em class="mn">。</em></p><div class="mx my gq gs mz na"><a href="https://dgg32.medium.com/membership" rel="noopener follow" target="_blank"><div class="nb ab fp"><div class="nc ab nd cl cj ne"><h2 class="bd ip gz z fq nf fs ft ng fv fx in bi translated">加入媒介与我的介绍链接-黄思兴</h2><div class="nh l"><h3 class="bd b gz z fq nf fs ft ng fv fx dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="ni l"><p class="bd b dl z fq nf fs ft ng fv fx dk translated">dgg32.medium.com</p></div></div><div class="nj l"><div class="po l nl nm nn nj no kn na"/></div></div></a></div><p id="042b" class="pw-post-body-paragraph lk ll io lm b ln mf jp lp lq mg js ls lt mh lv lw lx mi lz ma mb mj md me le ih bi translated"><em class="mn">更多内容看</em> <a class="ae kt" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="lm ip"> <em class="mn">说白了就是io </em> </strong> </a> <em class="mn">。报名参加我们的</em> <a class="ae kt" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="lm ip"> <em class="mn">免费周报</em> </strong> </a> <em class="mn">。在我们的</em> <a class="ae kt" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="lm ip"> <em class="mn">社区获得独家访问写作机会和建议</em> </strong> </a> <em class="mn">。</em></p></div></div>    
</body>
</html>