<html>
<head>
<title>How to Use React Context With Hooks for Global State Management</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用带有钩子的React上下文进行全局状态管理</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-use-react-context-with-hooks-for-global-state-management-8d7d3526c5af?source=collection_archive---------0-----------------------#2022-07-20">https://javascript.plainenglish.io/how-to-use-react-context-with-hooks-for-global-state-management-8d7d3526c5af?source=collection_archive---------0-----------------------#2022-07-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="7471" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">用React的useContext创建一个自定义上下文挂钩</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/75f13f1117b70ecb0bbce464eedda7f9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uTR3xhhgz9vSSEzAP5qKcg.png"/></div></div></figure><h1 id="19fa" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">内容</h1><ol class=""><li id="dcc6" class="lj lk iq ll b lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma bi translated"><strong class="ll ir">为什么</strong>您希望使用React的上下文API进行全局状态管理？</li><li id="d331" class="lj lk iq ll b lm mb lo mc lq md ls me lu mf lw lx ly lz ma bi translated">反应上下文能代替<strong class="ll ir"> Redux </strong>吗？</li><li id="0660" class="lj lk iq ll b lm mb lo mc lq md ls me lu mf lw lx ly lz ma bi translated"><strong class="ll ir">什么时候</strong>我应该使用React上下文？</li><li id="c7b8" class="lj lk iq ll b lm mb lo mc lq md ls me lu mf lw lx ly lz ma bi translated">如何使用React上下文:显示代码</li></ol></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h2 id="cb90" class="mn ks iq bd kt mo mp dn kx mq mr dp lb lq ms mt ld ls mu mv lf lu mw mx lh my bi translated">为什么要使用React的上下文API进行全局状态管理？</h2><p id="3f4e" class="pw-post-body-paragraph mz na iq ll b lm ln jr nb lo lp ju nc lq nd ne nf ls ng nh ni lu nj nk nl lw ij bi translated">答案很简单，尽管您可以通过<em class="nm"> props </em>将状态从主父组件一直传递到所有子组件，但在2级= &gt; <strong class="ll ir">深度props drilling</strong>之后，这将变得非常麻烦，这是一种糟糕的做法，会导致代码难以阅读和维护。这时你应该看看状态管理库(例如<strong class="ll ir"> Redux </strong>或内置<strong class="ll ir"> React Context </strong>)。</p><h2 id="4eb2" class="mn ks iq bd kt mo mp dn kx mq mr dp lb lq ms mt ld ls mu mv lf lu mw mx lh my bi translated">React上下文能代替Redux吗？</h2><p id="8dc8" class="pw-post-body-paragraph mz na iq ll b lm ln jr nb lo lp ju nc lq nd ne nf ls ng nh ni lu nj nk nl lw ij bi translated">嗯，看情况。【Redux和React上下文在React应用中仍然有其合理的位置，用于不同的目的。Redux是React最流行的状态管理库，但它不是React的一部分。另一方面，React Context是一个内置的React API，但它不是一个状态管理系统。Redux旨在用于更动态的数据，而<strong class="ll ir"> React Context应该用于不经常改变的静态数据</strong>，例如主题、语言、区域设置。与简单的React上下文相比，Redux可能需要一些初始样板文件，在您习惯这种模式之前可能需要一些时间。所以，<strong class="ll ir"> Redux和React语境不是同一个</strong>。</p><p id="6c5e" class="pw-post-body-paragraph mz na iq ll b lm nn jr nb lo no ju nc lq np ne nf ls nq nh ni lu nr nk nl lw ij bi translated">此外，<strong class="ll ir"> Redux提供了一些现成的好处</strong>。首先，使用Redux存储中的状态的组件只有在连接部分发生变化时才会重新呈现。与React上下文不同，<strong class="ll ir">由您来优化订阅React上下文</strong>的组件，例如，通过用<a class="ae ns" href="https://reactjs.org/docs/hooks-reference.html#usememo" rel="noopener ugc nofollow" target="_blank"> <em class="nm"> useMem </em> o() </a>或<a class="ae ns" href="https://reactjs.org/docs/react-api.html#reactmemo" rel="noopener ugc nofollow" target="_blank"> <em class="nm"> React.memo() </em> </a>来记忆它们。其次，Redux为<a class="ae ns" href="https://chrome.google.com/webstore/detail/redux-devtools/lmhkpmbekcpmknklioeibfkpmmfibljd?hl=en" rel="noopener ugc nofollow" target="_blank"> DevTools提供了时间旅行调试</a>，这非常有用。尽管如此，如果你使用React Context和<a class="ae ns" href="https://reactjs.org/docs/hooks-reference.html#usereducer" rel="noopener ugc nofollow" target="_blank"> <em class="nm"> useReducer </em> () </a>钩子，一个类似的项目叫做<a class="ae ns" href="https://github.com/reactrewind/react-rewind" rel="noopener ugc nofollow" target="_blank"> react-rewind </a>是可用的。</p><h2 id="ee3d" class="mn ks iq bd kt mo mp dn kx mq mr dp lb lq ms mt ld ls mu mv lf lu mw mx lh my bi translated">什么时候应该使用React上下文？</h2><p id="7e24" class="pw-post-body-paragraph mz na iq ll b lm ln jr nb lo lp ju nc lq nd ne nf ls ng nh ni lu nj nk nl lw ij bi translated">正如我之前提到的，对于不经常改变并且真正是全球性的(例如，主题、语言、地区)的<strong class="ll ir">数据，这是一个很好的选择。否则，让状态只局限于它所属的组件，或者使用Redux可能是更好的选择。</strong></p><h1 id="d830" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">如何使用React上下文:显示代码</h1><p id="4719" class="pw-post-body-paragraph mz na iq ll b lm ln jr nb lo lp ju nc lq nd ne nf ls ng nh ni lu nj nk nl lw ij bi translated">下面你可以看到一个gif图片，展示了一个简单的演示，我们将构建它来查看React上下文的运行情况。这将是一个最小的<a class="ae ns" href="https://reactjs.org/docs/create-a-new-react-app.html" rel="noopener ugc nofollow" target="_blank"><em class="nm">create-react-app</em></a>项目，有一点小小的变化——我们将用两个主题(亮和暗)使它主题化，其中当前的<strong class="ll ir">主题通过上下文</strong>共享。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nt"><img src="../Images/9da808872783703d8363671b3da16761.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*G2bYzis5MPHLbVXGt90uyg.gif"/></div></div><figcaption class="nu nv gj gh gi nw nx bd b be z dk">Themeable React app with a custom context hook</figcaption></figure><p id="b291" class="pw-post-body-paragraph mz na iq ll b lm nn jr nb lo no ju nc lq np ne nf ls nq nh ni lu nr nk nl lw ij bi translated">虽然为了简单起见，这篇文章只展示了最重要代码的要点，但是如果你想运行这个应用程序并仔细看看，你可以在GitHub上看到完整的演示:</p><div class="ny nz gp gr oa ob"><a href="https://github.com/pixochi/react-context-theme-example" rel="noopener  ugc nofollow" target="_blank"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd ir gy z fp og fr fs oh fu fw ip bi translated">GitHub-pix ochi/react-context-theme-example:一个React应用程序，展示了一个简单的例子，说明如何使用…</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">你可以在Medium上找到完整的解释。在项目目录中，您可以运行:在开发中运行应用程序…</h3></div><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">github.com</p></div></div><div class="ok l"><div class="ol l om on oo ok op kp ob"/></div></div></a></div><h2 id="2b6d" class="mn ks iq bd kt mo mp dn kx mq mr dp lb lq ms mt ld ls mu mv lf lu mw mx lh my bi translated">使用React上下文的5个步骤</h2><p id="5df7" class="pw-post-body-paragraph mz na iq ll b lm ln jr nb lo lp ju nc lq nd ne nf ls ng nh ni lu nj nk nl lw ij bi translated">下面你可以找到一个要点，它展示了在你的应用中开始使用React上下文所需的所有(最少)代码。gist中的注释更详细地解释了代码，但可以总结为<strong class="ll ir"> 5个简单的步骤</strong>:</p><ol class=""><li id="9e6b" class="lj lk iq ll b lm nn lo no lq oq ls or lu os lw lx ly lz ma bi translated">创建一个<em class="nm">上下文对象</em>(第5行)。</li><li id="c442" class="lj lk iq ll b lm mb lo mc lq md ls me lu mf lw lx ly lz ma bi translated">创建<em class="nm">一个定制钩子</em>，用于以后在其他组件中消费<em class="nm">上下文</em>的值(第8行)。</li><li id="ec26" class="lj lk iq ll b lm mb lo mc lq md ls me lu mf lw lx ly lz ma bi translated">为<em class="nm">上下文提供者</em>创建一个包装器(第12–20行)。</li><li id="aae5" class="lj lk iq ll b lm mb lo mc lq md ls me lu mf lw lx ly lz ma bi translated">用<em class="nm">上下文提供者</em>包装应用程序，这样所有组件都可以访问上下文值(第38–40行)。</li><li id="6a4b" class="lj lk iq ll b lm mb lo mc lq md ls me lu mf lw lx ly lz ma bi translated">在任何需要访问<em class="nm">上下文</em>的组件中使用<em class="nm">定制钩子</em>(第52行)。</li></ol><p id="bdc4" class="pw-post-body-paragraph mz na iq ll b lm nn jr nb lo no ju nc lq np ne nf ls nq nh ni lu nr nk nl lw ij bi translated">那么剩下唯一要做的事情就是使用上下文中的值，就像第58、64–65和71行的要点所示。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ot ou l"/></div><figcaption class="nu nv gj gh gi nw nx bd b be z dk">Code with React Context for sharing the current theme</figcaption></figure><p id="9102" class="pw-post-body-paragraph mz na iq ll b lm nn jr nb lo no ju nc lq np ne nf ls nq nh ni lu nr nk nl lw ij bi translated">现在，您可以对需要在整个应用程序中共享的任何数据使用相同的React Provider模式！🎉</p><h2 id="2467" class="mn ks iq bd kt mo mp dn kx mq mr dp lb lq ms mt ld ls mu mv lf lu mw mx lh my bi translated"><strong class="ak">如果你喜欢这篇文章，请关注我，了解更多关于React、JavaScript、TypeScript等开发的技巧:】</strong></h2><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi ov"><img src="../Images/58169394fda55f6cbde8487504ee1975.png" data-original-src="https://miro.medium.com/v2/resize:fit:620/0*eU4zeQ2g5yrfvVfB.gif"/></div></figure><h2 id="4336" class="mn ks iq bd kt mo mp dn kx mq mr dp lb lq ms mt ld ls mu mv lf lu mw mx lh my bi translated">成为会员</h2><p id="a982" class="pw-post-body-paragraph mz na iq ll b lm ln jr nb lo lp ju nc lq nd ne nf ls ng nh ni lu nj nk nl lw ij bi translated"><em class="nm">如果你喜欢看这样的故事，想支持我这个作家，</em> <a class="ae ns" href="https://jakub-kozak.medium.com/membership" rel="noopener"> <em class="nm">考虑报名成为中会员</em> </a> <em class="nm">。一个月5美元，给你</em> <strong class="ll ir"> <em class="nm">无限制访问</em> </strong> <em class="nm">媒体上的故事。如果你用我的链接</em>  <em class="nm">注册，我会赚一小笔佣金</em>🙌</p><div class="ny nz gp gr oa ob"><a href="https://jakub-kozak.medium.com/membership" rel="noopener follow" target="_blank"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd ir gy z fp og fr fs oh fu fw ip bi translated">通过我的推荐链接加入Medium雅各布·科萨克</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">阅读雅各布·科萨克(以及媒体上成千上万的其他作家)的每一个故事。您的会员费直接支持…</h3></div><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">jakub-kozak.medium.com</p></div></div><div class="ok l"><div class="ow l om on oo ok op kp ob"/></div></div></a></div></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><h2 id="36ce" class="mn ks iq bd kt mo mp dn kx mq mr dp lb lq ms mt ld ls mu mv lf lu mw mx lh my bi translated">工作机会——来加入我吧</h2><p id="355f" class="pw-post-body-paragraph mz na iq ll b lm ln jr nb lo lp ju nc lq nd ne nf ls ng nh ni lu nj nk nl lw ij bi translated">我在Tjekvik 的团队正在寻找更多的开发者！你有使用React和Ruby on Rails的经验吗？那就不要犹豫，马上在这里申请:<a class="ae ns" href="https://www.tjekvik.com/careers" rel="noopener ugc nofollow" target="_blank">https://www.tjekvik.com/careers</a>。你可以在欧洲的任何地方工作！🌍</p><div class="ny nz gp gr oa ob"><a href="https://jakub-kozak.medium.com/stop-using-for-conditional-rendering-in-react-a0f7b96200f8" rel="noopener follow" target="_blank"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd ir gy z fp og fr fs oh fu fw ip bi translated">停止在React中使用“&amp;&amp;”进行条件渲染</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">通过在React组件中不使用` &amp;&amp; '来避免错误</h3></div><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">jakub-kozak.medium.com</p></div></div><div class="ok l"><div class="ox l om on oo ok op kp ob"/></div></div></a></div><div class="ny nz gp gr oa ob"><a rel="noopener  ugc nofollow" target="_blank" href="/react-hooks-when-to-use-uselayouteffect-instead-of-useeffect-3271a96d881a"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd ir gy z fp og fr fs oh fu fw ip bi translated">React挂钩—何时使用useLayoutEffect而不是useEffect</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">useEffect和useLayoutEffect的区别——用一个真实的例子来解释。</h3></div><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="ok l"><div class="oy l om on oo ok op kp ob"/></div></div></a></div><div class="ny nz gp gr oa ob"><a href="https://medium.com/swlh/how-to-build-a-chrome-extension-with-react-typescript-and-webpack-92e806ce2e16" rel="noopener follow" target="_blank"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd ir gy z fp og fr fs oh fu fw ip bi translated">如何使用React、TypeScript和Webpack构建Chrome扩展</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">从创建样板文件到发布Chrome网络商店的完整扩展</h3></div><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">medium.com</p></div></div><div class="ok l"><div class="oz l om on oo ok op kp ob"/></div></div></a></div><div class="ny nz gp gr oa ob"><a href="https://medium.com/swlh/best-moment-js-alternatives-5dfa6861a1eb" rel="noopener follow" target="_blank"><div class="oc ab fo"><div class="od ab oe cl cj of"><h2 class="bd ir gy z fp og fr fs oh fu fw ip bi translated">最佳时刻。JS替代方案</h2><div class="oi l"><h3 class="bd b gy z fp og fr fs oh fu fw dk translated">比较大小、性能、类型脚本支持等</h3></div><div class="oj l"><p class="bd b dl z fp og fr fs oh fu fw dk translated">medium.com</p></div></div><div class="ok l"><div class="pa l om on oo ok op kp ob"/></div></div></a></div></div><div class="ab cl mg mh hu mi" role="separator"><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml mm"/><span class="mj bw bk mk ml"/></div><div class="ij ik il im in"><p id="b34a" class="pw-post-body-paragraph mz na iq ll b lm nn jr nb lo no ju nc lq np ne nf ls nq nh ni lu nr nk nl lw ij bi translated"><em class="nm">更多内容请看</em><a class="ae ns" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="ll ir"><em class="nm">plain English . io</em></strong></a><em class="nm">。报名参加我们的</em> <a class="ae ns" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ll ir"> <em class="nm">免费周报</em> </strong> </a> <em class="nm">。关注我们关于</em><a class="ae ns" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="ll ir"><em class="nm">Twitter</em></strong></a><em class="nm">和</em><a class="ae ns" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="ll ir"><em class="nm">LinkedIn</em></strong></a><em class="nm">。查看我们的</em> <a class="ae ns" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="ll ir"> <em class="nm">社区不和谐</em> </strong> </a> <em class="nm">加入我们的</em> <a class="ae ns" href="https://inplainenglish.pallet.com/talent/welcome" rel="noopener ugc nofollow" target="_blank"> <strong class="ll ir"> <em class="nm">人才集体</em> </strong> </a> <em class="nm">。</em></p></div></div>    
</body>
</html>