<html>
<head>
<title>How to Use React Functional Components with TypeScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在TypeScript中使用React功能组件</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-develop-react-functional-components-with-typescript-12c2cfbb271d?source=collection_archive---------0-----------------------#2022-08-29">https://javascript.plainenglish.io/how-to-develop-react-functional-components-with-typescript-12c2cfbb271d?source=collection_archive---------0-----------------------#2022-08-29</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="38ba" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">用TypeScript定义React功能组件的4种方法。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/abcd0f071309ff9b384ebab94a545398.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*MNSemhOQOujDJ8BPr5Tznw.jpeg"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">photo via <a class="ae ks" href="https://pixabay.com/" rel="noopener ugc nofollow" target="_blank">https://pixabay.com/</a></figcaption></figure><p id="11a5" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">当我们使用React开发项目时，使用最多的应该是组件，组件分为<strong class="kv io">功能组件</strong>和<strong class="kv io">类组件</strong>，我们可以定义如下:</p><ul class=""><li id="c15b" class="lp lq in kv b kw kx kz la lc lr lg ls lk lt lo lu lv lw lx bi translated">定义功能组件</li></ul><pre class="kd ke kf kg gt ly lz ma mb aw mc bi"><span id="ab55" class="md me in lz b gy mf mg l mh mi">function Welcome(props) {<br/>  return &lt;h1&gt;Hello, {props.name}&lt;/h1&gt;;<br/>}</span></pre><ul class=""><li id="507b" class="lp lq in kv b kw kx kz la lc lr lg ls lk lt lo lu lv lw lx bi translated">定义类组件</li></ul><pre class="kd ke kf kg gt ly lz ma mb aw mc bi"><span id="0d89" class="md me in lz b gy mf mg l mh mi">class Welcome extends React.Component {<br/>  render() {<br/>    return &lt;h1&gt;Hello, {this.props.name}&lt;/h1&gt;;<br/>  }<br/>}</span></pre><p id="e7ba" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在本文中，我将介绍使用TypeScript定义功能组件的4种方法，以及在使用过程中需要注意的几个问题。</p><p id="5ea2" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><a class="ae ks" href="#43cb" rel="noopener ugc nofollow">如何用TypeScript </a>定义功能组件<br/> ∘ <a class="ae ks" href="#0b21" rel="noopener ugc nofollow"> ⭐ 1。使用React。FC </a> <br/> ∘ <a class="ae ks" href="#f922" rel="noopener ugc nofollow"> ⭐ 2。利用JSX。元素</a> <br/> ∘ <a class="ae ks" href="#380d" rel="noopener ugc nofollow"> ⭐ 3。直接定义完整类型</a> <br/> ∘ <a class="ae ks" href="#9502" rel="noopener ugc nofollow"> ⭐ 4。使用React。props withschildren</a><br/><a class="ae ks" href="#4383" rel="noopener ugc nofollow">温馨提示</a> <br/> ∘ <a class="ae ks" href="#ac29" rel="noopener ugc nofollow">🎉 1.功能组件不能返回布尔值</a> <br/> ∘ <a class="ae ks" href="#f14c" rel="noopener ugc nofollow">🎉 2.无法使用Array.fill()填充组件</a> <br/> ∘ <a class="ae ks" href="#db25" rel="noopener ugc nofollow">🎉 3.支持通用组件</a> <br/> <a class="ae ks" href="#e5ea" rel="noopener ugc nofollow">引用</a></p></div><div class="ab cl mj mk hr ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="ig ih ii ij ik"><h1 id="43cb" class="mq me in bd mr ms mt mu mv mw mx my mz jt na ju nb jw nc jx nd jz ne ka nf ng bi translated">如何用TypeScript定义功能组件</h1><p id="a864" class="pw-post-body-paragraph kt ku in kv b kw nh jo ky kz ni jr lb lc nj le lf lg nk li lj lk nl lm ln lo ig bi translated">功能组件通常接受一个<code class="fe nm nn no lz b">props</code>参数并返回一个JSX元素或<code class="fe nm nn no lz b">null</code>。</p><p id="6e64" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">当我们需要使用TypeScript来定义一个功能组件的时候，我们有4种方式，每种方式都有自己的优缺点，具体情况而定。</p><h2 id="0b21" class="md me in bd mr np nq dn mv nr ns dp mz lc nt nu nb lg nv nw nd lk nx ny nf nz bi translated">⭐ 1.使用React。足球俱乐部</h2><p id="ecf2" class="pw-post-body-paragraph kt ku in kv b kw nh jo ky kz ni jr lb lc nj le lf lg nk li lj lk nl lm ln lo ig bi translated">由于React不是用TypeScript开发的，它使用社区开发的<code class="fe nm nn no lz b">@type/react</code>包提供的类型，该包有一个通用类型<code class="fe nm nn no lz b">FC</code>，允许我们向功能组件添加类型。</p><pre class="kd ke kf kg gt ly lz ma mb aw mc bi"><span id="fe77" class="md me in lz b gy mf mg l mh mi">type FCProps = { text: string };</span><span id="22f0" class="md me in lz b gy oa mg l mh mi">const FCComponent: React.FC&lt;FCProps&gt; = ({ text = "" }) =&gt; &lt;div&gt;{text}&lt;/div&gt;;</span></pre><p id="4633" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这里的<code class="fe nm nn no lz b">React.FC</code>是<code class="fe nm nn no lz b">React.FunctionComponent</code>的简写。</p><p id="710a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">当组件包含子元素时，TypeScript将提示警告:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ob oc l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Using React.FC</figcaption></figure><p id="ca50" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">提示警告内容:</p><pre class="kd ke kf kg gt ly lz ma mb aw mc bi"><span id="7417" class="md me in lz b gy mf mg l mh mi">Type '{ children: string; text: string; }' is not assignable to type 'IntrinsicAttributes &amp; FCProps'.<br/>  Property 'children' does not exist on type 'IntrinsicAttributes &amp; FCProps'.</span></pre><p id="4ecf" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这现在已被否决。有关具体讨论，请参见以下两个链接:</p><ul class=""><li id="450b" class="lp lq in kv b kw kx kz la lc lr lg ls lk lt lo lu lv lw lx bi translated"><a class="ae ks" href="https://github.com/facebook/create-react-app/pull/8177" rel="noopener ugc nofollow" target="_blank">清除React。来自类型脚本模板#8177 </a>的FC；</li><li id="840e" class="lp lq in kv b kw od kz oe lc of lg og lk oh lo lu lv lw lx bi translated"><a class="ae ks" href="https://fettblog.eu/typescript-react-why-i-dont-use-react-fc/" rel="noopener ugc nofollow" target="_blank"> TypeScript + React:我为什么不用React。T42舰队指挥官.</a></li></ul><h2 id="f922" class="md me in bd mr np nq dn mv nr ns dp mz lc nt nu nb lg nv nw nd lk nx ny nf nz bi translated">⭐ 2.利用JSX。元素</h2><p id="5407" class="pw-post-body-paragraph kt ku in kv b kw nh jo ky kz ni jr lb lc nj le lf lg nk li lj lk nl lm ln lo ig bi translated">使用<code class="fe nm nn no lz b">JSX.Element</code>类型作为功能组件的返回值类型。当组件的返回值不是<code class="fe nm nn no lz b">JSX.Element</code>类型时，TypeScript会提示错误。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ob oc l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Using JSX.Element</figcaption></figure><h2 id="380d" class="md me in bd mr np nq dn mv nr ns dp mz lc nt nu nb lg nv nw nd lk nx ny nf nz bi translated">⭐ 3.直接定义完整类型</h2><p id="81ea" class="pw-post-body-paragraph kt ku in kv b kw nh jo ky kz ni jr lb lc nj le lf lg nk li lj lk nl lm ln lo ig bi translated">由于<code class="fe nm nn no lz b">React</code>组件包含一个子元素，它会隐式传递一个<code class="fe nm nn no lz b">children</code>属性，导致定义的参数类型出错，所以我们可以直接定义一个完整的参数接口，包括<code class="fe nm nn no lz b">children</code>属性的类型:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ob oc l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Define the full type directly</figcaption></figure><h2 id="9502" class="md me in bd mr np nq dn mv nr ns dp mz lc nt nu nb lg nv nw nd lk nx ny nf nz bi translated">⭐ 4.使用React。有孩子的建议</h2><p id="2e78" class="pw-post-body-paragraph kt ku in kv b kw nh jo ky kz ni jr lb lc nj le lf lg nk li lj lk nl lm ln lo ig bi translated">第三种方法更麻烦，每次手工编写一个<code class="fe nm nn no lz b">children</code>属性类型，那么我们可以使用<code class="fe nm nn no lz b">React.PropsWithChildren</code>类型，它本身封装了<code class="fe nm nn no lz b">children</code>类型声明:</p><pre class="kd ke kf kg gt ly lz ma mb aw mc bi"><span id="a59d" class="md me in lz b gy mf mg l mh mi"><em class="oi">// react/index.d.ts</em><br/>type PropsWithChildren&lt;P&gt; = P &amp; { children?: ReactNode };</span></pre><p id="f6da" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">因此，使用<code class="fe nm nn no lz b">React.PropsWithChildren</code>类型来定义功能组件，而不必处理<code class="fe nm nn no lz b">children</code>的类型:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ob oc l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Using React.PropsWithChildren</figcaption></figure><h1 id="4383" class="mq me in bd mr ms oj mu mv mw ok my mz jt ol ju nb jw om jx nd jz on ka nf ng bi translated">技巧</h1><h2 id="ac29" class="md me in bd mr np nq dn mv nr ns dp mz lc nt nu nb lg nv nw nd lk nx ny nf nz bi translated">🎉 1.功能组件不能返回布尔值</h2><p id="3569" class="pw-post-body-paragraph kt ku in kv b kw nh jo ky kz ni jr lb lc nj le lf lg nk li lj lk nl lm ln lo ig bi translated">当我们在函数组件中使用条件语句时，如果React返回非JSX元素或非空值，它将抛出错误:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ob oc l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Functional Components cannot return boolean values</figcaption></figure><p id="8fc7" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">正确的做法是让功能组件返回有效的JSX元素或null:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ob oc l"/></div></figure><p id="6c77" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">当然，你不能这样写，当属性<code class="fe nm nn no lz b">useRender</code>是<code class="fe nm nn no lz b">false</code>时，它也会出错:</p><pre class="kd ke kf kg gt ly lz ma mb aw mc bi"><span id="7f46" class="md me in lz b gy mf mg l mh mi">const ConditionComponent = ({ useRender = false }) =&gt;<br/>  useRender &amp;&amp; &lt;span&gt;Render ConditionComponent&lt;/span&gt;;<em class="oi">// ❌</em></span></pre><h2 id="f14c" class="md me in bd mr np nq dn mv nr ns dp mz lc nt nu nb lg nv nw nd lk nx ny nf nz bi translated">🎉 2.无法使用Array.fill()填充组件</h2><p id="dbba" class="pw-post-body-paragraph kt ku in kv b kw nh jo ky kz ni jr lb lc nj le lf lg nk li lj lk nl lm ln lo ig bi translated">当我们的组件直接返回<code class="fe nm nn no lz b">Array.fill()</code>的结果时，TypeScript抛出错误。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ob oc l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Unable to use Array.fill() to fill components</figcaption></figure><p id="cab4" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">提示以下内容:</p><pre class="kd ke kf kg gt ly lz ma mb aw mc bi"><span id="9acc" class="md me in lz b gy mf mg l mh mi">'ArrayComponent' cannot be used as a JSX component.<br/>  Its return type 'any[]' is not a valid JSX element.<br/>    Type 'any[]' is missing the following properties from type 'ReactElement&lt;any, any&gt;': type, props, key</span></pre><p id="bd5c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">为了解决这个问题，我们可以定义函数的返回类型:</p><pre class="kd ke kf kg gt ly lz ma mb aw mc bi"><span id="f181" class="md me in lz b gy mf mg l mh mi">const ArrayComponent = () =&gt;<br/>  Array(3).fill(&lt;span&gt;Chris1993&lt;/span&gt;) as any as JSX.Element; <em class="oi">// ✅</em></span></pre><h2 id="db25" class="md me in bd mr np nq dn mv nr ns dp mz lc nt nu nb lg nv nw nd lk nx ny nf nz bi translated">🎉 3.支持通用组件</h2><p id="51b8" class="pw-post-body-paragraph kt ku in kv b kw nh jo ky kz ni jr lb lc nj le lf lg nk li lj lk nl lm ln lo ig bi translated">在使用TypeScript开发React功能组件时，还可以使用泛型来约束和声明泛型组件，这样可以使我们的组件更加灵活。</p><p id="892b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">它可以这样使用:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ob oc l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Support Generic Components</figcaption></figure><p id="ef7b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">更高级的用法在<a class="ae ks" href="https://react-typescript-cheatsheet.netlify.app/docs/advanced/patterns_by_usecase#generic-components" rel="noopener ugc nofollow" target="_blank">通用组件</a>章节中描述:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ob oc l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk"><a class="ae ks" href="https://react-typescript-cheatsheet.netlify.app/docs/advanced/patterns_by_usecase#generic-components" rel="noopener ugc nofollow" target="_blank">Generic Components</a></figcaption></figure><h1 id="e5ea" class="mq me in bd mr ms oj mu mv mw ok my mz jt ol ju nb jw om jx nd jz on ka nf ng bi translated">参考</h1><ul class=""><li id="a24a" class="lp lq in kv b kw nh kz ni lc oo lg op lk oq lo lu lv lw lx bi translated"><a class="ae ks" href="https://reactjs.org/" rel="noopener ugc nofollow" target="_blank">反应</a></li><li id="e0a3" class="lp lq in kv b kw od kz oe lc of lg og lk oh lo lu lv lw lx bi translated"><a class="ae ks" href="https://react-typescript-cheatsheet.netlify.app/" rel="noopener ugc nofollow" target="_blank"> React打字稿备忘单</a></li></ul></div><div class="ab cl mj mk hr ml" role="separator"><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo mp"/><span class="mm bw bk mn mo"/></div><div class="ig ih ii ij ik"><p id="5dc0" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="oi">更多内容请看</em><a class="ae ks" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="oi">plain English . io</em></strong></a><em class="oi">。报名参加我们的</em> <a class="ae ks" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="oi">免费周报</em> </strong> </a> <em class="oi">。关注我们关于</em><a class="ae ks" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="oi">Twitter</em></strong></a><a class="ae ks" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="oi">LinkedIn</em></strong></a><em class="oi"/><a class="ae ks" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="oi">YouTube</em></strong></a><em class="oi"/><a class="ae ks" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="oi">不和</em> </strong> </a> <em class="oi">。</em></p></div></div>    
</body>
</html>