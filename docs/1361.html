<html>
<head>
<title>How to Deploy a Parcel Build to Heroku</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何将包构建部署到Heroku</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-deploy-a-parcel-build-to-heroku-fa1ea74d2b96?source=collection_archive---------1-----------------------#2022-03-19">https://javascript.plainenglish.io/how-to-deploy-a-parcel-build-to-heroku-fa1ea74d2b96?source=collection_archive---------1-----------------------#2022-03-19</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="386c" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">关于将包构建部署到Heroku的教程。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/0d36edfc53f3f509a89cab16480ef3d5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*QSHslMroc4V7cwCz"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@cdr6934?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Chris Ried</a> on <a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="2eed" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这篇文章讲述了如何将一个<a class="ae ks" href="https://parceljs.org/" rel="noopener ugc nofollow" target="_blank">包</a>构建部署到<a class="ae ks" href="https://www.heroku.com/" rel="noopener ugc nofollow" target="_blank"> Heroku </a>。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi lp"><img src="../Images/6d50c71238341daeff9d5efc60ea59c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:906/format:webp/1*BKhUfX7VwqkFc_QeN29xlg.png"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Parcel and Heroku</figcaption></figure><h1 id="6f95" class="lq lr in bd ls lt lu lv lw lx ly lz ma jt mb ju mc jw md jx me jz mf ka mg mh bi translated">包裹</h1><p id="e856" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">假设您有一个包裹应用程序:</p><ul class=""><li id="586e" class="mn mo in kv b kw kx kz la lc mp lg mq lk mr lo ms mt mu mv bi translated">包裹-示例</li></ul><div class="mw mx gp gr my mz"><a href="https://github.com/remarkablemark/parcel-example" rel="noopener  ugc nofollow" target="_blank"><div class="na ab fo"><div class="nb ab nc cl cj nd"><h2 class="bd io gy z fp ne fr fs nf fu fw im bi translated">GitHub-remarble mark/Parcel-example:Parcel web app示例</h2><div class="ng l"><h3 class="bd b gy z fp ne fr fs nf fu fw dk translated">受教程“用Parcel构建web app”启发。克隆存储库:git克隆…</h3></div><div class="nh l"><p class="bd b dl z fp ne fr fs nf fu fw dk translated">github.com</p></div></div><div class="ni l"><div class="nj l nk nl nm ni nn km mz"/></div></div></a></div><ul class=""><li id="2664" class="mn mo in kv b kw kx kz la lc mp lg mq lk mr lo ms mt mu mv bi translated">宗地类型脚本示例</li></ul><div class="mw mx gp gr my mz"><a href="https://github.com/remarkablemark/parcel-typescript-example" rel="noopener  ugc nofollow" target="_blank"><div class="na ab fo"><div class="nb ab nc cl cj nd"><h2 class="bd io gy z fp ne fr fs nf fu fw im bi translated">GitHub-remarble mark/Parcel-TypeScript-example:Parcel TypeScript示例</h2><div class="ng l"><h3 class="bd b gy z fp ne fr fs nf fu fw dk translated">宗地类型脚本示例。克隆存储库:git克隆…</h3></div><div class="nh l"><p class="bd b dl z fp ne fr fs nf fu fw dk translated">github.com</p></div></div><div class="ni l"><div class="no l nk nl nm ni nn km mz"/></div></div></a></div><ul class=""><li id="705e" class="mn mo in kv b kw kx kz la lc mp lg mq lk mr lo ms mt mu mv bi translated">react-type script-parcel-template</li></ul><div class="mw mx gp gr my mz"><a href="https://github.com/remarkablemark/react-typescript-parcel-template" rel="noopener  ugc nofollow" target="_blank"><div class="na ab fo"><div class="nb ab nc cl cj nd"><h2 class="bd io gy z fp ne fr fs nf fu fw im bi translated">GitHub-remarkable mark/React-type script-Parcel-template:React type script Parcel模板</h2><div class="ng l"><h3 class="bd b gy z fp ne fr fs nf fu fw dk translated">React TypeScript宗地模板。克隆存储库:git克隆…</h3></div><div class="nh l"><p class="bd b dl z fp ne fr fs nf fu fw dk translated">github.com</p></div></div><div class="ni l"><div class="np l nk nl nm ni nn km mz"/></div></div></a></div><p id="6708" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在您的<code class="fe nq nr ns nt b"><a class="ae ks" href="https://docs.npmjs.com/cli/v8/configuring-npm/package-json" rel="noopener ugc nofollow" target="_blank">package.json</a></code>中，确保有一个<code class="fe nq nr ns nt b">build</code>脚本:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="5d18" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Heroku运行<code class="fe nq nr ns nt b"><a class="ae ks" href="https://devcenter.heroku.com/articles/nodejs-support#customizing-the-build-process" rel="noopener ugc nofollow" target="_blank">build</a></code>脚本，如果它在部署期间存在的话。</p><h1 id="189f" class="lq lr in bd ls lt lu lv lw lx ly lz ma jt mb ju mc jw md jx me jz mf ka mg mh bi translated">服务</h1><p id="0c9f" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">安装<a class="ae ks" href="https://www.npmjs.com/package/serve" rel="noopener ugc nofollow" target="_blank">伺服</a>为静态站点服务；</p><pre class="kd ke kf kg gt nw nt nx ny aw nz bi"><span id="b0dc" class="oa lr in nt b gy ob oc l od oe">npm install serve</span></pre><p id="4fa4" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在<code class="fe nq nr ns nt b">package.json</code>中创建一个<a class="ae ks" href="https://devcenter.heroku.com/articles/deploying-nodejs#specifying-a-start-script" rel="noopener ugc nofollow" target="_blank">启动脚本</a>:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="1409" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">或者创建一个<a class="ae ks" href="https://devcenter.heroku.com/articles/procfile" rel="noopener ugc nofollow" target="_blank"> Procfile </a>来服务您的项目目录:</p><pre class="kd ke kf kg gt nw nt nx ny aw nz bi"><span id="f0e7" class="oa lr in nt b gy ob oc l od oe">echo 'web: npx serve' &gt; Procfile</span></pre><blockquote class="of og oh"><p id="21c2" class="kt ku oi kv b kw kx jo ky kz la jr lb oj ld le lf ok lh li lj ol ll lm ln lo ig bi translated">Heroku通过查找Procfile或启动脚本来确定如何启动您的应用程序。</p></blockquote><p id="44d0" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">然后创建<a class="ae ks" href="https://github.com/vercel/serve-handler#options" rel="noopener ugc nofollow" target="_blank"> serve.json </a>以便静态站点和路由被正确服务:</p><pre class="kd ke kf kg gt nw nt nx ny aw nz bi"><span id="929c" class="oa lr in nt b gy ob oc l od oe">touch serve.json</span></pre><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="4429" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">提交并推送您的存储库。</p><h1 id="3e19" class="lq lr in bd ls lt lu lv lw lx ly lz ma jt mb ju mc jw md jx me jz mf ka mg mh bi translated">反对</h1><p id="aa76" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">按顺序添加<a class="ae ks" href="https://devcenter.heroku.com/articles/buildpacks" rel="noopener ugc nofollow" target="_blank"> Heroku buildpacks </a>:</p><ol class=""><li id="f608" class="mn mo in kv b kw kx kz la lc mp lg mq lk mr lo om mt mu mv bi translated"><a class="ae ks" href="https://elements.heroku.com/buildpacks/heroku/heroku-buildpack-nodejs" rel="noopener ugc nofollow" target="_blank"> heroku/nodejs </a></li><li id="40bf" class="mn mo in kv b kw on kz oo lc op lg oq lk or lo om mt mu mv bi translated"><a class="ae ks" href="https://elements.heroku.com/buildpacks/heroku/heroku-buildpack-static" rel="noopener ugc nofollow" target="_blank">heroku-build pack-static</a>(<a class="ae ks" href="https://github.com/heroku/heroku-buildpack-static#warning-heroku-buildpack-static-is-deprecated" rel="noopener ugc nofollow" target="_blank">弃用</a>)</li></ol><p id="4db6" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Node.js buildpack必须在static buildpack之前，因为必须先构建站点，然后才能提供服务。</p><p id="38db" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">可以通过Heroku CLI添加构建包:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="494c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">将<code class="fe nq nr ns nt b">&lt;MY_APP_NAME&gt;</code>替换为您的Heroku应用名称。</p><p id="78a0" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">也可以加上<code class="fe nq nr ns nt b"><a class="ae ks" href="https://devcenter.heroku.com/articles/app-json-schema#buildpacks" rel="noopener ugc nofollow" target="_blank">app.json</a></code>:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="280c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">创造一个<code class="fe nq nr ns nt b"><a class="ae ks" href="https://github.com/heroku/heroku-buildpack-static#deploying" rel="noopener ugc nofollow" target="_blank">static.json</a></code>:</p><pre class="kd ke kf kg gt nw nt nx ny aw nz bi"><span id="8578" class="oa lr in nt b gy ob oc l od oe">touch static.json</span></pre><p id="d160" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">并且<a class="ae ks" href="https://github.com/heroku/heroku-buildpack-static#configuration" rel="noopener ugc nofollow" target="_blank">为您的静态应用程序配置</a>选项:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nu nv l"/></div></figure><p id="b546" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">推送部署Heroku app。构建日志应该如下所示:</p><pre class="kd ke kf kg gt nw nt nx ny aw nz bi"><span id="3407" class="oa lr in nt b gy ob oc l od oe">-----&gt; Building on the Heroku-20 stack<br/>-----&gt; Using buildpacks:<br/>       1. heroku/nodejs<br/>       2. https://github.com/heroku/heroku-buildpack-static<br/>-----&gt; Node.js app detected<br/>-----&gt; Creating runtime environment<br/>-----&gt; Installing binaries<br/>-----&gt; Restoring cache<br/>-----&gt; Installing dependencies<br/>-----&gt; Build<br/>-----&gt; Pruning devDependencies<br/>-----&gt; Caching build<br/>-----&gt; Build succeeded!<br/>-----&gt; Static HTML app detected<br/>-----&gt; Installed nginx 1.19.0 to /app/bin<br/>-----&gt; Discovering process types<br/>       Procfile declares types     -&gt; (none)<br/>       Default types for buildpack -&gt; web<br/>-----&gt; Compressing...<br/>-----&gt; Launching...<br/>       Released v1<br/>       https://myappname.herokuapp.com/ deployed to Heroku</span></pre><p id="a5ec" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">由于Heroku会自动为您的静态应用程序创建一个dyno，因此无需使用<a class="ae ks" href="https://devcenter.heroku.com/articles/procfile" rel="noopener ugc nofollow" target="_blank"> Procfile </a>:</p><pre class="kd ke kf kg gt nw nt nx ny aw nz bi"><span id="df66" class="oa lr in nt b gy ob oc l od oe">web bin/boot</span></pre></div><div class="ab cl os ot hr ou" role="separator"><span class="ov bw bk ow ox oy"/><span class="ov bw bk ow ox oy"/><span class="ov bw bk ow ox"/></div><div class="ig ih ii ij ik"><p id="809a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="oi">本文原载于2022年3月16日</em><a class="ae ks" href="https://remarkablemark.org/blog/2022/03/16/deploy-parcel-build-to-heroku/" rel="noopener ugc nofollow" target="_blank"><em class="oi">remarkablemark.org</em></a><em class="oi">。</em></p><p id="8558" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="oi">更多内容看</em> <a class="ae ks" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="oi">说白了就是</em> </strong> </a> <em class="oi">。报名参加我们的</em> <a class="ae ks" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="oi">免费每周简讯</em> </strong> </a> <em class="oi">。关注我们</em> <a class="ae ks" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="oi">推特</em> </strong> </a> <em class="oi">和</em><strong class="kv io"><em class="oi"/></strong><a class="ae ks" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="oi">LinkedIn</em></strong></a><em class="oi">。加入我们的</em> <a class="ae ks" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="oi">社区不和谐</em> </strong> </a> <em class="oi">。</em></p></div></div>    
</body>
</html>