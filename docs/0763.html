<html>
<head>
<title>Lambda to Scrape Data Using TypeScript &amp; Serverless</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Lambda使用TypeScript &amp; Serverless抓取数据</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/lambda-to-scrape-data-using-typescript-serverless-75768fa417b9?source=collection_archive---------2-----------------------#2022-02-12">https://javascript.plainenglish.io/lambda-to-scrape-data-using-typescript-serverless-75768fa417b9?source=collection_archive---------2-----------------------#2022-02-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="a38d" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何使用TypeScript &amp; Serverless抓取数据的指南。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/d987593982cdd2b1bbe4c593d3348ac6.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LALluk_JYd1iY29sm-fX6w.png"/></div></div></figure><p id="faa3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在这篇博文中，我们将做以下事情:</p><ul class=""><li id="8bd1" class="ln lo iq kt b ku kv kx ky la lp le lq li lr lm ls lt lu lv bi translated">在Node.js/TypeScript中编写一个Lambda函数，从一个网站中提取以下数据集</li><li id="0cd8" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated">页面的标题</li><li id="c4c5" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated">页面上的任何图像</li><li id="b328" class="ln lo iq kt b ku lw kx lx la ly le lz li ma lm ls lt lu lv bi translated">将提取的数据存储在自动气象站的S3上</li></ul><p id="39e9" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我们将在这个项目中使用以下Node.js包:</p><p id="0558" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">-【无服务器】(<a class="ae mb" href="https://www.npmjs.com/package/serverless" rel="noopener ugc nofollow" target="_blank">https://www.npmjs.com/package/serverless</a>)(这个必须全局安装):这将帮助我们编写&amp;部署Lambda函数<br/>-【cheerio】(<a class="ae mb" href="https://www.npmjs.com/package/cheerio" rel="noopener ugc nofollow" target="_blank">https://www.npmjs.com/package/cheerio</a>):这将帮助我们将网页内容解析成jQuery对象<br/>-【Axios】(<a class="ae mb" href="https://www.npmjs.com/package/axios" rel="noopener ugc nofollow" target="_blank">https://www.npmjs.com/package/axios</a>):基于承诺的HTTP客户端，用于浏览器和node . js<br/>-【exceljs】(<a class="ae mb" href="https://www.npmjs.com/package/exceljs" rel="noopener ugc nofollow" target="_blank">https://www.npmjs.com/package/exceljs</a>):读取、操作和编写电子表格【T11</p><p id="977a" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">步骤1:全局安装无服务器</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="fe16" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">步骤2:从无服务器模板库中创建一个新的基于TypeScript的项目，如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="7fdf" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">步骤3:安装Lambda项目所需的节点包:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="b0db" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">步骤4:将“无服务器-脱机”添加到无服务器. ts中的插件列表:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="ece1" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">步骤5:在serverless.ts的环境变量中添加S3存储桶名称，如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="ffd4" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">步骤6:在serverless.ts文件中定义函数，如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="b286" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">步骤7:在handler.ts文件中定义您的函数来执行以下操作:</p><p id="abdd" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">-接收URL以从查询字符串中抓取数据<br/> -使用Axios向URL发出get请求<br/> -使用cheerio解析响应数据<br/> -从解析的响应对象中提取数据并将其存储在JSON文件中，并将所有图像URL存储在excel文件中<br/> -将提取的数据上传到S3</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="a27d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">步骤8:在您的环境中设置您的aws访问密钥和aws秘密密钥，如下所示:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="fb91" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">第9步:你现在已经准备好在你的机器上运行这个函数了，就像这样“sls离线stage local”。</p><p id="edc8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在你应该可以像这样从你的机器访问你的函数<a class="ae mb" href="http://localhost:3000/local/scrapeContent?url=ANY_URL_YOU_WISH_TO_SCRAPE`" rel="noopener ugc nofollow" target="_blank"><em class="me">http://localhost:3000/local/scrapeContenturl = ANY _ URL _ YOU _ WISH _ TO _ SCRAPE</em></a></p><p id="2ff5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">步骤10:如果你想在你的AWS账户上部署这个lambda函数，你可以这样做:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mc md l"/></div></figure><p id="5014" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">您可以从这里查看这个Lambda函数:</p><div class="mf mg gp gr mh mi"><a href="https://github.com/appletreeat56/scrape-content" rel="noopener  ugc nofollow" target="_blank"><div class="mj ab fo"><div class="mk ab ml cl cj mm"><h2 class="bd ir gy z fp mn fr fs mo fu fw ip bi translated">GitHub-apple treeat 56/scrape-content:这个存储库将从给定的URL中抓取内容</h2><div class="mp l"><h3 class="bd b gy z fp mn fr fs mo fu fw dk translated">这是一个用无服务器框架(https://www.serverless.com/)写的lambda函数。</h3></div><div class="mq l"><p class="bd b dl z fp mn fr fs mo fu fw dk translated">github.com</p></div></div><div class="mr l"><div class="ms l mt mu mv mr mw kp mi"/></div></div></a></div></div><div class="ab cl mx my hu mz" role="separator"><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc nd"/><span class="na bw bk nb nc"/></div><div class="ij ik il im in"><p id="6fd2" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">感谢您的阅读，如果您想支持我，请关注我，成为会员，支持更广泛的社区。</p><div class="mf mg gp gr mh mi"><a href="https://medium.com/@metacollective/membership" rel="noopener follow" target="_blank"><div class="mj ab fo"><div class="mk ab ml cl cj mm"><h2 class="bd ir gy z fp mn fr fs mo fu fw ip bi translated">通过我的推荐链接加入媒体Meta Collective</h2><div class="mp l"><h3 class="bd b gy z fp mn fr fs mo fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="mq l"><p class="bd b dl z fp mn fr fs mo fu fw dk translated">medium.com</p></div></div><div class="mr l"><div class="ne l mt mu mv mr mw kp mi"/></div></div></a></div><p id="9244" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><em class="me">更多内容请看</em><a class="ae mb" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kt ir"><em class="me">plain English . io</em></strong></a><em class="me">。报名参加我们的</em><strong class="kt ir"><em class="me"/></strong><a class="ae mb" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kt ir"><em class="me">免费周报</em> </strong> </a> <em class="me">。在我们的</em> <a class="ae mb" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir"> <em class="me">社区获得独家访问写作机会和建议</em> </strong> </a> <em class="me">。</em></p></div></div>    
</body>
</html>