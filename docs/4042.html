<html>
<head>
<title>Global Error and Response Handler in Node.js with Express and TypeScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带有Express和TypeScript的Node.js中的全局错误和响应处理程序</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/global-error-and-response-handler-in-node-js-with-express-and-typescript-913ec06d74b3?source=collection_archive---------1-----------------------#2022-10-20">https://javascript.plainenglish.io/global-error-and-response-handler-in-node-js-with-express-and-typescript-913ec06d74b3?source=collection_archive---------1-----------------------#2022-10-20</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="d72b" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">本指南将帮助您向Node.js应用程序添加全局错误和成功响应处理程序。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/c4761ebf645f967a6a5135e9e92f4363.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*2X_mH52Cwj4tdt4c"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/ja/@introspectivedsgn?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Erik Mclean</a> on <a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="8eee" class="kt ku in bd kv kw kx ky kz la lb lc ld jt le ju lf jw lg jx lh jz li ka lj lk bi translated">介绍</h1><p id="6b14" class="pw-post-body-paragraph ll lm in ln b lo lp jo lq lr ls jr lt lu lv lw lx ly lz ma mb mc md me mf mg ig bi translated">众所周知，JavaScript支持异常的概念。JavaScript可以在try-catch块中“抛出”和“捕获”异常，就像大多数具有异常处理功能的传统语言一样，比如Java和C++。</p><pre class="kd ke kf kg gt mh mi mj mk aw ml bi"><span id="8df0" class="mm ku in mi b gy mn mo l mp mq">try {     <br/>    // handle business logic here<br/>    // throw exception from here if any<br/>} catch(exception) {<br/>  // catch &amp; handle exception here<br/>}</span></pre><p id="b4fa" class="pw-post-body-paragraph ll lm in ln b lo mr jo lq lr ms jr lt lu mt lw lx ly mu ma mb mc mv me mf mg ig bi translated">但是正如我们都知道的，我们的代码包含了大量的try-and-catch块，我们无意中编写了单独的代码来处理相同或不同类型的错误。此外，在Node.js中，我们正在为每个控制器方法编写代码，以发送成功或失败响应。</p><p id="a3aa" class="pw-post-body-paragraph ll lm in ln b lo mr jo lq lr ms jr lt lu mt lw lx ly mu ma mb mc mv me mf mg ig bi translated">为了解决这类问题，我们需要一个单一的、集中的方法来处理各种情况。</p><p id="4507" class="pw-post-body-paragraph ll lm in ln b lo mr jo lq lr ms jr lt lu mt lw lx ly mu ma mb mc mv me mf mg ig bi translated">请在下面找到没有集中机制来处理错误和成功响应的问题列表</p><ol class=""><li id="7243" class="mw mx in ln b lo mr lr ms lu my ly mz mc na mg nb nc nd ne bi translated">代码重复</li><li id="ad56" class="mw mx in ln b lo nf lr ng lu nh ly ni mc nj mg nb nc nd ne bi translated">向现有代码添加额外功能的挑战(例如加密/解密)</li><li id="3006" class="mw mx in ln b lo nf lr ng lu nh ly ni mc nj mg nb nc nd ne bi translated">没有共同的模式、行为和反应</li></ol><h1 id="6229" class="kt ku in bd kv kw kx ky kz la lb lc ld jt le ju lf jw lg jx lh jz li ka lj lk bi translated">履行</h1><p id="338f" class="pw-post-body-paragraph ll lm in ln b lo lp jo lq lr ls jr lt lu lv lw lx ly lz ma mb mc md me mf mg ig bi translated">如果您正在寻找一个现成的、轻量级的、具有必要特性的样板文件，请查看我的below资源库，许多开发人员已经在使用它了。</p><div class="nk nl gp gr nm nn"><a href="https://github.com/santoshshinde2012/node-boilerplate" rel="noopener  ugc nofollow" target="_blank"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd io gy z fp ns fr fs nt fu fw im bi translated">GitHub-Santosh shinde 2012/Node-Boilerplate:用于微服务的节点类型脚本样板…</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">微服务的节点类型脚本样板。用TypeScript编写的Node.js应用程序的框架(带有安装说明…</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">github.com</p></div></div><div class="nw l"><div class="nx l ny nz oa nw ob km nn"/></div></div></a></div><h2 id="21c6" class="mm ku in bd kv oc od dn kz oe of dp ld lu og oh lf ly oi oj lh mc ok ol lj om bi translated"><strong class="ak"> 1。全局错误处理器</strong></h2><p id="db28" class="pw-post-body-paragraph ll lm in ln b lo lp jo lq lr ls jr lt lu lv lw lx ly lz ma mb mc md me mf mg ig bi translated">我们将使用Node.js中间件在一个地方捕获错误。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi on"><img src="../Images/ed97344fa9b5775eec3e06f7be58a8c5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*RK0AmiHlRKYybkN7zvVsRw.jpeg"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Global Error Handler</figcaption></figure><p id="d9d9" class="pw-post-body-paragraph ll lm in ln b lo mr jo lq lr ms jr lt lu mt lw lx ly mu ma mb mc mv me mf mg ig bi translated"><strong class="ln io">步骤1 —创建快速应用</strong></p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oo"><img src="../Images/6d28d742eb5193ff856bd8db7b848818.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xm3IaqeWPRdj32RbM6IysQ.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Create the express application</figcaption></figure><p id="19de" class="pw-post-body-paragraph ll lm in ln b lo mr jo lq lr ms jr lt lu mt lw lx ly mu ma mb mc mv me mf mg ig bi translated"><strong class="ln io">第二步——创建并添加错误处理中间件及其实现</strong></p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi op"><img src="../Images/d7359a098d5fe29dd95f44f197d81733.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*aiqGy5mSuCmJ4G-LwVxO3w.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">error handler middleware</figcaption></figure><p id="bbf5" class="pw-post-body-paragraph ll lm in ln b lo mr jo lq lr ms jr lt lu mt lw lx ly mu ma mb mc mv me mf mg ig bi translated"><strong class="ln io">步骤3——从应用程序中抛出错误来测试我们的代码</strong></p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oq"><img src="../Images/4df441c8caa37ae528c03e865ee8d824.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uHQz8Ax_tlwkjhtUAehCDA.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Throw Error</figcaption></figure><h2 id="a532" class="mm ku in bd kv oc od dn kz oe of dp ld lu og oh lf ly oi oj lh mc ok ol lj om bi translated">2.全局成功响应处理程序</h2><p id="3f06" class="pw-post-body-paragraph ll lm in ln b lo lp jo lq lr ls jr lt lu lv lw lx ly lz ma mb mc md me mf mg ig bi translated">我们将创建一个带有响应处理程序实现的基类，并在API实现的派生express控制器类中调用它。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi or"><img src="../Images/4151933dcf51233da907a286cc3b2953.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*kwHMrxlAj-zvLyGqBK5YsQ.jpeg"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Success Response Handler</figcaption></figure><p id="4e82" class="pw-post-body-paragraph ll lm in ln b lo mr jo lq lr ms jr lt lu mt lw lx ly mu ma mb mc mv me mf mg ig bi translated"><strong class="ln io">步骤1 —创建基类</strong></p><p id="d08d" class="pw-post-body-paragraph ll lm in ln b lo mr jo lq lr ms jr lt lu mt lw lx ly mu ma mb mc mv me mf mg ig bi translated">我们将定义一个抽象方法来为每个控制器注册路由，并定义一个公共发送方法及其在该类中的实现。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi os"><img src="../Images/c20bc5a6ba00d2bf06a77abe6fdfef2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*zonB5uFxhbHU7NlrSDXe9A.png"/></div></div></figure><p id="e2d1" class="pw-post-body-paragraph ll lm in ln b lo mr jo lq lr ms jr lt lu mt lw lx ly mu ma mb mc mv me mf mg ig bi translated"><strong class="ln io">步骤2 —从控制器类</strong>中派生出BaseApi类</p><pre class="kd ke kf kg gt mh mi mj mk aw ml bi"><span id="c295" class="mm ku in mi b gy mn mo l mp mq">export default class SystemStatusController extends BaseApi {}</span></pre><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ot"><img src="../Images/b1d9d9cd8e10eea1b6bed388ea8d64d3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tqb3INmmghqKFXN_3Ey-Jg.png"/></div></div></figure><p id="09fb" class="pw-post-body-paragraph ll lm in ln b lo mr jo lq lr ms jr lt lu mt lw lx ly mu ma mb mc mv me mf mg ig bi translated"><strong class="ln io">步骤3—使用super关键字调用基类send方法</strong></p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ou"><img src="../Images/5a6733482a78899b796d74e53cc4c1a3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*wvZpaBrZ36AW4f0y5n_qUQ.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Call base class send method using super keyword</figcaption></figure><h1 id="202e" class="kt ku in bd kv kw kx ky kz la lb lc ld jt le ju lf jw lg jx lh jz li ka lj lk bi translated">参考</h1><div class="nk nl gp gr nm nn"><a href="https://github.com/santoshshinde2012/node-boilerplate" rel="noopener  ugc nofollow" target="_blank"><div class="no ab fo"><div class="np ab nq cl cj nr"><h2 class="bd io gy z fp ns fr fs nt fu fw im bi translated">GitHub-Santosh shinde 2012/Node-Boilerplate:用于微服务的节点类型脚本样板…</h2><div class="nu l"><h3 class="bd b gy z fp ns fr fs nt fu fw dk translated">微服务的节点类型脚本样板。用TypeScript编写的Node.js应用程序的框架(带有安装说明…</h3></div><div class="nv l"><p class="bd b dl z fp ns fr fs nt fu fw dk translated">github.com</p></div></div><div class="nw l"><div class="ov l ny nz oa nw ob km nn"/></div></div></a></div><p id="8cb0" class="pw-post-body-paragraph ll lm in ln b lo mr jo lq lr ms jr lt lu mt lw lx ly mu ma mb mc mv me mf mg ig bi translated">感谢阅读，请分享你的评论，如果这个博客增加了你的学习价值，请鼓掌。</p><p id="66be" class="pw-post-body-paragraph ll lm in ln b lo mr jo lq lr ms jr lt lu mt lw lx ly mu ma mb mc mv me mf mg ig bi translated"><em class="ow">关注我上</em> <a class="ae ks" href="https://twitter.com/shindesan2012" rel="noopener ugc nofollow" target="_blank"> <strong class="ln io"> <em class="ow">推特</em> </strong> </a> <em class="ow">和</em><a class="ae ks" href="https://www.linkedin.com/in/shindesantosh/" rel="noopener ugc nofollow" target="_blank"><strong class="ln io"><em class="ow">LinkedIn</em></strong></a><em class="ow">。</em></p></div><div class="ab cl ox oy hr oz" role="separator"><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc pd"/><span class="pa bw bk pb pc"/></div><div class="ig ih ii ij ik"><p id="e527" class="pw-post-body-paragraph ll lm in ln b lo mr jo lq lr ms jr lt lu mt lw lx ly mu ma mb mc mv me mf mg ig bi translated"><em class="ow">更多内容看</em> <a class="ae ks" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ln io"> <em class="ow">说白了。报名参加我们的</em> <a class="ae ks" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ln io"> <em class="ow">免费每周简讯</em> </strong> </a> <em class="ow">。关注我们关于</em> <a class="ae ks" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"> <strong class="ln io"> <em class="ow">推特</em> </strong> </a>，<a class="ae ks" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="ln io"><em class="ow">LinkedIn</em></strong></a><em class="ow">，</em><a class="ae ks" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"><strong class="ln io"><em class="ow">YouTube</em></strong></a><em class="ow">，</em> <a class="ae ks" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="ln io"> <em class="ow">不和</em> </strong> </a> <em class="ow">。对增长黑客感兴趣？检查出</em> <a class="ae ks" href="https://circuit.ooo/" rel="noopener ugc nofollow" target="_blank"> <strong class="ln io"> <em class="ow">电路</em> </strong> </a> <em class="ow">。</em></strong></a></p></div></div>    
</body>
</html>