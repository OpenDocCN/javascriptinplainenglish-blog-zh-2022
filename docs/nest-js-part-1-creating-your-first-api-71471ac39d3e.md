# NestJS #1:åˆ›å»ºæ‚¨çš„ç¬¬ä¸€ä¸ª API

> åŸæ–‡ï¼š<https://javascript.plainenglish.io/nest-js-part-1-creating-your-first-api-71471ac39d3e?source=collection_archive---------4----------------------->

![](img/d2b6fa62684d2afcce32eb8b6ff0dcad.png)

NestJS Tutorial #1: Create Your First API

> æœ€åˆå‘å¸ƒäºâ€”https://www . nandhakumar . io/post/nest-js-tutorial-1-create-your-first-API

ä½ å¥½ã€‚ğŸ‘‹

ä¸ Nest åˆä½œå·²ç»æœ‰å‡ ä¸ªæœˆäº†ã€‚JS æˆ‘å–œæ¬¢è¿™ä¸ªæ¡†æ¶å¼€å‘å¯ä¼¸ç¼©çš„æœåŠ¡å™¨ç«¯åº”ç”¨çš„æ–¹å¼

æˆ‘ä»åœ¨åŠªåŠ›å­¦ä¹ æ›´å¤šå…³äº Nest çš„çŸ¥è¯†ã€‚JSï¼Œæ‰€ä»¥æƒ³åˆ°äº†ä»¥æ•™ç¨‹ç³»åˆ—çš„å½¢å¼åˆ†äº«æˆ‘ä»åˆçº§åˆ°é«˜çº§çš„å­¦ä¹ ã€‚

[è·Ÿæˆ‘æ¥](https://medium.com/@nandhakumar.io)ä¼šæ”¶åˆ°è¿™ä¸ªç³»åˆ—æ‰€æœ‰å³å°†å‘å¸ƒçš„å¸–å­çš„é€šçŸ¥ã€‚

æˆ‘ä»¬ç°åœ¨å°±å¼€å§‹å§ï¼ğŸš€

# å…ˆå†³æ¡ä»¶

*   [Javascript](https://developer.mozilla.org/en-US/docs/Web/JavaScript)
*   [æ‰“å­—ç¨¿](https://www.typescriptlang.org/)(å¯é€‰)
*   å“å‘€çš„åŸºç¡€
*   [é‚®é€’å‘˜](https://www.postman.com/)(ç”¨äº API æµ‹è¯•)
*   [ä»£ç ç¼–è¾‘å™¨](https://code.visualstudio.com/)
*   [èŠ‚ç‚¹ã€‚JS](https://nodejs.org/en/)

# ä»€ä¹ˆæ˜¯çªã€‚JSï¼Ÿ

å·¢ã€‚JS æ˜¯ä¸€ä¸ªæ„å»ºé«˜åº¦å¯ä¼¸ç¼©èŠ‚ç‚¹çš„æ¡†æ¶ã€‚JS æœåŠ¡å™¨ç«¯åº”ç”¨ã€‚å®ƒå®Œå…¨æ”¯æŒ typescript(å®ƒä¹Ÿå…è®¸æˆ‘ä»¬ç”¨çº¯ JS æ„å»ºåº”ç”¨ç¨‹åº)ã€‚

å®ƒç»“åˆäº† OOP(é¢å‘å¯¹è±¡ç¼–ç¨‹)å’Œå‡½æ•°å¼ç¼–ç¨‹æ¥ç¼–å†™å¹²å‡€å’Œå¯é‡ç”¨çš„ä»£ç ã€‚

å¦‚æœæ‚¨æ›¾ç»æ„å»ºè¿‡æœåŠ¡å™¨ç«¯åº”ç”¨ç¨‹åºï¼Œæ‚¨åº”è¯¥å¬è¯´è¿‡ [Expressã€‚JS](https://expressjs.com/) å’Œ [Fastify](https://www.fastify.io/) åº“ã€‚

å¼•æ“ç›–ä¸‹ï¼Œçªã€‚JS ç”¨çš„æ˜¯å¿«é€’ã€‚JS ä½œä¸ºå®ƒçš„é»˜è®¤ HTTP æœåŠ¡å™¨ã€‚å¦‚æœä½ æ›´å–œæ¬¢ä½¿ç”¨ Fastifyï¼Œä½ å¯ä»¥å¾ˆå®¹æ˜“åœ°åˆ‡æ¢[(æ›´å¤šå…³äºè¿™ä¸ªçš„å®˜æ–¹æ–‡æ¡£)](https://docs.nestjs.com/first-steps)

è¿™æ˜¯å…³äº Nest çš„ç®€çŸ­ä»‹ç»ã€‚å°„æµç ”ç©¶â€¦

# ç”Ÿæˆå·¢ã€‚JS é¡¹ç›®

åœ¨ç”Ÿæˆé¡¹ç›®ä¹‹å‰ï¼Œç¡®ä¿æ‚¨å·²ç»å®‰è£…äº†æœ€æ–°ç‰ˆæœ¬çš„ Nodeã€‚æ‚¨ç³»ç»Ÿä¸Šçš„ JS

æˆ‘åœ¨ç”¨ Nodeã€‚JS ç‰ˆæœ¬`v18.12.1`

æ¥ç­‘å·¢ã€‚JS é¡¹ç›®é¦–å…ˆï¼Œä½ éœ€è¦å®‰è£… [Nest Cli](https://docs.nestjs.com/cli/overview)

```
npm i -g @nestjs/cli
```

ç°åœ¨ç”Ÿæˆä¸€ä¸ªæ–°çš„å·¢ã€‚JS é¡¹ç›®

```
nest new [your project name]
```

å®ƒä¼šè¦æ±‚ï¼Œ

*   ç”¨å“ªä¸ªåŒ…ç»ç†( [npm](https://www.npmjs.com/) ï¼Œ[çº±](https://yarnpkg.com/)ï¼Œ [pnpm](https://pnpm.io/) )å‘¢ï¼Ÿ(æˆ‘é€‰çº±ï¼Œä½ å¯ä»¥éšå¿ƒé€‰)

ç°åœ¨åœ¨ä»£ç ç¼–è¾‘å™¨ä¸­æ‰“å¼€é¡¹ç›®

# ç†è§£ Nestã€‚JS é¡¹ç›®ç»“æ„

![](img/10616d7da0f596f317bb203376383712.png)

*   **node_modules** â€”åŒ…å«é¡¹ç›®æ‰€éœ€çš„æ‰€æœ‰åº“ã€‚
*   **src** â€”åŒ…å«æ‚¨çš„åº”ç”¨ç¨‹åºæºä»£ç ï¼Œåœ¨è¿™ä¸ªç›®å½•åµŒå¥—ä¸‹ã€‚JS å·²ç»ç”Ÿæˆäº†ä¸€ä¸ªå¯åŠ¨ä»£ç ã€‚è®©æˆ‘ä»¬æ¢ç´¢å®ƒä»¬æ˜¯ä»€ä¹ˆï¼Œ
*   **app.controller.spec.ts** â€”åŒ…å«æ¯ä¸ªæ§åˆ¶å™¨å®ç°çš„å•å…ƒæµ‹è¯•ç”¨ä¾‹
*   **app.controller.ts** â€”åŒ…å« [API](https://en.wikipedia.org/wiki/API) çš„å®ç°
*   **app.service.ts** â€”åŒ…å«å°†åœ¨æ§åˆ¶å™¨ä¸­ä½¿ç”¨çš„ä¸šåŠ¡é€»è¾‘
*   **app.module.ts** â€”åŒ…å«å¯¼å…¥ã€å¯¼å‡ºå’Œ DI(ä¾èµ–æ³¨å…¥)ã€‚ç¨åå°†è¯¦ç»†ä»‹ç»è¿™ä¸€ç‚¹â€¦
*   **main.ts** â€”åŒ…å«å¼•å¯¼åº”ç”¨ç¨‹åºçš„å®ç°ã€‚è¿™æ˜¯æ‚¨çš„åº”ç”¨ç¨‹åºçš„èµ·ç‚¹
*   **æµ‹è¯•** â€”åŒ…å« E2E æµ‹è¯•ç”¨ä¾‹å®ç°
*   **.eslintrc.js** â€”åŒ…å« lint é…ç½®ï¼Œæœ‰åŠ©äºè¯†åˆ«ä¸æ­£ç¡®çš„è¯­æ³•ã€ç±»å‹è„šæœ¬æ ‡å‡†ç­‰â€¦
*   **ã€‚gitignore** â€”åŒ…å«å°†ä»£ç æ¨é€åˆ° GitHub æ—¶è¦å¿½ç•¥çš„æ–‡ä»¶&ç›®å½•
*   **ã€‚prettierrc** â€”åŒ…å«æ›´æ¼‚äº®çš„é…ç½®æ¥æ ¼å¼åŒ–ä½ çš„ä»£ç 
*   **nest-cli.json** â€”åŸºç¡€åµŒå¥—ã€‚JS é…ç½®
*   **package.json** â€”åŒ…å«é¡¹ç›®æ‰€éœ€çš„ä¾èµ–é¡¹ã€è„šæœ¬ã€é¡¹ç›®ç‰ˆæœ¬ç­‰
*   README.md â€”åŒ…å«æ‚¨é¡¹ç›®çš„æ–‡æ¡£
*   **tsconfig.json** â€”åŒ…å«ç±»å‹è„šæœ¬é…ç½®

# å¯¹ API çš„åŸºæœ¬ç†è§£(å¦‚æœä½ çŸ¥é“ä»€ä¹ˆæ˜¯ APIï¼Œä½ å¯ä»¥è·³è¿‡è¿™ä¸€èŠ‚)

å¦‚æœä½ æ˜¯ä¸€ä¸ªå®Œå…¨çš„ API å¼€å‘åˆå­¦è€…ã€‚

ç®€å•æ¥è¯´ï¼Œ
å‡è®¾ä½ æœ‰ä¸€å—å¸ƒæ–™åŸæ–™ï¼Œä½ æƒ³æŠŠå®ƒç¼å¥½ã€‚

æ‰€ä»¥ä½ ä¼šå»æ‰¾ä¸€ä¸ªè£ç¼ï¼ŒæŠŠä½ çš„è¡£æœæ‹¿å»ç¼ã€‚ä½ ä¹Ÿå°†ç»™å‡ºä¸€äº›å…³äºè®¾è®¡åº”è¯¥å¦‚ä½•çš„æŒ‡ç¤ºã€‚

è€ƒè™‘åˆ°ä¸Šé¢çš„ä¾‹å­ï¼Œåœ¨è®¡ç®—æœºä¸–ç•Œä¸­ï¼Œå‰ç«¯åº”ç”¨ç¨‹åº(å…·æœ‰ç”¨æˆ·ç•Œé¢çš„åº”ç”¨ç¨‹åº)å°†å‘æœåŠ¡å™¨(è£ç¼)è¯·æ±‚å¸¦æœ‰ä¸€äº›å‚æ•°(å¸ƒæ–™åŸææ–™å’Œè®¾è®¡å¸ƒæ–™çš„æŒ‡ä»¤)çš„ç‰¹å®šæ•°æ®ï¼Œä½œä¸ºå›æŠ¥ï¼ŒæœåŠ¡å™¨å°†å‘æ‚¨å‘é€æ‰€è¯·æ±‚çš„æ•°æ®ä½œä¸ºå“åº”(ç¼åˆ¶å¸ƒæ–™)ã€‚

è¿™äº›è¯·æ±‚ä½¿ç”¨ API URL å‘é€ã€‚

ä¸€ä¸ª API(åº”ç”¨ç¨‹åºç¼–ç¨‹æ¥å£)çœ‹èµ·æ¥åƒè¿™æ ·ğŸ‘‡

```
// Example API
"https://google.com/api/users" // returns a list of users
```

å¦‚æœä½ è¿˜æ˜¯å¾ˆå›°æƒ‘ã€‚åˆ«æ‹…å¿ƒï¼Œå¾€å‰èµ°ä½ ä¼šæƒ³å‡ºåŠæ³•çš„ã€‚

# åˆ›å»ºæ‚¨çš„ç¬¬ä¸€ä¸ª API

è®©æˆ‘ä»¬å…ˆå¯åŠ¨æœåŠ¡å™¨

æ‰“å¼€ä½ çš„ç»ˆç«¯

å¯¼èˆªåˆ°æ‚¨çš„é¡¹ç›®ç›®å½•

ç„¶åè·‘

```
yarn start:dev
```

> *å°†* `*yarn*` *æ›¿æ¢ä¸º* `*npm*` *æˆ–* `*pnpm*` *å¦‚æœä½ å·²ç»åˆå§‹é…ç½®äº†é‚£äº›åŒ…ç®¡ç†å™¨*

ç°åœ¨ï¼Œæ‚¨çš„æœåŠ¡å™¨åº”è¯¥å·²ç»åœ¨

```
http://localhost:3000
```

æµ‹è¯•ç”± Nest ç”Ÿæˆçš„å¯åŠ¨ä»£ç ã€‚å°„æµç ”ç©¶â€¦

Open Postman(æµ‹è¯• API çš„å·¥å…·)

é€‰æ‹©**è·å–**æ–¹æ³•å¹¶æ·»åŠ **API URL(**[**http://localhost:3000**](http://localhost:3000/)**)**ç„¶åç‚¹å‡»**å‘é€**

![](img/b458f982ff9542202593ed7b0651f5c4.png)

æ‚¨å°†çœ‹åˆ°å“åº”ä¸ºâ€œHello Worldï¼â€

å¤ªå¥½äº†ï¼

æ‚¨å·²ç»æ‰§è¡Œäº†æ‚¨çš„ç¬¬ä¸€ä¸ª APIã€‚

ç°åœ¨è®©æˆ‘ä»¬è¯•ç€å®šåˆ¶è¿™ä¸ª API æ¥è·å¾—ä¸€ä¸ªç”¨æˆ·ååˆ—è¡¨

# ç¬¬ä¸€æ­¥

æ‰“å¼€**åº”ç”¨æ§åˆ¶å™¨. ts**

*   å°†**/ç”¨æˆ·**è·¯çº¿æ·»åŠ åˆ° **@Controller()** è£…é¥°å™¨ä¸­
*   å°† **@Get()** decorator ä¸‹çš„å‡½æ•°åæ”¹ä¸º **getUsers**
*   å°†è¿”å›ç±»å‹ä»**å­—ç¬¦ä¸²**æ›´æ”¹ä¸º**å­—ç¬¦ä¸²[]**
*   å°†åº”ç”¨æœåŠ¡æ–¹æ³•åç§°æ›´æ”¹ä¸º**è·å–ç”¨æˆ·**

ä»£ç ç‰‡æ®µğŸ‘‡

```
import { Controller, Get } from '@nestjs/common';
import { AppService } from './app.service';

@Controller('/users') // Add '/user' route
export class AppController {
  constructor(private readonly appService: AppService) {}
// Change the function name to getUsers
  @Get()
  getUsers(): string[] { // Change return type to string[](stirng Array) 
     // Change the service method name to getUsers
     return this.appService.getUsers(); 
  }
}
```

# ç¬¬äºŒæ­¥

æ‰“å¼€ **app.service.ts**

*   å°† AppService ç±»ä¸­çš„å‡½æ•°å **getHello()** æ”¹ä¸º **getUsers()**
*   å°†è¿”å›ç±»å‹ä»**å­—ç¬¦ä¸²**æ›´æ”¹ä¸º**å­—ç¬¦ä¸²[]**
*   å°†è¿”å›å€¼ä»**â€˜Hello Worldï¼â€™**è‡³`['userOne','userTwo']`

ä»£ç ç‰‡æ®µğŸ‘‡

```
import { Injectable } from '@nestjs/common';

@Injectable()
export class AppService {
  // Change function name to getUsers
  getUsers(): string[] { // Change return type to string[](stirng Array) 
    return ['userOne', 'userTwo'];
  }
}
```

å°±è¿™æ ·ï¼Œä½ çš„ç”¨æˆ· API å·²ç»å‡†å¤‡å¥½äº†ã€‚

è®©æˆ‘ä»¬åœ¨ã€Šé‚®å·®ã€‹ä¸­æµ‹è¯•ä¸€ä¸‹

*   å¼€æ”¾é‚®é€’å‘˜
*   é€‰æ‹©**è·å–**æ–¹æ³•å¹¶æ·»åŠ **API URL(**[**http://localhost:3000/users**](http://localhost:3000/users)**)**ç„¶åç‚¹å‡»**å‘é€**

![](img/50373256393364bdd240f9fc50b22bba.png)

å¦‚æœæ‚¨å¾—åˆ°çš„å“åº”æ˜¯ç”¨æˆ·ååˆ—è¡¨ã€‚

æ­å–œä½ ï¼ğŸ‘

ä½ å·²ç»åœ¨ Nest ä¸­åˆ›å»ºäº†ä½ çš„ç¬¬ä¸€ä¸ª APIã€‚å°„æµç ”ç©¶â€¦

ä»[è¿™é‡Œ](https://github.com/nandhakumar-rs/nest-js-tutorial-series)è·å¾—å®Œæ•´çš„æºä»£ç 

# æ„Ÿè°¢é˜…è¯»ï¼

å¸Œæœ›ä½ ä»Šå¤©å­¦åˆ°äº†æ–°ä¸œè¥¿ğŸ˜Šã€‚

[è·Ÿæˆ‘æ¥](https://medium.com/@nandhakumar.io)è·å¾—è¿™ä¸ªç³»åˆ—æ‰€æœ‰å³å°†å‘å¸ƒçš„å¸–å­çš„é€šçŸ¥ã€‚

åœ¨ [Twitter](https://twitter.com/nandhakumar_io) ã€ [Instagram](https://www.instagram.com/nandhakumar.io/) ã€ [Email](https://mailto:rsnk2013@gmail.com/) å’Œ [LinkedIn](https://www.linkedin.com/in/nandhakumar-io/) ä¸Šå…³æ³¨å¹¶è”ç³»æˆ‘ï¼Œäº†è§£æ›´å¤šç±»ä¼¼çš„æœ‰è¶£å†…å®¹ã€‚

*æ›´å¤šå†…å®¹çœ‹* [***è¯´ç™½äº†ã€‚æŠ¥åå‚åŠ æˆ‘ä»¬çš„***](https://plainenglish.io/) **[***å…è´¹å‘¨æŠ¥***](http://newsletter.plainenglish.io/) *ã€‚å…³æ³¨æˆ‘ä»¬å…³äº* [***æ¨ç‰¹***](https://twitter.com/inPlainEngHQ) ï¼Œ[***LinkedIn***](https://www.linkedin.com/company/inplainenglish/)*ï¼Œ*[***YouTube***](https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw)*ï¼Œä»¥åŠ* [***ä¸å’Œ***](https://discord.gg/GtDtUAvyhW) *ã€‚å¯¹å¢é•¿é»‘å®¢æ„Ÿå…´è¶£ï¼Ÿæ£€æŸ¥* [***ç”µè·¯***](https://circuit.ooo/) *ã€‚***