<html>
<head>
<title>5 Clever Hacks for React-Query and SWR</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">React-Queryå’ŒSWRçš„5ä¸ªå¦™æ‹›</h1>
<blockquote>åŸæ–‡ï¼š<a href="https://javascript.plainenglish.io/five-clever-hacks-for-react-query-or-swr-27c2453f4e2d?source=collection_archive---------1-----------------------#2022-07-05">https://javascript.plainenglish.io/five-clever-hacks-for-react-query-or-swr-27c2453f4e2d?source=collection_archive---------1-----------------------#2022-07-05</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><p id="5aec" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">å› æ­¤ï¼Œåœ¨React 18ä¸­å¤„ç†åŒé‡æ¸²æŸ“é—®é¢˜æœ€ç»ˆè®©ä½ ä½¿ç”¨äº†åƒ<a class="ae ki" href="https://react-query.tanstack.com/" rel="noopener ugc nofollow" target="_blank"> react-query </a>æˆ–<a class="ae ki" href="https://swr.vercel.app/" rel="noopener ugc nofollow" target="_blank"> SWR </a>è¿™æ ·çš„APIå¤„ç†åº“ã€‚å‰å®³ï¼ä½†æ˜¯ï¼Œæ‚¨çŸ¥é“å—ï¼Œæ‚¨å¯ä»¥ä»12Kb(æˆ–è€…SWRçš„4Kb)ä¸­è·å¾—æ¯”APIæŠ“å–æ›´å¤šçš„ä¸œè¥¿ï¼Ÿä»¥ä¸‹æ˜¯è¿™äº›ä»¤äººæ•¬ç•çš„åº“çš„äº”ç§éå¸¸æ–°é¢–çš„ç”¨æ³•ã€‚</p><h1 id="a0c1" class="kj kk in bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">æ›´å–œæ¬¢è§†é¢‘ï¼Ÿ</h1><p id="0b25" class="pw-post-body-paragraph jk jl in jm b jn lh jp jq jr li jt ju jv lj jx jy jz lk kb kc kd ll kf kg kh ig bi translated">å¦‚æœä½ æ›´å–œæ¬¢çœ‹ä½ çš„æŠ€æœ¯æ•…äº‹ï¼Œé‚£å°±å»YouTubeä¸Šçœ‹çœ‹ã€‚</p><figure class="lm ln lo lp gt lq"><div class="bz fp l di"><div class="lr ls l"/></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk">Five Clever Hacks for React-Query and SWR: The Video!</figcaption></figure><h1 id="6a61" class="kj kk in bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">ç®€åŒ–çš„å¤šæ¬¡æå–</h1><p id="dc5a" class="pw-post-body-paragraph jk jl in jm b jn lh jp jq jr li jt ju jv lj jx jy jz lk kb kc kd ll kf kg kh ig bi translated">æˆ‘ä»¬å€¾å‘äºæŠŠä¸€ä¸ª<code class="fe lx ly lz ma b">useQuery</code>é’©å­çœ‹ä½œæ˜¯æ¯æ¬¡è·å–ä¸€ä¸ªé’©å­ã€‚ä½†æ˜¯ï¼Œå‡è®¾æ‚¨è¦è¿›è¡Œä¸¤æ¬¡æå–ã€‚ä¾‹å¦‚ï¼Œæ‚¨æœ‰ä¸€ä¸ªç™»å½•ç³»ç»Ÿï¼Œåœ¨è¯¥ç³»ç»Ÿä¸­ï¼Œæ‚¨é¦–å…ˆè·å–è¿›è¡Œç™»å½•ï¼Œç„¶ååœ¨è·å¾—ç”¨æˆ·IDåå†æ¬¡è·å–ç”¨æˆ·ä¿¡æ¯ã€‚</p><p id="258d" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">æ‚¨å¯èƒ½ä¼šä»ä»¥ä¸‹å†…å®¹å¼€å§‹:</p><pre class="lm ln lo lp gt mb ma mc md aw me bi"><span id="5599" class="mf kk in ma b gy mg mh l mi mj">import { useQuery } from "react-query";</span><span id="0d6d" class="mf kk in ma b gy mk mh l mi mj">const fetchLogin = () =&gt; fetch("/login.json").json();<br/>const fetchUser = (id) =&gt; fetch(`/${id}.json`).json();</span><span id="f402" class="mf kk in ma b gy mk mh l mi mj"><em class="ml">const MyComponent = () =&gt; {<br/>  const</em> { <em class="ml">data</em>: login } =<em class="ml"> useQuery</em>("login"<em class="ml">, </em>fetchLogin);<br/>  <em class="ml">const</em> { <em class="ml">data</em>: user } =<em class="ml"> useQuery</em>(<br/>    "user"<em class="ml">,</em> () =&gt; fetchUser(login.id),<br/>    { enabled: login?.id }<br/>  );</span><span id="c0fc" class="mf kk in ma b gy mk mh l mi mj">  return &lt;div&gt;{JSON.stringify(user)}&lt;/div&gt;<br/>}</span></pre><p id="8725" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">åœ¨è¿™ä¸ªæ¨¡å‹ä¸­ï¼Œæˆ‘ä»¬çº§è”è¿™ä¸¤ä¸ª<code class="fe lx ly lz ma b">useQuery</code>é’©å­ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬è·å–ç™»å½•åï¼Œç„¶åä¸€æ—¦ç™»å½•åè¿”å›éé›¶çš„<code class="fe lx ly lz ma b">id</code>ï¼Œæˆ‘ä»¬å°±<code class="fe lx ly lz ma b">enable</code>è¿›è¡Œç¬¬äºŒæ¬¡æŸ¥è¯¢ã€‚ç°åœ¨ï¼Œè¿™æ˜¯å¯è¡Œçš„ã€‚å¯æ˜¯è¿™æ ·çš„ç—›è‹¦ï¼æƒ³è±¡ä¸€ä¸‹ï¼Œå¦‚æœæœ‰ä¸‰ä¸ªæˆ–æ›´å¤šçš„è¯·æ±‚ä¼šæ›´å¤æ‚ã€‚ä¸€å®šæœ‰æ›´å¥½çš„æ–¹æ³•ï¼</p><p id="8e99" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">å½“ç„¶ï¼Œæˆ‘ä»¬å¯ä»¥åªåšä¸€ä¸ª<code class="fe lx ly lz ma b">login</code>å‡½æ•°ï¼Œå°±åƒè¿™æ ·:</p><pre class="lm ln lo lp gt mb ma mc md aw me bi"><span id="0c51" class="mf kk in ma b gy mg mh l mi mj">const login = async () =&gt; {<br/>  const resp = await fetch("/login.json");<br/>  const { id } = await resp.json();</span><span id="8498" class="mf kk in ma b gy mk mh l mi mj">  const userResp = await fetch(`/${id}.json`);<br/>  const user = await userResp.json();<br/>  return user;<br/>};</span></pre><p id="cb83" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">åœ¨æˆ‘ä»¬çš„ç»„ä»¶ä¸­ä½¿ç”¨å®ƒã€‚</p><pre class="lm ln lo lp gt mb ma mc md aw me bi"><span id="b047" class="mf kk in ma b gy mg mh l mi mj"><em class="ml">const MyComponent = () =&gt; {<br/>  const</em> {data: user} =<em class="ml"> useQuery</em>("login"<em class="ml">, </em>login);<br/>  return &lt;div&gt;{JSON.stringify(user)}&lt;/div&gt;<br/>}</span></pre><p id="e167" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ä½ çœ‹ï¼Œ<code class="fe lx ly lz ma b">useQuery</code>ç›‘æ§ä»»ä½•å‡½æ•°ï¼Œå®ƒå¯ä»¥æ˜¯å•ä¸ªçš„<code class="fe lx ly lz ma b">fetch</code>ï¼Œä¹Ÿå¯ä»¥æ˜¯è¿™æ ·çš„å‡½æ•°ï¼Œç”¨é€»è¾‘ç­‰è¿›è¡Œå¤šæ¬¡æå–ã€‚æˆ–è€…å®ƒå¯èƒ½æ ¹æœ¬å°±ä¸æ˜¯ä¸€ä¸ªæå–(æ­£å¦‚æˆ‘ä»¬å°†å¾ˆå¿«çœ‹åˆ°çš„)ã€‚è¿™é‡Œçš„è¦ç‚¹æ˜¯å¼€å§‹è·³å‡º<code class="fe lx ly lz ma b">fetch</code>çš„æ¡†æ¡†æ€è€ƒã€‚</p><p id="40ed" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ä½†æ˜¯åœ¨æˆ‘ä»¬ç»“æŸå…³äº<code class="fe lx ly lz ma b">fetch</code>çš„è¯é¢˜ä¹‹å‰ï¼Œè®©æˆ‘ä»¬æ¥çœ‹ä¸¤ä¸ªæ›´æ–¹ä¾¿çš„å˜ä½“ã€‚</p><p id="b814" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨è¦è¿›è¡Œä¸€ç³»åˆ—çš„è¯»å–æ“ä½œï¼Œæ‚¨å¯ä»¥è¿™æ ·åš:</p><pre class="lm ln lo lp gt mb ma mc md aw me bi"><span id="d10a" class="mf kk in ma b gy mg mh l mi mj">const getTextData = async () =&gt; {<br/>  const out = [];<br/>  for (const name of ["a", "b", "c"]) {<br/>    const resp = await fetch(`/data_${name}.json`);<br/>    out.push(await resp.json());<br/>  }<br/>  return out;<br/>};<br/>...<br/><em class="ml">const</em> {data: textData} =<em class="ml"> useQuery</em>("textData"<em class="ml">, </em>getTextData);</span></pre><p id="b36c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ª<code class="fe lx ly lz ma b">for</code>å¾ªç¯æ¥éå†ä¸€ä¸ªå€¼æ•°ç»„ï¼Œç„¶ååœ¨è¿”å›æ‰€æœ‰å€¼ä¹‹å‰è¯·æ±‚æ¯ä¸ªå€¼çš„JSONã€‚é¡ºä¾¿è¯´ä¸€å¥ï¼Œå¦‚æœä½ å–œæ¬¢è¿™ä¸ªä¾‹å­ï¼Œä½†ä¸å–œæ¬¢<code class="fe lx ly lz ma b">for</code>ï¼Œä½ ç”¨<code class="fe lx ly lz ma b">forEach</code>æ›¿æ¢å®ƒï¼Œå®ƒä¸ä¼šå·¥ä½œï¼Œé‚£æ˜¯å› ä¸º<code class="fe lx ly lz ma b">forEach</code>ä¸<code class="fe lx ly lz ma b">async/await</code>ä¸å…¼å®¹ï¼Œä½†æ˜¯å˜¿ï¼Œä½ è‡ªå·±è¯•è¯•çœ‹ï¼Œäº«å—å§ã€‚</p><p id="3d5c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">å¦‚æœæ‚¨æƒ³å¹¶è¡Œæ‰§è¡Œæ­¤æ“ä½œï¼Œå¯ä»¥å°è¯•å¦‚ä¸‹æ–¹å¼:</p><pre class="lm ln lo lp gt mb ma mc md aw me bi"><span id="42e5" class="mf kk in ma b gy mg mh l mi mj">const getTextData = async () =&gt; Promise.all(<br/>  ["a", "b", "c"].map(async (name) =&gt; {<br/>    const resp = await fetch(`/data_${name}.json`);<br/>    return await resp.json();<br/>  })<br/>);</span></pre><p id="1349" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">è¿™ä¹Ÿæ˜¯å¯è¡Œçš„ï¼Œä½†æ˜¯æˆ‘ä¸è®¤ä¸ºç»“æœçš„é¡ºåºæ˜¯æœ‰ä¿è¯çš„ï¼Œè¿™å°†å–å†³äºå•ä¸ªè¯»å–çš„è§£å†³é€Ÿåº¦ã€‚</p><p id="aa06" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">æˆ‘å¬åˆ°ä½ åœ¨å°–å«:â€œå¤Ÿäº†ï¼Œåˆ«ç©äº†ï¼ç»™æˆ‘çœ‹çœ‹æ–°çš„ï¼â€å¥½å§å¥½å§ã€‚</p><h1 id="5624" class="kj kk in bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">è®°å½•æ—¶é—´</h1><p id="a321" class="pw-post-body-paragraph jk jl in jm b jn lh jp jq jr li jt ju jv lj jx jy jz lk kb kc kd ll kf kg kh ig bi translated">è®©æˆ‘ä»¬ç”¨SWRåšä¸€ä¸ªç§’è¡¨ã€‚ä¸ï¼Œæˆ‘æ²¡å¼€ç©ç¬‘ï¼</p><p id="093a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">æˆ‘ä»¬å°†ä»åˆ›å»ºä¸€ä¸ªå‡½å­(ä¸€ä¸ªäº§ç”Ÿå‡½æ•°çš„å‡½æ•°)å¼€å§‹ï¼Œè¿™ä¸ªå‡½å­å°†åˆ©ç”¨ä¸€ä¸ªçŸ¥é“å®ƒè¢«åˆ›å»ºçš„æ—¶é—´çš„å‡½æ•°ã€‚å½“æˆ‘ä»¬è°ƒç”¨å®ƒæ—¶ï¼Œå®ƒä¼šè¿”å›å¼€å§‹æ—¶é—´å’Œå½“å‰æ—¶é—´ä¹‹é—´çš„å·®å€¼ï¼Œä»¥ç§’ä¸ºå•ä½ã€‚</p><pre class="lm ln lo lp gt mb ma mc md aw me bi"><span id="5e51" class="mf kk in ma b gy mg mh l mi mj">const createStopwatch = () =&gt; {<br/>  const startTime = Date.now();<br/>  return () =&gt; {<br/>    return Math.round((Date.now() - startTime) / 1000);<br/>  };<br/>};</span></pre><p id="9eb0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ç°åœ¨ï¼Œå½“æˆ‘ä»¬è°ƒç”¨<code class="fe lx ly lz ma b">createStopwatch</code>æ—¶ï¼Œæˆ‘ä»¬å°†å¾—åˆ°ä¸€ä¸ªçŸ¥é“å…¶å¼€å§‹æ—¶é—´çš„å‡½æ•°ï¼Œå¹¶ç»™å‡ºä»é‚£æ—¶èµ·ç»è¿‡çš„æ—¶é—´ã€‚æˆ‘ä»¬å¯ä»¥åœ¨ä½¿ç”¨<code class="fe lx ly lz ma b">useSWR</code>é’©å­çš„ç»„ä»¶ä¸­ä½¿ç”¨å®ƒï¼Œå°±åƒè¿™æ ·:</p><pre class="lm ln lo lp gt mb ma mc md aw me bi"><span id="742b" class="mf kk in ma b gy mg mh l mi mj"><em class="ml">import</em> useSWR <em class="ml">from</em> "swr";</span><span id="3774" class="mf kk in ma b gy mk mh l mi mj">const Stopwatch = () =&gt; {<br/>  const stopwatchRef = useRef(createStopwatch());<br/>  const { data } = useSWR("stopwatch", stopwatchRef.current, {<br/>    refreshInterval: 100,<br/>    dedupingInterval: 100,<br/>  });</span><span id="fb8c" class="mf kk in ma b gy mk mh l mi mj">  return &lt;div&gt;Time: {data}&lt;/div&gt;;<br/>};</span></pre><p id="e515" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">æˆ‘ä»¬é¦–å…ˆåˆ›å»ºä¸€ä¸ªrefæ¥ä¿å­˜è¿™ä¸ªå‡½æ•°ï¼Œå› ä¸ºæˆ‘ä»¬ä½¿ç”¨äº†<code class="fe lx ly lz ma b">useRef</code>ï¼Œè¿™ä¸ªå‡½æ•°åœ¨æŒ‚è½½æ—¶åªä¼šè¢«è°ƒç”¨ä¸€æ¬¡ã€‚ç„¶åæˆ‘ä»¬åœ¨<code class="fe lx ly lz ma b">useSWR</code>é’©å­ä¸­ä½¿ç”¨é‚£ä¸ªå‡½æ•°(é€šè¿‡ä»<code class="fe lx ly lz ma b">stopwatchRef.current</code>ä¸­è·å–)ï¼Œç”±äº<code class="fe lx ly lz ma b">refreshInterval</code>ï¼Œé’©å­æ¯100æ¯«ç§’è°ƒç”¨ä¸€æ¬¡é‚£ä¸ªå‡½æ•°ã€‚</p><p id="4d3c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">å°±æ˜¯è¿™æ ·ï¼å˜£ï¼ç§’è¡¨ï¼æˆ‘ä»¬ä½¿ç”¨SWRå†…ç½®çš„åˆ·æ–°é—´éš”æ¥è°ƒç”¨è¿™ä¸ªåŒæ­¥å‡½æ•°ï¼Œè€Œä¸æ˜¯æ¯100æ¯«ç§’è·å–æ•°æ®ã€‚</p><p id="af5e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ç°åœ¨ï¼Œè¿™å¾ˆé…·ï¼Œä½†å¹¶ä¸å®é™…ï¼Œè®©æˆ‘ä»¬å°è¯•ä¸€äº›ç›¸å…³ä½†æ›´å®é™…çš„ä¸œè¥¿ã€‚</p><h1 id="8f36" class="kj kk in bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">ç›‘æ§é‚£äº›æ—¥å¿—ï¼</h1><p id="9d44" class="pw-post-body-paragraph jk jl in jm b jn lh jp jq jr li jt ju jv lj jx jy jz lk kb kc kd ll kf kg kh ig bi translated">å‡è®¾æ‚¨æƒ³è¦UIçš„ä¸€éƒ¨åˆ†æ¥ç›‘è§†æ—¥å¿—ã€‚æ—¥å¿—æ¯100æ¯«ç§’å°±ä¼šæ›´æ–°ä¸€æ¬¡<strong class="jm io"> lot </strong>ã€‚ä½†æ˜¯æ‚¨ä¸å¸Œæœ›å¦‚æ­¤é¢‘ç¹åœ°æ›´æ–°UIï¼Œå› ä¸ºï¼Œè®©æˆ‘ä»¬é¢å¯¹ç°å®å§ï¼Œæ—¥å¿—å¹¶ä¸æ˜¯é‚£ä¹ˆé‡è¦ã€‚é‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨react-query(æˆ–SWR)æ¥é™ä½æ›´æ–°é€Ÿåº¦å—ï¼Ÿæˆ‘ä»¬å½“ç„¶å¯ä»¥ï¼</p><p id="4dc0" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">é¦–å…ˆï¼Œè®©æˆ‘ä»¬æ¨¡æ‹Ÿä¸€ä¸ªæ—¥å¿—:</p><pre class="lm ln lo lp gt mb ma mc md aw me bi"><span id="525c" class="mf kk in ma b gy mg mh l mi mj">const subscribeToLog = () =&gt; {<br/>  let log = [];<br/>  let logIndex = 0;</span><span id="a13e" class="mf kk in ma b gy mk mh l mi mj">  setInterval(() =&gt; {<br/>    log.push(`${logIndex}: ${Date.now()}`);<br/>    log = log.slice(-3);<br/>    logIndex++;<br/>  }, 100);</span><span id="868c" class="mf kk in ma b gy mk mh l mi mj">  return () =&gt; log;<br/>};</span><span id="004c" class="mf kk in ma b gy mk mh l mi mj">const logListener = subscribeToLog();</span></pre><p id="7a2e" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ª<code class="fe lx ly lz ma b">logListener</code>å…¨å±€å‡½æ•°ï¼Œå®ƒè¿”å›ç”±intervalå‡½æ•°ä¸æ–­æ„å»ºçš„æ—¥å¿—æ¶ˆæ¯ã€‚æ¯éš”100æ¯«ç§’ï¼Œè¯¥é—´éš”ä¼šæ·»åŠ ä¸€æ¡æ–°çš„æ—¥å¿—æ¶ˆæ¯ï¼Œç„¶åå°†æ—¥å¿—ç¼©å‡åˆ°æœ€è¿‘çš„ä¸‰ä¸ªäº‹ä»¶(åªæ˜¯ä¸ºäº†ä¿æŒè¾ƒå°çš„æ˜¾ç¤ºå¤§å°ã€‚)</p><p id="65a9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ç°åœ¨ï¼Œæˆ‘ä»¬ä½¿ç”¨react-queryæ¥è·å–æ—¥å¿—ï¼Œä½†æ˜¯æ¯ç§’é’Ÿåªèƒ½è·å–ä¸€æ¬¡:</p><pre class="lm ln lo lp gt mb ma mc md aw me bi"><span id="46c1" class="mf kk in ma b gy mg mh l mi mj">import { useQuery } from "react-query";</span><span id="3598" class="mf kk in ma b gy mk mh l mi mj">const Logger = () =&gt; {<br/>  const { data } = useQuery("log", logListener, {<br/>    refetchInterval: 1000,<br/>  });</span><span id="1614" class="mf kk in ma b gy mk mh l mi mj">  return (<br/>    &lt;div&gt;<br/>      {data?.map((line, index) =&gt; (<br/>        &lt;div key={line}&gt;{line}&lt;/div&gt;<br/>      ))}<br/>    &lt;/div&gt;<br/>  );<br/>};</span></pre><p id="92f2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">åœ¨æœ¬ä¾‹ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨<code class="fe lx ly lz ma b">useQuery</code>é’©å­æ¯1000æ¯«ç§’(1ç§’)è½®è¯¢ä¸€æ¬¡<code class="fe lx ly lz ma b">logListener</code>(å®ƒè¿”å›æ—¥å¿—ä¸­çš„æœ€åä¸‰é¡¹)ã€‚è¿™é™åˆ¶äº†æ˜¾ç¤ºï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸ä¼šå¤ªé¢‘ç¹åœ°æ›´æ–°å®ƒã€‚</p><p id="1dbe" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">å½“ç„¶ï¼ŒSWRç”µç æ˜¯éå¸¸ä¸åŒçš„ã€‚ä½ å¾—æŠŠ<code class="fe lx ly lz ma b">refetchInterval</code>æ”¹æˆ<code class="fe lx ly lz ma b">refreshInterval</code>å†åŠ ä¸Šé‚£ä¸ª<code class="fe lx ly lz ma b">dedupingInterval</code>ã€‚è¿™å¾ˆç–¯ç‹‚ï¼Œæˆ‘çŸ¥é“ï¼Œå·®åˆ«æ˜¯æƒŠäººçš„ã€‚</p><p id="2be6" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">å¥½çš„ï¼Œè¿™ç¡®å®æ˜¯react-queryæˆ–SWRçš„ä¸åŒç”¨æ³•ï¼Œä½†æ˜¯æˆ‘è¿˜æœ‰ä»€ä¹ˆå‘¢ï¼Ÿè·å–GPSåæ ‡æ€ä¹ˆæ ·ï¼</p><figure class="lm ln lo lp gt lq gh gi paragraph-image"><div role="button" tabindex="0" class="mn mo di mp bf mq"><div class="gh gi mm"><img src="../Images/5a4ed6215e626bed58fb2319ae98f167.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Xh8aAO_qTOqDTMq4GmZAqQ.jpeg"/></div></div><figcaption class="lt lu gj gh gi lv lw bd b be z dk">Five Clever Hacks for React-Query and SWR image</figcaption></figure><h1 id="13ec" class="kj kk in bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">å¸¦ç€GPSå›å®¶</h1><p id="855a" class="pw-post-body-paragraph jk jl in jm b jn lh jp jq jr li jt ju jv lj jx jy jz lk kb kc kd ll kf kg kh ig bi translated">ä»»ä½•ä½ å¯ä»¥åŒ…è£…åœ¨æ‰¿è¯ºä¸­çš„ä¸œè¥¿ï¼Œä½ éƒ½å¯ä»¥ç”¨è¿™äº›æ£’æäº†çš„åº“æ¥ç›‘æ§ã€‚ä»¥è·å–GPSåæ ‡ä¸ºä¾‹ã€‚è¿™é‡Œæˆ‘ä»¬å°†æµè§ˆå™¨çš„å†…ç½®<code class="fe lx ly lz ma b">getCurrentPosition</code>åŒ…è£…åœ¨ä¸€ä¸ªæ‰¿è¯ºä¸­:</p><pre class="lm ln lo lp gt mb ma mc md aw me bi"><span id="451a" class="mf kk in ma b gy mg mh l mi mj">const getGPSCoordinates = async () =&gt;<br/>  new Promise((resolve, reject) =&gt; {<br/>    navigator.geolocation.getCurrentPosition(<br/>      (position) =&gt; {<br/>        resolve({<br/>          latitude: position.coords.latitude,<br/>          longitude: position.coords.longitude,<br/>        });<br/>      },<br/>      (error) =&gt; {<br/>        reject(error);<br/>      }<br/>    );<br/>  });</span></pre><p id="b4ae" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ç„¶åæˆ‘ä»¬å¯ä»¥ç§°ä¹‹ä¸ºâ€¦è®©æˆ‘é€‰ä¸€ä¸ªâ€¦è¿™æ¬¡æ˜¯SWR:</p><pre class="lm ln lo lp gt mb ma mc md aw me bi"><span id="85d1" class="mf kk in ma b gy mg mh l mi mj">import useSWR from "swr";</span><span id="113d" class="mf kk in ma b gy mk mh l mi mj">const GPS = () =&gt; {<br/>  const { data } = useSWR("gps", getGPSCoordinates);<br/>  return &lt;div&gt;Location: {JSON.stringify(data)}&lt;/div&gt;;<br/>};</span></pre><p id="b0f8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">å°±è¿™æ ·ï¼ŒGPSåæ ‡åœ¨ä½ çš„ç»„ä»¶é‡Œã€‚</p><p id="f61a" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">è¿™é‡Œçš„å…³é”®ç‚¹æ˜¯ã€‚ä»»ä½•å¯ä»¥è½¬æ¢æˆåŒæ­¥å‡½æ•°æˆ–åŸºäºæ‰¿è¯ºçš„å¼‚æ­¥å‡½æ•°çš„ä¸œè¥¿ï¼Œéƒ½å¯ä»¥ä¸è¿™äº›åº“ä¸€èµ·å·¥ä½œã€‚<strong class="jm io">ä»»ä½•äº‹æƒ…</strong>ã€‚ä¸€ç‚¹ä¹Ÿä¸ã€‚</p><h1 id="4005" class="kj kk in bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">ä¸Web Workerså¹¶è¡Œ</h1><p id="e038" class="pw-post-body-paragraph jk jl in jm b jn lh jp jq jr li jt ju jv lj jx jy jz lk kb kc kd ll kf kg kh ig bi translated">è¿™è®©æˆ‘æƒ³åˆ°äº†<a class="ae ki" href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API/Using_web_workers" rel="noopener ugc nofollow" target="_blank"> Web Workers </a>ï¼Œå®ƒä»¬æ˜¯éå¸¸æ–¹ä¾¿çš„ä»£ç ï¼Œå¯ä»¥åœ¨é¡µé¢ä¸Šçš„ä¸åŒçº¿ç¨‹ä¸­è¿è¡Œã€‚ä¸¾ä¸€ä¸ªç®€å•çš„ä¾‹å­:</p><pre class="lm ln lo lp gt mb ma mc md aw me bi"><span id="38ef" class="mf kk in ma b gy mg mh l mi mj">export const multiplyNumbers = (a, b) =&gt; {<br/>  postMessage({ type: "result", result: a * b });<br/>};</span></pre><p id="a680" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">è¿™ä¸ªå°å®¶ä¼™èƒ½æŠŠä¸¤ä¸ªæ•°å­—ç›¸ä¹˜ï¼Œç„¶åä¼ å›ç»“æœã€‚è¿™ä¹ˆå¥½çš„å°åŠŸèƒ½ï¼æ— è®ºå¦‚ä½•ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨react-query(æˆ–SWR)å°†å®ƒé›†æˆåˆ°æˆ‘ä»¬çš„ä»£ç ä¸­ï¼Œéå¸¸ç®€å•ã€‚æˆ‘ä»¬é¦–å…ˆéœ€è¦åŠ è½½å®ƒ:</p><pre class="lm ln lo lp gt mb ma mc md aw me bi"><span id="4a3f" class="mf kk in ma b gy mg mh l mi mj">import worker from "workerize-loader!./worker";</span><span id="8554" class="mf kk in ma b gy mk mh l mi mj">const workerInstance = worker();</span></pre><p id="c223" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ç°åœ¨æˆ‘ä»¬æœ‰äº†ä¸€ä¸ªä½¿ç”¨<code class="fe lx ly lz ma b">workerize-loader</code> WebpackåŠ è½½å™¨åŠ è½½çš„workerå®ä¾‹ã€‚ç„¶åï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒåŒ…è£…åœ¨ä¸€ä¸ªåŸºäºæ‰¿è¯ºçš„å‡½æ•°ä¸­ï¼Œè¯¥å‡½æ•°è°ƒç”¨å®ƒï¼Œç­‰å¾…ç»“æœï¼Œç„¶åç”¨è¾“å‡ºè§£ææ‰¿è¯ºã€‚</p><pre class="lm ln lo lp gt mb ma mc md aw me bi"><span id="bc97" class="mf kk in ma b gy mg mh l mi mj">const multiplyNumbers = async (args) =&gt;<br/>  new Promise((resolve) =&gt; {<br/>    workerInstance.addEventListener("message", (message) =&gt; {<br/>      if (message.data.type === "result") {<br/>        resolve(message.data.result);<br/>      }<br/>    });</span><span id="4433" class="mf kk in ma b gy mk mh l mi mj">    workerInstance.multiplyNumbers(args.a, args.b);<br/>  });</span></pre><p id="0845" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">æˆ‘ä»¬æ‰€åšçš„å°±æ˜¯åˆ›å»ºä¸€ä¸ªæ‰¿è¯ºï¼Œåœ¨å®ä¾‹ä¸Šæ³¨å†Œä¸€ä¸ªç›‘å¬å™¨ï¼Œç„¶åè¿›è¡Œè°ƒç”¨ã€‚ä¸€æ—¦ç›‘å¬å™¨è§¦å‘ï¼Œæˆ‘ä»¬å°±æœ‰äº†ç»“æœã€‚ä¸‹é¢æ˜¯ä½¿ç”¨è¿™ä¸ªå‡½æ•°çš„ç»„ä»¶ä»£ç ï¼Œè¿™æ¬¡ä½¿ç”¨çš„æ˜¯react-queryã€‚</p><pre class="lm ln lo lp gt mb ma mc md aw me bi"><span id="bb16" class="mf kk in ma b gy mg mh l mi mj">import { useMutation } from "react-query";</span><span id="f8ab" class="mf kk in ma b gy mk mh l mi mj">const WebWorker = () =&gt; {<br/>  const { data: result, mutate } = useMutation(<br/>    "multiply", multiplyNumbers);</span><span id="6b79" class="mf kk in ma b gy mk mh l mi mj">  const [valueA, setValueA] = useState("10");<br/>  const [valueB, setValueB] = useState("20");</span><span id="c3f2" class="mf kk in ma b gy mk mh l mi mj">  return (<br/>    &lt;div&gt;<br/>      &lt;input<br/>        value={valueA}<br/>        onChange={(evt) =&gt; setValueA(evt.target.value)}<br/>      /&gt;<br/>      &lt;input<br/>        value={valueB}<br/>        onChange={(evt) =&gt; setValueB(evt.target.value)}<br/>      /&gt;<br/>      &lt;button onClick={<br/>        () =&gt; mutate({ a: valueA, b: valueB })<br/>      }&gt;Multiply&lt;/button&gt;<br/>      &lt;div&gt;{result}&lt;/div&gt;<br/>    &lt;/div&gt;<br/>  );<br/>};</span></pre><p id="bed2" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä½¿ç”¨react-queryä¸­çš„<code class="fe lx ly lz ma b">useMutation</code>é’©å­ï¼Œå› ä¸ºå®ƒåœ¨ä¸»åŠ¨æ‰§è¡Œä¸€äº›äº‹æƒ…ï¼Œè¿™æ ·æ›´æœ‰æ„ä¹‰ã€‚è¿™å¾ˆé‡è¦ï¼Œå› ä¸ºä½ å¯èƒ½ä¼šç”¨åˆ°è¿™äº›æ¨¡å¼ã€‚ç¡®ä¿æ‚¨çš„æŸ¥è¯¢è¢«å»ºæ¨¡ä¸º<code class="fe lx ly lz ma b">useQuery</code>ï¼Œå¹¶ä¸”å¯èƒ½æ”¹å˜äº‹æƒ…çš„æ“ä½œä½¿ç”¨äº†<code class="fe lx ly lz ma b">useMutation</code>é’©å­ã€‚</p><p id="78b9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">å½“ç„¶ï¼Œè¿™å¯¹SWRæ²¡æœ‰å¸®åŠ©ï¼Œä¹Ÿæ²¡æœ‰çªå˜æŒ‚é’©ï¼Œä½†å¯¹SWRä¹Ÿæœ‰åŠæ³•åšåˆ°è¿™ä¸€ç‚¹ã€‚</p><p id="ef8f" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ç°åœ¨ï¼Œè®©æˆ‘ä»¬é€šè¿‡å›ç­”è¿™ä¸ªå¤è€çš„é—®é¢˜ï¼Œä»¥ç››å¤§çš„æ–¹å¼ç»“æŸè¿™ä¸ªè¯é¢˜ï¼›å¦‚æœä½ æœ‰ååº”æŸ¥è¯¢æˆ–SWRï¼Œä½ éœ€è¦ä¸€ä¸ªçŠ¶æ€ç®¡ç†å™¨å—ï¼Ÿ</p><h1 id="3e5e" class="kj kk in bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">å†…ç½®çŠ¶æ€ç®¡ç†å™¨ï¼Ÿï¼ï¼Ÿ</h1><p id="ecf3" class="pw-post-body-paragraph jk jl in jm b jn lh jp jq jr li jt ju jv lj jx jy jz lk kb kc kd ll kf kg kh ig bi translated">SWRå’Œreact-queryéƒ½ç®¡ç†ç¼“å­˜ï¼Œå¯¹å—ï¼Ÿå®ƒä»¬éƒ½å¯ä»¥ç¡®ä¿ï¼Œå¦‚æœæ‚¨ä»ä¸¤ä¸ªä¸åŒçš„ä½ç½®è®¿é—®åŒä¸€ä¸ªæŸ¥è¯¢é”®ï¼Œæ‚¨å°†è·å¾—ç›¸åŒçš„æ•°æ®ã€‚</p><p id="acdd" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">è¿™æ„å‘³ç€æ‚¨å¯ä»¥ä½¿ç”¨è¯¥ç¼“å­˜æ¥å…¨å±€å­˜å‚¨æ‚¨æƒ³è¦çš„æ•°æ®ä½ï¼Œå¹¶ä¸”å½“æ‚¨æ›´æ–°å®ƒä»¬æ—¶ï¼Œå®ƒä»¬å°†åœ¨å®ƒä»¬è¢«â€œè®¢é˜…â€çš„ä»»ä½•åœ°æ–¹æ›´æ–°ã€‚è¿™å°±åƒæ˜¯â€¦ä¸€ä¸ªå·ç»ç†å·¥ä½œçš„80%?</p><p id="9c72" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ›å»ºä¸€ä¸ªåä¸º<code class="fe lx ly lz ma b">useSWRGlobalState</code>çš„å®šåˆ¶é’©å­æ¥å®Œæˆè¿™ä¸ªå…¨å±€å…±äº«çš„ä»»åŠ¡ï¼Œçœ‹çœ‹å§ã€‚</p><pre class="lm ln lo lp gt mb ma mc md aw me bi"><span id="7d57" class="mf kk in ma b gy mg mh l mi mj">import useSWR from "swr";</span><span id="92b1" class="mf kk in ma b gy mk mh l mi mj">const useSWRGlobalState = (key, initialData) =&gt; {<br/>  const { data, mutate } = useSWR(key, () =&gt; initialData);<br/>  return [<br/>    data ?? initialData,<br/>    (value) =&gt;<br/>      mutate(value, {<br/>        revalidate: false,<br/>      }),<br/>  ];<br/>};</span></pre><p id="57ef" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">æ‚¨ç»™è¿™ä¸ªé’©å­ä¸€ä¸ª<code class="fe lx ly lz ma b">key</code>ï¼Œè¿™æ˜¯æˆ‘ä»¬ä¸€ç›´åœ¨ä½¿ç”¨çš„æŸ¥è¯¢é”®ï¼Œä»¥åŠæ‚¨æƒ³è¦çš„ä»»ä½•åˆå§‹æ•°æ®ã€‚åè¿‡æ¥ï¼Œå®ƒä½¿ç”¨<code class="fe lx ly lz ma b">useSWR</code>å’Œ<code class="fe lx ly lz ma b">mutate</code>å‡½æ•°æ¥è·å–å½“å‰æ•°æ®ã€‚</p><p id="a039" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ç„¶åé’©å­è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œçœ‹èµ·æ¥åƒæ˜¯ä»<code class="fe lx ly lz ma b">useState</code>è¿”å›çš„ã€‚è¿™æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå…¶ä¸­ç¬¬ä¸€é¡¹æ˜¯å½“å‰å€¼ï¼Œç¬¬äºŒé¡¹æ˜¯setterå‡½æ•°ã€‚</p><p id="196c" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">setterå‡½æ•°æ˜¯ç¥å¥‡çš„åœ°æ–¹ã€‚æˆ‘ä»¬è°ƒç”¨æˆ‘ä»¬å¾—åˆ°çš„<code class="fe lx ly lz ma b">mutate</code>å‡½æ•°ï¼Œå¹¶èµ‹äºˆå®ƒæ–°çš„å€¼<strong class="jm io">ï¼Œä½†æ˜¯</strong>æˆ‘ä»¬å‘Šè¯‰SWR <strong class="jm io">è€Œä¸æ˜¯</strong>é‡æ–°è·å–è¯¥å€¼ã€‚ä¹Ÿå°±æ˜¯è¯´ã€‚è®¾ç½®ç¼“å­˜ï¼Œä½†ä»…æ­¤è€Œå·²ã€‚</p><p id="a4e8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ç°åœ¨æˆ‘ä»¬å¯ä»¥ç”¨ä¸€äº›ç»„ä»¶æ¥åŒ…è£…å®ƒï¼</p><pre class="lm ln lo lp gt mb ma mc md aw me bi"><span id="2b23" class="mf kk in ma b gy mg mh l mi mj">const StateEditor = () =&gt; {<br/>  const [value, setValue] = useSWRGlobalState("sharedText", "");</span><span id="1150" class="mf kk in ma b gy mk mh l mi mj">  return (<br/>    &lt;input value={value}<br/>       onChange={(evt) =&gt; setValue(evt.target.value)} /&gt;<br/>  );<br/>};</span><span id="e4d8" class="mf kk in ma b gy mk mh l mi mj">const StateViewer = () =&gt; {<br/>  const [value] = useSWRGlobalState("sharedText", "");</span><span id="9c6b" class="mf kk in ma b gy mk mh l mi mj">  return &lt;div&gt;{value}&lt;/div&gt;;<br/>};</span><span id="f81d" class="mf kk in ma b gy mk mh l mi mj">const GlobalStateDemo = () =&gt; {<br/>  return (<br/>    &lt;div&gt;<br/>      &lt;StateEditor /&gt;<br/>      &lt;StateViewer /&gt;<br/>    &lt;/div&gt;<br/>  );<br/>};</span></pre><p id="1599" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">è¿™é‡Œæˆ‘ä»¬æœ‰ä¸¤ä¸ªç‹¬ç«‹çš„ç»„ä»¶ï¼Œä¸€ä¸ªç¼–è¾‘çŠ¶æ€ï¼Œå³<code class="fe lx ly lz ma b">StateEditor</code>ç»„ä»¶ï¼Œå¦ä¸€ä¸ªæŸ¥çœ‹å…±äº«çŠ¶æ€ï¼Œå³<code class="fe lx ly lz ma b">StateViewer</code>ã€‚å½“æ‚¨è¾“å…¥<code class="fe lx ly lz ma b">StateEditor</code>æ—¶ï¼Œå˜åŒ–ä¼šç«‹å³æ˜¾ç¤ºåœ¨<code class="fe lx ly lz ma b">StateViewer</code>ä¸­ã€‚</p><p id="2136" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ä¸å¼€ç©ç¬‘ï¼ŒçœŸçš„ã€‚æ²¡æœ‰ä¸Šä¸‹æ–‡ã€‚æ²¡æœ‰Reduxã€‚æ²¡æœ‰åŸå­ã€‚åªæœ‰ä¸€ä¸ªå°é’©å­ï¼Œå’Œä½ å·²ç»æ‹¥æœ‰çš„â€œè·å–åº“â€ã€‚ğŸ’¥å¾ˆç–¯ç‹‚ï¼Œå¯¹å§ï¼Ÿ</p><p id="95a9" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">ç°åœ¨ï¼Œæˆ‘çœŸçš„ä¼šç”¨è¿™ä¸ªå—ï¼Ÿåœ¨ä¸€ä¸ªå¯èƒ½å·²ç»æœ‰çŠ¶æ€ç®¡ç†å™¨çš„å¤§å‹åº”ç”¨ç¨‹åºä¸­ï¼Œè‚¯å®šæ²¡æœ‰ã€‚ä½†æ˜¯å¦‚æœæˆ‘éœ€è¦åœ¨æˆ‘çš„ç»„ä»¶å±‚æ¬¡ç»“æ„ä¸­å…±äº«çš„åªæ˜¯å•ä¸€çš„çŠ¶æ€ï¼Œæ¯”å¦‚ç”¨æˆ·IDå’ŒJWTï¼Œé‚£ä¹ˆæ˜¯çš„ï¼Œæˆ‘å¯èƒ½ä¼šè¿™æ ·åšã€‚</p><p id="c2bb" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">é¡ºä¾¿è¯´ä¸€å¥ï¼ŒReact-Queryä¹Ÿå¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ã€‚</p><pre class="lm ln lo lp gt mb ma mc md aw me bi"><span id="f811" class="mf kk in ma b gy mg mh l mi mj">const useRQGlobalState = (key, initialData) =&gt; [<br/>  useQuery(key, () =&gt; initialData, {<br/>    enabled: false,<br/>    initialData,<br/>  }).data ?? initialData,<br/>  (value) =&gt; client.setQueryData(key, value),<br/>];</span></pre><p id="eaad" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated">è¿™ä¸ªé’©å­è¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œå°±åƒå‰é¢ä¸€æ ·ï¼Œå…¶ä¸­æ•°ç»„ä¸­çš„ç¬¬ä¸€é¡¹æ˜¯æˆ‘ä»¬ç”¨<code class="fe lx ly lz ma b">useQuery</code>å¾—åˆ°çš„å½“å‰å€¼ï¼Œç„¶åç¬¬äºŒä¸ªå€¼æ˜¯ä¸€ä¸ªsetterå‡½æ•°ï¼Œå®ƒç›´æ¥åœ¨react-queryå®¢æˆ·æœºä¸Šä¸ºæŸ¥è¯¢è®¾ç½®ç¼“å­˜æ•°æ®ã€‚</p><h1 id="2cbb" class="kj kk in bd kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb lc ld le lf lg bi translated">åŒ…è£…å®ƒ</h1><p id="12cd" class="pw-post-body-paragraph jk jl in jm b jn lh jp jq jr li jt ju jv lj jx jy jz lk kb kc kd ll kf kg kh ig bi translated">æˆ‘å¸Œæœ›ä½ å·²ç»æ‰¾åˆ°äº†ä¸€ä¸ªæœ‰è¶£çš„æ—…ç¨‹ï¼Œé€šè¿‡å¼•å…¥è¿™äº›ä»¤äººæ•¬ç•çš„åº“ï¼Œä½ å¯ä»¥ä»ä½ æ·»åŠ åˆ°ä½ çš„åº”ç”¨ç¨‹åºä»£ç ä¸­çš„åƒå­—èŠ‚ä¸­æŒ–æ˜å‡ºæ›´å¤šçš„ä»·å€¼ã€‚ä»–ä»¬çœŸçš„æ˜¯Reactç”Ÿæ€ç³»ç»Ÿçš„æ— ä»·ä¹‹å®ã€‚</p><p id="fce8" class="pw-post-body-paragraph jk jl in jm b jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ig bi translated"><em class="ml">æ›´å¤šå†…å®¹è¯·çœ‹</em><a class="ae ki" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="jm io"><em class="ml">plain English . io</em></strong></a><em class="ml">ã€‚æŠ¥åå‚åŠ æˆ‘ä»¬çš„</em> <a class="ae ki" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io"> <em class="ml">å…è´¹å‘¨æŠ¥</em> </strong> </a> <em class="ml">ã€‚å…³æ³¨æˆ‘ä»¬å…³äº</em><a class="ae ki" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="jm io"><em class="ml">Twitter</em></strong></a><em class="ml">å’Œ</em><a class="ae ki" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="jm io"><em class="ml">LinkedIn</em></strong></a><em class="ml">ã€‚æŸ¥çœ‹æˆ‘ä»¬çš„</em> <a class="ae ki" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io"> <em class="ml">ç¤¾åŒºä¸å’Œè°</em> </strong> </a> <em class="ml">åŠ å…¥æˆ‘ä»¬çš„</em> <a class="ae ki" href="https://inplainenglish.pallet.com/talent/welcome" rel="noopener ugc nofollow" target="_blank"> <strong class="jm io"> <em class="ml">äººæ‰é›†ä½“</em> </strong> </a> <em class="ml">ã€‚</em></p></div></div>    
</body>
</html>