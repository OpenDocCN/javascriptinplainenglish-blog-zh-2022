<html>
<head>
<title>Recursive Components with Vue.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">带有Vue.js的递归组件</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/recursive-components-with-vue-js-c3c49e69955c?source=collection_archive---------17-----------------------#2022-01-10">https://javascript.plainenglish.io/recursive-components-with-vue-js-c3c49e69955c?source=collection_archive---------17-----------------------#2022-01-10</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="79f2" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">一个小的示例应用程序，用于可视化“爬楼梯”问题。</h2></div><div class="kf kg gp gr kh ki"><a href="https://medium.com/@applied-math-coding/membership" rel="noopener follow" target="_blank"><div class="kj ab fo"><div class="kk ab kl cl cj km"><h2 class="bd ir gy z fp kn fr fs ko fu fw ip bi translated">通过我的推荐链接加入Medium-applied . math . coding</h2><div class="kp l"><h3 class="bd b gy z fp kn fr fs ko fu fw dk translated">获得我所有的故事，以及其他作家在媒体上发表的成千上万的故事。我坚信，媒介是…</h3></div><div class="kq l"><p class="bd b dl z fp kn fr fs ko fu fw dk translated">medium.com</p></div></div><div class="kr l"><div class="ks l kt ku kv kr kw kx ki"/></div></div></a></div><p id="7914" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">这篇文章是我最近提交的关于“爬楼梯”问题的故事的后续，你可以在这里找到<a class="ae lu" href="https://applied-math-coding.medium.com/the-climbing-stairs-problem-5418a964d1e1" rel="noopener"/>。现在让我们将结果可视化，即模拟一个球以各种方式从楼梯上落下。</p><p id="6d18" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">当然，这种可视化比它认为的任何严肃的意义都有趣，尽管前端代码中使用的技术看起来非常有趣。</p><p id="c475" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">我使用版本3中的<a class="ae lu" href="https://v3.vuejs.org/" rel="noopener ugc nofollow" target="_blank"> Vue.js </a>来创建应用程序，结果应该看起来像这样简单:</p><figure class="ma mb mc md gt me gh gi paragraph-image"><div role="button" tabindex="0" class="mf mg di mh bf mi"><div class="gh gi lz"><img src="../Images/66cac520a1bf912b966d1c75c29c4f32.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Wl0m3WbOK_TVpTV7f_9XEg.png"/></div></div></figure><p id="aca4" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">你可以看到<a class="ae lu" href="https://applied-math-coding.github.io/ball-falling-steps/" rel="noopener ugc nofollow" target="_blank">在这里</a>在行动。整个代码位于这个<a class="ae lu" href="https://github.com/applied-math-coding/ball-falling-steps" rel="noopener ugc nofollow" target="_blank">库</a>中。</p><p id="1320" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">整个应用程序由两个组件组成:<code class="fe lv lw lx ly b">App.vue</code>和<code class="fe lv lw lx ly b">Step.vue</code>。</p><p id="6487" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated"><code class="fe lv lw lx ly b">App</code>组件包含所有触发resp的动作按钮逻辑。停止模拟。此外，它在其模板中托管第一个<code class="fe lv lw lx ly b">Step</code>:</p><pre class="ma mb mc md gt mk ly ml mm aw mn bi"><span id="113c" class="mo mp iq ly b gy mq mr l ms mt">&lt;div class="step-positioner" :style="{ width, height: width }"&gt;<br/>   &lt;Step :idx="0"&gt;&lt;/Step&gt;<br/>&lt;/div&gt;</span></pre><p id="c9c2" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated"><code class="fe lv lw lx ly b">Step</code>只是代表一个显示底部和左边界的盒子。有趣的是,<code class="fe lv lw lx ly b">Step</code>的实现是递归的:</p><p id="604d" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">所以<code class="fe lv lw lx ly b">Step.vue</code>的模板看起来是这样的:</p><pre class="ma mb mc md gt mk ly ml mm aw mn bi"><span id="d9cd" class="mo mp iq ly b gy mq mr l ms mt">&lt;template&gt;<br/>  &lt;div ref="step" class="step"&gt;<br/>    &lt;div class="ball" v-if="currentStep === idx"&gt;&lt;/div&gt;<br/>    &lt;div class="next-step-positioner" <br/>       v-if="idx + 1 &lt; numberOfSteps"&gt;<br/>       <strong class="ly ir">&lt;Step :idx="idx + 1"&gt;&lt;/Step&gt;</strong><br/>    &lt;/div&gt;<br/>  &lt;/div&gt;<br/>&lt;/template&gt;</span></pre><p id="585d" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">正如您所看到的，同一个组件，虽然是另一个实例，但是在它自己的模板定义中被重用。</p><p id="d4bf" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">每个<code class="fe lv lw lx ly b">Step</code>都有一个内部状态<code class="fe lv lw lx ly b">idx</code>，代表其在楼梯上的位置。递归添加的组件提供有加1的<code class="fe lv lw lx ly b">idx</code>。此外，当<code class="fe lv lw lx ly b">idx + 1 &lt; numberOfSteps</code>时，或者换句话说，当已经添加了楼梯的所有步骤时，递归停止。</p><p id="6292" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">另一个有趣的部分是每一步的定位。这个想法只是让下一步相对于当前步骤定位。这是通过将以下样式添加到步进包装元素中实现的，即“步进定位器”:</p><pre class="ma mb mc md gt mk ly ml mm aw mn bi"><span id="123f" class="mo mp iq ly b gy mq mr l ms mt">position: absolute;<br/>left: 100%;<br/>bottom: 100%;<br/>width: 100%;<br/>height: 100%;</span></pre><p id="10c4" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">为了让每样东西都呈现完美的像素，我们实际上还必须考虑到边界的宽度(<code class="fe lv lw lx ly b">calc(100% + var( — border-width))</code>)，但这些都是次要的细节。</p><p id="c5ee" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">上面的CSS从当前的右上角开始递归呈现步骤。这样我们就有了一个楼梯。</p><p id="3d6e" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">此外，每个<code class="fe lv lw lx ly b">Step</code>包含一个元素，用于渲染球。如果该球的<code class="fe lv lw lx ly b">idx</code>与模拟确定的球一致，则该球仅在特定的<code class="fe lv lw lx ly b">Step</code>显示。因此，如果模拟希望球在位置<code class="fe lv lw lx ly b">idx</code>被渲染，那么它只给出全局状态，即<code class="fe lv lw lx ly b">currentStep</code>，值<code class="fe lv lw lx ly b">idx</code>:</p><pre class="ma mb mc md gt mk ly ml mm aw mn bi"><span id="05a7" class="mo mp iq ly b gy mq mr l ms mt">&lt;div class="ball" <strong class="ly ir">v-if="currentStep === idx"</strong>&gt;&lt;/div&gt;</span></pre><p id="817a" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">这里值得注意的是，这个全局状态不是传递给所有的<code class="fe lv lw lx ly b">Step</code>实例，而是添加到一个<code class="fe lv lw lx ly b">vuex</code>存储中。在这种情况下，这是最干净的方法。你可以在<code class="fe lv lw lx ly b">/store/index.ts</code>找到店铺的定义。</p><p id="4638" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">同时，这个存储实现了类似于<code class="fe lv lw lx ly b">decrCurrentStep, initCurrentStep, …</code>的变异，这些变异在实际的模拟代码中使用。</p><p id="ee8d" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">点击开始按钮触发的<code class="fe lv lw lx ly b">App.vue</code>内的模拟代码如下所示:</p><pre class="ma mb mc md gt mk ly ml mm aw mn bi"><span id="4e45" class="mo mp iq ly b gy mq mr l ms mt">for (let seq of <br/>   enumerate_climbing_stairs(this.$store.state.numberOfSteps)) {<br/>   <strong class="ly ir">this.$store.commit("initCurrentStep");</strong><br/>   for (let idx of seq) {<br/>     await new Promise&lt;void&gt;((res) =&gt; setTimeout(() =&gt; res(), 200));<br/>     <strong class="ly ir">this.$store.commit("decrCurrentStep", idx)</strong>;<br/>   }<br/>}</span></pre><p id="38dc" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">在这里，您可以看到全局状态是如何被存储上的相应突变所改变的。</p></div><div class="ab cl mu mv hu mw" role="separator"><span class="mx bw bk my mz na"/><span class="mx bw bk my mz na"/><span class="mx bw bk my mz"/></div><div class="ij ik il im in"><p id="1f32" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">虽然这个应用没什么大不了的，但是我觉得一个人可以从中学到很多东西。</p><p id="805a" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated">感谢阅读！</p><p id="9476" class="pw-post-body-paragraph ky kz iq la b lb lc jr ld le lf ju lg lh li lj lk ll lm ln lo lp lq lr ls lt ij bi translated"><em class="nb">更多内容看</em> <a class="ae lu" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="la ir"> <em class="nb">说白了。报名参加我们的</em> <a class="ae lu" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="la ir"> <em class="nb">免费周报</em> </strong> </a> <em class="nb">。在我们的</em> <a class="ae lu" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="la ir"> <em class="nb">社区不和谐</em> </strong> </a> <em class="nb">获得独家获取写作机会和建议。</em></strong></a></p></div></div>    
</body>
</html>