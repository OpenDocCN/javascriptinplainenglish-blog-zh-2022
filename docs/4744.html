<html>
<head>
<title>A Better Way To Format Phone Numbers in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用JavaScript格式化电话号码的更好方法</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/a-better-way-to-format-phone-numbers-in-javascript-81ce04c2f3a3?source=collection_archive---------3-----------------------#2022-12-29">https://javascript.plainenglish.io/a-better-way-to-format-phone-numbers-in-javascript-81ce04c2f3a3?source=collection_archive---------3-----------------------#2022-12-29</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><h2 id="cab0" class="ip iq ir bd b dl is it iu iv iw ix dk iy translated" aria-label="kicker paragraph">JavaScript技巧</h2><div class=""/><div class=""><h2 id="12d5" class="pw-subtitle-paragraph jx ja ir bd b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko dk translated">使用JavaScript中的自定义模板实现电话号码格式的一致性</h2></div><figure class="kq kr ks kt gu ku gi gj paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gi gj kp"><img src="../Images/a8005407292204daaf77b59d2888df7a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xb_4HNPEgPWBWbzPqfDjtg.jpeg"/></div></div></figure><p id="1c9a" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">今天的问题涉及根据模板格式化电话号码。这是一个有趣的谜题，因为它非常有用。不久前，我有机会开发一个Microsoft Access应用程序来管理电话号码列表。最有趣的方面之一是理解如何根据号码本身的国家显示电话号码。或者，如何基于模板显示电话号码。在这篇文章中，我用JavaScript解决了同样的问题。</p><h1 id="0ef2" class="lx ly ir bd lz ma mb mc md me mf mg mh kg mi kh mj kj mk kk ml km mm kn mn mo bi translated">问题:通过模板格式化电话号码</h1><p id="3479" class="pw-post-body-paragraph lb lc ir ld b le mp kb lg lh mq ke lj lk mr lm ln lo ms lq lr ls mt lu lv lw ik bi translated">链接到<a class="ae mu" href="https://www.codewars.com/kata/61393fd03e441f001ac9c7d4" rel="noopener ugc nofollow" target="_blank">形</a></p><figure class="kq kr ks kt gu ku gi gj paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gi gj mv"><img src="../Images/2b1a07654c6ba406803c8f287a87480d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jc_n6gAaH3Lq3i1WK_zBbw.png"/></div></div></figure><p id="a747" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">你需要写一个函数，通过一个模板来格式化一个电话号码。</p><p id="5355" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">给你数字和字符串。</p><p id="123e" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">如果位数比需要的多，应该忽略它们</p><p id="1eca" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">如果位数少于所需位数，应返回无效的电话号码</p><p id="1ea8" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">例子</p><pre class="kq kr ks kt gu mw mx my bn mz na bi"><span id="4ad2" class="nb ly ir mx b be nc nd l ne nf">(79052479075, "+# ### ### ## ##") =&gt; "+7 905 247 90 75"<br/>(79052479075, "+# (###) ### ##-##") =&gt; "+7 (905) 247 90-75"<br/>(79052479075, "+# ### ### ## ##") =&gt; "+7 905 247 90 75"<br/>(81237068908090, "+## ### ### ## ##") =&gt; "+81 237 068 90 80"<br/>(8123706890, "+## ### ### ##-##") =&gt; "Invalid phone number"<br/>(911, "###") =&gt; "911"<br/>(112, "+ () -") =&gt; "+ () -"</span></pre><h1 id="b8d5" class="lx ly ir bd lz ma mb mc md me mf mg mh kg mi kh mj kj mk kk ml km mm kn mn mo bi translated">我的解决方案</h1><figure class="kq kr ks kt gu ku gi gj paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gi gj mv"><img src="../Images/b7b1b311356ace6f1cf423e7133e188a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pxdR5-u2SfovdpegIZJfcA.jpeg"/></div></div></figure><p id="07d2" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">我对我的解决方案很满意。我决定用正则表达式来解决这个问题。我只需要一个简单的正则表达式来标识模板中的标签(<code class="fe ng nh ni mx b">#</code>):</p><pre class="kq kr ks kt gu mw mx my bn mz na bi"><span id="6c33" class="nb ly ir mx b be nc nd l ne nf">const re: RegExp = /#/g;</span></pre><p id="f922" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">使用这个正则表达式，我可以计算模板中所有的hashtags。这让我明白数字中的位数是否足以满足模板。</p><pre class="kq kr ks kt gu mw mx my bn mz na bi"><span id="f505" class="nb ly ir mx b be nc nd l ne nf">const len: number = template.match(re)?.length ?? -1;</span></pre><p id="fb77" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">我不能在正则表达式上直接使用<code class="fe ng nh ni mx b">length</code>，因为它可能是<code class="fe ng nh ni mx b">undefined</code>。在这种情况下，我返回<code class="fe ng nh ni mx b">-1</code>来表明我没有找到任何标签。</p><p id="c87f" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">要计算数字的位数，只需将其转换为字符串并计算位数即可:</p><pre class="kq kr ks kt gu mw mx my bn mz na bi"><span id="886f" class="nb ly ir mx b be nc nd l ne nf">const num: string = number.toString();</span></pre><p id="17a4" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">如果数字的位数小于标签数，我返回<code class="fe ng nh ni mx b">Invalid phone number</code>。</p><pre class="kq kr ks kt gu mw mx my bn mz na bi"><span id="886c" class="nb ly ir mx b be nc nd l ne nf">if (num.length &lt; len) {<br/>  return "Invalid phone number";<br/>}</span></pre><p id="0da8" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">为了用数字替换模板中的标签，我可以使用一个<code class="fe ng nh ni mx b">for</code>循环。但在这种情况下，我不需要它。我只需要在模板字符串上调用<code class="fe ng nh ni mx b">replace</code>。这样，每当我找到一个标签，我就用相应的数字替换这个字符。</p><pre class="kq kr ks kt gu mw mx my bn mz na bi"><span id="467c" class="nb ly ir mx b be nc nd l ne nf">let i = 0;<br/>let result = template.replace(re, () =&gt; num[i++]);</span></pre><p id="8c00" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">我不得不使用一个<code class="fe ng nh ni mx b">replace</code>循环外部的变量来跟踪当前数字的索引。这样，每当我找到一个hashtag，我就用相应的数字替换这个字符。此外，我还利用了Increment ( <code class="fe ng nh ni mx b">++</code>)运算符的属性:</p><blockquote class="nj nk nl"><p id="21a6" class="lb lc nm ld b le lf kb lg lh li ke lj nn ll lm ln no lp lq lr np lt lu lv lw ik bi translated">递增(++)运算符对其操作数进行递增(加1 ),并根据运算符的位置返回递增前后的值。</p></blockquote><p id="2dce" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">这样，我只有在替换完成后才增加索引。</p><p id="d555" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">综合所有因素，我得到了以下解决方案:</p><pre class="kq kr ks kt gu mw mx my bn mz na bi"><span id="73aa" class="nb ly ir mx b be nc nd l ne nf">export const formatNumber = (number: number, template: string): string =&gt; {<br/>  const re: RegExp = /#/g;<br/>  const num: string = number.toString();<br/>  const len: number = template.match(re)?.length ?? -1;<br/>  <br/>  let i = 0;<br/>  let result =<br/>    num.length &lt; len<br/>      ? "Invalid phone number"<br/>      : template.replace(re, () =&gt; num[i++]);<br/>  return result;<br/>};</span></pre><h1 id="3f56" class="lx ly ir bd lz ma mb mc md me mf mg mh kg mi kh mj kj mk kk ml km mm kn mn mo bi translated">更好的解决方案</h1><figure class="kq kr ks kt gu ku gi gj paragraph-image"><div role="button" tabindex="0" class="kv kw di kx bf ky"><div class="gi gj mv"><img src="../Images/6bca2cf0c9e895d3bc7471c83aca634a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*w7skOxV4M-UnUSXq258v0Q.jpeg"/></div></div></figure><p id="1a4c" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">尽管我对自己的解决方案很满意，但还有另一种基于模板格式化电话号码的方法。解决方案不是我的，而是另一个用户提出的。解决方案更加优雅，可读性更好。</p><pre class="kq kr ks kt gu mw mx my bn mz na bi"><span id="0cae" class="nb ly ir mx b be nc nd l ne nf">export function formatNumber(number: number, template: string): string {<br/>  for (const digit of `${number}`) template = template.replace("#", digit);<br/>  if (template.includes("#")) return "Invalid phone number";<br/>  return template;<br/>}</span></pre><p id="49e5" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">在这种情况下，我们使用一个<code class="fe ng nh ni mx b">for...of</code>循环来迭代数字中的所有数字。这样，用相应的数字替换每个hashtag就足够了。</p><p id="4362" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">甚至控制条件也比较简单。如果模板仍然包含hashtags，则表示数字中的位数小于hashtags的个数。这种情况下，我返回<code class="fe ng nh ni mx b">Invalid phone number</code>。</p><p id="4cac" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">我也可以用这个方法来检查数字中的位数是否足够满足模板。这样，我可以稍微简化一下我的解决方案:</p><pre class="kq kr ks kt gu mw mx my bn mz na bi"><span id="c317" class="nb ly ir mx b be nc nd l ne nf">export const formatNumber = (n: number, template: string, i = 0): string =&gt; {<br/>  let result: string = template.replace(/#/g, () =&gt; `${n}`[i++] ?? "#");<br/>  return result.includes("#") ? "Invalid phone number" : result;<br/>};</span></pre><p id="42ac" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated">感谢阅读！敬请关注更多内容。</p></div><div class="ab cl nq nr hv ns" role="separator"><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv nw"/><span class="nt bw bk nu nv"/></div><div class="ik il im in io"><p id="9ef0" class="pw-post-body-paragraph lb lc ir ld b le lf kb lg lh li ke lj lk ll lm ln lo lp lq lr ls lt lu lv lw ik bi translated"><strong class="ld jb"> <em class="nm">不要错过我的下一篇文章—报名我的</em> </strong> <a class="ae mu" href="https://medium.com/subscribe/@el3um4s" rel="noopener"> <strong class="ld jb"> <em class="nm">中邮箱列表</em> </strong> </a></p><div class="nx ny gq gs nz oa"><a href="https://el3um4s.medium.com/membership" rel="noopener follow" target="_blank"><div class="ob ab fp"><div class="oc ab od cl cj oe"><h2 class="bd jb gz z fq of fs ft og fv fx ja bi translated">通过我的推荐链接加入Medium—Samuele</h2><div class="oh l"><h3 class="bd b gz z fq of fs ft og fv fx dk translated">阅读萨缪尔的每一个故事(以及媒体上成千上万的其他作家)。不是中等会员？在这里加入一块…</h3></div><div class="oi l"><p class="bd b dl z fq of fs ft og fv fx dk translated">el3um4s.medium.com</p></div></div><div class="oj l"><div class="ok l ol om on oj oo kz oa"/></div></div></a></div><h2 id="f37d" class="op ly ir bd lz oq or dn md os ot dp mh lk ou ov mj lo ow ox ml ls oy oz mn ix bi translated">更多内容请访问<a class="ae mu" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> PlainEnglish.io </a>。</h2><p id="3aa9" class="pw-post-body-paragraph lb lc ir ld b le mp kb lg lh mq ke lj lk mr lm ln lo ms lq lr ls mt lu lv lw ik bi translated"><em class="nm">报名参加我们的</em> <a class="ae mu" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ld jb"> <em class="nm">免费每周简讯</em> </strong> </a> <em class="nm">。关注我们关于</em><a class="ae mu" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="ld jb"><em class="nm">Twitter</em></strong></a>，<a class="ae mu" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="ld jb"><em class="nm">LinkedIn</em></strong></a><strong class="ld jb"><em class="nm">，</em></strong><a class="ae mu" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"><strong class="ld jb"><em class="nm">YouTube</em></strong></a><strong class="ld jb"><em class="nm">，以及</em></strong><em class="nm"/><strong class="ld jb"><em class="nm">不和</em> </strong>  </p><h2 id="a759" class="op ly ir bd lz oq or dn md os ot dp mh lk ou ov mj lo ow ox ml ls oy oz mn ix bi translated">希望扩大你的科技创业公司的知名度和采用率吗？检查<a class="ae mu" href="https://circuit.ooo/?utm=publication-post-cta" rel="noopener ugc nofollow" target="_blank">电路</a>。</h2></div></div>    
</body>
</html>