<html>
<head>
<title>‘State is Hard’ — Where to Handle State in React?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">“状态是硬的”React中在哪里处理状态？</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/state-is-hard-where-to-handle-state-in-react-75c18ec5c6f?source=collection_archive---------6-----------------------#2022-03-11">https://javascript.plainenglish.io/state-is-hard-where-to-handle-state-in-react-75c18ec5c6f?source=collection_archive---------6-----------------------#2022-03-11</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/e9255571f169e835c201f294b90363e2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*h4hH25C7IaAgVK4hAkBg7Q.jpeg"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@coffeegeek?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Coffee Geek</a> on <a class="ae kc" href="https://unsplash.com/s/photos/compare?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="75ea" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当我们编写软件时，最大的问题之一是我们应该如何处理状态？用户需要填写表单并更新字段。数据，也就是状态，应该保存在一个对象中还是由一个库来管理，以便我们在其他地方也能容易地访问它？还是应该用输入字段的值在DOM中反映状态？</p><p id="b8fb" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当数据被发送到服务器时，我们如何处理持久性？我们应该使用关系数据库还是一些新奇的NoSQL数据库？更重要的是:我们如何处理来自多个用户的it突变？</p><p id="2418" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">在一些框架的帮助下，这些问题中的许多都为我们解答了，我们可以继续前进了。像<a class="ae kc" href="https://rubyonrails.org/" rel="noopener ugc nofollow" target="_blank"> Rails </a>、<a class="ae kc" href="https://www.djangoproject.com/" rel="noopener ugc nofollow" target="_blank"> Django </a>或<a class="ae kc" href="https://laravel.com/" rel="noopener ugc nofollow" target="_blank"> Laravel </a>这样的后端框架正在为我们处理大量的数据库问题。如何解决前端的状态管理？</p><p id="4042" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当我们使用React时，许多问题都没有答案，直到我们花时间去解决它们，因为React非常简单。当我们这样做时，我们应该考虑不同种类的状态:本地状态和全局状态。</p><h1 id="bbb1" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">我说的局部状态和全局状态是什么意思？</h1><p id="ed4b" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">区别很简单:全局状态是可能呈现在UI中不同区域的数据。有时，这些数据可能会通过不同的表单进行更新。而且通常情况下，一些UI组件会根据特定的状态显示一些图标/徽章或其他东西。脸书、LinkedIn或其他网络应用程序中的“<em class="me">收到新消息</em>”图标就是一个很好的例子。根据经验，我们从服务器获取的所有东西都应该被认为是一个全局状态。</p><p id="e20d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">另一方面，本地状态是表示UI如何显示的数据，或者是易变的数据，即非持久的数据。例如，对于嵌套模式对话框组件，它是对话框是否打开的标志。或者，它可以是决定某些表单域是否可见的逻辑。通常情况下，这种状态依赖于全局状态，并且可能是从全局状态派生出来的。</p><h1 id="784e" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">我们应该区分这两种类型的国家吗？</h1><p id="6492" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">在一些架构中，著名的是榆树架构，每个状态都是全局的。如果开发人员确保表示状态的数据结构是有效的，这就很好。对我个人来说，我觉得JavaScript有点令人困惑，但是Elm可以很容易地设置一个类型来表示您需要的所有内容，而不会迷失在细节中。</p><h1 id="c03b" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">为什么我们不应该处理组件内部的状态呢？</h1><p id="dc60" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">迟早你<strong class="kf ir">将</strong>不得不对不同组件中的一些状态变化做出响应，实现通知系统将会让你非常头疼。</p><p id="f222" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">如果一个数据非常重要，以至于我们需要持久化它，我们可能希望在许多组件中使用它。当我们这样做时，我们在这些组件之间创建了一个紧密的耦合，为了解耦它们，我们创建了一个每个人都可以访问的全局<em class="me">数据存储</em>。因此，我们在某种程度上创建了这些组件所依赖的接口，而不是实际的实现。js以这种方式处理状态管理，效果很好。</p></div><div class="ab cl mf mg hu mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ij ik il im in"><p id="269d" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们有两个选择，将数据放在哪里以使其可用。我们可以使用React上下文或状态管理库，如反冲或Redux。</p><h1 id="037d" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">什么时候我们应该为一个状态使用上下文？</h1><p id="5c6a" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">一个上下文有一个很大的优势，那就是它包含在React out of the box中。文档很棒，概念很容易理解，API也很容易使用。但是，用例是有限的！当上下文保存的数据不会改变或者至少不会经常改变时，应该使用上下文。为什么会这样呢？因为当上下文<em class="me">中的数据改变时，无论组件是否依赖于数据，所有的</em>子组件都将被重新呈现。因此，如果我们对变化很大的数据使用上下文，就会产生性能瓶颈。</p><p id="2e8c" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">一个上下文很好的用例是陈述许多子组件所依赖的，因此我们必须使用适当的钻取。当这种状态改变时，子组件无论如何都必须重新呈现，因为它们实际上依赖于数据。</p><p id="b734" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">对于所有其他数据，我们应该考虑使用状态管理库。</p><h1 id="a298" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">React中的状态管理选项</h1><p id="46f3" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">状态管理库在React中有很长的历史。例如，Redux 于2015年发布，仅比React本身的发布晚了两年。Redux的灵感来源于茶。</p><p id="d7c3" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">最近，<a class="ae kc" href="https://recoiljs.org/" rel="noopener ugc nofollow" target="_blank">反冲</a>也设法创造了一些牵引力。反冲与React集成得非常好，因为它也是由脸书开发的，他们利用了现代React功能，如<a class="ae kc" href="https://reactjs.org/docs/hooks-intro.html" rel="noopener ugc nofollow" target="_blank">挂钩</a>。</p><p id="b516" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">有了这些库，当然也可以使用本地状态。我们可以在组件中使用<code class="fe mm mn mo mp b">useState</code>钩子。</p><h1 id="2e56" class="lb lc iq bd ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly bi translated">结论</h1><p id="1c72" class="pw-post-body-paragraph kd ke iq kf b kg lz ki kj kk ma km kn ko mb kq kr ks mc ku kv kw md ky kz la ij bi translated">国家管理一直很难。但是，在像反冲这样的库的帮助下，以及我们这方面的一点前瞻性思维，这变得更加容易。我们现在有了创建架构良好的web应用程序的所有选项，同时依赖于经过验证的工具，我们不必自己发明这些工具。</p><p id="53b7" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">当然，处理数据的存储必须被导入以实际使用它。这类似于访问一个上下文或另一个组件。</p></div><div class="ab cl mf mg hu mh" role="separator"><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk ml"/><span class="mi bw bk mj mk"/></div><div class="ij ik il im in"><p id="b41f" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">附注:首先，你应该收到我的邮件。 <a class="ae kc" href="https://grnt-grdwhl.medium.com/subscribe" rel="noopener"> <strong class="kf ir"> <em class="me">你可以在这里做！</em> </strong> </a> <em class="me">其次，如果你喜欢体验媒介的自己，可以考虑通过报名成为会员</em>   <em class="me">来支持我和其他成千上万的作家</em> <a class="ae kc" href="https://grnt-grdwhl.medium.com/membership" rel="noopener"> <strong class="kf ir"> <em class="me">。每月只需5美元，你也有机会通过写作赚钱。通过这个链接</em> </strong> </a> <em class="me">报名</em> <a class="ae kc" href="https://grnt-grdwhl.medium.com/membership" rel="noopener"> <strong class="kf ir"> <em class="me">，你就直接用你的一部分费用支持我，不会多花你多少钱。如果你这样做了，万分感谢！</em></strong></a></p><p id="126a" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="me">更多内容请看</em><a class="ae kc" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir"><em class="me">plain English . io</em></strong></a><em class="me">。报名参加我们的</em> <a class="ae kc" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir"> <em class="me">免费周报</em> </strong> </a> <em class="me">。关注我们</em><a class="ae kc" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir"><em class="me">Twitter</em></strong></a><em class="me">和</em><a class="ae kc" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kf ir"><em class="me">LinkedIn</em></strong></a><em class="me">。加入我们的</em> <a class="ae kc" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir"> <em class="me">社区不和谐</em> </strong> </a> <em class="me">。</em></p></div></div>    
</body>
</html>