<html>
<head>
<title>Add the Jest Testing Framework to an Existing Next.js App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">将Jest测试框架添加到现有的Next.js应用程序</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/add-the-jest-testing-framework-to-an-existing-next-js-app-d30b0e1dcd5c?source=collection_archive---------6-----------------------#2022-05-12">https://javascript.plainenglish.io/add-the-jest-testing-framework-to-an-existing-next-js-app-d30b0e1dcd5c?source=collection_archive---------6-----------------------#2022-05-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="85e1" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">找到将Jest添加到Next.js应用程序的简单方法。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/f67dd8e2f13bbf4164809ccdf8bd8ada.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*MqbiDTUKCtSMiKa4.png"/></div></div></figure><p id="16cc" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><em class="ln">原发布于</em><a class="ae lo" href="https://fek.io/blog/add-jest-testing-framework-to-an-existing-next-js-app" rel="noopener ugc nofollow" target="_blank"><em class="ln">https://fek . io</em></a><em class="ln">。</em></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="lp lq l"/></div></figure><p id="d896" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">我一直在用<a class="ae lo" href="https://nextjs.org/" rel="noopener ugc nofollow" target="_blank"> Next.js </a>做我目前正在做的一个新项目。我在Node.js上使用web应用程序的大部分经验都是使用<a class="ae lo" href="https://expressjs.com/" rel="noopener ugc nofollow" target="_blank"> Express.js </a>框架。我喜欢在测试中使用的工具之一是<a class="ae lo" href="https://jestjs.io/" rel="noopener ugc nofollow" target="_blank"> Jest </a>。</p><p id="acff" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果你还没有机会使用Jest，它绝对值得一试。它在React社区中非常受欢迎，并且在框架中内置了测试覆盖。</p><h1 id="abad" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">将Jest添加到Next.js的简单方法</h1><p id="21a1" class="pw-post-body-paragraph kr ks iq kt b ku mj jr kw kx mk ju kz la ml lc ld le mm lg lh li mn lk ll lm ij bi translated">将Jest添加到Next.js的最简单方法是在使用<code class="fe mo mp mq mr b">create-next-app</code>命令行工具搭建一个新应用时这样做。以下是如何使用该工具创建下一个应用程序的示例:</p><pre class="kg kh ki kj gt ms mr mt mu aw mv bi"><span id="b934" class="mw ls iq mr b gy mx my l mz na">npx create-next-app --example with-jest with-jest-app <br/># or <br/>yarn create next-app --example with-jest with-jest-app <br/># or<!-- --> <br/>pnpm create next-app -- --example with-jest with-jest-app</span></pre><p id="2651" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这将创建一个示例Next.js应用程序，其中Jest已经配置好并准备就绪。</p><h1 id="7a51" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">向Next.js添加Jest并不难</h1><p id="406b" class="pw-post-body-paragraph kr ks iq kt b ku mj jr kw kx mk ju kz la ml lc ld le mm lg lh li mn lk ll lm ij bi translated">如果你有一个预先存在的Next.js应用程序，jest可以很容易地添加。我们将通过以下步骤向Next.js 12应用程序添加Jest</p><h1 id="a148" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">添加测试模块</h1><p id="2ec1" class="pw-post-body-paragraph kr ks iq kt b ku mj jr kw kx mk ju kz la ml lc ld le mm lg lh li mn lk ll lm ij bi translated">使用您选择的软件包管理器添加<code class="fe mo mp mq mr b">@testing-library/react</code>、<code class="fe mo mp mq mr b">@testing-library/jest-dom</code>、<code class="fe mo mp mq mr b">jest-environment-jsdom</code>模块。我将使用<code class="fe mo mp mq mr b">yarn</code>作为我的例子:</p><pre class="kg kh ki kj gt ms mr mt mu aw mv bi"><span id="0089" class="mw ls iq mr b gy mx my l mz na">yarn add jest @testing-library/react @testing-library/jest-dom jest-environment-jsdom --dev</span></pre><h1 id="ab4a" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">添加Jest配置</h1><p id="28ba" class="pw-post-body-paragraph kr ks iq kt b ku mj jr kw kx mk ju kz la ml lc ld le mm lg lh li mn lk ll lm ij bi translated">我们需要做的下一件事是向我们项目的根目录添加一个<code class="fe mo mp mq mr b">jest.config.js</code>文件，并编写以下配置代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nb lq l"/></div></figure><h1 id="a08d" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">添加单元测试</h1><p id="fd2c" class="pw-post-body-paragraph kr ks iq kt b ku mj jr kw kx mk ju kz la ml lc ld le mm lg lh li mn lk ll lm ij bi translated">现在，我们将为登录页面添加第一个单元测试。我们将在根目录下为我们所有的测试创建一个文件夹。Jest使用下面的<code class="fe mo mp mq mr b">__tests__</code>目录来存储所有的Jest测试。我们将创建这个目录，并为我们的测试添加一个名为<code class="fe mo mp mq mr b">index.test.js</code>的测试文件。将以下代码添加到该文件中:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nb lq l"/></div></figure><h1 id="67d2" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">向package.json添加一个测试运行程序</h1><p id="7a2c" class="pw-post-body-paragraph kr ks iq kt b ku mj jr kw kx mk ju kz la ml lc ld le mm lg lh li mn lk ll lm ij bi translated">我们的最后一步是修改我们的<code class="fe mo mp mq mr b">package.json</code>文件，向脚本部分添加一个测试运行程序脚本。我的脚本部分如下例所示:</p><pre class="kg kh ki kj gt ms mr mt mu aw mv bi"><span id="4e56" class="mw ls iq mr b gy mx my l mz na">...<br/>  "scripts": {<br/>    "dev": "next dev",<br/>    "build": "next build",<br/>    "start": "next start",<br/>    "lint": "next lint",<br/>    "test": "jest"<br/>  },<br/>...</span></pre><h1 id="6d94" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">运行我们的单元测试</h1><p id="d54a" class="pw-post-body-paragraph kr ks iq kt b ku mj jr kw kx mk ju kz la ml lc ld le mm lg lh li mn lk ll lm ij bi translated">现在我们已经完成了这四项更改，我们可以运行第一个测试了:</p><pre class="kg kh ki kj gt ms mr mt mu aw mv bi"><span id="f359" class="mw ls iq mr b gy mx my l mz na">&gt; yarn test<br/>yarn run v1.22.18<br/>$ jest<br/> PASS  __tests__/index.test.js<br/>  Home<br/>    ✓ renders a heading (94 ms)<br/><br/>Test Suites: 1 passed, 1 total<br/>Tests:       1 passed, 1 total<br/>Snapshots:   0 total<br/>Time:        1.419 s<br/>Ran all test suites.<br/>✨  Done in 3.29s.</span></pre><p id="4f18" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">现在，如果我们想要添加一个测试覆盖报告，我们可以在我们的<code class="fe mo mp mq mr b">package.json</code>文件的脚本部分的测试命令中添加<code class="fe mo mp mq mr b">--coverage</code>标志。</p><pre class="kg kh ki kj gt ms mr mt mu aw mv bi"><span id="69e1" class="mw ls iq mr b gy mx my l mz na">"test": "jest --coverage"</span></pre><p id="3dc6" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果您再次运行测试运行程序，您的输出应该如下所示:</p><pre class="kg kh ki kj gt ms mr mt mu aw mv bi"><span id="661c" class="mw ls iq mr b gy mx my l mz na">❯ yarn test<br/>yarn run v1.22.18<br/>$ jest --coverage<br/> PASS  __tests__/index.test.js<br/>  Home<br/>    ✓ renders a heading (90 ms)<br/><br/>----------|---------|----------|---------|---------|-------------------<br/>File      | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s<br/>----------|---------|----------|---------|---------|-------------------<br/>All files |     100 |      100 |     100 |     100 |<br/> index.js |     100 |      100 |     100 |     100 |<br/>----------|---------|----------|---------|---------|-------------------<br/>Test Suites: 1 passed, 1 total<br/>Tests:       1 passed, 1 total<br/>Snapshots:   0 total<br/>Time:        1.382 s<br/>Ran all test suites.<br/>✨  Done in 3.13s.</span></pre><h1 id="8712" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">结论</h1><p id="89e3" class="pw-post-body-paragraph kr ks iq kt b ku mj jr kw kx mk ju kz la ml lc ld le mm lg lh li mn lk ll lm ij bi translated">在测试和模仿方面，Next.js提供了很多选项。除了Jest，你还可以使用<a class="ae lo" href="https://docs.cypress.io/guides/getting-started/writing-your-first-test#What-you-ll-learn" rel="noopener ugc nofollow" target="_blank">柏树</a>、<a class="ae lo" href="https://playwright.dev/docs/intro" rel="noopener ugc nofollow" target="_blank">剧作家</a>或<a class="ae lo" href="https://github.com/vitest-dev/vitest" rel="noopener ugc nofollow" target="_blank">维特斯特</a>进行测试。</p><p id="6533" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在这篇文章中使用Jest的例子是使用Rust编译器，但是如果你愿意，你也可以使用Babel来运行Jest。祝测试愉快！</p></div><div class="ab cl nc nd hu ne" role="separator"><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh ni"/><span class="nf bw bk ng nh"/></div><div class="ij ik il im in"><p id="824b" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><em class="ln">更多内容看</em> <a class="ae lo" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir"> <em class="ln">说白了。报名参加我们的</em> <a class="ae lo" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir"> <em class="ln">免费周报</em> </strong> </a> <em class="ln">。关注我们关于</em><a class="ae lo" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="kt ir"><em class="ln">Twitter</em></strong></a><em class="ln">和</em><a class="ae lo" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kt ir"><em class="ln">LinkedIn</em></strong></a><em class="ln">。查看我们的</em> <a class="ae lo" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir"> <em class="ln">社区不和谐</em> </strong> </a> <em class="ln">加入我们的</em> <a class="ae lo" href="https://inplainenglish.pallet.com/talent/welcome" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir"> <em class="ln">人才集体</em> </strong> </a> <em class="ln">。</em></strong></a></p></div></div>    
</body>
</html>