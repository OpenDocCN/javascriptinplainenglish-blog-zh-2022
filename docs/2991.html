<html>
<head>
<title>Ionic &amp; GunJS: Build a dApp Using a Decentralised DB in Your Ionic App</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Ionic &amp; GunJS:在你的Ionic应用中使用一个分散的数据库来构建一个dApp</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/ionic-gunjs-build-a-dapp-using-a-decentralised-db-in-your-ionic-app-4cbb5325b63e?source=collection_archive---------8-----------------------#2022-07-20">https://javascript.plainenglish.io/ionic-gunjs-build-a-dapp-using-a-decentralised-db-in-your-ionic-app-4cbb5325b63e?source=collection_archive---------8-----------------------#2022-07-20</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="600e" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">如何使用GunJS构建Ionic应用程序的指南。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/5cf3bc5a555f44d7a010189977bfc53d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*tnqGnRkbbU1YlICv"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@campaign_creators?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Campaign Creators</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="bdc5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当构建一个应用程序时，你需要了解后端发生了什么，你需要在后端托管一些东西，可能是服务器和数据库，要么在某个地方的机器上进行物理托管，要么通过云提供商进行虚拟托管。</p><p id="0fa3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你需要看看你的应用程序如何与一个遥远的未知领域的后端进行通信。</p><p id="d972" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果有一种方法可以让您托管数据库，而不需要实际拥有物理和/或虚拟的服务器，会怎么样？有了马克·纳达尔的GunJS，这是一种可能。</p><h2 id="5ebd" class="lu lv iq bd lw lx ly dn lz ma mb dp mc lf md me mf lj mg mh mi ln mj mk ml mm bi translated"><strong class="ak">什么是GunJS？</strong></h2><p id="4714" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf mp lh li lj mq ll lm ln mr lp lq lr ij bi translated">简而言之:GunJS是一个去中心化的数据库，位于设备的本地存储领域。</p><p id="0217" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">虽然不需要设置实际的服务器，但是如果您愿意，可以选择设置一个称为中继服务器的东西，我也将在本文中向您展示。</p><p id="dd23" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">没有人是一座孤岛。在研究写这篇文章的过程中，我阅读并修改了React教程上的<a class="ae kv" href="https://gun.eco/docs/React-Tutorial" rel="noopener ugc nofollow" target="_blank"> GunJS文档</a>，并观看了来自<a class="ls lt ep" href="https://medium.com/u/695782484bda?source=post_page-----4cbb5325b63e--------------------------------" rel="noopener" target="_blank"> Nader Dabit </a>、<a class="ls lt ep" href="https://medium.com/u/ef09f9b6b917?source=post_page-----4cbb5325b63e--------------------------------" rel="noopener" target="_blank"> Mark Nadal </a>和Fireship的视频。我将构建的应用程序已经根据我读过的文档进行了修改，以使其与Ionic React配合使用。</p><p id="4d70" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我已经计划写一篇关于使用GunJS构建一个Ionic应用程序的文章很长时间了。我花了一段时间研究如何用Ionic实现GunJS，因为它非常棘手，我盯着几个死胡同。</p><h2 id="6481" class="lu lv iq bd lw lx ly dn lz ma mb dp mc lf md me mf lj mg mh mi ln mj mk ml mm bi translated">先决条件</h2><ul class=""><li id="030f" class="ms mt iq ky b kz mn lc mo lf mu lj mv ln mw lr mx my mz na bi translated">请注意，这需要中级水平的离子反应知识</li><li id="a98a" class="ms mt iq ky b kz nb lc nc lf nd lj ne ln nf lr mx my mz na bi translated">您还需要Node.js Express方面的中级知识，因为我们还将构建一个中继服务器。这是可选的，但是有一个中继服务器是很酷的。</li></ul><h2 id="97fe" class="lu lv iq bd lw lx ly dn lz ma mb dp mc lf md me mf lj mg mh mi ln mj mk ml mm bi translated"><strong class="ak">软件版本</strong></h2><p id="9906" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf mp lh li lj mq ll lm ln mr lp lq lr ij bi translated">Ionic React应用程序采用Ionic版本6构建，其Ionic CLI版本为6.20.1。</p><h2 id="c87c" class="lu lv iq bd lw lx ly dn lz ma mb dp mc lf md me mf lj mg mh mi ln mj mk ml mm bi translated">我们将会建造什么？</h2><p id="4fb9" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf mp lh li lj mq ll lm ln mr lp lq lr ij bi translated">我们将在这里构建一个所有设备共享的待办事项列表。不会实现复杂的身份验证，只是一个简单的共享列表，以演示在Ionic React应用程序中使用GunJS数据库。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ng"><img src="../Images/e5648b42970fa2dc67f216db826ed05e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*WpxcBVhxcpcdFHW4wezowg.png"/></div></div></figure><h2 id="95b1" class="lu lv iq bd lw lx ly dn lz ma mb dp mc lf md me mf lj mg mh mi ln mj mk ml mm bi translated">步骤0:启动一个新的Node.js Express服务器(可选的，但是很酷)</h2><p id="6d64" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf mp lh li lj mq ll lm ln mr lp lq lr ij bi translated">我们将从创建一个中继服务器开始。中继服务器只是一个简单的“中继器”,将任何数据库更改中继到其他设备。这是可选的，因为你并不真的需要一个中继服务器，因为GunJS是在没有“中间人”的情况下开发的。</p><p id="d150" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">要启动中继服务器，请设置一个新的Node.js Express服务器。安装以下NPM软件包:</p><ol class=""><li id="f2a1" class="ms mt iq ky b kz la lc ld lf nh lj ni ln nj lr nk my mz na bi translated">快递<code class="fe nl nm nn no b">npm install express</code></li><li id="fcb4" class="ms mt iq ky b kz nb lc nc lf nd lj ne ln nf lr nk my mz na bi translated">枪<code class="fe nl nm nn no b">npm install gun</code></li></ol><p id="d25a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在index.js文件中，插入以下代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="280c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这是一篇很短的文章，大约只有11行。在后台运行index.js，下一步就可以开始你的Ionic项目了。请注意服务器地址，在本例中，它是<a class="ae kv" href="http://localhost:3000." rel="noopener ugc nofollow" target="_blank"> http://localhost:3000。</a></p><p id="1279" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果您计划在其他地方托管它，请记住记下服务器地址，因为这在以后会很重要。</p><h2 id="6157" class="lu lv iq bd lw lx ly dn lz ma mb dp mc lf md me mf lj mg mh mi ln mj mk ml mm bi translated">步骤1:启动一个Ionic React项目，并在你的应用程序中设置GunJS</h2><p id="bbbc" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf mp lh li lj mq ll lm ln mr lp lq lr ij bi translated">开始一个离子项目，并选择反应作为建造的方法。这将开始构建一个Ionic React应用程序的过程，供您阅读。</p><p id="ea72" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于这个列表应用程序，我选择使用空白模板。您可以选择您喜欢的任何其他模板，但我将使用一个普通的空白模板开始。</p><p id="403d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">类似于节点服务器，我们还需要安装Gun:</p><pre class="kg kh ki kj gt nr no ns nt aw nu bi"><span id="0a3c" class="lu lv iq no b gy nv nw l nx ny">npm install gun</span></pre><h2 id="cd27" class="lu lv iq bd lw lx ly dn lz ma mb dp mc lf md me mf lj mg mh mi ln mj mk ml mm bi translated">第二步:在你的App.tsx中设置GunJS</h2><p id="4059" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf mp lh li lj mq ll lm ln mr lp lq lr ij bi translated">好了，现在我们必须在你的App.tsx中设置GunJS。下面是App.tsx文件的代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="0001" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第6行-导入枪到你的离子反应项目。</p><p id="cd12" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第32行-声明gun库(我意识到这听起来很酷，但重读后可能会误解:)，再次指责Gun的创造者<a class="ls lt ep" href="https://medium.com/u/ef09f9b6b917?source=post_page-----4cbb5325b63e--------------------------------" rel="noopener" target="_blank">马克·纳达尔</a>。不过名字很酷)。请注意，我已经在这里添加了中继服务器。如果您没有任何中继服务器，您可以选择添加<code class="fe nl nm nn no b">http://localhost:3000</code>或将其留空，只需声明<code class="fe nl nm nn no b">Gun()</code>。</p><p id="b076" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第40行——将枪作为道具放在家中——如果枪在其他地方使用，重复此步骤。</p><h2 id="d538" class="lu lv iq bd lw lx ly dn lz ma mb dp mc lf md me mf lj mg mh mi ln mj mk ml mm bi translated">第三步:写信给你的家</h2><p id="7891" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf mp lh li lj mq ll lm ln mr lp lq lr ij bi translated">这是所有奇迹发生的地方。在Home.tsx中编写以下代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="np nq l"/></div></figure><p id="4377" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">好了，接近106行，这里是重要的部分:</p><p id="7f7c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第7–9行——这是我们设置取自App.tsx的枪支道具的地方。</p><p id="ab03" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第11–13行——这是我们在首次加载应用程序时将initialState设置为一个空白的todos数组的地方。</p><p id="f592" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第15–19行——这是扩展todo和添加任何新todo的reducer函数。</p><p id="05e7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第25行——这是我们设置todo使用状态的地方。</p><p id="89be" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第30–40行——如果有任何更改，将加载该代码，并将所有todo放入todos数组中。</p><p id="618b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第51–59行——这是我们将待办事项保存到数据库的地方。</p><p id="0340" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第62–71行——我们必须根据索引重新排列待办事项。</p><p id="1323" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第85–87行-这是我们可以添加新待办事项的输入框。</p><p id="4d37" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第89–95行——这是一个循环，重复了newTodoArray中重新排列的todos。</p><p id="55a7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">第98–101行——这是保存并向列表中添加新待办事项的按钮。</p><h2 id="a24f" class="lu lv iq bd lw lx ly dn lz ma mb dp mc lf md me mf lj mg mh mi ln mj mk ml mm bi translated">第四步:构建你的Ionic应用并测试它</h2><p id="e8a2" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf mp lh li lj mq ll lm ln mr lp lq lr ij bi translated">在使用Ionic应用程序后，我能够创建以下列表</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nz"><img src="../Images/c2aea6372d6cd86789a8d02d3b4fdee5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*VsRAYobuVdtL0PFeUGnf6w.png"/></div></div></figure><p id="9be6" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">因为我是在本地网络中工作，所以这很好。有了中继服务器，数据几乎是实时传入的。如果没有中继服务器，您可能需要进行刷新，以给它额外的推动力来获取最新的数据。</p><h2 id="d3c2" class="lu lv iq bd lw lx ly dn lz ma mb dp mc lf md me mf lj mg mh mi ln mj mk ml mm bi translated">结论</h2><p id="e713" class="pw-post-body-paragraph kw kx iq ky b kz mn jr lb lc mo ju le lf mp lh li lj mq ll lm ln mr lp lq lr ij bi translated">不言而喻，如果您决定在基于云的服务器(也许是Heroku，或者任何数量的基于云的提供者)中构建和托管Node.js Express服务器(参见步骤1 ),效果会更好。这将在所有下载了你的应用程序的设备上创建一个可靠的分散数据库中继，从而创建一个分散的数据库系统。</p><p id="2c6d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">请注意，这只会创建一个Ionic应用程序，而不是一个可以直接安装到您的设备上使用的应用程序。这需要一些工作，以确保分散的GunJS数据库的工作。</p><p id="8532" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">从这里开始，有两种方法可以确保Ionic GunJS应用程序按预期运行:</p><ol class=""><li id="5c5e" class="ms mt iq ky b kz la lc ld lf nh lj ni ln nj lr nk my mz na bi translated">将主机应用程序作为渐进式网络应用程序(PWA)——这可以通过Ionic轻松完成</li><li id="2fe5" class="ms mt iq ky b kz nb lc nc lf nd lj ne ln nf lr nk my mz na bi translated">为基于GunJS的列表创建一个微前端(MFE)接口，并将其嵌入到Ionic应用程序中，以便在Android或iOS上构建的混合原生应用程序中使用。这将在另一篇文章中涉及，希望很快。</li></ol><p id="64e4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">同时，一定要试一试，让我知道你的想法。</p><p id="a81c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="oa">塞拉马特·孟加图拉</em></p></div><div class="ab cl ob oc hu od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="ij ik il im in"><p id="522c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="oa">更多内容看</em> <a class="ae kv" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="oa">说白了。报名参加我们的</em> <a class="ae kv" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="oa">免费周报</em> </strong> </a> <em class="oa">。关注我们关于</em><a class="ae kv" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="oa">Twitter</em></strong></a><em class="oa">和</em><a class="ae kv" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="oa">LinkedIn</em></strong></a><em class="oa">。查看我们的</em> <a class="ae kv" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="oa">社区不和谐</em> </strong> </a> <em class="oa">，加入我们的</em> <a class="ae kv" href="https://inplainenglish.pallet.com/talent/welcome" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="oa">人才集体</em> </strong> </a> <em class="oa">。</em></strong></a></p></div></div>    
</body>
</html>