# ä½ å¿…é¡»çŸ¥é“çš„é’©å­ç”¨æ³•

> åŸæ–‡ï¼š<https://javascript.plainenglish.io/react-useeffect-hook-usages-you-must-know-45157805fb98?source=collection_archive---------5----------------------->

## å­¦ä¹  React ä¸­ useEffect é’©å­çš„å®é™…ç”¨æ³•ï¼Œä»¥åŠå¦‚ä½•é€šè¿‡å„ç§ç”¨ä¾‹ç®¡ç†ç»„ä»¶çš„å‰¯ä½œç”¨ã€‚

![](img/d9e2edea2eb58cb59ab37950ed630509.png)

React æ˜¯ä¸€ä¸ªåŸºäº JavaScript çš„ç”¨æˆ·ç•Œé¢åº“ã€‚React ç»„ä»¶æ˜¯ç‹¬ç«‹çš„å¯é‡ç”¨ä»£ç é€»è¾‘ç‰‡æ®µï¼Œå…·æœ‰è‡ªå·±çš„ UIã€‚å¤šä¸ªç»„ä»¶ä¸€èµ·åˆ›å»ºä¸€ä¸ªæœ‰æ„ä¹‰çš„å·¥ä½œ React åº”ç”¨ç¨‹åºã€‚

æˆ‘ä»¬å¯ä»¥ç”¨ä¸¤ç§æ–¹å¼åˆ›å»ºç»„ä»¶ï¼Œä½¿ç”¨ç±»æˆ–å‡½æ•°ã€‚éšç€ JavaScript å¼€å‘äººå‘˜å¯¹å‡½æ•°çš„äº†è§£è¶Šæ¥è¶Šå¤šï¼Œæˆ‘ä»¬çœ‹åˆ°è®¸å¤š React å¼€å‘äººå‘˜é€‚åº”åŸºäºå‡½æ•°çš„ç»„ä»¶ï¼Œè€Œä¸æ˜¯åŸºäºç±»çš„ç»„ä»¶ã€‚

ä» React 16.8 ç‰ˆæœ¬å¼€å§‹ï¼ŒReact å¾—åˆ°äº†ä¸€ä¸ªä»¤äººå…´å¥‹çš„æ–°ç‰¹æ€§ï¼Œå«åš[é’©å­](https://www.youtube.com/watch?v=CvNvRaS3u60)ã€‚React æä¾›äº†è®¸å¤šæ ‡å‡†çš„å†…ç½®é’©å­æ¥ç®¡ç†çŠ¶æ€ã€éš”ç¦»å‰¯ä½œç”¨ã€åˆ›å»ºå¼•ç”¨ã€æé«˜æ€§èƒ½ç­‰ã€‚æˆ‘ä»¬è¿˜å¯ä»¥åˆ›å»º[è‡ªå®šä¹‰é’©å­](https://www.youtube.com/watch?v=nt-TB3f5kp4)ï¼Œè¿™åªæ˜¯è®¿é—®è®¸å¤š React ç‰¹æ€§çš„ JavaScript å‡½æ•°ã€‚

åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬å°†è®¨è®ºä¸€ä¸ªæœ€å¸¸ç”¨çš„å†…ç½® React æŒ‚é’©`useEffect`ã€‚æˆ‘ä»¬å°†é€šè¿‡å®é™…çš„ä½¿ç”¨æ¡ˆä¾‹æ¥å­¦ä¹ å®ƒçš„ç”¨æ³•ã€‚

# useEffect æŒ‚é’©

ç»„ä»¶çš„ç»“æœæ˜¯ç”¨å‘ˆç°é€»è¾‘(ç”¨ JSX å†™çš„)åœ¨ç”¨æˆ·ç•Œé¢ä¸Šå‘ˆç°â€œæŸäº›ä¸œè¥¿â€ã€‚è®¸å¤šå› ç´ é©±åŠ¨æ¸²æŸ“é€»è¾‘ï¼Œ

*   çŠ¶æ€å€¼åœ¨ç»„ä»¶å†…éƒ¨å®šä¹‰å’Œæ›´æ–°ã€‚
*   props å€¼è¢«ä¼ é€’ç»™ç»„ä»¶ã€‚
*   å‰¯ä½œç”¨ã€‚

ç°åœ¨ï¼Œæœ‰å“ªäº›`side effects`ï¼Ÿå¦‚æœä½ ä»¥å‰åœ¨ç¼–ç¨‹çš„ç¯å¢ƒä¸­æ²¡æœ‰å¬è¯´è¿‡ï¼Œé‚£ä¹Ÿæ²¡å…³ç³»ã€‚è¿™é‡Œå°±è®©æˆ‘ä»¬æ¥ç ´ä¸€ç ´ï¼Œäº†è§£ä¸€ä¸‹ã€‚

*   å‰¯ä½œç”¨å¯ä»¥æ˜¯è´Ÿè´£æ”¹å˜ç»„ä»¶çŠ¶æ€çš„ä»»ä½•æ•ˆæœ(ç¼–ç¨‹é€»è¾‘)ã€‚å¦‚æœçŠ¶æ€æ”¹å˜ï¼Œç»„ä»¶ä¼šé‡æ–°å‘ˆç°ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªå…¸å‹çš„å‰¯ä½œç”¨æ˜¯è¿›è¡Œ API è°ƒç”¨å¹¶æ›´æ”¹ç»„ä»¶çš„æœ¬åœ°çŠ¶æ€æ¥å­˜å‚¨ API å“åº”æ•°æ®ã€‚
*   æ­¤å¤–ï¼Œå¯èƒ½ä¼šæœ‰å‰¯ä½œç”¨ï¼Œå¯èƒ½ä¸ä¼šæ›´æ–°çŠ¶æ€å€¼ï¼Œä¹Ÿä¸ä¼šå½±å“æ¸²æŸ“é€»è¾‘ã€‚ä¾‹å¦‚ï¼Œæ‚¨åœ¨æµè§ˆå™¨æ§åˆ¶å°ä¸Šè®°å½•ä¸€ä¸ªæ–‡æœ¬ï¼Œæˆ–è€…åœ¨æµè§ˆå™¨çš„æœ¬åœ°å­˜å‚¨ä¸­å­˜å‚¨ä¸€äº›å†…å®¹ã€‚è¯·æ³¨æ„ï¼Œå…¶ä¸­ä¸€äº›æˆ‘ä»¬å¯ä»¥ä½¿ç”¨`useRef`é’©å­æ¥å®Œæˆï¼Œæˆ‘ä»¬å°†åœ¨ä»¥åçš„æ–‡ç« ä¸­å­¦ä¹ ã€‚

æ‰€ä»¥ï¼Œå‰¯ä½œç”¨æ˜¯æˆ‘ä»¬åº”è¯¥ä»æ¸²æŸ“ä¸­åˆ†ç¦»å‡ºæ¥çš„ã€‚`useEffect`é’©å­é€šè¿‡å°†å®ƒä»æ¸²æŸ“é€»è¾‘ä¸­åˆ†ç¦»å‡ºæ¥æ¥å¸®åŠ©æ‰§è¡Œå‰¯ä½œç”¨ã€‚

```
useEffect(callback, [dependencies]);
```

useEffect æŒ‚é’©æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œ

*   å®šä¹‰å’Œæ¸…é™¤å‰¯ä½œç”¨çš„å›è°ƒå‡½æ•°ã€‚
*   ä¸€ä¸ªå¯é€‰çš„ä¾èµ–æ•°ç»„ï¼Œç¡®ä¿ä½•æ—¶è¿è¡Œå›è°ƒå‡½æ•°ä¸­å®šä¹‰çš„å‰¯ä½œç”¨ã€‚

# useEffect æŒ‚é’©çš„ç”¨æ³•

æˆ‘ä»¬ä¼ é€’ç»™`useEffect`é’©å­çš„å›è°ƒå‡½æ•°è¿è¡Œå‰¯ä½œç”¨ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼ŒReact ä¼šåœ¨ç»„ä»¶çš„æ¯æ¬¡æ¸²æŸ“æ—¶è¿è¡Œå®ƒã€‚ä½†æ˜¯ï¼Œåœ¨æ¯ä¸ªæ¸²æŸ“ä¸Šè¿è¡Œå‰¯ä½œç”¨å¯èƒ½ä¼šéå¸¸æ˜‚è´µï¼Œè€Œä¸”ä¼šå½±å“æ€§èƒ½ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¼ é€’ç»™ useEffect é’©å­çš„ä¾èµ–æ•°ç»„å‚æ•°æ¥æ§åˆ¶å®ƒã€‚

åœ¨è¿™ä¸€èŠ‚ä¸­ï¼Œæˆ‘ä»¬å°†å­¦ä¹  useEffect é’©å­çš„å…­ç§ç”¨æ³•æ¥è¿è¡Œå’Œæ¸…ç†å‰¯ä½œç”¨ã€‚

# 1.å‰¯ä½œç”¨è¿è¡Œ`After Every`æ¸²æŸ“

ç¬¬ä¸€ç§æ˜¯é»˜è®¤æƒ…å†µã€‚å¦‚æœä¸å°†ä¾èµ–æ•°ç»„ä¼ é€’ç»™ useEffect é’©å­ï¼Œå›è°ƒå‡½æ•°å°†åœ¨æ¯æ¬¡æ¸²æŸ“æ—¶æ‰§è¡Œã€‚å› æ­¤`React`ä¼šåœ¨æ¯æ¬¡æ¸²æŸ“åè¿è¡Œå®ƒå®šä¹‰çš„å‰¯ä½œç”¨ã€‚

è¿™ä¸æ˜¯ä¸€ä¸ªç»å¸¸ä½¿ç”¨çš„ç”¨ä¾‹åœºæ™¯ã€‚æˆ‘ä»¬å¯èƒ½æ€»æ˜¯æƒ³æ§åˆ¶å‰¯ä½œç”¨çš„å‘ç”Ÿã€‚

```
useEffect(() => {
  // Side Effect
});
```

# 2.åˆå§‹æ¸²æŸ“åå‰¯ä½œç”¨è¿è¡Œ`Only Once`

æ‚¨å¯èƒ½å¸Œæœ›åœ¨åˆå§‹æ¸²æŸ“ååªè¿è¡Œä¸€æ¬¡å‰¯ä½œç”¨ã€‚å…¸å‹çš„æƒ…å†µæ˜¯è·å–æ•°æ®ï¼Œè¿›è¡Œ API è°ƒç”¨ï¼Œå¹¶åœ¨åˆå§‹å‘ˆç°åå°†å“åº”å­˜å‚¨åœ¨çŠ¶æ€å˜é‡ä¸­ã€‚æ‚¨ä¸æƒ³å†æ¬¡è¿›è¡Œæ­¤ API è°ƒç”¨ã€‚

æ‚¨å¯ä»¥å°†ä¸€ä¸ªç©ºæ•°ç»„ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ä¼ é€’ç»™ useEffect é’©å­æ¥å¤„ç†è¿™ä¸ªç”¨ä¾‹ã€‚

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå‰¯ä½œç”¨ä»…åœ¨ç»„ä»¶çš„åˆå§‹æ¸²æŸ“åè¿è¡Œä¸€æ¬¡ã€‚

```
useEffect(() => {
  // Side Effect
}, []);
```

# 3.`State Value`å˜åŒ–åçš„å‰¯ä½œç”¨

æ‚¨å¯èƒ½éœ€è¦æ ¹æ®çŠ¶æ€å€¼è¿è¡Œå‰¯ä½œç”¨ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯èƒ½ä¼šæœ‰ä¸€ä¸ªå‰¯ä½œç”¨ï¼Œå³æ ¹æ®å£è¯­(è‹±è¯­ã€è¥¿ç­ç‰™è¯­ã€å°åœ°è¯­ã€æ³°ç±³å°”è¯­ç­‰)å‡†å¤‡ä¸€æ¡é—®å€™æ¶ˆæ¯ã€‚).è¿™é‡Œï¼Œå£è¯­å€¼å­˜å‚¨åœ¨ä¸€ä¸ªçŠ¶æ€å˜é‡ä¸­ã€‚

æ¯å½“æˆ‘ä»¬é€‰æ‹©ä¸€ç§å£è¯­ï¼ŒçŠ¶æ€å°±ä¼šæ›´æ–°ã€‚éšç€çŠ¶æ€å€¼çš„æ›´æ–°ï¼Œæ‚¨å¸Œæœ›é‡æ–°åˆ›å»ºé—®å€™æ¶ˆæ¯ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªç”¨ä¾‹ï¼Œæ‚¨å¿…é¡»å°†çŠ¶æ€å˜é‡ä½œä¸ºä¾èµ–æ•°ç»„çš„ä¸€éƒ¨åˆ†ä¼ é€’ç»™ useEffect é’©å­ã€‚

```
useEffect(() => {
  // Side Effect
}, [state]);
```

åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå‰¯ä½œç”¨å°†åœ¨æ¯æ¬¡çŠ¶æ€å˜é‡çš„å€¼æ”¹å˜æ—¶è¿è¡Œã€‚å¦‚æœå¤šä¸ªçŠ¶æ€å˜é‡å½±å“å‰¯ä½œç”¨ï¼Œå¯ä»¥åœ¨ä¾èµ–æ•°ç»„ä¸­ä»¥é€—å·åˆ†éš”çš„å½¢å¼ä¼ é€’å®ƒä»¬ã€‚

```
useEffect(() => {
  // Side Effect
}, [state1, state2, state3]);
```

# 4.`Props Value`æ”¹å˜åå‰¯ä½œç”¨è¿è¡Œ

å°±åƒçŠ¶æ€ä¸€æ ·ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠé“å…·ä½œä¸ºä¾èµ–æ¥è¿è¡Œå‰¯ä½œç”¨ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ¯å½“ä½œä¸ºä¾èµ–é¡¹ä¼ é€’çš„é“å…·å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå‰¯ä½œç”¨å°±ä¼šè¿è¡Œã€‚

æ‚¨å¯ä»¥åƒå‰é¢çš„ä¾‹å­ä¸€æ ·ï¼Œä»¥é€—å·åˆ†éš”çš„ä¾èµ–å…³ç³»æ¥ä¼ é€’å¤šä¸ªå±æ€§ã€‚

```
useEffect(() => {
  // Side Effect
}, [props]);
```

# 5.`Props and State Value`æ”¹å˜åå‰¯ä½œç”¨è¿è¡Œ

å¦‚æœæ‚¨éœ€è¦åœ¨æ¯æ¬¡çŠ¶æ€å’Œé“å…·ç»„åˆå‘ç”Ÿå˜åŒ–æ—¶è¿è¡Œå‰¯ä½œç”¨ï¼Œè¯¥æ€ä¹ˆåŠï¼Ÿå½“å‰¯ä½œç”¨å–å†³äºçŠ¶æ€å’Œé“å…·å€¼æ—¶ï¼Œå¯èƒ½ä¼šå‡ºç°è¿™ç§ç”¨ä¾‹ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæ‚¨éœ€è¦å°† state å’Œ props å˜é‡ä½œä¸ºä¾èµ–é¡¹ä¼ é€’ã€‚

```
useEffect(() => {
  // Side Effect
}, [props, state]);
```

# 6.å‰¯ä½œç”¨`Cleanup`

åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»çœ‹åˆ°äº†å¦‚ä½•ä»¥åŠä½•æ—¶è¿è¡Œå‰¯ä½œç”¨ã€‚åŒæ ·é‡è¦çš„æ˜¯ï¼Œæˆ‘ä»¬è¦æ¸…ç†æ‰å½±å“åº”ç”¨ç¨‹åºæ€§èƒ½çš„å‰¯ä½œç”¨ã€‚æ¯ä¸ªå‰¯ä½œç”¨éƒ½ä¸ä¸€æ ·ã€‚å› æ­¤ï¼Œå‰¯ä½œç”¨çš„æ¸…é™¤ç­–ç•¥ä¼šæœ‰æ‰€ä¸åŒã€‚

ä¾‹å¦‚ï¼Œå¦‚æœä½¿ç”¨`setTimeout`å‡½æ•°è¿è¡Œå®šæ—¶å™¨æœ‰å‰¯ä½œç”¨ï¼Œå°±éœ€è¦é€šè¿‡è°ƒç”¨`clearTimeout`å‡½æ•°æ¥æ¸…é™¤å®ƒã€‚ä½†æ˜¯æˆ‘ä»¬æ€ä¹ˆåšå‘¢ï¼Ÿ

ä¸ºäº†æ¸…ç†å‰¯ä½œç”¨ï¼Œæ‚¨éœ€è¦ä»æˆ‘ä»¬ä¼ é€’ç»™ useEffect é’©å­çš„å›è°ƒå‡½æ•°ä¸­è¿”å›ä¸€ä¸ªå‡½æ•°ã€‚æ‚¨å¿…é¡»å°†å‰¯ä½œç”¨æ¸…é™¤é€»è¾‘æ”¾åœ¨è¿”å›çš„å‡½æ•°ä¸­ã€‚

```
useEffect(() => {
  // Side Effectreturn () => {
    // Side Effect Cleanup
  }
}[props, state]);
```

æœ‰å‡ ç‚¹éœ€è¦æ³¨æ„ï¼Œ

*   æ¯æ¬¡åˆå§‹æ¸²æŸ“åéƒ½ä¼šè°ƒç”¨æ¸…ç†åŠŸèƒ½æ¥æ¸…ç†ä¹‹å‰çš„å‰¯ä½œç”¨ï¼Œç„¶åè¿è¡Œåç»­çš„å‰¯ä½œç”¨ã€‚
*   å½“ç»„ä»¶å¸è½½æ—¶ï¼Œcleanup å‡½æ•°è¢«è°ƒç”¨ã€‚

# ç»“è®º

ä»¥ä¸Šå°±æ˜¯å…³äº`useEffect`é’©å­çš„ç”¨æ³•ã€‚æˆ‘å¸Œæœ›è¿™ç¯‡æ–‡ç« å¯¹ä½ æœ‰æ‰€å¸®åŠ©ã€‚

ä½†æ˜¯ç­‰ç­‰ï¼Œè¿˜æ²¡å®Œï¼ŒçœŸçš„ï¼å¦‚æœä½ æƒ³é€šè¿‡åŠ¨æ‰‹é¡¹ç›®ç»§ç»­äº†è§£å®ƒï¼Œæˆ‘ä¼šæŠŠè¿™ä¸ª YouTube è§†é¢‘æ•™ç¨‹ç•™ç»™ä½ ã€‚æˆ‘å¸Œæœ›ä½ ä¹Ÿå–œæ¬¢å®ƒã€‚

*è¯·* [*è®¢é˜…*](https://www.youtube.com/tapasadhikary?sub_confirmation=1) *æœªæ¥å†…å®¹*ğŸ”¥ğŸ”¥ğŸ”¥

# åœ¨æˆ‘ä»¬ç»“æŸä¹‹å‰â€¦

æˆ‘åˆ†äº«æˆ‘çš„çŸ¥è¯†ï¼Œ

*   ğŸŒWeb å¼€å‘(JavaScriptã€ReactJSã€Next.jsã€Node.js ç­‰ç­‰â€¦â€¦)
*   ğŸ›¡ï¸ç½‘ç»œå®‰å…¨å…¬å¸
*   ğŸ’¼èŒä¸šå‘å±•
*   ğŸŒ±å¼€æº
*   âœï¸å†…å®¹åˆ›ä½œ

è®©æˆ‘ä»¬è¿æ¥èµ·æ¥ï¼Œ

*   [åœ¨ Twitter ä¸Šå…³æ³¨](https://twitter.com/tapasadhikary)
*   [è®¢é˜…æˆ‘çš„ YouTube é¢‘é“](https://www.youtube.com/tapasadhikary?sub_confirmation=1)
*   [GitHub ä¸Šçš„ä¾§é¡¹ç›®](https://github.com/atapas)
*   [Showwcase React ç¤¾åŒº](https://www.showwcase.com/community/react.js)

*åŸè½½äº*[*https://blog . greenroots . info*](https://blog.greenroots.info/react-useeffect-hook-usages-you-must-know)*ã€‚*

*æ›´å¤šå†…å®¹è¯·çœ‹*[***plain English . io***](https://plainenglish.io/)*ã€‚æŠ¥åå‚åŠ æˆ‘ä»¬çš„* [***å…è´¹å‘¨æŠ¥***](http://newsletter.plainenglish.io/) *ã€‚å…³æ³¨æˆ‘ä»¬å…³äº*[***Twitter***](https://twitter.com/inPlainEngHQ)*å’Œ**[***LinkedIn***](https://www.linkedin.com/company/inplainenglish/)*ã€‚åŠ å…¥æˆ‘ä»¬çš„* [***ç¤¾åŒº***](https://discord.gg/GtDtUAvyhW) *ã€‚**