<html>
<head>
<title>Get WordPress REST API Finally Ready to Work with Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">让WordPress REST API最终准备好使用Node.js</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/getting-wordpress-rest-api-finally-ready-to-work-with-nodejs-10e54fc3101a?source=collection_archive---------1-----------------------#2022-05-29">https://javascript.plainenglish.io/getting-wordpress-rest-api-finally-ready-to-work-with-nodejs-10e54fc3101a?source=collection_archive---------1-----------------------#2022-05-29</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="0b85" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">如何让WordPress REST API使用Node.js的教程</h2></div><p id="0706" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在谷歌中获得成千上万的结果是一件很棒的事情，但是当你找到的帖子过时时，情况就变得更加复杂了。最近，当我试图让我的Node.js应用程序与WP REST API一起工作时，我就遇到了这种情况。我希望这个帖子不会太快过时，你会发现它很有帮助。</p><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="gh gi ky"><img src="../Images/befd2af674e871f5781f29d5fc42fedd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*rqZ6suimSdLrlrJ9c2LRcw.png"/></div></div></figure><p id="32a1" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我的任务很简单——创建一个WordPress网站，并使用Node.js添加一个新帖子。</p><p id="0253" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="ke io">当前形势</strong></p><p id="9583" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我是在WP 6.0出来几天后写的这个帖子。我知道它从5.6开始对REST API有很好的支持，所以集成应该相对容易。在5.6 WordPress团队增加了一个内置的应用程序密码选项，所以我决定不再使用<strong class="ke io">和第三方插件进行认证。此外，我使用基本的节点获取来做一个POST请求，<strong class="ke io">，没有来自npm </strong>的任何类型的WP集成包。</strong></p><h2 id="fecc" class="lk ll in bd lm ln lo dn lp lq lr dp ls kl lt lu lv kp lw lx ly kt lz ma mb mc bi translated"><strong class="ak"> WordPress安装和配置</strong></h2><p id="199f" class="pw-post-body-paragraph kc kd in ke b kf md jo kh ki me jr kk kl mf kn ko kp mg kr ks kt mh kv kw kx ig bi translated">首先，我们需要一个WP实例和SSL证书。</p><p id="67f1" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="mi">如果没有SSL，您的网络或您的站点与授权应用程序之间的网络上的攻击者可能会看到应用程序密码。<br/></em><a class="ae mj" href="https://make.wordpress.org/core/2020/11/05/application-passwords-integration-guide/" rel="noopener ugc nofollow" target="_blank"><em class="mi">https://make . WordPress . org/core/2020/11/05/application-passwords-integration-guide/</em></a></p><p id="10f0" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">无SSL应用程序密码选项被禁用。当SSL准备就绪，我们的网站在HTTPS提供服务时，我们可以在Users部分创建一个新的应用程序密码(为此我将使用“AP”)。</p><p id="e70c" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">首先，什么是AP？这是一个仅为REST请求创建的密码。它可以有自己的名字，可以随时删除。它可以在不泄露你真实的WordPress凭证的情况下使用。</p><figure class="kz la lb lc gt ld gh gi paragraph-image"><div role="button" tabindex="0" class="le lf di lg bf lh"><div class="gh gi mk"><img src="../Images/e7045acf0560213df68cfd95a4094712.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*SpKDBgrXdBbmHJdBfavLeQ.png"/></div></div></figure><p id="e019" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这是第一个误导部分。您在一个特定的用户配置文件下创建一个新的AP——在我的例子中是admin，并为它命名。几个小时以来，我一直认为这个名称和生成的密码是我的API请求的新凭证。不幸的是，密码的名称只针对您，它在REST请求中不起任何作用。</p><p id="f21e" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">您将在请求中使用的登录名是您的主要WordPress登录名，而不是提供的密码名称。</p><p id="20cb" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这是你在WordPress仪表盘中唯一需要做的事情。我发现了这么多过时的资源，其中提到我必须编辑的。htaccess文件或者安装<a class="ae mj" href="https://github.com/WP-API/Basic-Auth" rel="noopener ugc nofollow" target="_blank">基本认证</a>插件(很久没更新了)或者其他一些第三方插件。<br/>不，对于基本认证，您只需要一个SSL和一个AP。</p><h2 id="1922" class="lk ll in bd lm ln lo dn lp lq lr dp ls kl lt lu lv kp lw lx ly kt lz ma mb mc bi translated"><strong class="ak"> Node.js </strong></h2><p id="8886" class="pw-post-body-paragraph kc kd in ke b kf md jo kh ki me jr kk kl mf kn ko kp mg kr ks kt mh kv kw kx ig bi translated">在这里你也不需要太多。如果你有最新的Node.js，你甚至不需要安装<a class="ae mj" href="https://www.npmjs.com/package/node-fetch" rel="noopener ugc nofollow" target="_blank">取节点</a>，因为它已经内置了<a class="ae mj" href="https://blog.logrocket.com/fetch-api-node-js/" rel="noopener ugc nofollow" target="_blank"/></p><p id="a4aa" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">您的所有请求URL都以下列开头:</p><pre class="kz la lb lc gt ml mm mn mo aw mp bi"><span id="496f" class="lk ll in mm b gy mq mr l ms mt"><a class="ae mj" href="https://your-website/wp-json" rel="noopener ugc nofollow" target="_blank">https://your-website/wp-json</a></span></pre><p id="3ff3" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">你可以在<a class="ae mj" href="https://developer.wordpress.org/rest-api/reference/" rel="noopener ugc nofollow" target="_blank">文档</a>中了解更多。</p><p id="c8cf" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">安装node-fetch并将其导入文件后，我创建新帖子的代码如下所示:</p><figure class="kz la lb lc gt ld"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="5f9b" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">您将收到创建的帖子详细信息作为回应。您可以将它全部包装在try/catch块中。</p><p id="31f9" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这里需要记住几件事:</p><ol class=""><li id="1aa2" class="mw mx in ke b kf kg ki kj kl my kp mz kt na kx nb nc nd ne bi translated">您的WP端点必须是HTTPS。</li><li id="df55" class="mw mx in ke b kf nf ki ng kl nh kp ni kt nj kx nb nc nd ne bi translated">请求的主体必须与内容类型相匹配</li><li id="2cde" class="mw mx in ke b kf nf ki ng kl nh kp ni kt nj kx nb nc nd ne bi translated">我对登录和密码使用缓冲区，因为我认为这是最可靠的处理方式。</li></ol><p id="cbc8" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">以下是获取所有帖子的方法:</p><figure class="kz la lb lc gt ld"><div class="bz fp l di"><div class="mu mv l"/></div></figure><h2 id="fe67" class="lk ll in bd lm ln lo dn lp lq lr dp ls kl lt lu lv kp lw lx ly kt lz ma mb mc bi translated"><strong class="ak">结论</strong></h2><p id="d8b0" class="pw-post-body-paragraph kc kd in ke b kf md jo kh ki me jr kk kl mf kn ko kp mg kr ks kt mh kv kw kx ig bi translated">我不想使用<a class="ae mj" href="https://github.com/wp-api/node-wpapi" rel="noopener ugc nofollow" target="_blank"> node-wp-api </a>,因为它将来可能不适合我——与WooComerce和ACF集成。我想要纯粹的WP和JS体验。</p><p id="737c" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">有了当前版本的WordPress和Node.js，即使没有额外的js框架，建立连接也是非常容易的。</p><p id="215d" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">由于WordPress和Node.js最近的变化，StackOverflow上的许多主题已经过时了。</p><p id="47ca" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">编码快乐！</p><p id="e26e" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="mi">更多内容看</em> <a class="ae mj" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io"> <em class="mi">说白了。报名参加我们的</em> <a class="ae mj" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io"> <em class="mi">免费周报</em> </strong> </a> <em class="mi">。关注我们</em><a class="ae mj" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="ke io"><em class="mi">Twitter</em></strong></a><em class="mi">和</em><a class="ae mj" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="ke io"><em class="mi">LinkedIn</em></strong></a><em class="mi">。查看我们的</em> <a class="ae mj" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io"> <em class="mi">社区不和谐</em> </strong> </a> <em class="mi">加入我们的</em> <a class="ae mj" href="https://inplainenglish.pallet.com/talent/welcome" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io"> <em class="mi">人才集体</em> </strong> </a> <em class="mi">。</em></strong></a></p></div></div>    
</body>
</html>