<html>
<head>
<title>4 High-Quality Custom React Hooks</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">4个高品质定制反应挂钩</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/with-5-high-quality-react-custom-hooks-i-got-promoted-eafe77684ca8?source=collection_archive---------10-----------------------#2022-09-12">https://javascript.plainenglish.io/with-5-high-quality-react-custom-hooks-i-got-promoted-eafe77684ca8?source=collection_archive---------10-----------------------#2022-09-12</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="fb2b" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">下面是这4个React钩子如何不可思议地解放了我的生产力。我希望这能帮助你赚更多的钱。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/5be3213b280beabf7a1162356ab028a2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*1ZrA7lk0u7YD6AyQ"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@alexandermils?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Alexander Mils</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="0be6" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">什么是自定义挂钩</h1><p id="7abf" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated"><em class="mk">钩子是React 16.8中的新增功能。它们允许您使用状态和其他React特性，而无需编写类。</em></p><p id="f9e8" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">有了自定义钩子，组件逻辑可以提取到可重用的函数中，我将根据实际使用场景列出这4个高质量的钩子。</p><h2 id="5e9b" class="mq kx iq bd ky mr ms dn lc mt mu dp lg lx mv mw li mb mx my lk mf mz na lm nb bi translated">通过这篇文章，你可以了解到</h2><ul class=""><li id="7e12" class="nc nd iq lq b lr ls lu lv lx ne mb nf mf ng mj nh ni nj nk bi translated">如何在不担心内存的情况下合理地请求数据</li><li id="f030" class="nc nd iq lq b lr nl lu nm lx nn mb no mf np mj nh ni nj nk bi translated">钩子形式的DOM滚动的高性能监控</li><li id="fa1a" class="nc nd iq lq b lr nl lu nm lx nn mb no mf np mj nh ni nj nk bi translated">告别样板意大利面代码，快速实现元素悬停的效果</li><li id="3b00" class="nc nd iq lq b lr nl lu nm lx nn mb no mf np mj nh ni nj nk bi translated">快速创建高性能的动画弹出窗口，包括钩子、吐司和工具提示等。</li></ul><h1 id="6442" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">1.使用安全状态</h1><p id="a1ec" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">如果你在你的React应用程序中看到这个错误，请举手，✋:</p><p id="0b70" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated"><em class="mk">警告:无法在卸载的组件上调用setState(或forceUpdate)。这是不可行的，但它表明您的应用程序中存在内存泄漏。<br/>要解决这个问题，请取消componentWillUnmount方法中的所有订阅和异步任务。</em></p><p id="cffd" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">为什么会出现这个问题？</p><p id="0615" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">当您发出一个<strong class="lq ir">异步数据请求，但是组件已经被卸载</strong>时，这个错误经常发生。例如，应用程序中的一些逻辑告诉React远离组件。</p><p id="2e43" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">您仍然有一个针对远程数据的<strong class="lq ir">未决请求</strong>，但是当数据到达并修改组件状态时，应用程序已经呈现了一个不同的组件。</p><p id="4a1e" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">嗯，怎么解决？</p><p id="d918" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">有一个解决方案并不完美:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="c083" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">严格来说，你<strong class="lq ir">没有取消你的数据获取请求</strong>。变通办法检查组件是否已安装。如果组件没有安装，它会避免调用<code class="fe ns nt nu nv b">setState</code>。但是网络请求仍然有效。</p><h2 id="74e4" class="mq kx iq bd ky mr ms dn lc mt mu dp lg lx mv mw li mb mx my lk mf mz na lm nb bi translated">胡克溶液</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="38cd" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">怎么用？</p><p id="fa09" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">跟我们一样，<code class="fe ns nt nu nv b">useState</code>用法是一样的，但是组件卸载后，<code class="fe ns nt nu nv b">setState</code>将不再执行异步回调，避免组件卸载后更新状态导致内存泄漏。</p><h1 id="f7ab" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">2.使用IntersectionObserver</h1><p id="b67a" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">这个钩子是基于<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/API/IntersectionObserver" rel="noopener ugc nofollow" target="_blank">intersect observer</a>实现的，你可以在<a class="ae kv" href="https://developer.mozilla.org/en-US/docs/Web/API/IntersectionObserver" rel="noopener ugc nofollow" target="_blank"> MDN </a>上找到更多intersect observer配置。</p><p id="be11" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">如果元素在窗口中可见，则返回true，并且只执行一次。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nq nr l"/></div></figure><h2 id="ec73" class="mq kx iq bd ky mr ms dn lc mt mu dp lg lx mv mw li mb mx my lk mf mz na lm nb bi translated">真实场景</h2><p id="53fc" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">有一个要求是，当屏幕滑动到底部某个元素时，我需要传递一些参数给服务器，以便更好地分析用户的产品使用情况，所以此时你可以使用这个钩子。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="0975" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">完了！使用方法很简单，没有问题！:)</p><h1 id="fb35" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">3.使用悬停</h1><p id="f83e" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">这是一个我们经常使用的钩子，所以你不必写同样的<code class="fe ns nt nu nv b">mouseenter</code>、<code class="fe ns nt nu nv b">mouseleave</code>和<code class="fe ns nt nu nv b">debounce</code>。</p><p id="9e41" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">首先，您需要一个<code class="fe ns nt nu nv b">useEventListener</code>钩子来快速注册和销毁事件:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="b746" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">然后，在<code class="fe ns nt nu nv b">useHover</code>中，写鼠标进入和鼠标离开事件，它将返回一个<code class="fe ns nt nu nv b">Boolean</code>值:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="23f1" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">怎么用？</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nw nr l"/></div></figure><h1 id="e497" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">4.useDelayUnmount</h1><p id="8a3c" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">嗯，你的项目里有以下动画吗？</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nx"><img src="../Images/e274d74160a1516ba6cd7559011e2460.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*zIXuIH3arViT3n49B00Hsw.gif"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">A modal, but no leaving the animation</figcaption></figure><p id="bbf8" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">首先，这个弹窗可以正常使用，有淡入效果，这是好的，但是从视觉层面来说，这个弹窗似乎缺少一种淡出动画效果。这是因为用户体验会更好，所以我们试着用hook来改造一下:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nq nr l"/></div></figure><p id="9c39" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">太神奇了！代码很简单，让我们制作一个完整的高性能的带渐隐的弹出窗口。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nw nr l"/></div></figure><p id="1f7f" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">太好了！它看起来好多了，我们用最短的可能的方式来完成一个用户体验指标。</p><p id="94a3" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated">值得一提的是，react UI库现在支持完整的高性能动画(组件被卸载)，这是一个好消息。</p></div><div class="ab cl ny nz hu oa" role="separator"><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od oe"/><span class="ob bw bk oc od"/></div><div class="ij ik il im in"><p id="8514" class="pw-post-body-paragraph lo lp iq lq b lr ml jr lt lu mm ju lw lx mn lz ma mb mo md me mf mp mh mi mj ij bi translated"><em class="mk">更多内容看</em> <a class="ae kv" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="lq ir"> <em class="mk">说白了就是io </em> </strong> </a> <em class="mk">。报名参加我们的</em> <a class="ae kv" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="lq ir"> <em class="mk">免费周报</em> </strong> </a> <em class="mk">。关注我们关于</em> <a class="ae kv" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"> <strong class="lq ir"> <em class="mk">推特</em> </strong> </a>，<a class="ae kv" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"> <strong class="lq ir"> <em class="mk">领英</em> </strong> </a> <em class="mk">，</em><a class="ae kv" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"><strong class="lq ir"><em class="mk">YouTube</em></strong></a><em class="mk"/><a class="ae kv" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"><strong class="lq ir"><em class="mk">不和</em> </strong> </a> <em class="mk">。对增长黑客感兴趣？检查</em> <a class="ae kv" href="https://circuit.ooo/" rel="noopener ugc nofollow" target="_blank"> <strong class="lq ir"> <em class="mk">电路</em> </strong> </a> <em class="mk">。</em></p></div></div>    
</body>
</html>