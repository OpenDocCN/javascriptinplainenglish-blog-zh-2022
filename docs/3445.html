<html>
<head>
<title>Building A Beautiful Link Preview With Web Components</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Web组件构建漂亮的链接预览</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/building-a-beautiful-link-preview-with-web-components-bfbf7af71be4?source=collection_archive---------2-----------------------#2022-08-29">https://javascript.plainenglish.io/building-a-beautiful-link-preview-with-web-components-bfbf7af71be4?source=collection_archive---------2-----------------------#2022-08-29</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="3688" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">从URL获取打开的图形数据以显示缩略图预览</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/7304e97886b697f2856b6a29ccd1da2a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZKEBdcwrjef7hgkv9lx0vw.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Web Highlights Link Preview Component</figcaption></figure><p id="e56e" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="lr">本文原载于</em> <a class="ae ls" href="https://web-highlights.com/blog/" rel="noopener ugc nofollow" target="_blank"> <em class="lr">网集锦博客</em> </a> <em class="lr">。你可以在这里找到</em><a class="ae ls" href="https://web-highlights.com/blog/building-a-beautiful-link-preview-with-web-components/" rel="noopener ugc nofollow" target="_blank"><em class="lr"/></a><em class="lr">。</em></p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><p id="b4b6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">最近，我改进了我的<a class="ae ls" href="https://web-highlights.com/" rel="noopener ugc nofollow" target="_blank"> Web Highlights </a>应用仪表板的设计，为每个高亮页面显示一个链接预览。这是新设计的样子:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ma"><img src="../Images/1f460e1ba62480e0e28743fb1897fd06.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*1PKEfbejvmunHMQk3rCvUQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk"><a class="ae ls" href="http://web-highlights.com/" rel="noopener ugc nofollow" target="_blank">Web Highlights</a><strong class="bd mb"> </strong>dashboard</figcaption></figure><p id="261b" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在这篇文章中，我想分享如何创建这样一个链接预览组件，并使网页出现缩略图。</p><p id="8be8" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">如果你关注我的文章，你可能会知道我是Web组件的忠实粉丝。所以，当然，我也用Web组件构建了这个组件。</p><p id="7477" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">出于几个原因:</p><ul class=""><li id="90eb" class="mc md iq kx b ky kz lb lc le me li mf lm mg lq mh mi mj mk bi translated">我可以在Vue.js web应用程序以及基于web组件的Chrome扩展中使用该组件。</li><li id="9e24" class="mc md iq kx b ky ml lb mm le mn li mo lm mp lq mh mi mj mk bi translated">架构封装得更好</li><li id="5887" class="mc md iq kx b ky ml lb mm le mn li mo lm mp lq mh mi mj mk bi translated">任何人都可以重用该组件</li></ul><p id="7648" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">假设你还没有被说服。嵌入应用程序就像在您的web应用程序中包含这几行代码一样简单:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="6c41" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">你可以在这里找到一个<a class="ae ls" href="https://web-highlights.github.io/webhighlights-link-preview/" rel="noopener ugc nofollow" target="_blank">的演示。这里还有一个</a><a class="ae ls" href="https://codepen.io/marius2502/pen/zYWyPxe" rel="noopener ugc nofollow" target="_blank">代码笔</a>展示了在任何地方使用链接预览是多么容易:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="ms mr l"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">CodePen: Web Highlights Link Preview</figcaption></figure></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="e43b" class="mt mu iq bd mv mw mx my mz na nb nc nd jw ne jx nf jz ng ka nh kc ni kd nj nk bi translated">前端</h1><p id="4640" class="pw-post-body-paragraph kv kw iq kx b ky nl jr la lb nm ju ld le nn lg lh li no lk ll lm np lo lp lq ij bi translated">对于组件的设计，我遵循了一个普通的中等做。预览卡包含标题、描述、链接和预览图像。以下是缩略图预览组件的外观:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nq"><img src="../Images/efd3afd15106ab8f8199aa659365fb64.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*f6To7VWIueY7Rtcrg05S6A.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Link Preview Component</figcaption></figure><p id="f897" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">此外，当从我们的API获取开放图形数据时，该组件显示了一些<strong class="kx ir">加载</strong>指示器，我们将在后面介绍。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/f2163187a7831e03a02afa64755cf37c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1276/1*5_drQ4Yo8J6Yf5GWte_4yQ.gif"/></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Link Preview Component loading state</figcaption></figure><p id="3e19" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在本文中，我不会详细讨论CSS实现。但是你可以在这里找到Github库。请随意查看。</p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h2 id="5b30" class="ns mu iq bd mv nt nu dn mz nv nw dp nd le nx ny nf li nz oa nh lm ob oc nj od bi translated">构建Web组件</h2><p id="d658" class="pw-post-body-paragraph kv kw iq kx b ky nl jr la lb nm ju ld le nn lg lh li no lk ll lm np lo lp lq ij bi translated">为了构建这个web组件，我创建了定制元素<code class="fe oe of og oh b">webhighlights-link-preview</code>。为了让开发更容易，我使用了谷歌的Lit库。</p><p id="d87d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们通过使用Lit的<code class="fe oe of og oh b">customElement</code> decorator创建我们的定制元素，并提供一些反应性属性，使我们的元素可由客户端定制:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="0d86" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">客户端必须提供一个<code class="fe oe of og oh b">url</code>,我们将从我们的API中获取开放图形数据。此外，如果您想使用不同的API，可以提供一个替代的<code class="fe oe of og oh b">apiUrl</code> URL。</p><p id="f3b4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">并非每个网站都提供开放图形元数据标签，以便在我们找不到给定URL的<strong class="kx ir">标题</strong>、<strong class="kx ir">描述</strong>或<strong class="kx ir">图像</strong>时，客户端可以提供一些后备数据。</p><p id="fbc6" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">此外，我们需要一个reactive属性来存储获取的相应URL的元数据:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="b59a" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><code class="fe oe of og oh b">OpenGraphMetaData</code>接口定义了我们期望从API获得的对象。看起来是这样的:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="5bc5" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">因此，如果您想创建自己的API，您需要让您的服务器响应适应这个<code class="fe oe of og oh b">OpenGraphMetaData</code>接口，并在components <code class="fe oe of og oh b">apiUrl</code>属性中提供端点的URL。</p><p id="4b00" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">此外，我们需要知道组件是否应该显示文本加载指示器。在这种情况下，只要我们的<code class="fe oe of og oh b">metaData</code>属性是<code class="fe oe of og oh b">undefined</code>，我们就想显示它。为了在模板中检查这一点，我们创建了一个简单的getter:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="69dc" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在，在模板中，我们可以有条件地添加一些CSS类，使我们的组件显示一个加载状态，这取决于<code class="fe oe of og oh b">metaData</code>是仍在从服务器获取还是已经被加载:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="45c5" class="mt mu iq bd mv mw mx my mz na nb nc nd jw ne jx nf jz ng ka nh kc ni kd nj nk bi translated"><strong class="ak">获取打开的图形数据</strong></h1><p id="248f" class="pw-post-body-paragraph kv kw iq kx b ky nl jr la lb nm ju ld le nn lg lh li no lk ll lm np lo lp lq ij bi translated">为了获得预览所需的所有数据，我们必须从相应的URL中获取Open Graph元数据标签。如果您不熟悉开放图协议，您应该先看看这篇文章:</p><div class="oi oj gp gr ok ol"><a href="https://web-highlights.com/blog/turn-your-website-into-a-beautiful-thumbnail-link-preview/" rel="noopener  ugc nofollow" target="_blank"><div class="om ab fo"><div class="on ab oo cl cj op"><h2 class="bd ir gy z fp oq fr fs or fu fw ip bi translated">让你的网站有一个漂亮的缩略图链接预览</h2><div class="os l"><h3 class="bd b gy z fp oq fr fs or fu fw dk translated">理解并应用开放图协议到你的网站。最近，我试图找出如何使链接…</h3></div><div class="ot l"><p class="bd b dl z fp oq fr fs or fu fw dk translated">web-highlights.com</p></div></div><div class="ou l"><div class="ov l ow ox oy ou oz kp ol"/></div></div></a></div><p id="6563" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">使用像<a class="ae ls" href="https://www.opengraph.io/" rel="noopener ugc nofollow" target="_blank"> OpenGraph.io </a>这样的API可以获得必要的数据。使用这样的API，我们不需要创建服务器来获取数据。不幸的是，大多数API的请求数量有限。例如，OpenGraph.io将其限制为100个请求。</p><p id="4e4d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">由于我不想为获取开放图形数据支付任何费用，所以我创建了一个简单的Netlify函数，使用开源的<strong class="kx ir"> openGraphScraper </strong>库获取开放图形数据。这个库是一个简单的节点模块，用于抓取任何网站的开放图形。</p><p id="9730" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">在生产中，我为我的<a class="ae ls" href="http://web-highlights.com/" rel="noopener ugc nofollow" target="_blank"> Web Highlights </a>应用程序使用普通的服务器环境，因为我还想提供一些服务器端缓存来减少加载时间。但是，对于这个例子，一个简单的Netlify函数应该就可以了。</p><p id="ef58" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我们可以通过从库中导入<code class="fe oe of og oh b">ogs</code>对象来获得任何URL的开放图形数据:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="2bc4" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">然后像这样获取数据:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="22e2" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">之后，我们通过使用适配器函数将接收到的<code class="fe oe of og oh b">SuccessResult</code>接口适配到我们期望的<code class="fe oe of og oh b">OpenGrapgMetaData</code>接口:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="c407" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">下面是Netlify处理程序的样子:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure><p id="071d" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">现在，在我们的前端，我们可以通过从端点获取所需的元数据:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mq mr l"/></div></figure></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="7ab5" class="mt mu iq bd mv mw mx my mz na nb nc nd jw ne jx nf jz ng ka nh kc ni kd nj nk bi translated">最后的想法</h1><p id="376a" class="pw-post-body-paragraph kv kw iq kx b ky nl jr la lb nm ju ld le nn lg lh li no lk ll lm np lo lp lq ij bi translated">感谢阅读这篇文章。我希望你能按照我的建议来构建你自己的链接预览组件，或者重用我们在这里创建的组件。请注意，我不能保证所提供的Netlifiy API将永远可用。因此，如果您计划在生产中使用该组件，请确保提供您自己的端点。</p><p id="476f" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">我总是乐于回答问题，并乐于接受批评。随时欢迎联系我！通过<strong class="kx ir"/><a class="ae ls" href="https://www.linkedin.com/in/marius-bongarts-6b3638171/" rel="noopener ugc nofollow" target="_blank"><strong class="kx ir">LinkedIn</strong></a><strong class="kx ir">，</strong>关注我<strong class="kx ir"/><a class="ae ls" href="https://twitter.com/MariusBongarts" rel="noopener ugc nofollow" target="_blank"><strong class="kx ir">Twitter</strong></a>或<a class="ae ls" href="https://medium.com/subscribe/@mariusbongarts" rel="noopener"> <strong class="kx ir">订阅</strong> </a>通过电子邮件获取我的故事。</p><p id="f2a0" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><a class="ae ls" href="https://medium.com/@mariusbongarts/membership" rel="noopener"> <strong class="kx ir">这里是无限制访问媒体上每一个内容的链接</strong> </a> <strong class="kx ir">。如果你使用这个链接注册，我会赚一小笔钱，不需要你额外付费。</strong></p><div class="oi oj gp gr ok ol"><a href="https://medium.com/@mariusbongarts/membership" rel="noopener follow" target="_blank"><div class="om ab fo"><div class="on ab oo cl cj op"><h2 class="bd ir gy z fp oq fr fs or fu fw ip bi translated">通过我的推荐链接加入Medium-Marius bong arts</h2><div class="os l"><h3 class="bd b gy z fp oq fr fs or fu fw dk translated">作为一个媒体会员，你的会员费的一部分会给你阅读的作家，你可以完全接触到每一个故事…</h3></div><div class="ot l"><p class="bd b dl z fp oq fr fs or fu fw dk translated">medium.com</p></div></div><div class="ou l"><div class="pa l ow ox oy ou oz kp ol"/></div></div></a></div></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><h1 id="edb0" class="mt mu iq bd mv mw mx my mz na nb nc nd jw ne jx nf jz ng ka nh kc ni kd nj nk bi translated">关于作者</h1><p id="206e" class="pw-post-body-paragraph kv kw iq kx b ky nl jr la lb nm ju ld le nn lg lh li no lk ll lm np lo lp lq ij bi translated">我是埃森哲软件工程分析师宋。最驱动我的是我想创造一些可能对他人有帮助并改变他人生活的东西的冲动。</p><p id="89ea" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated">比如你是否厌倦了浏览自己的历史来寻找前几天看到的信息？我的<a class="ae ls" href="https://chrome.google.com/webstore/detail/web-highlights-%20-bookmark/hldjnlbobkdkghfidgoecgmklcemanhm" rel="noopener ugc nofollow" target="_blank"> <strong class="kx ir">网站重点介绍Chrome扩展</strong> </a>覆盖了你，并将通过以结构化和高效的方式组织你的研究来提高你的生产力。就像你在书和文章上做的那样，突出显示任何网页或PDF上的文本。你的精彩片段会直接同步到web-highlights.com<a class="ae ls" href="https://web-highlights.com/" rel="noopener ugc nofollow" target="_blank">的网络应用上，你可以在任何地方找到它们。</a></p></div><div class="ab cl lt lu hu lv" role="separator"><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly lz"/><span class="lw bw bk lx ly"/></div><div class="ij ik il im in"><p id="7e61" class="pw-post-body-paragraph kv kw iq kx b ky kz jr la lb lc ju ld le lf lg lh li lj lk ll lm ln lo lp lq ij bi translated"><em class="lr">更多内容看</em> <a class="ae ls" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kx ir"> <em class="lr">说白了就是io </em> </strong> </a> <em class="lr">。报名参加我们的</em> <a class="ae ls" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kx ir"> <em class="lr">免费周报</em> </strong> </a> <em class="lr">。关注我们关于</em> <a class="ae ls" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"> <strong class="kx ir"> <em class="lr">推特</em> </strong> </a>，<a class="ae ls" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"> <strong class="kx ir"> <em class="lr">领英</em> </strong> </a> <em class="lr">，</em><a class="ae ls" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"><strong class="kx ir"><em class="lr">YouTube</em></strong></a><em class="lr"/><a class="ae ls" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"><strong class="kx ir"><em class="lr">不和</em> </strong> </a> <em class="lr">。</em></p></div></div>    
</body>
</html>