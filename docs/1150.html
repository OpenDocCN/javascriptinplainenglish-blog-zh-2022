<html>
<head>
<title>JavaScript Promises: Understanding Promise.all()</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript Promises:了解Promise.all()</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/javascript-promises-understanding-promise-all-c6a126d02e86?source=collection_archive---------5-----------------------#2022-03-06">https://javascript.plainenglish.io/javascript-promises-understanding-promise-all-c6a126d02e86?source=collection_archive---------5-----------------------#2022-03-06</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/9cda5ea26c2b01abc1c2320806f44316.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*Zio88-JSHV4e5WAW"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/@sapegin?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Artem Sapegin</a> on <a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="0972" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">ECMAScript 2021是最新的JavaScript版本，它为JavaScript语言引入了多个新特性。但是promise.all()是在ECMAScript 2015(ES6)中引入的，有效期为7年。</p><p id="4c98" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在本文中，我们将看看<code class="fe ky kz la lb b">promise.all()</code>是如何工作的，以及我们如何一次执行多个异步调用。</p><h1 id="7008" class="lc ld in bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">Promise.all()方法</h1><p id="019a" class="pw-post-body-paragraph ka kb in kc b kd ma kf kg kh mb kj kk kl mc kn ko kp md kr ks kt me kv kw kx ig bi translated"><code class="fe ky kz la lb b">Promise.all</code>方法接受一个可迭代的承诺(接受一个承诺数组)并返回一个包含输入承诺结果数组的新承诺。<br/>同时并行处理多个承诺，并等待所有承诺就绪。</p><p id="319d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">语法:-</p><pre class="mf mg mh mi gt mj lb mk ml aw mm bi"><span id="b521" class="mn ld in lb b gy mo mp l mq mr">const data = Promise.all([promise1, promise2,...]); // iterable</span></pre><p id="1510" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">您可以使用<strong class="kc io">提取承诺解析值。然后</strong>语法:-</p><pre class="mf mg mh mi gt mj lb mk ml aw mm bi"><span id="3a0a" class="mn ld in lb b gy mo mp l mq mr">data.then((values) =&gt; {<br/>  values; // [resultOfPromise1, resultOfPromise2, ...]<br/>}).catch(error =&gt; {<br/>  console.log(error)<br/>}</span></pre><p id="a861" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">或者<strong class="kc io">异步/等待</strong>:</p><pre class="mf mg mh mi gt mj lb mk ml aw mm bi"><span id="7dd2" class="mn ld in lb b gy mo mp l mq mr">try{<br/> const result = await data;<br/> console.log(Result); //[resultPromise1, resultPromise2, ...]<br/>} catch (error =&gt; {<br/> console.log(error);<br/>}</span></pre><p id="2227" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">请注意，结果数组的顺序与其源承诺中的顺序相同。</p><p id="a36d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">关于<code class="fe ky kz la lb b"> promise.all() </code>有趣的事情是:-</p><ul class=""><li id="9dc9" class="ms mt in kc b kd ke kh ki kl mu kp mv kt mw kx mx my mz na bi translated">如果所有承诺都成功解析，那么结果将由包含每个承诺值的结果数组组成。</li><li id="042a" class="ms mt in kc b kd nb kh nc kl nd kp ne kt nf kx mx my mz na bi translated">但是如果任何一个承诺被拒绝，那么由<code class="fe ky kz la lb b">promise.all()</code>返回的承诺会立即被拒绝，并出现错误。</li></ul><p id="9c22" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我举个例子让你更好的理解以上两点:</p><p id="b624" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">示例1:- </strong></p><figure class="mf mg mh mi gt jo"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="b751" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">正如你所看到的，承诺的结果和它的源承诺顺序相同。尽管第一个承诺需要最长的时间来解决，但它仍然是一系列结果中的第一个。</p><p id="39fa" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="kc io">示例2:- </strong></p><figure class="mf mg mh mi gt jo"><div class="bz fp l di"><div class="ng nh l"/></div></figure><p id="ebf1" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这里第二个承诺两秒后拒绝，导致<code class="fe ky kz la lb b">promise.all()</code>立即拒绝，所以<strong class="kc io">。catch </strong>执行。即使其中一个失败，另一个仍将继续执行，但它们的结果将被忽略。</p><h1 id="cd91" class="lc ld in bd le lf lg lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz bi translated">结论:-</h1><p id="4733" class="pw-post-body-paragraph ka kb in kc b kd ma kf kg kh mb kj kk kl mc kn ko kp md kr ks kt me kv kw kx ig bi translated"><code class="fe ky kz la lb b">Promise.all()</code>是一个有用的函数，可以并行执行多个异步操作，并将结果聚合到一个数组中。</p><p id="9a9a" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">它接受一个<strong class="kc io">可迭代对象</strong>，比如一个承诺数组作为输入。</p><ul class=""><li id="6619" class="ms mt in kc b kd ke kh ki kl mu kp mv kt mw kx mx my mz na bi translated">如果所有的承诺都兑现了，我会得到结果。</li><li id="70fa" class="ms mt in kc b kd nb kh nc kl nd kp ne kt nf kx mx my mz na bi translated">如果任何一个承诺被拒绝，就会被拒绝。</li><li id="5431" class="ms mt in kc b kd nb kh nc kl nd kp ne kt nf kx mx my mz na bi translated">当涉及多个异步任务时经常使用。</li><li id="6e8f" class="ms mt in kc b kd nb kh nc kl nd kp ne kt nf kx mx my mz na bi translated">这个方法<strong class="kc io">聚合了多个承诺的结果</strong>。</li></ul><p id="44ec" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><a class="ae jz" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise/all#browser_compatibility" rel="noopener ugc nofollow" target="_blank"> <strong class="kc io">浏览器兼容性</strong> </a> <br/>请注意，<code class="fe ky kz la lb b">promise.all()</code>在除了internet explorer之外的所有现代浏览器中都完全支持。</p><p id="8d7c" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这将是一系列文章，在下一篇文章中我们将讨论promise.any()。敬请期待！！！</p><blockquote class="ni nj nk"><p id="1020" class="ka kb nl kc b kd ke kf kg kh ki kj kk nm km kn ko nn kq kr ks no ku kv kw kx ig bi translated">请在评论区分享你的观点，是的，欢迎反馈。<br/>希望你会喜欢并分享这篇文章，以便更好地到达<br/>查看我的其他文章在——<a class="ae jz" href="https://medium.com/@aayushtibra1997" rel="noopener"><strong class="kc io">https://medium.com/@aayushtibra1997</strong></a><strong class="kc io"><br/>感谢阅读:)</strong></p></blockquote><p id="794f" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="nl">更多内容看</em> <a class="ae jz" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kc io"> <em class="nl">说白了。报名参加我们的</em> <a class="ae jz" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kc io"> <em class="nl">免费周报</em> </strong> </a> <em class="nl">。关注我们</em> <a class="ae jz" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"> <strong class="kc io"> <em class="nl">推特</em> </strong> </a> <em class="nl">和</em><a class="ae jz" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kc io"><em class="nl">LinkedIn</em></strong></a><em class="nl">。加入我们的</em> <a class="ae jz" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kc io"> <em class="nl">社区</em> </strong> </a> <em class="nl">。</em></strong></a></p></div></div>    
</body>
</html>