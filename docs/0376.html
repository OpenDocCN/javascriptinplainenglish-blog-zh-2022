<html>
<head>
<title>The Assembly Line Pattern in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript中的装配线模式</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/the-assembly-line-pattern-in-javascript-78dbc5d33584?source=collection_archive---------21-----------------------#2022-01-21">https://javascript.plainenglish.io/the-assembly-line-pattern-in-javascript-78dbc5d33584?source=collection_archive---------21-----------------------#2022-01-21</a></blockquote><div><div class="fc ic id ie if ig"/><div class="ih ii ij ik il"><div class=""/><figure class="gm go jm jn jo jp gi gj paragraph-image"><div role="button" tabindex="0" class="jq jr di js bf jt"><div class="gi gj jl"><img src="../Images/1716e72f5f1ddbf685e1f998fe4391fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*G_JOMYyLcBJoncy7"/></div></div><figcaption class="jw jx gk gi gj jy jz bd b be z dk">Photo by <a class="ae ka" href="https://unsplash.com/@medinacatering?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Medina Catering</a> on <a class="ae ka" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="d75c" class="pw-post-body-paragraph kb kc io kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ih bi translated">装配线模式可以将一组复杂的需求转化为简单的执行。</p><p id="b552" class="pw-post-body-paragraph kb kc io kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ih bi translated">经过十年的node.js编程和更长时间的JavaScript编程，通过应用<strong class="kd ip"> <em class="kz">装配线模式</em> </strong> (ALP)概念，许多大型复杂的项目被轻松地分解成更小的步骤。</p><p id="6247" class="pw-post-body-paragraph kb kc io kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ih bi translated">这种模式不像其他OOP模式那样流行，因为它更适合JavaScript发挥作用的函数式编程世界。ALP可以用来构建灵活简单的工作流引擎的开端。ALP类似于<strong class="kd ip"> <em class="kz">流水线模式</em> </strong>，但是流水线可以位于ALP之上；作为一个更大的结构，它可以代表一个装配线工厂。</p><p id="f6ce" class="pw-post-body-paragraph kb kc io kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ih bi translated">ALP由一个分配器，质量控制，精炼，装配，最后是一个调度员组成。</p><p id="f370" class="pw-post-body-paragraph kb kc io kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ih bi translated">ALP的快速概述:</p><ul class=""><li id="aebc" class="la lb io kd b ke kf ki kj km lc kq ld ku le ky lf lg lh li bi translated">分配器:获取材料</li><li id="6842" class="la lb io kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated">质量控制:过滤材料</li><li id="d516" class="la lb io kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated">精炼厂:修改材料</li><li id="ef48" class="la lb io kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated">装配:添加到材料</li><li id="6f0c" class="la lb io kd b ke lj ki lk km ll kq lm ku ln ky lf lg lh li bi translated">调度员:运送材料</li></ul><p id="5160" class="pw-post-body-paragraph kb kc io kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ih bi translated">每个步骤不必应用于每个项目，每个步骤本身可以有多个步骤，包括在返回主线之前遍历子装配线。当产品通过生产线时，它也可以在任何时候被拒绝。</p><p id="4333" class="pw-post-body-paragraph kb kc io kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ih bi translated">当使用ALP时，感觉就像是<strong class="kd ip"> <em class="kz">责任链</em> </strong>模式与<strong class="kd ip"> <em class="kz">装饰者</em> </strong>模式相匹配。您可以阅读关于ALP和其他地方提到的其他模式的更深入的细节和示例。现在，让我们开始用JavaScript编写这个练习。</p><p id="469f" class="pw-post-body-paragraph kb kc io kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ih bi translated">下面是使用node.js中的<strong class="kd ip"> <em class="kz"> require </em> </strong>构造的一般框架或脚手架。</p><figure class="lo lp lq lr gu jp"><div class="bz fq l di"><div class="ls lt l"/></div></figure><p id="0589" class="pw-post-body-paragraph kb kc io kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ih bi translated">代码严格遵循上述ALP的大纲，使用<strong class="kd ip"> <em class="kz">承诺</em> </strong>作为同步链，类似于装配线。额外的步骤可以很容易地插入中间或分解成多个步骤。可以更改步骤的名称，以指定它被编码来执行的实际任务，而不是一般的ALP任务。</p><p id="9e12" class="pw-post-body-paragraph kb kc io kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ih bi translated">让我们用一个简单的项目来看一个实现每个步骤的例子。该项目将包括读入一个CSV文件，生成和计算附加列，然后将输出格式化为HTML。如果遵循这种做法，编写包含单个函数中所有步骤的东西将违反<strong class="kd ip"> <em class="kz">关注点分离</em> </strong>规则。将它分成多个文件降低了认知的复杂性，并将它的功能隔离到一个易于管理的代码块中。</p><p id="c4d7" class="pw-post-body-paragraph kb kc io kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ih bi translated">上面的搭建文件不需要修改；必须只写步骤。从分配器步骤开始需要一些参数。在这种情况下，CSV文件的路径将启动该过程。可以发送附加参数，如配置文件。这类似于物理装配线上的控制面板设置。</p><figure class="lo lp lq lr gu jp"><div class="bz fq l di"><div class="ls lt l"/></div></figure><p id="bc7f" class="pw-post-body-paragraph kb kc io kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ih bi translated">与装配线一样，使用对象的外壳并添加CSV文件将项目传递到下一步:<strong class="kd ip"> <em class="kz">【解析({ csv }) </em> </strong>。当我们向其中添加项目时，让我们称这个外壳为“盒子”。下一步是质量控制步骤，在细化(解析)之前确定CSV文件的格式是否正确。</p><p id="99ce" class="pw-post-body-paragraph kb kc io kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ih bi translated">我们的CSV文件规范要求它有一个标题行，后跟数据行:</p><pre class="lo lp lq lr gu lu lv lw lx aw ly bi"><span id="8f71" class="lz ma io lv b gz mb mc l md me">Sample CSV file:</span><span id="c732" class="lz ma io lv b gz mf mc l md me">header1,header2,header3,header4,header5,header6<br/>1,2,3,4,5,6<br/>6,5,4,3,2,1<br/>11,22,33,44,55,66<br/>66,55,44,33,22,11</span></pre><figure class="lo lp lq lr gu jp"><div class="bz fq l di"><div class="ls lt l"/></div></figure><p id="0b9f" class="pw-post-body-paragraph kb kc io kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ih bi translated">本练习假设CSV文件很小；所以不会约束记忆。当然，<strong class="kd ip"> <em class="kz"> readline </em> </strong>模块可以处理更大的文件，但是对于这个例子，让我们保持简单。下一步是提炼，它将把文件解析成一个表示行和单元格的二维数组，然后传递给下一步。</p><figure class="lo lp lq lr gu jp"><div class="bz fq l di"><div class="ls lt l"/></div></figure><p id="4cbc" class="pw-post-body-paragraph kb kc io kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ih bi translated">组装步骤现在将向数组中添加另一个元素。一个新的单元格将被添加到每一行，它将包含该行中数字的总和。对于标题行，我们将添加一个“<strong class="kd ip"> <em class="kz">总计</em> </strong>”列。</p><figure class="lo lp lq lr gu jp"><div class="bz fq l di"><div class="ls lt l"/></div></figure><p id="1e47" class="pw-post-body-paragraph kb kc io kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ih bi translated">组装之后，我们将把它作为一个HTML格式的表格发送出去。传递盒子时，使用spread运算符，并在单个<strong class="kd ip"> <em class="kz"> resolve </em> </strong>语句中添加附加属性。</p><figure class="lo lp lq lr gu jp"><div class="bz fq l di"><div class="ls lt l"/></div></figure><p id="6d48" class="pw-post-body-paragraph kb kc io kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ih bi translated">请注意，每个步骤都被限制在它的工作空间中，并且只负责一项工作。然后，它使用<strong class="kd ip"> <em class="kz"> resolve </em> </strong>方法将项目传递到下一步。这保持了代码的整洁和灵活性，可以随时接受额外的步骤。</p><p id="685b" class="pw-post-body-paragraph kb kc io kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ih bi translated">这种模式和技术可以被修改、扩展和增强，成为一个完全成熟的工作流引擎，以一种干净的自顶向下的方法处理无数的步骤，消除混乱的分支和条件块。</p><p id="ac65" class="pw-post-body-paragraph kb kc io kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ih bi translated">使用装配线模式构建您的下一个项目！</p><p id="9d2e" class="pw-post-body-paragraph kb kc io kd b ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky ih bi translated"><em class="kz">更多内容请看</em> <a class="ae ka" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kd ip"> <em class="kz">说白了就是</em> </strong> </a> <em class="kz">。报名参加我们的</em> <a class="ae ka" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kd ip"> <em class="kz">免费每周简讯</em> </strong> </a> <em class="kz">。在我们的</em> <a class="ae ka" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kd ip"> <em class="kz">社区</em> </strong> </a> <em class="kz">获得独家获得写作机会和建议。</em></p></div></div>    
</body>
</html>