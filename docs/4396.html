<html>
<head>
<title>How to Easily Handle the onScroll Event in React</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在React中轻松处理onScroll事件</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/react-onscroll-fbd93e3d9f8a?source=collection_archive---------5-----------------------#2022-11-29">https://javascript.plainenglish.io/react-onscroll-fbd93e3d9f8a?source=collection_archive---------5-----------------------#2022-11-29</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/e8fad5ad03c8c7ba21ddafaf802d9789.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*NMsk9Ujkbhkse79tq-qzjg.png"/></div></div></figure><p id="0ff7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">要处理React元素上的<code class="fe kt ku kv kw b">onScroll</code>事件，需要为元素的<code class="fe kt ku kv kw b">onScroll</code>属性分配一个函数，并使用event对象来执行一个动作。每当用户在页面上向上或向下滚动时，就会发生该操作。</p><p id="19cc" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">例如:</p><p id="f19c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe kt ku kv kw b">App.jsx</code></p><pre class="kx ky kz la gt lb kw lc bn ld le bi"><span id="39ec" class="lf lg in kw b be lh li l lj lk">import { useState } from 'react';<br/><br/>export default function App() {<br/>  const [scrollTop, setScrollTop] = useState(0);<br/><br/>  const handleScroll = (event) =&gt; {<br/>    setScrollTop(event.currentTarget.scrollTop);<br/>  };<br/><br/>  return (<br/>    &lt;div&gt;<br/>      Scroll top: &lt;b&gt;{scrollTop}&lt;/b&gt;<br/>      &lt;br /&gt;<br/>      &lt;br /&gt;<br/>      &lt;div<br/>        style={{<br/>          border: '1px solid black',<br/>          width: '400px',<br/>          height: '200px',<br/>          overflow: 'auto',<br/>        }}<br/>        onScroll={handleScroll}<br/>      &gt;<br/>        {[...Array(10)].map((_, i) =&gt; (<br/>          &lt;p key={i}&gt;Content&lt;/p&gt;<br/>        ))}<br/>      &lt;/div&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><figure class="kx ky kz la gt jo gh gi paragraph-image"><div class="gh gi ll"><img src="../Images/09537a0094fbaa71b320bb462376e9c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:874/0*OVkzCp4i0MZa1s6C.gif"/></div><figcaption class="lm ln gj gh gi lo lp bd b be z dk">The text is updated when the component’s <code class="fe kt ku kv kw b">onScroll</code> event fires.</figcaption></figure><p id="7a9e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">每当视窗滚动时，传递给<code class="fe kt ku kv kw b">onScroll</code>属性的函数(事件监听器)就会被调用。它是用一个事件对象调用的，该对象可用于执行操作和访问与滚动事件相关的信息。</p><p id="47b1" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这个事件对象的<code class="fe kt ku kv kw b">currentTarget</code>属性返回<code class="fe kt ku kv kw b">onScroll</code>监听器所连接的元素。</p><p id="5adc" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">提示:</strong>如果您不确定何时使用事件对象的<code class="fe kt ku kv kw b">currentTarget</code>或<code class="fe kt ku kv kw b">target</code>属性，本文可能会有所帮助:<a class="ae lq" href="https://codingbeautydev.com/blog/javascript-event-target-vs-currenttarget/" rel="noopener ugc nofollow" target="_blank">JavaScript中的事件目标与当前目标:重要的区别</a>。</p><p id="afd0" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们使用元素的<code class="fe kt ku kv kw b">scrollTop</code>属性来获取元素的滚动条距离其最顶端的位置有多远。然后我们用新值更新状态变量，这反映在页面上。</p><p id="7518" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io">注意</strong>:我们使用了<code class="fe kt ku kv kw b"><a class="ae lq" href="https://reactjs.org/docs/hooks-state.html" rel="noopener ugc nofollow" target="_blank">useState</a></code>钩子来管理状态。这个钩子返回两个值的数组，其中第一个是存储状态的变量，第二个是在被调用时更新状态的函数。</p><h1 id="720f" class="lr lg in bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">在React中处理<code class="fe kt ku kv kw b">window</code>对象上的onScroll事件</h1><p id="c7b3" class="pw-post-body-paragraph jv jw in jx b jy mo ka kb kc mp ke kf kg mq ki kj kk mr km kn ko ms kq kr ks ig bi translated">我们还可以处理全局<code class="fe kt ku kv kw b"><a class="ae lq" href="https://developer.mozilla.org/en-US/docs/Web/API/Window" rel="noopener ugc nofollow" target="_blank">window</a></code>对象上的<code class="fe kt ku kv kw b">onScroll</code>事件，以便在视窗滚动时执行一个动作。我们可以用<code class="fe kt ku kv kw b">addEventListener()</code>方法做到这一点:</p><p id="760b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe kt ku kv kw b">App.js</code></p><pre class="kx ky kz la gt lb kw lc bn ld le bi"><span id="a388" class="lf lg in kw b be lh li l lj lk">import { useState, useEffect } from 'react';<br/><br/>export default function App() {<br/>  const [scrollTop, setScrollTop] = useState(0);<br/><br/>  useEffect(() =&gt; {<br/>    const handleScroll = (event) =&gt; {<br/>      setScrollTop(window.scrollY);<br/>    };<br/><br/>    window.addEventListener('scroll', handleScroll);<br/><br/>    return () =&gt; {<br/>      window.removeEventListener('scroll', handleScroll);<br/>    };<br/>  }, []);<br/><br/>  return (<br/>    &lt;div&gt;<br/>      &lt;div<br/>        style={{<br/>          position: 'fixed',<br/>          padding: '10px 0',<br/>          top: '0',<br/>          backgroundColor: 'white',<br/>          borderBottom: '1px solid #c0c0c0',<br/>          width: '100%',<br/>        }}<br/>      &gt;<br/>        Scroll top: &lt;b&gt;{scrollTop}&lt;/b&gt;<br/>      &lt;/div&gt;<br/>      &lt;div style={{ marginTop: '50px' }}&gt;<br/>        {[...Array(30)].map((_, i) =&gt; (<br/>          &lt;p key={i}&gt;Content&lt;/p&gt;<br/>        ))}<br/>      &lt;/div&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><figure class="kx ky kz la gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi mt"><img src="../Images/e40fe969790356aa50d7c2a34f51e1e9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*9gGFZOr49fvfStey.gif"/></div></div><figcaption class="lm ln gj gh gi lo lp bd b be z dk">The text is updated when the window’s <code class="fe kt ku kv kw b">onScroll</code> event fires.</figcaption></figure><p id="a431" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><code class="fe kt ku kv kw b"><a class="ae lq" href="https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener" rel="noopener ugc nofollow" target="_blank">addEventListener()</a></code>方法最多接受两个参数:</p><ol class=""><li id="5e3b" class="mu mv in jx b jy jz kc kd kg mw kk mx ko my ks mz na nb nc bi translated"><code class="fe kt ku kv kw b">type</code>:表示要监听的事件类型的字符串。</li><li id="eb38" class="mu mv in jx b jy nd kc ne kg nf kk ng ko nh ks mz na nb nc bi translated"><code class="fe kt ku kv kw b">listener</code>:事件触发时调用的函数。</li></ol><p id="e3aa" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">它还需要一些可选的参数，你可以在这里了解更多关于<a class="ae lq" href="https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/addEventListener" rel="noopener ugc nofollow" target="_blank">的内容。</a></p><p id="8453" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">一旦组件在页面加载时呈现，我们就调用<code class="fe kt ku kv kw b"><a class="ae lq" href="https://reactjs.org/docs/hooks-effect.html" rel="noopener ugc nofollow" target="_blank">useEffect</a></code>钩子中的<code class="fe kt ku kv kw b">addEventListener()</code>来注册监听器。我们将一个空的依赖数组传递给<code class="fe kt ku kv kw b">useEffect</code>,这样这个注册只发生一次。在cleanup函数中，我们调用<code class="fe kt ku kv kw b"><a class="ae lq" href="https://developer.mozilla.org/en-US/docs/Web/API/EventTarget/removeEventListener" rel="noopener ugc nofollow" target="_blank">removeEventListener()</a></code>方法来取消注册事件监听器并防止内存泄漏。</p><p id="ba51" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在<code class="fe kt ku kv kw b">onScroll</code>监听器中，我们访问<code class="fe kt ku kv kw b"><a class="ae lq" href="https://developer.mozilla.org/en-US/docs/Web/API/Window/scrollY" rel="noopener ugc nofollow" target="_blank">Window</a></code> <a class="ae lq" href="https://developer.mozilla.org/en-US/docs/Web/API/Window/scrollY" rel="noopener ugc nofollow" target="_blank"> </a> <code class="fe kt ku kv kw b"><a class="ae lq" href="https://developer.mozilla.org/en-US/docs/Web/API/Window/scrollY" rel="noopener ugc nofollow" target="_blank">scrollY</a></code>属性来显示页面当前水平滚动的像素数。</p></div><div class="ab cl ni nj hr nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="ig ih ii ij ik"><p id="3229" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="np">原载于</em><a class="ae lq" href="https://cbdev.link/b6f9b7" rel="noopener ugc nofollow" target="_blank"><em class="np">codingbeautydev.com</em></a></p><h1 id="ad55" class="lr lg in bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">JavaScript做的每一件疯狂的事情</h1><p id="e18c" class="pw-post-body-paragraph jv jw in jx b jy mo ka kb kc mp ke kf kg mq ki kj kk mr km kn ko ms kq kr ks ig bi translated">一本关于JavaScript微妙的警告和鲜为人知的部分的迷人指南。</p><figure class="kx ky kz la gt jo gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/143ee152ba78025ea8643ba5b9726a20.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*YS5Oub8REWy8vnOEqBnsyQ.png"/></div></figure><p id="7d6e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><a class="ae lq" href="https://cbdev.link/d3c4eb" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io">报名</strong> </a>立即免费领取一份。</p><p id="4e37" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="np">更多内容请看</em><a class="ae lq" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="jx io"><em class="np">plain English . io</em></strong></a><em class="np">。报名参加我们的</em> <a class="ae lq" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io"> <em class="np">免费周报</em> </strong> </a> <em class="np">。关注我们上</em><a class="ae lq" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="jx io"><em class="np">Twitter</em></strong></a><a class="ae lq" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="jx io"><em class="np">LinkedIn</em></strong></a><strong class="jx io"><em class="np"/></strong><a class="ae lq" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"><strong class="jx io"><em class="np">YouTube</em></strong></a><strong class="jx io"><em class="np"/></strong><em class="np">和</em> <a class="ae lq" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io"> <em class="np">不和</em> </strong> </a>  <em class="np">对成长黑客感兴趣？检查</em> <a class="ae lq" href="https://circuit.ooo/" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io"> <em class="np">电路</em> </strong> </a> <strong class="jx io"> <em class="np">。</em> </strong></p></div></div>    
</body>
</html>