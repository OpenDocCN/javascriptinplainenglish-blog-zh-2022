<html>
<head>
<title>More Stores to Save the Data</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">更多商店来保存数据</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/more-stores-to-save-the-data-in-putout-plugins-2c014c5dda3?source=collection_archive---------29-----------------------#2022-01-27">https://javascript.plainenglish.io/more-stores-to-save-the-data-in-putout-plugins-2c014c5dda3?source=collection_archive---------29-----------------------#2022-01-27</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="9578" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">了解这个代码转换器的插件。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi kc"><img src="../Images/7fbb2ab3831898b4edb68d5ec327921c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1200/format:webp/0*U5iKapC68v9BR1XW.png"/></div><figcaption class="kk kl gj gh gi km kn bd b be z dk"><em class="ko">I hear the song of the nightingale.<br/>The sun is warm, the wind is mild,<br/>willows are green along the shore -<br/>Here no Ox can hide!<br/>What artist can draw that massive head,<br/>those majestic horns?<br/>© Zen Ten Bulls</em></figcaption></figure><p id="673b" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">嗨伙计们！<br/>今天我们来谈谈万能代码转换器的插件。</p><h1 id="1b43" class="ll lm in bd ln lo lp lq lr ls lt lu lv jt lw ju lx jw ly jx lz jz ma ka mb mc bi translated">💪重用-复制-初始化现在支持<code class="fe md me mf mg b">MemberExpression</code></h1><p id="21e4" class="pw-post-body-paragraph kp kq in kr b ks mh jo ku kv mi jr kx ky mj la lb lc mk le lf lg ml li lj lk ig bi translated">🐊<a class="ae mm" href="https://github.com/coderaiser/putout" rel="noopener ugc nofollow" target="_blank"> <strong class="kr io">输出</strong> </a>规则<a class="ae mm" href="https://github.com/coderaiser/putout/tree/v24.5.0/packages/plugin-reuse-duplicate-init#putoutplugin-reuse-duplicate-init-" rel="noopener ugc nofollow" target="_blank"> <strong class="kr io">重用-复制-初始化</strong> </a>现在支持<a class="ae mm" href="https://babeljs.io/docs/en/babel-types#memberexpression" rel="noopener ugc nofollow" target="_blank"> <strong class="kr io">成员表达式</strong> </a>。还有这样的代码:</p><pre class="kd ke kf kg gt mn mg mo mp aw mq bi"><span id="779b" class="mr lm in mg b gy ms mt l mu mv">const {operator} = require('putout');<br/>const {replaceWith} = require('putout').operator</span></pre><p id="7d6d" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">它将很容易转化为:</p><pre class="kd ke kf kg gt mn mg mo mp aw mq bi"><span id="e676" class="mr lm in mg b gy ms mt l mu mv">const {operator} = require('putout');<br/>const {replaceWith} = operator</span></pre><h1 id="94f1" class="ll lm in bd ln lo lp lq lr ls lt lu lv jt lw ju lx jw ly jx lz jz ma ka mb mc bi translated">商店街的新人</h1><p id="1015" class="pw-post-body-paragraph kp kq in kr b ks mh jo ku kv mi jr kx ky mj la lb lc mk le lf lg ml li lj lk ig bi translated">当您需要存储遍历数据以备将来处理，并希望正确处理时:使用<code class="fe md me mf mg b"><a class="ae mm" href="https://github.com/coderaiser/putout/blob/master/packages/engine-runner/README.md#stores" rel="noopener ugc nofollow" target="_blank">Stores</a></code>，这是首选的保存方式🐊<code class="fe md me mf mg b">Putout</code>数据。<code class="fe md me mf mg b">traverse</code> init函数只调用一次，其他任何处理变量的方式都很可能导致bug。</p><p id="13ad" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">有两种类型的商店:</p><ul class=""><li id="b4c7" class="mw mx in kr b ks kt kv kw ky my lc mz lg na lk nb nc nd ne bi translated"><code class="fe md me mf mg b">✅<a class="ae mm" href="https://github.com/coderaiser/putout/tree/v23.2.0/packages/engine-runner#store" rel="noopener ugc nofollow" target="_blank">store</a></code> -向对象存储简单的值；</li><li id="f019" class="mw mx in kr b ks nf kv ng ky nh lc ni lg nj lk nb nc nd ne bi translated"><code class="fe md me mf mg b">✅<a class="ae mm" href="https://github.com/coderaiser/putout/tree/v23.2.0/packages/engine-runner#liststore" rel="noopener ugc nofollow" target="_blank">listStore</a></code>存储数组项；</li></ul><p id="805e" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">现在我们有了<code class="fe md me mf mg b"><a class="ae mm" href="https://github.com/coderaiser/putout/tree/v23.2.0/packages/engine-runner#upstore" rel="noopener ugc nofollow" target="_blank">upstore</a></code>，它能够根据您提供的名称更新您输入的信息。</p><p id="3361" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">下面就来分别说一下。</p><h1 id="cf07" class="ll lm in bd ln lo lp lq lr ls lt lu lv jt lw ju lx jw ly jx lz jz ma ka mb mc bi translated"><code class="fe md me mf mg b">listStore</code></h1><p id="8655" class="pw-post-body-paragraph kp kq in kr b ks mh jo ku kv mi jr kx ky mj la lb lc mk le lf lg ml li lj lk ig bi translated">使用<code class="fe md me mf mg b">listStore</code>保存列表之类的东西。让我们假设您有这样的代码:</p><pre class="kd ke kf kg gt mn mg mo mp aw mq bi"><span id="9335" class="mr lm in mg b gy ms mt l mu mv">debugger;<br/>const hello = '';<br/>debugger;<br/>const world = '';</span></pre><p id="11f7" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">我们来处理一下！</p><pre class="kd ke kf kg gt mn mg mo mp aw mq bi"><span id="7ca8" class="mr lm in mg b gy ms mt l mu mv">module.exports.traverse = ({listStore}) =&gt; ({<br/>    'debugger'(path) {<br/>        listStore('x');<br/>    },<br/>    <br/>    Program: {<br/>        exit() {<br/>            console.log(listStore());<br/>            // returns<br/>            ['x', 'x'];<br/>            // for code<br/>            'debugger; debugger';<br/>        },<br/>    },<br/>});</span></pre><h1 id="44bf" class="ll lm in bd ln lo lp lq lr ls lt lu lv jt lw ju lx jw ly jx lz jz ma ka mb mc bi translated"><code class="fe md me mf mg b">store</code></h1><p id="34a6" class="pw-post-body-paragraph kp kq in kr b ks mh jo ku kv mi jr kx ky mj la lb lc mk le lf lg ml li lj lk ig bi translated">当你需要<code class="fe md me mf mg b">key-value</code>时，使用<code class="fe md me mf mg b">store</code>:</p><pre class="kd ke kf kg gt mn mg mo mp aw mq bi"><span id="c001" class="mr lm in mg b gy ms mt l mu mv">module.exports.traverse = ({push, store}) =&gt; ({<br/>    'debugger'(path) {<br/>        store('hello', 'world');<br/>        push(path);<br/>    },<br/>    <br/>    Program: {<br/>        exit() {<br/>            store();<br/>            // returns<br/>            ['world'];<br/>            <br/>            store.entries();<br/>            // returns<br/>            [['hello', 'world']];<br/>            <br/>            store('hello');<br/>            // returns<br/>            'world';<br/>        },<br/>    },<br/>});</span></pre><h1 id="fff1" class="ll lm in bd ln lo lp lq lr ls lt lu lv jt lw ju lx jw ly jx lz jz ma ka mb mc bi translated"><code class="fe md me mf mg b">upstore</code></h1><p id="8be0" class="pw-post-body-paragraph kp kq in kr b ks mh jo ku kv mi jr kx ky mj la lb lc mk le lf lg ml li lj lk ig bi translated">当您需要更新已经保存的值时，使用<code class="fe md me mf mg b">upstore</code>:</p><pre class="kd ke kf kg gt mn mg mo mp aw mq bi"><span id="0a56" class="mr lm in mg b gy ms mt l mu mv">module.exports.traverse = ({push, store}) =&gt; ({<br/>    TSTypeAliasDeclaration(path) {<br/>        if (path.parentPath.isExportNamedDeclaration())<br/>            return;<br/>        <br/>        store(path.node.id.name, {<br/>            path,<br/>        });<br/>    },<br/>    <br/>    ObjectProperty(path) {<br/>        const {value} = path.node;<br/>        const {name} = value;<br/>        <br/>        store(name, {<br/>            used: true,<br/>        });<br/>    },<br/>    <br/>    Program: {<br/>        exit() {<br/>            for (const {path, used} of store()) {<br/>                if (used)<br/>                    continue;<br/>                <br/>                push(path);<br/>            }<br/>        },<br/>    },<br/>});</span></pre><h1 id="279d" class="ll lm in bd ln lo lp lq lr ls lt lu lv jt lw ju lx jw ly jx lz jz ma ka mb mc bi translated"><code class="fe md me mf mg b">not-rule-</code>前缀为<code class="fe md me mf mg b">Rules</code></h1><p id="39f1" class="pw-post-body-paragraph kp kq in kr b ks mh jo ku kv mi jr kx ky mj la lb lc mk le lf lg ml li lj lk ig bi translated">当您使用特定于您的项目的<a class="ae mm" href="https://github.com/coderaiser/putout#rulesdir" rel="noopener ugc nofollow" target="_blank">规则</a>，并且您不想发布它们(但是想将它们保存在存储库中)——使用<code class="fe md me mf mg b">--rulesdir</code>:</p><pre class="kd ke kf kg gt mn mg mo mp aw mq bi"><span id="d4b1" class="mr lm in mg b gy ms mt l mu mv">putout --rulesdir rules</span></pre><p id="7d19" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">类似于它在🐊<code class="fe md me mf mg b">Putout</code>目录中的知识库<code class="fe md me mf mg b"><a class="ae mm" href="https://github.com/coderaiser/putout/tree/master/rules" rel="noopener ugc nofollow" target="_blank">/rules</a></code>🎉</p><p id="3d92" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">当你需要重用某些东西时，你可以创建一个带有前缀<strong class="kr io"> not-rule- </strong>的文件或目录，例如<strong class="kr io"> not-rule-common </strong>，它将在处理选项阶段被忽略。</p><p id="f157" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated">那都是乡亲们！祝你愉快，🥳！</p><p id="06ef" class="pw-post-body-paragraph kp kq in kr b ks kt jo ku kv kw jr kx ky kz la lb lc ld le lf lg lh li lj lk ig bi translated"><em class="nk">更多内容看</em> <a class="ae mm" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kr io"> <em class="nk">说白了。报名参加我们的</em> <a class="ae mm" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kr io"> <em class="nk">免费周报</em> </strong> </a> <em class="nk">。在我们的</em> <a class="ae mm" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kr io"> <em class="nk">社区不和谐</em> </strong> </a> <em class="nk">获得独家获取写作机会和建议。</em></strong></a></p></div></div>    
</body>
</html>