<html>
<head>
<title>Deploy Source Code to GitHub Pages with zx.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用zx.js将源代码部署到GitHub页面</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/deploy-source-code-to-github-pages-with-zx-js-8c5136595956?source=collection_archive---------17-----------------------#2022-05-16">https://javascript.plainenglish.io/deploy-source-code-to-github-pages-with-zx-js-8c5136595956?source=collection_archive---------17-----------------------#2022-05-16</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="f244" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">将静态页面部署到Github页面的简单方法。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/378164b5575b921d973ab18e4b8b61a9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*ShRvKtIdWT6SbFpq"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@animeshchatterjee?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">A C</a> on <a class="ae ks" href="https://unsplash.com/s/photos/js?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="0d8d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在开始谈论这篇文章的主要观点之前，我将谈一谈让我有机会与<strong class="kv io"> zx.js </strong>合作的原因。我有一个用Gulp建立的个人页面，我把它放在了GitHub页面上。因为我没有为我的页面设置目录，所以我需要处理两个分支。一个用于开发，一个用于部署。</p><p id="cb1e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在开发分支，我设置了一些构建工具，如Gulp、Webpack等。来编译我的源代码。在部署分支中，我只需要用开发分支的输出替换它的内容，并将其推送到GitHub。下面是我的<strong class="kv io">手动</strong>流程:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi lp"><img src="../Images/a0dc6aca5d56c16b02a10ed434d26cd5.png" data-original-src="https://miro.medium.com/v2/resize:fit:862/format:webp/1*dM2xSzRaa5UGY5XIu9GJxQ.png"/></div></figure><p id="33b4" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我真的不喜欢这种流量。然后我找到了一个支持我轻松完成这项工作的库。这是<code class="fe lq lr ls lt b">gulp-gh-pages</code>。这个库可以帮助我将所有内容从输出目录推到部署分支，而无需复制和签出…</p><h1 id="fdc7" class="lu lv in bd lw lx ly lz ma mb mc md me jt mf ju mg jw mh jx mi jz mj ka mk ml bi translated">出事了</h1><p id="8135" class="pw-post-body-paragraph kt ku in kv b kw mm jo ky kz mn jr lb lc mo le lf lg mp li lj lk mq lm ln lo ig bi translated">这是过去的事了。这个库运行良好。最近，当我升级我的Node.js版本并对我的个人站点进行一些更改时，我在使用<code class="fe lq lr ls lt b">gulp-gh-pages</code>部署流程时遇到了一些问题。它抛出了一些关于它们的依赖库的错误。我试图用一些正常的方法来修复它，比如升级版本，改变依赖库的版本…但是它仍然不起作用。我决定以我的方式处理我的部署流程。经过一番研究后，我选择了<strong class="kv io"> zx.js </strong>作为我的工作，我只需要几行代码来处理它。下面几行，我就说说我是怎么完成的。</p><h1 id="15be" class="lu lv in bd lw lx ly lz ma mb mc md me jt mf ju mg jw mh jx mi jz mj ka mk ml bi translated">需求和规划</h1><p id="1a1b" class="pw-post-body-paragraph kt ku in kv b kw mm jo ky kz mn jr lb lc mo le lf lg mp li lj lk mq lm ln lo ig bi translated">在开始编码之前，我们需要再看一下需求。我们有一个包含两个分支的存储库(开发分支和部署分支)。在开发部门，我们将在。在这个部门，我们可以做任何我们想做的事情。只需要确保我们可以将想要部署的内容放在一个目录中。第二个分支是我们想要包含开发分支的所有输出的地方。要求是生成一个命令或类似的东西，将开发分支中的输出自动带到部署分支。</p><p id="ec67" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在我们开始自动执行之前，我会制定一个手动执行的计划。首先，我真的不喜欢我上面说的步骤(构建，将输出目录复制到另一个地方，签出到部署分支)。我建议采取其他步骤，让我们在当前目录中完成我们的工作。以下是步骤:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi mr"><img src="../Images/476010e7d0f729587d7933d81a9fbf30.png" data-original-src="https://miro.medium.com/v2/resize:fit:928/format:webp/1*ULkzQhrjlluXhfelvqYefQ.png"/></div></figure><p id="7178" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">将那些<strong class="kv io"> </strong>步骤转换成。<strong class="kv io"> js </strong>文件，我们将有一个带有注释和函数的文件，如下所示:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="391d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在下一部分中，我们将使用<strong class="kv io"> zx.js. </strong>来完成此功能</p><h1 id="6210" class="lu lv in bd lw lx ly lz ma mb mc md me jt mf ju mg jw mh jx mi jz mj ka mk ml bi translated">让我们编码</h1><p id="8a0c" class="pw-post-body-paragraph kt ku in kv b kw mm jo ky kz mn jr lb lc mo le lf lg mp li lj lk mq lm ln lo ig bi translated">让我们从第一部分开始。</p><p id="556d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io">检查临时目录是否已经存在。</strong></p><p id="6a3b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在这一部分，我们需要临时目录的名称。我的选择是<code class="fe lq lr ls lt b">temp</code>。你可以用任何你喜欢的名字。要检查这个目录是否已经存在，我们只需要通过方法<code class="fe lq lr ls lt b">existsSync</code>使用库<code class="fe lq lr ls lt b">fs</code>。如果该目录已经存在，我们需要删除该目录。下面是我们将对文件进行的更改，以完成这一步:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="0db2" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在我们上面添加的行中，我们可以使用<strong class="kv io"> xz.js轻松删除一个目录。</strong>让我们移动到下一部分。</p><p id="98d8" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io">克隆并替换部署分支中的源代码。</strong></p><p id="25d2" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在下一部分中，我们将在deployment分支中克隆我们的存储库，并用我们之前构建的输出目录中的源代码替换该分支中的所有源代码。为了克隆我们的存储库，我们需要获得当前的远程主机。我们可以用下面的git命令得到这个结果:</p><pre class="kd ke kf kg gt mu lt mv mw aw mx bi"><span id="055a" class="my lv in lt b gy mz na l nb nc">git config --get remote.origin.url</span></pre><p id="1194" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">有了这个命令的结果，我们只需要运行一个普通的带参数<code class="fe lq lr ls lt b">--branch</code>的<code class="fe lq lr ls lt b">git clone</code>部署分支来克隆我们的库。然后我们只需要做两件事:删除临时目录中的所有源代码，并将输出目录中的所有源代码复制到临时目录中。很简单，下面我就展示一下:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="92c3" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io">检查gdfgdf中的文件更改。</strong></p><p id="4a1a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在这一步中，我们需要检查输出的源代码和部署分支中的当前源代码之间的任何变化。Git将使用带有参数<code class="fe lq lr ls lt b">-d</code> <code class="fe lq lr ls lt b">-m</code> <code class="fe lq lr ls lt b">--others</code>的命令<code class="fe lq lr ls lt b">git ls-file</code>来帮助我们完成这项工作。如果任何文件被更改，我们将向用户显示一条消息。如果源代码被更改，我们将把这些更改推送到部署分支。我想我们都知道三个命令<code class="fe lq lr ls lt b">git add</code> <code class="fe lq lr ls lt b">git commit</code>和<code class="fe lq lr ls lt b">git push</code>来完成这项工作。让我们看看在这一步中我们做了什么:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ms mt l"/></div></figure><p id="d75c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我忘了告诉你一个小步骤来改变目录到临时目录的内部。为此，我们可以非常容易地使用<strong class="kv io"> zx.js </strong>中的函数<code class="fe lq lr ls lt b">cd(&lt;path&gt;)</code>。完成我们的工作后，不要忘记将目录更改为外部。</p><p id="0142" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io">清理</strong></p><p id="7184" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这一步很简单，删除临时目录即可。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ms mt l"/></div></figure><h1 id="abf8" class="lu lv in bd lw lx ly lz ma mb mc md me jt mf ju mg jw mh jx mi jz mj ka mk ml bi translated">我们跑吧</h1><p id="d2e1" class="pw-post-body-paragraph kt ku in kv b kw mm jo ky kz mn jr lb lc mo le lf lg mp li lj lk mq lm ln lo ig bi translated">我们已经用<strong class="kv io"> zx.js </strong>完成了一个从开发分支输出到部署分支自动部署代码的文件。现在，让我们用一个简单的例子来运行这个文件。我有一个包含两个分支的存储库，<code class="fe lq lr ls lt b">master</code>用于部署，<code class="fe lq lr ls lt b">develop</code>用于开发。在<code class="fe lq lr ls lt b">master</code>中，我添加了一个文件<code class="fe lq lr ls lt b">first.txt</code>，内容为“第一个文件”,如下所示:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi nd"><img src="../Images/40549d6ad2917e8ef9bb8e0526d21ca5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1186/format:webp/1*ESE4FNOIdF_3j24rMVGrPA.png"/></div></figure><p id="0a24" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在<code class="fe lq lr ls lt b">develop</code>，我们将为它设立一个小点。首先，我们需要安装<strong class="kv io"> zx.js </strong>。很简单:</p><pre class="kd ke kf kg gt mu lt mv mw aw mx bi"><span id="43af" class="my lv in lt b gy mz na l nb nc">yarn add -D zx</span></pre><p id="9d5b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">其次，我们将使用上面完成的文件中的内容创建<code class="fe lq lr ls lt b">deploy.mjs</code>。最后，只需要添加一个<code class="fe lq lr ls lt b">.gitignore</code>来忽略<code class="fe lq lr ls lt b">node_module</code>和<code class="fe lq lr ls lt b">dist</code>(输出目录的名称)。下面是我们在<code class="fe lq lr ls lt b">develop</code>中看到的:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ne"><img src="../Images/cc27bc40292fb5ea17b26476e7001b77.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Vf8z9UvvFSZTbSBt54OPaQ.png"/></div></div></figure><p id="a288" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在，我们将创建一个目录<code class="fe lq lr ls lt b">dist</code>来存放内容<code class="fe lq lr ls lt b">first.txt</code>。但是这个文件的内容并不是像<code class="fe lq lr ls lt b">master</code>那样的“第一个文件”。我们需要将该文件的数据更改为“编辑的第一个文件”。然后我们创建一个内容为“second”的新文件<code class="fe lq lr ls lt b">second.txt</code>。以下是我们在<code class="fe lq lr ls lt b">dist</code>中看到的内容:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nf"><img src="../Images/5cfa22b97572aaa133a6f82201ea8f62.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9uzxjIRDcPSJ1oQQYDnvWQ.png"/></div></div></figure><p id="4808" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在，让我们使用以下命令来尝试我们的<strong class="kv io"> deploy.mjs </strong>:</p><pre class="kd ke kf kg gt mu lt mv mw aw mx bi"><span id="8b88" class="my lv in lt b gy mz na l nb nc">zx deploy.mjs</span></pre><p id="b1f5" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">下面是我从这个命令中得到的结果:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi ng"><img src="../Images/e09d6010405e0822edce450dcc4f1953.png" data-original-src="https://miro.medium.com/v2/resize:fit:1130/format:webp/1*2LO5L0ESfv5VRLxVQcHd_g.png"/></div></figure><p id="58c8" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我看到<code class="fe lq lr ls lt b">temp</code>被移除了，也许这是个好结果。让我们在<code class="fe lq lr ls lt b">master</code>打开Github查看一下:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nh"><img src="../Images/40175e9d6dd612f70c0e13f4df4dab2b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_qpgYuzoJwc1ZAKBza-q2Q.png"/></div></div></figure><p id="eb98" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">那有效！增加了<code class="fe lq lr ls lt b">second.txt</code>，修改了<code class="fe lq lr ls lt b">first.txt</code>。</p><h1 id="a9ac" class="lu lv in bd lw lx ly lz ma mb mc md me jt mf ju mg jw mh jx mi jz mj ka mk ml bi translated">结论</h1><p id="6967" class="pw-post-body-paragraph kt ku in kv b kw mm jo ky kz mn jr lb lc mo le lf lg mp li lj lk mq lm ln lo ig bi translated">在本文中，我已经向您展示了如何一步一步地使用<strong class="kv io"> zx.js </strong>将源代码部署到Github页面。这很简单，我认为从zx.js开始是个好方法。希望这篇文章对你有帮助。我真的不太擅长Git和终端命令，所以我使用的命令非常简单。我认为你能比我做得更好。让我们试一试。你可以在他们的文档中了解更多关于zx.js的信息:</p><div class="ni nj gp gr nk nl"><a href="https://github.com/google/zx" rel="noopener  ugc nofollow" target="_blank"><div class="nm ab fo"><div class="nn ab no cl cj np"><h2 class="bd io gy z fp nq fr fs nr fu fw im bi translated">GitHub - google/zx:编写更好脚本的工具</h2><div class="ns l"><h3 class="bd b gy z fp nq fr fs nr fu fw dk translated">Bash很棒，但是在编写脚本时，人们通常会选择更方便的编程语言…</h3></div><div class="nt l"><p class="bd b dl z fp nq fr fs nr fu fw dk translated">github.com</p></div></div><div class="nu l"><div class="nv l nw nx ny nu nz km nl"/></div></div></a></div><p id="165c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">以下是我的示例存储库:</p><div class="ni nj gp gr nk nl"><a href="https://github.com/tasynguyen3894/zx_simple_example" rel="noopener  ugc nofollow" target="_blank"><div class="nm ab fo"><div class="nn ab no cl cj np"><h2 class="bd io gy z fp nq fr fs nr fu fw im bi translated">GitHub-tasynguyen 3894/zx _ simple _ example</h2><div class="ns l"><h3 class="bd b gy z fp nq fr fs nr fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="nt l"><p class="bd b dl z fp nq fr fs nr fu fw dk translated">github.com</p></div></div><div class="nu l"><div class="oa l nw nx ny nu nz km nl"/></div></div></a></div><p id="0d95" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在我做了一些优化之后，这个流的要点文件如下:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ms mt l"/></div></figure><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/73c074782e28bac875c87638e51f8ab0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*7fRKrETV_jOAIZyN"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@mikofilm?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Mike Kononov</a> on <a class="ae ks" href="https://unsplash.com/s/photos/building-window?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="464a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">感谢您的阅读。</p><p id="ffc1" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">通过<a class="ae ks" href="https://www.linkedin.com/in/thaisangnguyen3894/" rel="noopener ugc nofollow" target="_blank"> Linkedin </a>或<a class="ae ks" href="https://twitter.com/tasyit" rel="noopener ugc nofollow" target="_blank"> Twitter </a>与我联系。</p></div><div class="ab cl ob oc hr od" role="separator"><span class="oe bw bk of og oh"/><span class="oe bw bk of og oh"/><span class="oe bw bk of og"/></div><div class="ig ih ii ij ik"><p id="2b65" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="oi">更多内容看</em> <a class="ae ks" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="oi">说白了就是</em> </strong> </a> <em class="oi">。报名参加我们的</em> <a class="ae ks" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="oi">免费周报</em> </strong> </a> <em class="oi">。关注我们关于</em><a class="ae ks" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="oi">Twitter</em></strong></a><em class="oi">和</em><a class="ae ks" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="oi">LinkedIn</em></strong></a><em class="oi">。查看我们的</em> <a class="ae ks" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="oi">社区不和谐</em> </strong> </a> <em class="oi">加入我们的</em> <a class="ae ks" href="https://inplainenglish.pallet.com/talent/welcome" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="oi">人才集体</em> </strong> </a> <em class="oi">。</em></p></div></div>    
</body>
</html>