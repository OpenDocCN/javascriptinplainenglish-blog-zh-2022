<html>
<head>
<title>How to Send Login Notifications to Users using Auth0 Actions</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何使用Auth0操作向用户发送登录通知</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-send-login-notifications-to-users-using-auth0-actions-8798597dfb5?source=collection_archive---------1-----------------------#2022-08-21">https://javascript.plainenglish.io/how-to-send-login-notifications-to-users-using-auth0-actions-8798597dfb5?source=collection_archive---------1-----------------------#2022-08-21</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/b6fc742be325ac35b30ec7b0ba2df2df.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*2Vtyzh75W1caZwvdmKYhkA.png"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Sending login notifications to users using Auth0 Actions</figcaption></figure><p id="ba85" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">你永远不能确定你在互联网上的安全性。好消息是，大多数公司正变得积极主动，通过通知用户可疑的登录活动来防止对用户的黑客攻击。一些银行甚至通知用户每次登录尝试，我喜欢这样。</p><p id="ee6f" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">此时，大多数用户已经收到至少一封来自Gmail或Twitter等服务的电子邮件，告知他们帐户上的登录活动，如下图所示。</p><figure class="ky kz la lb gt jo gh gi paragraph-image"><div class="gh gi kx"><img src="../Images/d302b00e991580682806fb6122a6c924.png" data-original-src="https://miro.medium.com/v2/resize:fit:976/format:webp/0*VE-jnBEWzL82taO_.png"/></div></figure><p id="0a43" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">在本文中，您将学习如何使用<a class="ae lc" href="https://auth0.com/blog/introducing-auth0-actions/" rel="noopener ugc nofollow" target="_blank"> Auth0 Actions </a>为您的应用程序设置类似的东西。Auth0操作是JavaScript函数，您可以在身份验证流程的不同阶段插入这些函数，例如用户注册、登录和重置密码，以扩展默认功能。Auth0操作允许您使用第三方库并存储要在代码中使用的机密。</p><p id="3d21" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">你可能已经猜到我要说什么了，但是让我给你描述一下。Auth0操作将在登录启动后执行，并在完成登录流程前发送一封电子邮件，如下所示。</p><figure class="ky kz la lb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi le"><img src="../Images/e723cba46f540b7b4f2a69326315b5e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*fvHxqfSRGNIenBhP.png"/></div></div></figure><p id="bab2" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">在这个例子中，操作将通过电子邮件通知用户，但是你也可以通过短信或其他方式通知用户——我的朋友，没有限制。</p><h1 id="10af" class="lf lg in bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">先决条件</h1><p id="3572" class="pw-post-body-paragraph jz ka in kb b kc md ke kf kg me ki kj kk mf km kn ko mg kq kr ks mh ku kv kw ig bi translated">要了解这个示例，您需要一个Auth0帐户。如果你还没有，你可以注册一个免费的。你还需要一个电子邮件发送服务，比如<a class="ae lc" href="https://sendgrid.com/" rel="noopener ugc nofollow" target="_blank"> Sendgrid </a>来发送电子邮件。</p><h1 id="ee01" class="lf lg in bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">设置Auth0操作</h1><p id="f039" class="pw-post-body-paragraph jz ka in kb b kc md ke kf kg me ki kj kk mf km kn ko mg kq kr ks mh ku kv kw ig bi translated">要设置操作，</p><ol class=""><li id="71a7" class="mi mj in kb b kc kd kg kh kk mk ko ml ks mm kw mn mo mp mq bi translated">打开您的Auth0仪表板</li><li id="0b24" class="mi mj in kb b kc mr kg ms kk mt ko mu ks mv kw mn mo mp mq bi translated">选择左侧导航栏中的<strong class="kb io">动作&gt;流程</strong>选项，并点击<strong class="kb io">构建定制</strong></li></ol><figure class="ky kz la lb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi le"><img src="../Images/8ecfbbc97dff6a5960f3cdccb1a5dfce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*NdHtmDQkDR2aa51Q.png"/></div></div></figure><p id="95f5" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">3.如下所示填写创建操作*<strong class="kb io">*表格，并点击* *创建</strong>按钮</p><figure class="ky kz la lb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi le"><img src="../Images/b2f5f5db6625a97f9625d58a41d6073b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*sJBji26txvx0y1Tr.png"/></div></div></figure><p id="1b29" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">4.将<code class="fe mw mx my mz b">@sendgrid/mail</code> npm包添加到编辑器的依赖部分。</p><figure class="ky kz la lb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi le"><img src="../Images/e16f5eace8f0d164e47d793c56ac75c7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*XuQrPUpsuG_j40Sl.png"/></div></div></figure><p id="f978" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">5.将<code class="fe mw mx my mz b">SENDGRID_API_KEY</code>添加到机密部分。</p><figure class="ky kz la lb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi le"><img src="../Images/8f6ae1b9ca19d13c65959044088bd078.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*BhrXCs5W2uuYRnKy.png"/></div></div></figure><p id="27d3" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">6.在代码编辑器中更新<code class="fe mw mx my mz b">onExecutePostLogin</code>函数，如下所示。<code class="fe mw mx my mz b">event</code>对象提供所需的信息，如存储的机密、电子邮件、名称、所用设备的IP地址和地理位置。你可以在<a class="ae lc" href="https://auth0.com/docs/customize/actions/flows-and-triggers/login-flow/event-object" rel="noopener ugc nofollow" target="_blank">文档</a>中读到更多关于<code class="fe mw mx my mz b">event</code>物体的信息。</p><pre class="ky kz la lb gt na mz nb nc aw nd bi"><span id="d235" class="ne lg in mz b gy nf ng l nh ni">exports.onExecutePostLogin = async (event) =&gt; {<br/>  const sgMail = require('@sendgrid/mail')<br/>  sgMail.setApiKey(event.secrets.SENDGRID_API_KEY)<br/>  const { user, request } = event;<br/>  const { ip, geoip } = request;<br/>  const msg = {<br/>    to: user.email, // Change to your recipient<br/>    from: "f@theanshuman.dev", // Change to your verified sender<br/>    subject: `Recent login from ${geoip.cityName}, ${geoip.countryCode}`,<br/>    html: `Hi ${user.name}, your account has been logged in recently from &lt;b&gt;${geoip.cityName}&lt;/b&gt;, &lt;b&gt;${geoip.countryCode}&lt;/b&gt; from IP address &lt;b&gt;${ip}&lt;/b&gt;.`,<br/>  };<br/>  sgMail<br/>    .send(msg)<br/>    .then(() =&gt; console.log("Sent successfully"))<br/>    .catch((err) =&gt; {<br/>      console.log(err);<br/>    });<br/>};</span></pre><p id="448d" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">7.点击<strong class="kb io">部署</strong>按钮激活动作。</p><figure class="ky kz la lb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi le"><img src="../Images/34d30a8d1a009445fc9adae7792ceb48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*1kS-fxiOMq4o4W0m.png"/></div></div></figure><p id="aafa" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">8.是时候测试一下动作了。登录您的应用程序</p><figure class="ky kz la lb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi le"><img src="../Images/88ddbdfeff97891f5edb8d8c54527d38.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*eBMHBokk9LTIinsI.png"/></div></div></figure><p id="9c4d" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">9.您可以打开Auth0仪表板内的<strong class="kb io">监控&gt;日志</strong>部分来查看操作执行细节。</p><figure class="ky kz la lb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi le"><img src="../Images/791f96066ee17f1c6196246da4fcf9b4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*EFywh8mPML7p3V-V.png"/></div></div></figure><h1 id="93fa" class="lf lg in bd lh li lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc bi translated">结论</h1><p id="ae4a" class="pw-post-body-paragraph jz ka in kb b kc md ke kf kg me ki kj kk mf km kn ko mg kq kr ks mh ku kv kw ig bi translated">在本文中，您了解了Auth0操作，以及如何轻松地创建一个操作来向用户发送登录通知。Auth0是一个领先的身份验证和授权平台，为开发人员提供社交登录、用户管理和无密码登录等功能。你可以<a class="ae lc" href="https://a0.to/signup-for-auth0" rel="noopener ugc nofollow" target="_blank">在Auth0上免费注册</a>来尝试这个例子或者用你自己的一个来做实验。</p><p id="cf02" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated">希望这篇文章对你有帮助！如果你有任何反馈或问题，你可以在下面的评论中提出来。更多此类文章，请关注我的<a class="ae lc" href="https://twitter.com/sun_anshuman" rel="noopener ugc nofollow" target="_blank"> Twitter </a>。</p><p id="193a" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><em class="ld">下次见！</em></p><figure class="ky kz la lb gt jo gh gi paragraph-image"><div class="gh gi nj"><img src="../Images/340b9989138fc742ea3c95ff3154efae.png" data-original-src="https://miro.medium.com/v2/resize:fit:490/0*BIsddI0XLW7qdiuo.gif"/></div></figure></div><div class="ab cl nk nl hr nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="ig ih ii ij ik"><p id="9e7b" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><em class="ld">原载于2022年8月21日</em><a class="ae lc" href="https://dev.to/anshuman_bhardwaj/sending-login-notifications-to-users-using-auth0-actions-153e" rel="noopener ugc nofollow" target="_blank"><em class="ld">https://dev . to</em></a><em class="ld">。</em></p></div><div class="ab cl nk nl hr nm" role="separator"><span class="nn bw bk no np nq"/><span class="nn bw bk no np nq"/><span class="nn bw bk no np"/></div><div class="ig ih ii ij ik"><p id="a287" class="pw-post-body-paragraph jz ka in kb b kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw ig bi translated"><em class="ld">更多内容看</em> <a class="ae lc" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kb io"> <em class="ld">说白了。报名参加我们的</em> <a class="ae lc" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kb io"> <em class="ld">免费每周简讯</em> </strong> </a> <em class="ld">。关注我们关于</em> <a class="ae lc" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"> <strong class="kb io"> <em class="ld">推特</em> </strong> </a>，<a class="ae lc" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kb io"><em class="ld">LinkedIn</em></strong></a><em class="ld">，</em><a class="ae lc" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"><strong class="kb io"><em class="ld">YouTube</em></strong></a><em class="ld">，</em> <a class="ae lc" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kb io"> <em class="ld">不和</em> </strong> </a> <em class="ld">。</em></strong></a></p></div></div>    
</body>
</html>