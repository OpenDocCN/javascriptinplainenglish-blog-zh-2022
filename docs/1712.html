<html>
<head>
<title>Building a Web Page Editor with Craft.js: Getting Set Up</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Craft.js构建网页编辑器:入门</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/getting-started-with-craft-js-setup-df733d961f53?source=collection_archive---------6-----------------------#2022-04-13">https://javascript.plainenglish.io/getting-started-with-craft-js-setup-df733d961f53?source=collection_archive---------6-----------------------#2022-04-13</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="3de3" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">一个由React支持的拖放页面编辑器！</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/6cb05b8cb8f126f8d6c9333e4d9980bb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*oyLVDi-hqTpvSly7"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@emilep?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Emile Perron</a> on <a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="565f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">无论你是想建立自己的网站构建器，还是只是在现有的网站编辑器中添加拖放功能，Craft.js都会支持你！仍处于早期开发阶段，在撰写本文时处于0 . 2 . 0-β3版本，Craft.js使用React作为其选择的库，消除了您自己的页面编辑器中的繁重工作和猜测。</p><h2 id="c3a0" class="lp lq in bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated">什么是Craft.js</h2><p id="fc79" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">Craft.js ( <strong class="kv io"> Craft </strong>)是一个构建在React之上的拖放页面编辑器，它允许容易地被广泛采用，这使得大多数前端开发人员在寻找一个可怕任务的简单解决方案时变得容易。Craft从其他各种解决方案中获得灵感，例如<a class="ae ks" href="https://github.com/artf/grapesjs" rel="noopener ugc nofollow" target="_blank"> Grape.js </a>一个开源页面生成器、<a class="ae ks" href="https://github.com/react-dnd/react-dnd" rel="noopener ugc nofollow" target="_blank"> React-DnD </a>一个用于React的拖放库，它不在内部使用，但被用作参考，以及一个经过修改的<a class="ae ks" href="https://github.com/pelotom/use-methods" rel="noopener ugc nofollow" target="_blank"> use-methods </a>实现，它是一个用于简化reducers的钩子。</p><p id="c535" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Craft也有一个<a class="ae ks" href="https://opencollective.com/craftjs" rel="noopener ugc nofollow" target="_blank">开放集体</a>如果你愿意支持他们，如果你需要支持自己他们也有<a class="ae ks" href="https://discord.gg/sPpF7fX" rel="noopener ugc nofollow" target="_blank">不和</a>。也可以在<a class="ae ks" href="https://github.com/prevwong/craft.js" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上随意查看这个项目！</p><h2 id="2858" class="lp lq in bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated">入门指南</h2><p id="c724" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">对于本文，我使用我自己的模板库，它使用TypeScript、Next和Yarn 3。你可以在这里<a class="ae ks" href="https://github.com/TheGrimSilence/nextjs-typescript-tailwindcss-starter" rel="noopener ugc nofollow" target="_blank">抓取它</a>，我将带你为Craft设置它，也使用TailwindCSS来简化样式。Craft的文档使用了材料UI组件，但是我想创建我们自己的组件。</p><p id="2e8f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这个模板自带了TailwindCSS、NextJS、TypeScript和Yarn 3。虽然大多数Yarn 3安装可能默认使用PnP，但我强烈建议使用<code class="fe mn mo mp mq b">node-modules</code>链接器来确保接下来的构建没有问题。</p><p id="90ce" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">一旦你得到了模板，只需运行<code class="fe mn mo mp mq b">yarn</code>它就会在缓存中解包，这意味着你不必等待Yarn来获取包。我还设置了在安装和卸载时运行的<strong class="kv io"> stage </strong>包，这样任何与Yarn相关的东西都会立即提交给Git。</p><p id="3d7a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在，安装飞船，我们可以开始了！</p><pre class="kd ke kf kg gt mr mq ms mt aw mu bi"><span id="2106" class="lp lq in mq b gy mv mw l mx my">yarn add @craftjs/core</span></pre><h2 id="8b36" class="lp lq in bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated">项目结构</h2><p id="d4e5" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">现在我们已经有了我们需要的一切，我们将通过设置我们的项目结构来结束。</p><pre class="kd ke kf kg gt mr mq ms mt aw mu bi"><span id="7fc5" class="lp lq in mq b gy mv mw l mx my">./components/<br/>  ├ user/<br/>  │ ├ Button.tsx<br/>  │ ├ Container.tsx<br/>  │ ├ Text.tsx<br/>  │ └ Card.tsx<br/>  └ editor/<br/>    ├ Settings.tsx<br/>    ├ Toolbox.tsx<br/>    ├ Canvas.tsx<br/>    ├ RenderNode.tsx<br/>    └ Component.tsx</span></pre><p id="5123" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><strong class="kv io">用户</strong>组件将是用户从<strong class="kv io">工具箱</strong>中拖出并放入<strong class="kv io">画布</strong>中的组件。<strong class="kv io">设置</strong>将是我们编辑所选组件/节点的控件。<strong class="kv io">组件</strong>不是必需的，但是对于以一种方便的方式分配名称、图标和相关元素是有用的。</p><p id="4284" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这就是设置，所以让我们来看看一些基本的工艺。</p><h2 id="0de5" class="lp lq in bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated">编辑器组件</h2><p id="3184" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">为了让我们用我们的任何组件做任何事情，Craft需要准确地知道我们的应用程序的哪一部分属于它。这就是<code class="fe mn mo mp mq b"><a class="ae ks" href="https://craft.js.org/docs/api/editor" rel="noopener ugc nofollow" target="_blank">&lt;Editor /&gt;</a></code>的用武之地！编辑器组件是存储状态的上下文提供者。它附带了一些重要的道具:</p><ul class=""><li id="f0d9" class="mz na in kv b kw kx kz la lc nb lg nc lk nd lo ne nf ng nh bi translated"><code class="fe mn mo mp mq b">resolver</code>:这是我们添加用户组件数组的地方，这样Craft就知道如何在编辑器中解析组件的任何实例。否则，就像试图使用React而不导入它一样。</li><li id="6d0b" class="mz na in kv b kw ni kz nj lc nk lg nl lk nm lo ne nf ng nh bi translated"><code class="fe mn mo mp mq b">enabled</code>:布尔值，控制编辑器是否允许任何编辑。当您想要启用正在编辑的页面的预览时，请使用此选项。</li><li id="1d05" class="mz na in kv b kw ni kz nj lc nk lg nl lk nm lo ne nf ng nh bi translated"><code class="fe mn mo mp mq b">indicator</code>:如果你对红色/绿色不满意，可以在这里设置拖放指示器的颜色。虽然文档中没有说明，但您也可以设置<code class="fe mn mo mp mq b">transition: "none"</code>关闭指示器的默认扭曲转换。</li><li id="c1be" class="mz na in kv b kw ni kz nj lc nk lg nl lk nm lo ne nf ng nh bi translated"><code class="fe mn mo mp mq b">onRender</code>:这就是我们的<strong class="kv io"> RenderNode </strong>组件的用武之地，我们用它来定义我们选择的节点周围的边界以及其他附加内容，比如选择的组件或控件的名称。</li></ul><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nn"><img src="../Images/16ec46d97b3942c1db7be3be61e9cfb5.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FbJszabxaIeqkmJUJ2-QGQ.png"/></div></div></figure><h2 id="6b03" class="lp lq in bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated">框架组件</h2><p id="7682" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">在<strong class="kv io">编辑器</strong>中，我们需要定义应用程序中可编辑的区域。因此<strong class="kv io">编辑器</strong>保持状态，<strong class="kv io">帧</strong>是我们正在编辑的画布。这意味着在编辑器中我们也可以有两个侧栏，<strong class="kv io">工具箱</strong>和<strong class="kv io">设置</strong>，因为它们属于编辑器状态。它只有一个属性，<code class="fe mn mo mp mq b">data?</code>,这个属性是可选的，允许我们加载JSON提供的序列化节点。这方面的一个用例是在多页编辑器中加载保存到数据库的页面。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nn"><img src="../Images/eece38ed86c555dc646631ba7e59c686.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YrleX-TqfsQtSSsYphz1gw.png"/></div></div></figure><h2 id="dacf" class="lp lq in bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated">元素组件</h2><p id="7d80" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">最后，在树的底部，我们有<strong class="kv io">元素</strong>组件，它将一个常规的React组件变成一个可编辑的Craft组件。在将组件拖放到编辑器中时，您不需要这样做，但是如果您希望组件的各个部分拥有自己的dropzones，那么<strong class="kv io">元素</strong>会在容器或卡片组件中定义这些区域。它有几个重要的道具:</p><ul class=""><li id="c123" class="mz na in kv b kw kx kz la lc nb lg nc lk nd lo ne nf ng nh bi translated"><code class="fe mn mo mp mq b">is</code>:要么是“div”这样的基本元素，要么是你的<strong class="kv io">用户</strong>交给它的某个组件。不放“容器”，放<code class="fe mn mo mp mq b">is={Container}</code>。</li><li id="6448" class="mz na in kv b kw ni kz nj lc nk lg nl lk nm lo ne nf ng nh bi translated"><code class="fe mn mo mp mq b">id?</code>:如果组件在一个<strong class="kv io">用户</strong>组件中，它会给组件分配一个id，这样Craft就不会混淆。</li><li id="5869" class="mz na in kv b kw ni kz nj lc nk lg nl lk nm lo ne nf ng nh bi translated"><code class="fe mn mo mp mq b">canvas?</code>:将节点设置为画布节点的布尔值。不知道这意味着什么，除了它为用户创建一个可编辑的dropzone来放置节点。</li><li id="dcf7" class="mz na in kv b kw ni kz nj lc nk lg nl lk nm lo ne nf ng nh bi translated"><code class="fe mn mo mp mq b">hidden?</code>:隐藏节点，我不确定这是什么目的，因为我不确定它是对树还是对用户隐藏节点。<code class="fe mn mo mp mq b">display: "none"</code>※后者。</li><li id="c0e8" class="mz na in kv b kw ni kz nj lc nk lg nl lk nm lo ne nf ng nh bi translated"><code class="fe mn mo mp mq b">custom?</code>:设置自定义属性，同样不确定你会用它来做什么。也许对于craft的节点数据之上的自定义数据，比如给每个节点分配hashnamess，类似于Webflow存储它们的hashname？</li><li id="da12" class="mz na in kv b kw ni kz nj lc nk lg nl lk nm lo ne nf ng nh bi translated">这是一个棘手的问题。只有当<code class="fe mn mo mp mq b">is</code>设置为1时，才会将我们的道具传递给你的<strong class="kv io">用户</strong>组件。如果<code class="fe mn mo mp mq b">is</code>是一个字符串，比如“div ”,那么它什么也不做。</li></ul><p id="dbeb" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">你也可以在<strong class="kv io">元素</strong>上提供常规的道具，比如<code class="fe mn mo mp mq b">className</code>，但是只有当<code class="fe mn mo mp mq b">is</code>是一个普通的HTML元素，比如div，它才有效。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nn"><img src="../Images/6fad957eedadae9b2f384d8c7468fd48.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QYRxdaM5l_kerjRWJtmIRg.png"/></div></div></figure><h2 id="475a" class="lp lq in bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated">把所有的放在一起</h2><p id="babb" class="pw-post-body-paragraph kt ku in kv b kw mi jo ky kz mj jr lb lc mk le lf lg ml li lj lk mm lm ln lo ig bi translated">最后，你有一个非常基本的编辑器。它还不能做太多，但是我们将在第二部分中扩展它。我们有一个带有单个dropzone的编辑器，但是没有可以拖动的<strong class="kv io">用户</strong>组件，并且无法访问这些设置。我们将在下一部分处理所有这些问题！</p><p id="b347" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="no">更多内容看</em> <a class="ae ks" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="no">说白了。报名参加我们的</em> <a class="ae ks" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="no">免费周报</em> </strong> </a> <em class="no">。关注我们关于</em><a class="ae ks" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="no">Twitter</em></strong></a><em class="no">和</em><a class="ae ks" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="no">LinkedIn</em></strong></a><em class="no">。加入我们的</em> <a class="ae ks" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="no">社区</em> </strong> </a> <em class="no">。</em></strong></a></p></div></div>    
</body>
</html>