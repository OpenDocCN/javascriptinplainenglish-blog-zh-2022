<html>
<head>
<title>Create an SDL Field with GraphQL Modules for Schema Stitching</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用GraphQL模块创建一个SDL字段用于模式拼接</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/creating-an-sdl-field-with-graphql-modules-for-schema-stitching-38e4f8e6c482?source=collection_archive---------8-----------------------#2022-03-17">https://javascript.plainenglish.io/creating-an-sdl-field-with-graphql-modules-for-schema-stitching-38e4f8e6c482?source=collection_archive---------8-----------------------#2022-03-17</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="df16" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">使用GraphQL模块创建SDL场的指南。</h2></div><p id="185b" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">GraphQL模块是一种以划分方式构建现代GraphQL应用程序的便捷方式。这个由公会创建的方便的库让开发人员以一种更容易测试和长期开发的方式分解他们的GraphQL模式。</p><p id="9b05" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">进入<a class="ae ky" href="https://www.graphql-tools.com/docs/schema-stitching/stitch-combining-schemas" rel="noopener ugc nofollow" target="_blank"> GraphQL模式拼接</a>，这是一种将子模式组合成大型“网关”模式供应用程序使用的便捷方式。用最简单的术语来说，它就像是GraphQL模式的SQL连接。</p><figure class="la lb lc ld gt le gh gi paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="gh gi kz"><img src="../Images/037b32f3881a4b2dc0cec0a02f72643b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*y-v6rdyclzniSXwB.png"/></div></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk">Image from GraphQL Tools Schema Stitching Docs</figcaption></figure><p id="0425" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在模式拼接中组合模式的一种方法是使用带有指令的SDL。通常，当试图找到有关GraphQL模式的更多细节时，使用自省来找出模式上所有可用的类型和变化。然而，对于指令，自省不起作用，因为指令将从输出中省略，网关将被迫创建自己的合并配置来组合子模式。创建那些合并配置可能很糟糕，而指令使它变得稍微容易一些。</p></div><div class="ab cl lp lq hr lr" role="separator"><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu lv"/><span class="ls bw bk lt lu"/></div><div class="ig ih ii ij ik"><p id="ca60" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">SDL字段的一个挑战是，它需要访问应用程序的整个模式，以便生成正确的字符串并附加模式拼接所需的指令。使用<code class="fe lw lx ly lz b">createApplication</code>配置上的<code class="fe lw lx ly lz b">schemaBuilder</code>选项，我们能够做一些神奇的✨让它工作。</p><figure class="la lb lc ld gt le gh gi paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="gh gi ma"><img src="../Images/3e61144ec1a8b0e6b1ba745329f3bd5f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6Gk6UbUwkqnv_1LV4dQagA.png"/></div></div></figure><p id="e777" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">下面的<code class="fe lw lx ly lz b">sdlSchemaBuilder</code>能够从组合的GraphQL模块中获取解析器和typedef，并添加所需的解析器、typedef和模式转换器，以便出现模式指令。</p><figure class="la lb lc ld gt le gh gi paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="gh gi mb"><img src="../Images/6e8629bf70954225eb7c8590668e1104.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*FzFam0Tj75ngZZg48ysanQ.png"/></div></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk">sdlSchemaHelper for the schemaBuilder in a GraphQL module createApplication</figcaption></figure><pre class="la lb lc ld gt mc lz md me aw mf bi"><span id="76d2" class="mg mh in lz b gy mi mj l mk ml">const { print } = require('graphql')<br/>const { gql } = require('graphql-modules')<br/>const { makeExecutableSchema } = require('@graphql-tools/schema')<br/>const { stitchingDirectives } <br/>       = require("@graphql-tools/stitching-directives")<br/>const { mergeTypeDefs, <br/>        mergeResolvers <br/>      } = require('@graphql-tools/merge')<br/>const { stitchingDirectivesTypeDefs, <br/>        stitchingDirectivesValidator<br/>      } = stitchingDirectives()</span><span id="5ad6" class="mg mh in lz b gy mm mj l mk ml">const sdlQuerySchema = gql`<br/>   type Query {<br/>      _sdl: String!<br/>   }</span><span id="865b" class="mg mh in lz b gy mm mj l mk ml">`</span><span id="6a9c" class="mg mh in lz b gy mm mj l mk ml">module.exports = ({ typeDefs, resolvers }) =&gt; {<br/>  const directivesTypeDefs = mergeTypeDefs([<br/>     stitchingDirectivesTypeDefs,<br/>     typeDefs,<br/>     sdlQuerySchema <br/>  ])</span><span id="d2ae" class="mg mh in lz b gy mm mj l mk ml">  const sdlQueryResolvers = {<br/>    Query: {<br/>      _sdl: () =&gt; print(directivesTypeDefs)<br/>    }<br/>  }</span><span id="82ef" class="mg mh in lz b gy mm mj l mk ml">  const mergedResolvers = <br/>    mergeResolvers([resolvers,    sdlQueryResolvers])</span><span id="7321" class="mg mh in lz b gy mm mj l mk ml">  return makeExecutableSchema({<br/>    typeDefs: directivesTypeDefs,<br/>    schemaTransforms: [stitchingDirectivesValidator],<br/>    resolvers: mergedResolvers<br/>  })</span><span id="cd6f" class="mg mh in lz b gy mm mj l mk ml">}</span></pre><p id="a85b" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">通过使用<code class="fe lw lx ly lz b">mergeResolvers</code> <code class="fe lw lx ly lz b">mergeTypeDefs</code> <code class="fe lw lx ly lz b">print</code>和<code class="fe lw lx ly lz b">makeExecutableSchema</code>函数，我们能够将已经组合的应用程序的模式与附加的<code class="fe lw lx ly lz b">_sdl</code>字段、<code class="fe lw lx ly lz b">_sdl</code>解析器和应用程序的模式指令相结合，从而创建一个与指令兼容的GraphQL模块应用程序的模式拼接！这是一个口，但我希望这有所帮助！</p><p id="9748" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">编码快乐！</p><p id="83f5" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">—帕特</p><p id="3d3a" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="mn">更多内容请看</em><a class="ae ky" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="ke io"><em class="mn">plain English . io</em></strong></a><em class="mn">。报名参加我们的</em> <a class="ae ky" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io"> <em class="mn">免费周报</em> </strong> </a> <em class="mn">。关注我们关于</em><a class="ae ky" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="ke io"><em class="mn">Twitter</em></strong></a><em class="mn">和</em><strong class="ke io"><em class="mn"/></strong><a class="ae ky" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="ke io"><em class="mn">LinkedIn</em></strong></a><em class="mn">。加入我们的</em> <a class="ae ky" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io"> <em class="mn">社区</em> </strong> </a> <em class="mn">。</em></p></div></div>    
</body>
</html>