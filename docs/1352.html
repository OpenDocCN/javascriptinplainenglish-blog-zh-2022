<html>
<head>
<title>Why Did and Don’t You Need to Import React?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">为什么需要和不需要导入React？</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/why-did-and-dont-you-need-to-import-react-ad5a57ccaa9e?source=collection_archive---------6-----------------------#2022-03-18">https://javascript.plainenglish.io/why-did-and-dont-you-need-to-import-react-ad5a57ccaa9e?source=collection_archive---------6-----------------------#2022-03-18</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="ae9d" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">这对你来说意味着什么？</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/f3f5829f05e4351227dddbc59909718a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-tKFy4n9I3HxeEIX_9zH_w.png"/></div></div></figure><p id="3b7e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">从React v17.0开始，您不必再在JSX文件中导入React。但是，为什么在创建React组件时，这种看似未使用的导入首先是必要的呢？为什么现在不再是了？</p><p id="e86d" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">在React开发的很长一段时间里，有必要在使用React组件的JavaScript或TypeScript文件中导入<code class="fe ln lo lp lq b">React</code>。直到2020年8月发布的React v17.0，React才引入了一个新的转换功能，使其开发人员不必再这样做了。</p><p id="e0c8" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">但是为什么我们首先要进口它呢？我们每次创建React组件时都必须添加这个看似未使用的导入，这是什么原因呢？为什么我们“突然”不再需要它了？</p><h1 id="e5e7" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">我们需要它的原因</h1><p id="ea7d" class="pw-post-body-paragraph kr ks iq kt b ku mj jr kw kx mk ju kz la ml lc ld le mm lg lh li mn lk ll lm ij bi translated">如果你不熟悉React开发，它由大量所谓的React组件组成。React开发背后的主要理念是创建可以在不同场景中重用和组合的小组件。要创建React组件，标准是使用JSX，它是JavaScript的语法扩展。</p><p id="9fd3" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">此类组件和JSX的外观示例如下:</p><pre class="kg kh ki kj gt mo lq mp mq aw mr bi"><span id="b253" class="ms ls iq lq b gy mt mu l mv mw">import React from "react";</span><span id="3ce4" class="ms ls iq lq b gy mx mu l mv mw">function Card({ content }) {<br/>  return (<br/>    &lt;div&gt;<br/>      &lt;CardBody size="medium"&gt;{content}&lt;/CardBody&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span></pre><p id="da2c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">对于大多数React开发人员来说，这感觉非常熟悉。这是一个接受一个道具的简单的<code class="fe ln lo lp lq b">Card</code>组件。该组件本身呈现一些HTML、一个单独的<code class="fe ln lo lp lq b">div</code>和另一个名为<code class="fe ln lo lp lq b">CardBody</code>的随机React组件。对于后一个组件，我们传递两个属性:<code class="fe ln lo lp lq b">Card</code>作为其<code class="fe ln lo lp lq b">children</code>接收的<code class="fe ln lo lp lq b">content</code>属性和其<code class="fe ln lo lp lq b">size</code>属性的静态值。</p><p id="ff7c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这里没什么特别的。但是在目前的形式下，浏览器对此无能为力。如前所述，JSX是建立在JavaScript之上的语法扩展。浏览器不理解JSX，所以当它试图评估这段代码时，它只会抛出一个错误。</p><p id="5974" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">这跟必须导入<code class="fe ln lo lp lq b">React</code>有什么关系？最终，您的React代码仍然需要由浏览器接收和呈现。但它将首先被转换成浏览器可以理解的形式，而不是当前的形式:常规JavaScript。这将看起来如下:</p><pre class="kg kh ki kj gt mo lq mp mq aw mr bi"><span id="d5ef" class="ms ls iq lq b gy mt mu l mv mw">import React from "react";</span><span id="e39c" class="ms ls iq lq b gy mx mu l mv mw">function Card({ content }) {<br/>  return React.createElement('div', null, React.createElement(CardBody, { size: 'medium' }, content));<br/>}</span></pre><p id="b3dd" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">所有的语法糖都被去除，并转换成各自的JavaScript等价物。基于此，我们可以看到，使用JSX创建一个React组件只不过是一个使用3个函数参数的函数调用:组件的类型、它在对象形式中的属性以及它的子元素。</p><p id="d54c" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">但最需要注意的是函数本身。在引擎盖下，React组件是<code class="fe ln lo lp lq b">createElement</code>调用，该函数来自<code class="fe ln lo lp lq b">React</code>。基于此，我们可以回到本文最初的问题，理解每当我们创建一个React组件时导入<code class="fe ln lo lp lq b">React</code>的必要性。没有它，转换后的JSX代码将在浏览器中失败，因为React需要在范围内通过其<code class="fe ln lo lp lq b">createElement</code>函数创建组件。</p><h1 id="d21d" class="lr ls iq bd lt lu lv lw lx ly lz ma mb jw mc jx md jz me ka mf kc mg kd mh mi bi translated">我们不再需要它的原因是</h1><p id="263d" class="pw-post-body-paragraph kr ks iq kt b ku mj jr kw kx mk ju kz la ml lc ld le mm lg lh li mn lk ll lm ij bi translated">所以现在我们知道了之前为什么需要它，下一个有趣的问题就变成了为什么我们突然不再需要它了。React v17.0中的什么改变让我们不必在每个使用JSX的文件中执行这种烦人且看似无用的<code class="fe ln lo lp lq b">React</code>导入？</p><p id="e16e" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">简而言之，React将创建元素的功能移向了新的入口点。它没有依赖于包的主入口点中公开的<code class="fe ln lo lp lq b">createElement</code>函数，而是被分割成仅供编译器使用的入口点，如Babel和TypeScript。</p><p id="b87f" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">因此，现在在转换JSX时，编译器能够并且将会自动从那些新的入口点导入适当的函数。这意味着开发人员不必手动添加<code class="fe ln lo lp lq b">React</code>导入，因为编译器不再需要依赖主入口点。转换前后的示例代码如下所示:</p><pre class="kg kh ki kj gt mo lq mp mq aw mr bi"><span id="b5a1" class="ms ls iq lq b gy mt mu l mv mw">function Card({ content }) {<br/>  return (<br/>    &lt;div&gt;<br/>      &lt;CardBody size="medium"&gt;{content}&lt;/CardBody&gt;<br/>    &lt;/div&gt;<br/>  );<br/>}</span><span id="9aec" class="ms ls iq lq b gy mx mu l mv mw">// Inserted by a compiler<br/>import { jsx as _jsx } from 'react/jsx-runtime';</span><span id="0867" class="ms ls iq lq b gy mx mu l mv mw">function Card({ content }) {<br/>  return _jsx("div", {<br/>    children: _jsx(CardBody, { size: "medium", children: content })<br/>  });<br/>}</span></pre><p id="d527" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">为了向后兼容，这个特性也被移植到了大多数旧的React版本中。如果您想了解更多关于如何升级到这种新的JSX变换，建议看一看<a class="ae my" href="https://reactjs.org/blog/2020/09/22/introducing-the-new-jsx-transform.html#how-to-upgrade-to-the-new-jsx-transform" rel="noopener ugc nofollow" target="_blank">升级指南</a>。</p></div><div class="ab cl mz na hu nb" role="separator"><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne nf"/><span class="nc bw bk nd ne"/></div><div class="ij ik il im in"><p id="c8f5" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated">如果你喜欢这篇文章，可以考虑看看<a class="ae my" href="https://www.getrevue.co/profile/chakshunyu" rel="noopener ugc nofollow" target="_blank">不凡反应</a>时事通讯和我的<a class="ae my" href="https://twitter.com/keraito" rel="noopener ugc nofollow" target="_blank">推特</a>中的其他条目，以便将来更新。</p><p id="38e7" class="pw-post-body-paragraph kr ks iq kt b ku kv jr kw kx ky ju kz la lb lc ld le lf lg lh li lj lk ll lm ij bi translated"><em class="ng">更多内容请看</em><a class="ae my" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kt ir"><em class="ng">plain English . io</em></strong></a><em class="ng">。报名参加我们的</em> <a class="ae my" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir"> <em class="ng">免费周报</em> </strong> </a> <em class="ng">。关注我们关于</em><a class="ae my" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="kt ir"><em class="ng">Twitter</em></strong></a><em class="ng">和</em><strong class="kt ir"><em class="ng"/></strong><a class="ae my" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kt ir"><em class="ng">LinkedIn</em></strong></a><em class="ng">。加入我们的</em> <a class="ae my" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kt ir"> <em class="ng">社区</em> </strong> </a> <em class="ng">。</em></p></div></div>    
</body>
</html>