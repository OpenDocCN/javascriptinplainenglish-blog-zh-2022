<html>
<head>
<title>How to Convert Your Angular App into a PWA (2022)</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何将您的Angular应用程序转换为PWA (2022)</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/this-is-how-to-convert-your-angular-app-into-a-pwa-2022-694a086effc5?source=collection_archive---------5-----------------------#2022-05-30">https://javascript.plainenglish.io/this-is-how-to-convert-your-angular-app-into-a-pwa-2022-694a086effc5?source=collection_archive---------5-----------------------#2022-05-30</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="a3e0" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">关于如何将Angular应用程序转换为渐进式web应用程序(PWA)的教程。</h2></div><p id="4f53" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">你听说过PWA的成功故事吗？</p><p id="20dd" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">例如，当星巴克从iOS应用程序转换到PWA时，他们能够将应用程序的大小减少99.84%。您可以在此阅读详细的案例研究<a class="ae ky" href="https://formidable.com/work/starbucks-progressive-web-app/" rel="noopener ugc nofollow" target="_blank">。</a></p><p id="8960" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Pinterest的广告收入增长了44%。</p><p id="17f0" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">更不用说Spotify、优步、Twitter和其他已经在渐进式网络应用上取得巨大成功的公司了。</p><figure class="la lb lc ld gt le gh gi paragraph-image"><div class="gh gi kz"><img src="../Images/6f60cfb033808dbf7174d5ce00ccf999.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/0*V0pJ2s1456SHYH4o.jpg"/></div></figure><p id="7a43" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">但即使有这些诱人的成功故事，我仍然遇到一些公司正在使用Angular，但没有将他们的Angular应用程序转换为PWA——即使只需要5分钟或更少。😲</p><p id="47a7" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">例如，我最近为丹麦一家名为<a class="ae ky" href="https://relion.dk" rel="noopener ugc nofollow" target="_blank"> Relion </a>的初创公司做了一些<a class="ae ky" href="https://danielk.tech/consulting" rel="noopener ugc nofollow" target="_blank">角度咨询</a>。他们遇到了运行时性能问题，打电话给我来帮助他们。有一次，我不经意地提到考虑使用PWA来提高他们的加载时性能，并惊讶地发现他们对Angular的渐进式web应用程序功能了解不多。</p><figure class="la lb lc ld gt le gh gi paragraph-image"><div class="gh gi lh"><img src="../Images/5d4057014a36602dc50e00a6beaee89a.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/0*dtOMzIp6Kd0De_td.gif"/></div></figure><p id="3cf1" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">所以…</p><p id="88b2" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">今天，我们将讨论使用Angular service workers来创建PWA(渐进式web应用程序)。</p><p id="35a5" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">准备好了吗？</p><p id="b697" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">让我们深入研究一下，从优势开始。</p><h1 id="ec9b" class="li lj in bd lk ll lm ln lo lp lq lr ls jt lt ju lu jw lv jx lw jz lx ka ly lz bi translated">有什么优势？</h1><p id="8cb9" class="pw-post-body-paragraph kc kd in ke b kf ma jo kh ki mb jr kk kl mc kn ko kp md kr ks kt me kv kw kx ig bi translated">以下是将Angular应用程序转换成渐进式web应用程序的一些好处。</p><ul class=""><li id="094c" class="mf mg in ke b kf kg ki kj kl mh kp mi kt mj kx mk ml mm mn bi translated">疯狂的负载速度性能(如果做得好)。</li><li id="b5cf" class="mf mg in ke b kf mo ki mp kl mq kp mr kt ms kx mk ml mm mn bi translated">一个类似原生的应用程序，可以通过移动浏览器或谷歌Play商店(如果你知道怎么做，还有苹果商店)访问。</li><li id="e27c" class="mf mg in ke b kf mo ki mp kl mq kp mr kt ms kx mk ml mm mn bi translated">App store独立性。</li><li id="8163" class="mf mg in ke b kf mo ki mp kl mq kp mr kt ms kx mk ml mm mn bi translated">能够离线操作(感谢服务人员)。</li><li id="7ea4" class="mf mg in ke b kf mo ki mp kl mq kp mr kt ms kx mk ml mm mn bi translated">通过服务人员发送推送通知的能力。</li><li id="1bfe" class="mf mg in ke b kf mo ki mp kl mq kp mr kt ms kx mk ml mm mn bi translated">有一个自定义闪屏(在Angular 中也称为<a class="ae ky" href="https://danielk.tech/home/angular-app-shell-ultimate-guide" rel="noopener ugc nofollow" target="_blank">应用外壳)</a></li><li id="d169" class="mf mg in ke b kf mo ki mp kl mq kp mr kt ms kx mk ml mm mn bi translated">令人敬畏的搜索引擎优化得分——作为快速响应的网页，PWAs的平均搜索引擎优化得分为85分。</li><li id="614d" class="mf mg in ke b kf mo ki mp kl mq kp mr kt ms kx mk ml mm mn bi translated">更小的文件大小(本地应用比PWA需要更多的数据来下载)。</li><li id="1a29" class="mf mg in ke b kf mo ki mp kl mq kp mr kt ms kx mk ml mm mn bi translated">无痛更新(服务人员会在后台自动更新应用，无需用户做任何事情)。</li></ul><h1 id="0a95" class="li lj in bd lk ll lm ln lo lp lq lr ls jt lt ju lu jw lv jx lw jz lx ka ly lz bi translated">缺点是什么？</h1><p id="fece" class="pw-post-body-paragraph kc kd in ke b kf ma jo kh ki mb jr kk kl mc kn ko kp md kr ks kt me kv kw kx ig bi translated">缺点？</p><p id="ea30" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">坦率地说，我知道的缺点很少。</p><p id="4f66" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我所知道的最大的缺点是苹果商店的政策不允许开发者将他们的渐进式网络应用程序作为一个应用程序来部署。</p><p id="070e" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">你的应用应该包括功能、内容和用户界面，使其超越一个重新包装的网站。如果你的应用不是特别有用、独特或“像应用一样”，它就不属于应用商店。— 苹果应用商店</p><p id="d631" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果你知道任何其他突出的缺点，那么请在这篇文章的底部留下评论。👇</p><h1 id="64bb" class="li lj in bd lk ll lm ln lo lp lq lr ls jt lt ju lu jw lv jx lw jz lx ka ly lz bi translated">怎么做？</h1><p id="70dc" class="pw-post-body-paragraph kc kd in ke b kf ma jo kh ki mb jr kk kl mc kn ko kp md kr ks kt me kv kw kx ig bi translated">第一步是<a class="ae ky" href="https://danielk.tech/home/how-to-install-and-use-the-angular-cli" rel="noopener ugc nofollow" target="_blank">使用Angular CLI </a>安装<a class="ae ky" href="https://npmjs.com/@angular/pwa" rel="noopener ugc nofollow" target="_blank"> @angular/pwa </a>包。</p><pre class="la lb lc ld gt mu mv mw mx aw my bi"><span id="14e2" class="mz lj in mv b gy na nb l nc nd">ng add @angular/pwa</span></pre><p id="eed3" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">过去，专家们需要几个小时甚至几天来创建一个PWA——现在，一个3岁的剃须刀可以在你阻止他之前安装这个。</p><p id="10ec" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">刚刚发生了什么？</p><figure class="la lb lc ld gt le gh gi paragraph-image"><div class="gh gi lh"><img src="../Images/f0b164ff7a6b502d766b0b57f0a40a0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:600/0*jbVORSBaEj9y8D80.gif"/></div></figure><p id="8db8" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><code class="fe ne nf ng mv b">@angular/pwa</code>包是一个Angular示意图，它将<a class="ae ky" href="https://web.dev/progressive-web-apps" rel="noopener ugc nofollow" target="_blank">渐进式Web应用</a>支持添加到Angular应用中。简而言之，这里有一些你应该知道的事情:</p><ul class=""><li id="9fb5" class="mf mg in ke b kf kg ki kj kl mh kp mi kt mj kx mk ml mm mn bi translated">在app模块中自动导入并注册服务人员。</li><li id="bf50" class="mf mg in ke b kf mo ki mp kl mq kp mr kt ms kx mk ml mm mn bi translated">更新<code class="fe ne nf ng mv b">index.html</code>以包含<code class="fe ne nf ng mv b">manifest.json</code>文件，该文件包含关于渐进式web应用程序的详细信息。</li><li id="243a" class="mf mg in ke b kf mo ki mp kl mq kp mr kt ms kx mk ml mm mn bi translated">创建图标文件以支持PWA。这些都放在<code class="fe ne nf ng mv b">src/assets/icons</code>文件夹中，应该用应用程序的图标进行更新，以便进行品牌推广。</li><li id="c45b" class="mf mg in ke b kf mo ki mp kl mq kp mr kt ms kx mk ml mm mn bi translated">创造了<code class="fe ne nf ng mv b">src/ngsw-config.json</code>。该文件用于配置服务人员。</li></ul><p id="5776" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">这就是如何将你的Angular应用程序转换成PWA。</p><p id="d79f" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果您对如何配置缓存行为有疑问，请查看Angular文档中的<a class="ae ky" href="https://angular.io/guide/service-worker-config" rel="noopener ugc nofollow" target="_blank">页面。</a></p><h1 id="f5b8" class="li lj in bd lk ll lm ln lo lp lq lr ls jt lt ju lu jw lv jx lw jz lx ka ly lz bi translated">有角度的PWA是如何工作的？</h1><p id="a11a" class="pw-post-body-paragraph kc kd in ke b kf ma jo kh ki mb jr kk kl mc kn ko kp md kr ks kt me kv kw kx ig bi translated">如果你正在努力理解正在发生的一切，让我花点时间来解释一下。</p><p id="a55c" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">首先，渐进式web应用程序只不过是一个美化了的网页，它使用<a class="ae ky" href="https://en.wikipedia.org/wiki/Progressive_web_application#Service_workers" rel="noopener ugc nofollow" target="_blank">服务工作者</a>来缓存资产和数据以供离线使用或加快加载速度。</p><p id="d8b7" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们刚刚做的是使用<code class="fe ne nf ng mv b">@angular/pwa</code> schematics包创建一个服务工作器，它将缓存我们配置的任何内容。默认情况下，服务人员将自动缓存以下文件。</p><ul class=""><li id="e0ef" class="mf mg in ke b kf kg ki kj kl mh kp mi kt mj kx mk ml mm mn bi translated"><code class="fe ne nf ng mv b">favicon.ico</code></li><li id="38b4" class="mf mg in ke b kf mo ki mp kl mq kp mr kt ms kx mk ml mm mn bi translated">所有的构建工件(JavaScript和CSS包)。</li><li id="7827" class="mf mg in ke b kf mo ki mp kl mq kp mr kt ms kx mk ml mm mn bi translated">位于资产文件夹中的任何文件。</li><li id="814e" class="mf mg in ke b kf mo ki mp kl mq kp mr kt ms kx mk ml mm mn bi translated">配置的<code class="fe ne nf ng mv b">outputPath</code>或<code class="fe ne nf ng mv b">resourcesOutputPath</code>正下方的图像和字体。</li></ul><p id="771a" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在，当我们部署我们的Angular应用程序时，服务人员将与它一起部署，并将缓存上面的资产。下次用户加载您的web应用程序时，它会加载得更快，因为您的CSS、JavaScript和其他资产已经被服务人员缓存了。</p><p id="5ec0" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">情况越来越好。</p><p id="2b43" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">当您部署新版本时，服务人员将检测到这些更改，并在后台静默更新缓存，以便下次重新加载您的应用时，用户将运行最新版本。</p><p id="5422" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果您想订阅这些更新，并在缓存更新后提示用户重新加载，那么下面是如何做的。</p><pre class="la lb lc ld gt mu mv mw mx aw my bi"><span id="99f8" class="mz lj in mv b gy na nb l nc nd">import { Component, OnInit } from '@angular/core';<br/>import { SwUpdate } from '@angular/service-worker';<br/><br/>@Component({<br/>  selector: 'app-root',<br/>  templateUrl: './app.component.html',<br/>  styleUrls: ['./app.component.css']<br/>})<br/>export class AppComponent implements OnInit{<br/><br/>  constructor( private swUpdate: SwUpdate) {}<br/><br/>    ngOnInit() {<br/>      if (this.swUpdate.isEnabled) {<br/>        this.swUpdate.available.subscribe(() =&gt; {<br/>          if(confirm("You're using an old version of the control panel. Want to update?")) {<br/>            window.location.reload();<br/>          }<br/>        });<br/>      }<br/>    }<br/>}</span></pre><h1 id="a524" class="li lj in bd lk ll lm ln lo lp lq lr ls jt lt ju lu jw lv jx lw jz lx ka ly lz bi translated">你完了！</h1><p id="562d" class="pw-post-body-paragraph kc kd in ke b kf ma jo kh ki mb jr kk kl mc kn ko kp md kr ks kt me kv kw kx ig bi translated">现在我想听听你的意见:</p><p id="46ce" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">你打算把你的Angular项目转换成一个渐进式的web应用程序吗？</p><p id="d2fd" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">又或许你觉得不值得？</p><p id="0cb9" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">请在下面的评论区告诉我。</p><p id="cac0" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="ke io">关注我:</strong> <a class="ae ky" href="https://github.com/dkreider" rel="noopener ugc nofollow" target="_blank"> GitHub </a>，<a class="ae ky" href="https://dkreider.medium.com/" rel="noopener">中型</a>，<a class="ae ky" href="https://danielk.tech/" rel="noopener ugc nofollow" target="_blank">个人博客</a></p><figure class="la lb lc ld gt le gh gi paragraph-image"><div class="gh gi nh"><img src="../Images/95331bea99429ddad97fd233e334b403.png" data-original-src="https://miro.medium.com/v2/resize:fit:570/format:webp/0*cYsy1aPE_y1jrYms.png"/></div></figure></div><div class="ab cl ni nj hr nk" role="separator"><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn no"/><span class="nl bw bk nm nn"/></div><div class="ig ih ii ij ik"><p id="5c0f" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="mt">最初发布于</em><a class="ae ky" href="https://danielk.tech/home/angular-pwa" rel="noopener ugc nofollow" target="_blank"><em class="mt">https://danielk . tech</em></a><em class="mt">。</em></p><p id="ee87" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="mt">更多内容看</em> <a class="ae ky" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io"> <em class="mt">说白了。报名参加我们的</em><strong class="ke io"><em class="mt"/></strong><a class="ae ky" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="ke io"><em class="mt">免费每周简讯</em> </strong> </a> <em class="mt">。关注我们</em> <a class="ae ky" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io"> <em class="mt">推特</em> </strong> </a> <em class="mt">和</em><a class="ae ky" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="ke io"><em class="mt">LinkedIn</em></strong></a><em class="mt">。查看我们的</em> <a class="ae ky" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io"> <em class="mt">社区不和谐</em> </strong> </a> <em class="mt">加入我们的</em> <a class="ae ky" href="https://inplainenglish.pallet.com/talent/welcome" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io"> <em class="mt">人才集体</em> </strong> </a> <em class="mt">。</em></strong></a></p></div></div>    
</body>
</html>