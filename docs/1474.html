<html>
<head>
<title>How to Get Started with AWS EventBridge &amp; Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何开始使用AWS EventBridge &amp; Node.js</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/getting-started-with-aws-eventbridge-nodejs-c9dc1e1ca936?source=collection_archive---------0-----------------------#2022-03-27">https://javascript.plainenglish.io/getting-started-with-aws-eventbridge-nodejs-c9dc1e1ca936?source=collection_archive---------0-----------------------#2022-03-27</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="cdd1" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">关于从AWS EventBridge和Node.js开始的指南</h2></div><p id="66dc" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">你在设计一个事件驱动的架构吗？如果是这样，那么AWS事件桥可能是你的下一个好赌注。根据EventBridge的AWS</p><p id="8bbf" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">“Amazon event bridge是一种无服务器事件总线，通过使用从应用程序、集成软件即服务(SaaS)应用程序和AWS服务生成的事件，可以更轻松地大规模构建事件驱动的应用程序”</p><h2 id="15af" class="kz la in bd lb lc ld dn le lf lg dp lh kl li lj lk kp ll lm ln kt lo lp lq lr bi translated">什么是事件驱动架构？</h2><p id="5295" class="pw-post-body-paragraph kc kd in ke b kf ls jo kh ki lt jr kk kl lu kn ko kp lv kr ks kt lw kv kw kx ig bi translated">事件驱动架构是一种编程范例，在这种架构中，我们设计应用程序以应对“应用程序状态的重大变化”。</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi lx"><img src="../Images/6d59fed2467e8894ff7d1d062f4fd990.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*uXE-t14wKnsfOZQs.png"/></div></div></figure><p id="5a68" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">EventBridge是另一个消息/事件编排服务，就像AWS SNS和SQS一样，只是功能有很大不同。由于本文更多地涉及EventBridge服务，因此我将展示从node js应用程序到event bridge服务的连接和使用的完整演示。</p><p id="a46e" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">让我们从AWS事件桥的实现开始</p><h1 id="a6cd" class="mj la in bd lb mk ml mm le mn mo mp lh jt mq ju lk jw mr jx ln jz ms ka lq mt bi translated">步骤1:设置规则</h1><p id="af79" class="pw-post-body-paragraph kc kd in ke b kf ls jo kh ki lt jr kk kl lu kn ko kp lv kr ks kt lw kv kw kx ig bi translated">导航到AWS管理控制台并搜索Amazon EventBridge。</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi mu"><img src="../Images/b870b70c0797a3cdfdc2d9328c0ea6b2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*nNRAj77KP0h0hzXd6UbRJQ.png"/></div></div></figure><p id="a00f" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">单击“创建规则”。</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div class="gh gi mv"><img src="../Images/8e02ca5dadbfcfdf99411ed19546a1ac.png" data-original-src="https://miro.medium.com/v2/resize:fit:736/format:webp/1*lkaaJfCCXoGYfKn9dsI7Wg.png"/></div><figcaption class="mw mx gj gh gi my mz bd b be z dk">initial view of event bridge page</figcaption></figure><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi na"><img src="../Images/844715ae3bfd25a6aa5872c004d9c26a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*CRxxTAIl9nIQyhNaHYucXw.png"/></div></div></figure><p id="dfda" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">给出名称、描述，并从下拉列表中选择事件总线。你可以选择默认开始，但也可以自定义和选择不同的事件总线。要使用不同的事件总线，您需要从上一个屏幕创建一个。</p><p id="754b" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">规则类型有两个参数</p><ol class=""><li id="f948" class="nb nc in ke b kf kg ki kj kl nd kp ne kt nf kx ng nh ni nj bi translated">具有事件模式的规则</li><li id="6a65" class="nb nc in ke b kf nk ki nl kl nm kp nn kt no kx ng nh ni nj bi translated">日程安排</li></ol><p id="283c" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">第一个选项在事件与已定义的事件模式匹配时触发(我们将在下一部分中看到这一点)。第二个选项更像是自动触发事件桥的CRON作业。</p><p id="3dd4" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">点击“下一步”。</p><h1 id="0666" class="mj la in bd lb mk ml mm le mn mo mp lh jt mq ju lk jw mr jx ln jz ms ka lq mt bi translated"><strong class="ak">第2步:构建事件模式</strong></h1><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi np"><img src="../Images/bb247d479a526f1118aae2ef37ed9337.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xhSc39w_oVX1IlgpIPeWEQ.png"/></div></div><figcaption class="mw mx gj gh gi my mz bd b be z dk">You can choose this setting as per your requirement. I’ll go with the default setting</figcaption></figure><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi nq"><img src="../Images/d4bac932912c80996bfbd867135b16b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*k5-yspKKq8ttoWTizCc7Tw.png"/></div></div></figure><p id="8d23" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">对于事件模式，选择“自定义模式(JSON编辑器)”并添加一个有效的JSON。JSON {“source”:“node-js-test”}意味着事件桥将接受具有值为node-js-test的属性源的事件</p><p id="a750" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">点击“下一步”。</p><h1 id="09a0" class="mj la in bd lb mk ml mm le mn mo mp lh jt mq ju lk jw mr jx ln jz ms ka lq mt bi translated">步骤3:选择目标</h1><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi nr"><img src="../Images/d442b14454a18b9ef2975ee284adda3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*LL0-2U6OpFJ8JuyNhjzAnw.png"/></div></div></figure><p id="2d8d" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">出于演示目的，我将只使用CloudWatch日志来查看从节点js应用程序发送的事件详细信息。我在这里使用一个单一的目标，但你可以添加多个。</p><p id="1094" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">Target指的是在事件桥服务捕获到有效事件后立即触发的AWS服务。</p><p id="e254" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">添加Lambda函数作为目标将意味着，只要事件桥捕捉到有效事件，就将执行该函数。</p><p id="68d4" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">点击“下一步”。</p><h1 id="acf8" class="mj la in bd lb mk ml mm le mn mo mp lh jt mq ju lk jw mr jx ln jz ms ka lq mt bi translated">步骤4:添加标签</h1><p id="6788" class="pw-post-body-paragraph kc kd in ke b kf ls jo kh ki lt jr kk kl lu kn ko kp lv kr ks kt lw kv kw kx ig bi translated">这个步骤完全是可选的，您可以选择是否添加标记。</p><h1 id="cb24" class="mj la in bd lb mk ml mm le mn mo mp lh jt mq ju lk jw mr jx ln jz ms ka lq mt bi translated">第5步:检查配置并创建规则</h1><p id="9679" class="pw-post-body-paragraph kc kd in ke b kf ls jo kh ki lt jr kk kl lu kn ko kp lv kr ks kt lw kv kw kx ig bi translated">在AWS事件桥控制台中，新添加的规则将可见，控制台如下所示:</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi ns"><img src="../Images/ae00bdb0895deeec7045e66924dee29c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gpgFbHTJ2GeTwkT6lsZ9_w.png"/></div></div></figure><h1 id="4494" class="mj la in bd lb mk ml mm le mn mo mp lh jt mq ju lk jw mr jx ln jz ms ka lq mt bi translated">步骤6:创建Node.js服务器</h1><p id="91bf" class="pw-post-body-paragraph kc kd in ke b kf ls jo kh ki lt jr kk kl lu kn ko kp lv kr ks kt lw kv kw kx ig bi translated">为此，我将创建一个最低限度的Express服务器。在这种情况下，安装两个npm包aws-sdk和express，用于凭据目的。</p><p id="dec3" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">文件1: AWS.js</p><figure class="ly lz ma mb gt mc"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="f1ff" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">要向事件桥服务发送事件，您需要做的就是使用aws-sdk中提供的putEvents函数。params对象包含上述值的最低限度，额外的属性可以在官方文档中找到。</p><p id="18fa" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">索引. js</p><figure class="ly lz ma mb gt mc"><div class="bz fp l di"><div class="nt nu l"/></div></figure><p id="e0ea" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">一旦运行该应用程序，事件将被发送到EventBridge服务。该函数在成功调用时将写入cloudwatch日志(因为我们添加了cloudwatch日志组作为目标)。</p><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div class="gh gi nv"><img src="../Images/bd4371fce8540eb1f4136d3ba62afa69.png" data-original-src="https://miro.medium.com/v2/resize:fit:914/format:webp/1*Gtd1PaII1yM7ouXvXWlO7w.png"/></div><figcaption class="mw mx gj gh gi my mz bd b be z dk">console log after running file.</figcaption></figure><figure class="ly lz ma mb gt mc gh gi paragraph-image"><div role="button" tabindex="0" class="md me di mf bf mg"><div class="gh gi nw"><img src="../Images/0857af7357bb0fa92e3797fbda6f33fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ODXmVZppWbGqmoIKdigoIw.png"/></div></div><figcaption class="mw mx gj gh gi my mz bd b be z dk">the cloud watch logs available as soon as the event was successfully sent.</figcaption></figure><p id="5982" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">完整代码可在此处获得:</p><div class="nx ny gp gr nz oa"><a href="https://github.com/akshay271703/aws-node-js-demo" rel="noopener  ugc nofollow" target="_blank"><div class="ob ab fo"><div class="oc ab od cl cj oe"><h2 class="bd io gy z fp of fr fs og fu fw im bi translated">GitHub-akshay 271703/AWS-node-js-demo</h2><div class="oh l"><h3 class="bd b gy z fp of fr fs og fu fw dk translated">此时您不能执行该操作。您已使用另一个标签页或窗口登录。您已在另一个选项卡中注销，或者…</h3></div><div class="oi l"><p class="bd b dl z fp of fr fs og fu fw dk translated">github.com</p></div></div><div class="oj l"><div class="ok l ol om on oj oo mh oa"/></div></div></a></div><p id="cb97" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">不为你工作？</p><p id="054f" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">可能的情况—</p><ol class=""><li id="2fc0" class="nb nc in ke b kf kg ki kj kl nd kp ne kt nf kx ng nh ni nj bi translated">事件总线区域应该是恒定的。</li><li id="7c7a" class="nb nc in ke b kf nk ki nl kl nm kp nn kt no kx ng nh ni nj bi translated">检查您的事件总线是否可被发现/启动。</li><li id="0b57" class="nb nc in ke b kf nk ki nl kl nm kp nn kt no kx ng nh ni nj bi translated">如果使用自定义总线名称，请在params对象中添加EventBusName属性。</li><li id="6831" class="nb nc in ke b kf nk ki nl kl nm kp nn kt no kx ng nh ni nj bi translated">将在事件桥服务所在的同一区域创建云观察日志组。请确定您启动服务的AWS区域。</li></ol><p id="ba58" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果有任何问题，请随时在GitHub库中提出，我很乐意帮助您。</p><p id="bc61" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="ky">更多内容请看</em><a class="ae op" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="ke io"><em class="ky">plain English . io</em></strong></a><em class="ky">。报名参加我们的</em> <a class="ae op" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io"> <em class="ky">免费周报</em> </strong> </a> <em class="ky">。关注我们关于</em><a class="ae op" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="ke io"><em class="ky">Twitter</em></strong></a><em class="ky">和</em><strong class="ke io"><em class="ky"/></strong><a class="ae op" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="ke io"><em class="ky">LinkedIn</em></strong></a><em class="ky">。加入我们的</em> <a class="ae op" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io"> <em class="ky">社区</em> </strong> </a> <em class="ky">。</em></p></div></div>    
</body>
</html>