<html>
<head>
<title>Create a Heroku App on GitHub Pull Request</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">在GitHub Pull请求上创建Heroku应用程序</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/create-heroku-app-on-github-pull-request-8ace90281632?source=collection_archive---------13-----------------------#2022-04-27">https://javascript.plainenglish.io/create-heroku-app-on-github-pull-request-8ace90281632?source=collection_archive---------13-----------------------#2022-04-27</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="0346" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">关于如何使用GitHub操作在GitHub pull request (PR)上创建Heroku应用程序的指南。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/1c096da3f5d794bd59bf39bdfc21e72f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*qQZtrMB92tf5KkHH.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk"><a class="ae ks" href="https://brand.heroku.com/" rel="noopener ugc nofollow" target="_blank">Heroku logo</a></figcaption></figure><p id="adad" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">本文讲述了如何在GitHub pull request (PR)打开时创建Heroku应用程序。</p><h1 id="e85f" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">问题</h1><p id="8720" class="pw-post-body-paragraph kt ku in kv b kw mh jo ky kz mi jr lb lc mj le lf lg mk li lj lk ml lm ln lo ig bi translated">由于一个<a class="ae ks" href="https://status.heroku.com/incidents/2413" rel="noopener ugc nofollow" target="_blank">事件</a>导致Heroku撤销了他们的GitHub集成，我需要一种替代方法来创建<a class="ae ks" href="https://devcenter.heroku.com/articles/github-integration-review-apps" rel="noopener ugc nofollow" target="_blank">评审应用</a>，而不必通过CLI 手动<a class="ae ks" href="https://remarkablemark.org/blog/2022/04/18/heroku-git-deploy-branch/" rel="noopener ugc nofollow" target="_blank">部署它们。</a></p><h1 id="501c" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">解决办法</h1><p id="8818" class="pw-post-body-paragraph kt ku in kv b kw mh jo ky kz mi jr lb lc mj le lf lg mk li lj lk ml lm ln lo ig bi translated">我创建了一个<a class="ae ks" href="https://github.com/features/actions" rel="noopener ugc nofollow" target="_blank"> GitHub Actions </a>工作流，它在PR打开时创建一个Heroku应用程序。</p><p id="783d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">首先，创建工作流文件:</p><pre class="kd ke kf kg gt mm mn mo mp aw mq bi"><span id="1eb8" class="mr lq in mn b gy ms mt l mu mv">mkdir -p .github/workflows/<br/>touch .github/workflows/heroku-pull-request.yml</span></pre><p id="ed9c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">工作流将在<a class="ae ks" href="https://docs.github.com/en/actions/using-workflows/events-that-trigger-workflows#pull_request" rel="noopener ugc nofollow" target="_blank">拉动请求</a>时触发:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="b728" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">默认情况下，<code class="fe my mz na mn b">pull_request</code>事件由以下活动类型触发:</p><ul class=""><li id="7d5e" class="nb nc in kv b kw kx kz la lc nd lg ne lk nf lo ng nh ni nj bi translated">开的</li><li id="09eb" class="nb nc in kv b kw nk kz nl lc nm lg nn lk no lo ng nh ni nj bi translated">同时发生</li><li id="955e" class="nb nc in kv b kw nk kz nl lc nm lg nn lk no lo ng nh ni nj bi translated">重新开始</li></ul><p id="b50e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">要用类似于<code class="fe my mz na mn b">closed</code>的类型触发工作流，您需要添加它:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="cb55" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">创建一个作业并将Heroku应用程序名设置为一个<a class="ae ks" href="https://docs.github.com/en/actions/learn-github-actions/environment-variables" rel="noopener ugc nofollow" target="_blank">环境变量</a>:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="3b78" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><code class="fe my mz na mn b">github.event.number</code>是公关号。</p><p id="5986" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">对于第一个作业步骤，<a class="ae ks" href="https://github.com/actions/checkout" rel="noopener ugc nofollow" target="_blank">在source (PR)分支签出</a>存储库:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="be5a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">登录到<a class="ae ks" href="https://github.com/marketplace/actions/deploy-to-heroku" rel="noopener ugc nofollow" target="_blank"> Heroku </a>以便您可以使用CLI执行操作:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="661c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在您的存储库密码中设置<a class="ae ks" href="https://remarkablemark.org/blog/2021/06/21/heroku-api-key/" rel="noopener ugc nofollow" target="_blank"> Heroku API密钥</a>。</p><p id="a8d5" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如果PR打开，创建一个Heroku应用程序:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="4edb" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">要在团队下创建一个Heroku app，设置<code class="fe my mz na mn b">--team</code>参数。</p><p id="cd47" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">或者，您可以将应用程序添加到现有的Heroku pipeline:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="b62f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">用您的管道名称替换<code class="fe my mz na mn b">my-pipeline</code>。</p><p id="9c13" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">或者，您可以从另一个Heroku应用程序复制环境变量(配置变量):</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="1be4" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">将<code class="fe my mz na mn b">my-development-app</code>替换为您的其他Heroku应用名称。</p><p id="27b0" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">将<a class="ae ks" href="https://devcenter.heroku.com/articles/git#for-an-existing-app" rel="noopener ugc nofollow" target="_blank"> Heroku遥控器</a>添加到存储库中:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="33db" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这就创建了一个名为<code class="fe my mz na mn b">heroku</code>的Git remote。</p><p id="6691" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">将本地存储库分支推送到Heroku remote以部署应用程序:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="e2bb" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">或者，你可以用<code class="fe my mz na mn b"><a class="ae ks" href="https://devcenter.heroku.com/changelog-items/1829" rel="noopener ugc nofollow" target="_blank">main</a></code>代替<code class="fe my mz na mn b">master</code>。</p><p id="594a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">或者，您可以在部署应用程序后添加公关评论:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mw mx l"/></div></figure><p id="3e33" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如果你的PR关闭了，那就销毁Heroku app:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mw mx l"/></div></figure><h1 id="a56e" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">工作流程</h1><p id="0520" class="pw-post-body-paragraph kt ku in kv b kw mh jo ky kz mi jr lb lc mj le lf lg mk li lj lk ml lm ln lo ig bi translated">以下是完整的GitHub操作工作流程:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mw mx l"/></div></figure></div><div class="ab cl np nq hr nr" role="separator"><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu nv"/><span class="ns bw bk nt nu"/></div><div class="ig ih ii ij ik"><p id="9543" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><a class="ae ks" href="https://b.remarkabl.org/3xZJrMe" rel="noopener ugc nofollow" target="_blank"> <em class="nw">本文原载于《remarkablemark.org》2022年4月23日。</em> </a></p><p id="2050" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="nw">更多内容看</em> <a class="ae ks" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="nw">说白了。报名参加我们的</em> <a class="ae ks" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="nw">免费周报</em> </strong> </a> <em class="nw">。关注我们关于</em><a class="ae ks" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="nw">Twitter</em></strong></a><em class="nw">和</em><a class="ae ks" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="nw">LinkedIn</em></strong></a><em class="nw">。加入我们的</em> <a class="ae ks" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="nw">社区</em> </strong> </a> <em class="nw">。</em></strong></a></p></div></div>    
</body>
</html>