<html>
<head>
<title>How to Use Events in Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Node.js中使用事件</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-use-events-in-node-js-5301675f5fd1?source=collection_archive---------5-----------------------#2022-08-04">https://javascript.plainenglish.io/how-to-use-events-in-node-js-5301675f5fd1?source=collection_archive---------5-----------------------#2022-08-04</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="d736" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">探索Node.js基于事件的体系结构</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/b607e5f1453fb19fcc6f09b5fe25456f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*R8kX8XLY_qrDRcgA"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@pankajpatel?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Pankaj Patel</a> on <a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="8b68" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">我们经常听到Node.js有一个事件驱动的架构或者是基于事件的，但是这个基于事件的模型到底是什么呢？今天，在这篇文章中，我们将尝试解码相同。</p><h2 id="9802" class="lp lq in bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated"><strong class="ak"> <em class="mi">外行人术语中的事件</em> </strong></h2><p id="9054" class="pw-post-body-paragraph kt ku in kv b kw mj jo ky kz mk jr lb lc ml le lf lg mm li lj lk mn lm ln lo ig bi translated">假设你去一家必胜客吃了一份美味的披萨。最初，厨师会无所事事，什么也不做，但他/她一接到“准备比萨饼”的命令，就会立即行动。</p><p id="f2ce" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">一旦顾客进来并发出“准备比萨饼”的命令，厨师就开始为顾客准备同样的东西。</p><p id="99f0" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">所以，这里“准备比萨饼”作为一个事件。顾客是事件的发布者或发出者，厨师基本上是事件的倾听者。</p><p id="a927" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">一旦事件从发布者发出，侦听器就会开始对其进行操作。</p><p id="da85" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">现在，一旦你对事件的方式和内容有了一个基本的了解，让我们从技术的角度来看更多的细节。</p><h2 id="53c7" class="lp lq in bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated"><strong class="ak"> <em class="mi">技术流程</em> </strong></h2><p id="1799" class="pw-post-body-paragraph kt ku in kv b kw mj jo ky kz mk jr lb lc ml le lf lg mm li lj lk mn lm ln lo ig bi translated">初始化节点应用程序。</p><pre class="kd ke kf kg gt mo mp mq mr aw ms bi"><span id="2d65" class="lp lq in mp b gy mt mu l mv mw">npm init</span></pre><p id="e2e5" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">按原样输入默认值，您将拥有您的节点项目设置。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi mx"><img src="../Images/d9ea6fce1893955c121949fc4a93bd5b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*OldMs1K91HmoxizFnv3now.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Project_Default</figcaption></figure><p id="2ee3" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">为了在我们的应用程序中使用事件，我们需要导入事件模块，并从那里导入EventEmitter类。</p><pre class="kd ke kf kg gt mo mp mq mr aw ms bi"><span id="d814" class="lp lq in mp b gy mt mu l mv mw">import { EventEmitter } from 'events';</span></pre><p id="c22b" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">所有发出事件的对象都是EventEmitter类的实例。</p><p id="0ea8" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">所以，让我们创建一个实例。</p><pre class="kd ke kf kg gt mo mp mq mr aw ms bi"><span id="939c" class="lp lq in mp b gy mt mu l mv mw">const events = new EventEmitter();</span></pre><p id="7066" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">一旦创建了实例，为了注册监听器，我们在EventEmitter类中使用了<strong class="kv io">"<em class="my">" on "</em></strong>方法，通过该方法可以注册监听器。</p><pre class="kd ke kf kg gt mo mp mq mr aw ms bi"><span id="a88c" class="lp lq in mp b gy mt mu l mv mw">events.on('prepare pizza', function () {</span><span id="f77e" class="lp lq in mp b gy mz mu l mv mw">console.log('Pizza is being prepared');</span><span id="fb59" class="lp lq in mp b gy mz mu l mv mw">});</span></pre><p id="e01a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这里，第一个参数是事件名称，第二个参数是关于一旦事件发出后需要做什么的函数。</p><p id="df5d" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">好了，我们已经准备好了我们的侦听器，但是如果我们不发出事件，这是没有用的(因为厨师知道如何准备比萨饼，但只有当客户要求时才会准备)，同样的事情可以使用导入的类中的<strong class="kv io"> " <em class="my"> emit" </em> </strong>方法来完成。</p><pre class="kd ke kf kg gt mo mp mq mr aw ms bi"><span id="9fd0" class="lp lq in mp b gy mt mu l mv mw">events.emit('prepare pizza');</span></pre><p id="2c00" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">一旦我们使用emit，所有监听事件的侦听器都会被触发，并相应地采取行动。让我们看看完整的代码:</p><pre class="kd ke kf kg gt mo mp mq mr aw ms bi"><span id="0487" class="lp lq in mp b gy mt mu l mv mw">import { EventEmitter } from 'events';</span><span id="5f79" class="lp lq in mp b gy mz mu l mv mw">const events = new EventEmitter();</span><span id="678c" class="lp lq in mp b gy mz mu l mv mw">events.on('prepare pizza', function () {</span><span id="ee8a" class="lp lq in mp b gy mz mu l mv mw">console.log('Pizza is being prepared');</span><span id="c54e" class="lp lq in mp b gy mz mu l mv mw">});</span><span id="5fdc" class="lp lq in mp b gy mz mu l mv mw">events.emit('prepare pizza');</span><span id="9757" class="lp lq in mp b gy mz mu l mv mw">// Output - Pizza is being prepared</span></pre><h2 id="4696" class="lp lq in bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated"><strong class="ak"> <em class="mi">同步执行监听器</em> </strong></h2><p id="07d1" class="pw-post-body-paragraph kt ku in kv b kw mj jo ky kz mk jr lb lc ml le lf lg mm li lj lk mn lm ln lo ig bi translated">我们还可以在同一个实例上注册多个侦听器，在这种情况下，相同的侦听器会按顺序或以同步模式执行。</p><pre class="kd ke kf kg gt mo mp mq mr aw ms bi"><span id="b995" class="lp lq in mp b gy mt mu l mv mw">import { EventEmitter } from 'events';</span><span id="e25b" class="lp lq in mp b gy mz mu l mv mw">const events = new EventEmitter();</span><span id="68e5" class="lp lq in mp b gy mz mu l mv mw">events.on('prepare pizza', function () {</span><span id="e572" class="lp lq in mp b gy mz mu l mv mw">console.log('Pizza is being prepared - Step 1');</span><span id="bef7" class="lp lq in mp b gy mz mu l mv mw">});</span><span id="3c9d" class="lp lq in mp b gy mz mu l mv mw">events.on('prepare pizza', function () {</span><span id="5ec5" class="lp lq in mp b gy mz mu l mv mw">console.log('Pizza is being prepared - Step 2');</span><span id="89da" class="lp lq in mp b gy mz mu l mv mw">});</span><span id="82f2" class="lp lq in mp b gy mz mu l mv mw">events.on('prepare pizza', function () {</span><span id="0446" class="lp lq in mp b gy mz mu l mv mw">console.log('Pizza is being prepared - Step 3');</span><span id="2b72" class="lp lq in mp b gy mz mu l mv mw">});</span><span id="3327" class="lp lq in mp b gy mz mu l mv mw">events.emit('prepare pizza');</span><span id="a275" class="lp lq in mp b gy mz mu l mv mw">// Output </span><span id="8f18" class="lp lq in mp b gy mz mu l mv mw">Pizza is being prepared - Step 1<br/>Pizza is being prepared - Step 2<br/>Pizza is being prepared - Step 3</span></pre><h2 id="6b6e" class="lp lq in bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated"><strong class="ak"> <em class="mi">事件发射器带参数</em> </strong></h2><p id="15e8" class="pw-post-body-paragraph kt ku in kv b kw mj jo ky kz mk jr lb lc ml le lf lg mm li lj lk mn lm ln lo ig bi translated">回到上面的比萨饼和顾客的类比，不同的顾客希望他们的比萨饼上有不同的浇头，即需要定制或需要传递定制值，并且在下订单时将传递相同的浇头。</p><p id="85d3" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">同样，在发出事件时可以传递额外的参数，并且可以在侦听器中访问这些参数。</p><pre class="kd ke kf kg gt mo mp mq mr aw ms bi"><span id="90eb" class="lp lq in mp b gy mt mu l mv mw">events.on('prepare pizza', function (topping) {</span><span id="d0aa" class="lp lq in mp b gy mz mu l mv mw">console.log(`Pizza is being prepared with ${topping.toppings}`);</span><span id="bb3d" class="lp lq in mp b gy mz mu l mv mw">});</span><span id="191f" class="lp lq in mp b gy mz mu l mv mw">events.emit('prepare pizza', { toppings: 'Olive' });</span><span id="236a" class="lp lq in mp b gy mz mu l mv mw">events.emit('prepare pizza', { toppings: 'Mushroom' });</span></pre><p id="c9c6" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这里，我们在第二个参数中传递了不同的参数，在侦听器中使用了相同的参数，输出如下:</p><pre class="kd ke kf kg gt mo mp mq mr aw ms bi"><span id="2af2" class="lp lq in mp b gy mt mu l mv mw">Pizza is being prepared with Olive<br/>Pizza is being prepared with Mushroom</span></pre><h2 id="206c" class="lp lq in bd lr ls lt dn lu lv lw dp lx lc ly lz ma lg mb mc md lk me mf mg mh bi translated"><strong class="ak"> <em class="mi">多个事件发射器实例</em> </strong></h2><p id="a15c" class="pw-post-body-paragraph kt ku in kv b kw mj jo ky kz mk jr lb lc ml le lf lg mm li lj lk mn lm ln lo ig bi translated">我们还可以在同一个代码库中拥有多个事件发射器实例。</p><p id="57e0" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">让我们更好地理解它:</p><p id="79f1" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">多个事件实例就像有多个必胜客实例一样。现在，一个餐厅中的顾客将与另一个餐厅中的顾客不同，并且存在订单变化，即“<strong class="kv io"> <em class="my">【准备-比萨饼”</em> </strong>在两个餐厅中将是相同的，这将仅触发该特定餐厅的厨师准备已经下订单的比萨饼。</p><p id="21bf" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">类似地，我们可以有多个事件发射器实例，但是监听器将只监听从同一个实例对象发出的事件。</p><p id="e86a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">让我们通过一个例子来更好地理解它:</p><pre class="kd ke kf kg gt mo mp mq mr aw ms bi"><span id="7bd1" class="lp lq in mp b gy mt mu l mv mw">import { EventEmitter } from 'events';</span><span id="850a" class="lp lq in mp b gy mz mu l mv mw">const event1 = new EventEmitter();</span><span id="6c01" class="lp lq in mp b gy mz mu l mv mw">const event2 = new EventEmitter();</span><span id="c716" class="lp lq in mp b gy mz mu l mv mw">event1.on('prepare pizza', function (topping) {</span><span id="f1d6" class="lp lq in mp b gy mz mu l mv mw">console.log(`Pizza is being prepared with ${topping.toppings} from event 1`);</span><span id="e55d" class="lp lq in mp b gy mz mu l mv mw">});</span><span id="8f62" class="lp lq in mp b gy mz mu l mv mw">event2.on('prepare pizza', function (topping) {</span><span id="93ea" class="lp lq in mp b gy mz mu l mv mw">console.log(`Pizza is being prepared with ${topping.toppings} from event2`);</span><span id="a4c8" class="lp lq in mp b gy mz mu l mv mw">});</span><span id="d38e" class="lp lq in mp b gy mz mu l mv mw">event1.emit('prepare pizza', { toppings: 'Olive' });</span><span id="039b" class="lp lq in mp b gy mz mu l mv mw">Output - Pizza is being prepared with Olive from event 1</span></pre><p id="a07c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">可以看出，即使我们有两个不同实例的同名侦听器，也只会侦听为其发出事件的那个实例。</p><p id="8b8c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">同样，如果我们从多个实例发出相同名称的事件，那么只有注册了侦听器的那个实例会起作用。</p><pre class="kd ke kf kg gt mo mp mq mr aw ms bi"><span id="1ae9" class="lp lq in mp b gy mt mu l mv mw">import { EventEmitter } from 'events';</span><span id="443e" class="lp lq in mp b gy mz mu l mv mw">const event1 = new EventEmitter();</span><span id="3de2" class="lp lq in mp b gy mz mu l mv mw">const event2 = new EventEmitter();</span><span id="a6f8" class="lp lq in mp b gy mz mu l mv mw">event2.on('prepare pizza', function (topping) {</span><span id="0f36" class="lp lq in mp b gy mz mu l mv mw">console.log(`Pizza is being prepared with ${topping.toppings} from event2`);</span><span id="9b68" class="lp lq in mp b gy mz mu l mv mw">});</span><span id="7a44" class="lp lq in mp b gy mz mu l mv mw">event1.emit('prepare pizza', { toppings: 'Olive' });</span><span id="996f" class="lp lq in mp b gy mz mu l mv mw">event2.emit('prepare pizza', { toppings: 'Mushroom' });</span><span id="43de" class="lp lq in mp b gy mz mu l mv mw">Output - Pizza is being prepared with Mushroom from event2</span></pre><p id="0262" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">简而言之，这是关于事件在Node.js中如何工作的基础知识。请注意，它们在节点的整体架构中起着关键作用，并广泛用于HTTP、fs、sockets和更多作为节点主干的模块。<br/>因此，对事件如何运作有一个基本的了解变得更加重要。</p><p id="8449" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在结束之前，这里有一个用我们的餐馆类比的图片描述，帮助你以一种更整洁的方式记住这个概念。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi na"><img src="../Images/a7123e6dbd3abebbea2f8dc07c678079.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6eXbChmb4PnlyqBWMDWDzg.jpeg"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Event_Nodejs</figcaption></figure><p id="2745" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">让我知道，如果你有任何疑问和关注，或者如果你想让我写任何其他文章。</p></div><div class="ab cl nb nc hr nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="ig ih ii ij ik"><p id="1961" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">关于我——我是一个编程爱好者，喜欢阅读和写作前端设计、JavaScript和UI/UX相关的东西。点击<a class="ae ks" href="https://medium.com/@avinash.dev21987" rel="noopener">这里</a>阅读我所有的文章，并让我知道你的反馈。</p></div><div class="ab cl nb nc hr nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="ig ih ii ij ik"><p id="794e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="my">更多内容看</em> <a class="ae ks" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="my">说白了。报名参加我们的</em> <a class="ae ks" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="my">免费周报</em> </strong> </a> <em class="my">。关注我们关于</em><strong class="kv io"><em class="my"/></strong><a class="ae ks" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="my">推特</em></strong></a><a class="ae ks" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="my">领英</em> </strong> </a> <em class="my">，以及</em> <a class="ae ks" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="my">不和</em> </strong> </a> <em class="my">。</em></strong></a></p></div></div>    
</body>
</html>