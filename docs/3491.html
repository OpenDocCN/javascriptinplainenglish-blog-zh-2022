<html>
<head>
<title>What is PNPM &amp; Why You Should Try It As a Frontend Developer</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">什么是PNPM &amp;为什么你应该作为一个前端开发人员尝试它</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/what-is-pnpm-why-you-should-try-it-as-a-frontend-developer-69a3a7b34f5b?source=collection_archive---------4-----------------------#2022-09-01">https://javascript.plainenglish.io/what-is-pnpm-why-you-should-try-it-as-a-frontend-developer-69a3a7b34f5b?source=collection_archive---------4-----------------------#2022-09-01</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="96d2" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">认识pnpm——NPM/yarn的替代方案，了解它的优势、依赖性管理和用法。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/ac783681a5ae2adb9c7dc0540b41ad65.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qlAp3Dz9S22Rila5"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@kris_ricepees?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Gary Bendig</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="cb80" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为什么要用pnpm，它的学习点是什么？</p><h1 id="855c" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">pnpm是什么？</h1><p id="8cec" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">根据官方<a class="ae kv" href="https://pnpm.io/" rel="noopener ugc nofollow" target="_blank">文件</a>，</p><p id="807f" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><strong class="ky ir"> Pnpm是一个快速、节省磁盘空间的包管理器。</strong></p><h1 id="a566" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">优势</h1><h2 id="b77d" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated">1.快的</h2><p id="0df5" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">以下是几种工具的对比:</p><p id="e696" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">可以看出，<code class="fe nb nc nd ne b">pnpm</code>作为黄色部分，在大多数场景下，包安装的速度明显优于<code class="fe nb nc nd ne b">npm/yarn</code>，速度会比<code class="fe nb nc nd ne b">npm/yarn</code>快2倍。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nf"><img src="../Images/4a3c2ebc38dfb75d48cc12b42b050bf7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*r-CRPVPRBjEug5hg8-igYg.png"/></div></div></figure><p id="2f0e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们来看看基准数据，主要对比<code class="fe nb nc nd ne b">pnpm</code>和<code class="fe nb nc nd ne b">yarn</code>:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ng"><img src="../Images/98e51687fcf888a1a3afae3a486a9c28.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*YgMK1kTBi_9pkrZkuwaCkA.png"/></div></div></figure><p id="145d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">总体来说，<code class="fe nb nc nd ne b">pnpm</code>的包安装速度还是明显优于<code class="fe nb nc nd ne b">yarn</code>。</p><h2 id="5754" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated">2.有效利用磁盘空间</h2><p id="75a4" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">在内部，<code class="fe nb nc nd ne b">pnpm</code>使用一个内容可寻址文件系统来存储磁盘上的所有文件。这个文件系统的优点是:</p><p id="0b94" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">同一个包不会重复安装。使用<code class="fe nb nc nd ne b">npm/yarn</code>时，如果1000个项目依赖<code class="fe nb nc nd ne b">lodash</code>，那么<code class="fe nb nc nd ne b">lodash</code>很可能安装1000次，这部分代码就写在磁盘的1000个地方。但是使用<code class="fe nb nc nd ne b">pnpm</code>的时候只会安装一次，磁盘上只有一个地方可以写。再用的话就直接用<code class="fe nb nc nd ne b">hardlink</code>了。</p><p id="c5b4" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">即使一个包有不同的版本，<code class="fe nb nc nd ne b">pnpm</code>也大量重用了以前版本的代码。比如<code class="fe nb nc nd ne b">lodash</code>有1000个文件，更新版本后还有一个文件，那么磁盘不会重写这1001个文件而是保留原来1000个文件的<code class="fe nb nc nd ne b">hardlink</code>，只写新的。文档。</p><h2 id="8d6e" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated">3.高度安全</h2><p id="a71e" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">之前使用<code class="fe nb nc nd ne b">npm/yarn</code>时，由于<code class="fe nb nc nd ne b">node_module</code>的扁平化结构，如果A依赖B and B依赖C，那么A可以直接使用C，但问题是A并没有将C声明为依赖。因此，出现了这种非法访问。但是<code class="fe nb nc nd ne b">pnpm</code>脑洞非常大，创造了一套依赖管理方法，很好的解决了这个问题，保证了安全性。</p><h1 id="ddba" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">PNPM依赖性管理</h1><p id="5cb3" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">回想一下<code class="fe nb nc nd ne b">npm/yarn</code>为什么要扁平化<code class="fe nb nc nd ne b">node_modules.</code>难道不是因为相同的依赖项会被复制多次，而且路径太长？</p><p id="ed94" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">不复制怎么办，比如通过链接？</p><p id="32a3" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">首先我来介绍一下<code class="fe nb nc nd ne b">link</code>，也就是软硬<code class="fe nb nc nd ne b">link</code>。这是操作系统提供的机制。硬链接是同一文件的不同引用，而软链接是创建一个新文件，并且文件的内容指向另一个路径。当然，这两个链接在使用上是相似的。</p><p id="bf1b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">如果不复制文件，只需将<code class="fe nb nc nd ne b">npm</code>包的内容保存在全局存储库中，并链接其余的地方。</p><p id="8c1a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">这样就不会浪费多份拷贝的磁盘空间，也不会出现路径过长的问题。因为路径太长的限制是目录层次不能太深的关键，所以现在它是每个位置的目录的链接，而不是同一个目录，所以没有长度限制。<br/>没错，<code class="fe nb nc nd ne b">pnpm</code>就是通过这个思路实现的。</p><p id="5dd7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">然后删除node_modules，再用<code class="fe nb nc nd ne b">pnpm</code>重新安装，执行<code class="fe nb nc nd ne b">pnpm</code> install。</p><p id="0c06" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">你会发现上面印着这样一句话:</p><pre class="kg kh ki kj gt nh ne ni nj aw nk bi"><span id="9da5" class="mp lt iq ne b gy nl nm l nn no">pnpm install</span></pre><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi np"><img src="../Images/8cf4e788332ffd10607eeeb40c2d7703.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*IxAcMI5AHQqvpKu0J_2RaQ.png"/></div></div></figure><p id="3231" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">展开<code class="fe nb nc nd ne b">.pnpm</code>看一看:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nq"><img src="../Images/6d2b9bc1580a0413f8879387d458ccb7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1226/format:webp/1*Cewnyamzt3myXhsMe8PiiA.png"/></div></figure><p id="57b7" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">所有的依赖关系都在这里列出，从全局存储中硬连线，然后通过<code class="fe nb nc nd ne b">softlinks</code>组织包到包的依赖关系。</p><p id="2bc9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">例如，<code class="fe nb nc nd ne b">.pnpm</code>下的快递，这些都是软链接，</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div class="gh gi nr"><img src="../Images/155347b196bfc2c383d8b576a8ec2f4a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1254/format:webp/1*HiWI8PDjCOC3tXpIxs1UCA.png"/></div></figure><p id="1abf" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">也就是说，所有的依赖都是从全局存储到<code class="fe nb nc nd ne b">node_modules/.pnpm</code>的硬链接，然后通过软链接相互依赖。</p><p id="b04c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">官方给出了示意图，大家一起看看就明白了:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi ns"><img src="../Images/9c9394494ef6bd50bd179a2041ee1b0a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*KiXOhjIsgvXEKoWkWMQ8eA.png"/></div></div></figure><h1 id="6906" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">使用</h1><h2 id="9c1a" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated">pnpm安装</h2><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="nt nu l"/></div></figure><h2 id="2e63" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated">pnpm更新</h2><p id="dbe2" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">根据指定的范围将包更新到最新版本。</p><h2 id="804f" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated">pnpm卸载</h2><pre class="kg kh ki kj gt nh ne ni nj aw nk bi"><span id="1d44" class="mp lt iq ne b gy nl nm l nn no">// Remove axios<br/>npm install axios --filter package-a</span></pre><h2 id="20d3" class="mp lt iq bd lu mq mr dn ly ms mt dp mc lf mu mv me lj mw mx mg ln my mz mi na bi translated">pnpm链接</h2><p id="f10e" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated">将本地项目链接到另一个项目。请注意，使用的是硬链接，而不是软链接</p><pre class="kg kh ki kj gt nh ne ni nj aw nk bi"><span id="c9dd" class="mp lt iq ne b gy nl nm l nn no">pnpm link ../../axios</span></pre><p id="838a" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">可以看出<code class="fe nb nc nd ne b">pnpm</code>虽然做了很多复杂的设计，但是用户是察觉不到的，使用起来非常友好。</p><h1 id="9830" class="ls lt iq bd lu lv lw lx ly lz ma mb mc jw md jx me jz mf ka mg kc mh kd mi mj bi translated">最后</h1><p id="590e" class="pw-post-body-paragraph kw kx iq ky b kz mk jr lb lc ml ju le lf mm lh li lj mn ll lm ln mo lp lq lr ij bi translated"><strong class="ky ir">感谢阅读。</strong>我期待着<strong class="ky ir"> </strong>您的关注和阅读更多高质量的文章。</p><div class="nv nw gp gr nx"><div role="button" tabindex="0" class="ab bv gv cb fp ny nz bn oa kp ex"><div class="ob l"><div class="ab q"><div class="l di"><img alt="omgzui" class="l de bw oc od fe" src="../Images/113db82933227743d0067a68e250ac93.png" width="20" height="20" loading="lazy" data-original-src="https://miro.medium.com/v2/resize:fill:40:40/1*AmBIV4haXTWPO--EhE0Q1A.jpeg"/><div class="fb bw l oc od fc n aw fd"/></div><div class="hh l fo"><p class="bd b dl z fp fq fr fs ft fu fv fw dk translated"><a class="ae af ag ah ai aj ak al am an ao ap aq ar as" href="https://medium.com/@omgzui?source=post_page-----69a3a7b34f5b--------------------------------" rel="noopener follow" target="_top"> omgzui </a></p></div></div><div class="og oh gw l"><h2 class="bd ir ts tt fp tu fr fs tv fu fw ip bi translated">Java Script语言</h2></div><div class="ab q"><div class="l fo"><a class="bd b be z bi tw au tx ty tz qi ua an eh ei ub uc ud el em eo de bk ep" href="https://medium.com/@omgzui/list/javascript-48bfc7b5f93c?source=post_page-----69a3a7b34f5b--------------------------------" rel="noopener follow" target="_top">View list</a></div><div class="ue l fo"><span class="bd b dl z dk">57 stories</span></div></div></div><div class="ot dh ou fp ab ov fo di"><div class="di ol bv om on"><div class="dh l"><img alt="" class="dh" src="../Images/64fcf15e27c514ec49d62966b68dbc15.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*DbDdSUf5SchniJuq"/></div></div><div class="di ol bv oo op oq"><div class="dh l"><img alt="" class="dh" src="../Images/3e6ce891363c151131c5993ca0dcc526.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*7cAp-WibSblfO7hT"/></div></div><div class="di bv or os oq"><div class="dh l"><img alt="" class="dh" src="../Images/a7dd413de22f319a3c4729c9e737feb8.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*FcmHdVfoUOhlJlsG"/></div></div></div></div></div><div class="nv nw gp gr nx"><div role="button" tabindex="0" class="ab bv gv cb fp ny nz bn oa kp ex"><div class="ob l"><div class="ab q"><div class="l di"><img alt="omgzui" class="l de bw oc od fe" src="../Images/113db82933227743d0067a68e250ac93.png" width="20" height="20" loading="lazy" data-original-src="https://miro.medium.com/v2/resize:fill:40:40/1*AmBIV4haXTWPO--EhE0Q1A.jpeg"/><div class="fb bw l oc od fc n aw fd"/></div><div class="hh l fo"><p class="bd b dl z fp fq fr fs ft fu fv fw dk translated"><a class="ae af ag ah ai aj ak al am an ao ap aq ar as" href="https://medium.com/@omgzui?source=post_page-----69a3a7b34f5b--------------------------------" rel="noopener follow" target="_top"> omgzui </a></p></div></div><div class="og oh gw l"><h2 class="bd ir ts tt fp tu fr fs tv fu fw ip bi translated">更好的编程</h2></div><div class="ab q"><div class="l fo"><a class="bd b be z bi tw au tx ty tz qi ua an eh ei ub uc ud el em eo de bk ep" href="https://medium.com/@omgzui/list/better-programing-9b4c9bb174aa?source=post_page-----69a3a7b34f5b--------------------------------" rel="noopener follow" target="_top">View list</a></div><div class="ue l fo"><span class="bd b dl z dk">109 stories</span></div></div></div><div class="ot dh ou fp ab ov fo di"><div class="di ol bv om on"><div class="dh l"><img alt="" class="dh" src="../Images/64fcf15e27c514ec49d62966b68dbc15.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*DbDdSUf5SchniJuq"/></div></div><div class="di ol bv oo op oq"><div class="dh l"><img alt="" class="dh" src="../Images/3e6ce891363c151131c5993ca0dcc526.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*7cAp-WibSblfO7hT"/></div></div><div class="di bv or os oq"><div class="dh l"><img alt="" class="dh" src="../Images/a7dd413de22f319a3c4729c9e737feb8.png" width="194" height="194" loading="lazy" role="presentation" data-original-src="https://miro.medium.com/v2/resize:fill:388:388/0*FcmHdVfoUOhlJlsG"/></div></div></div></div></div></div><div class="ab cl oz pa hu pb" role="separator"><span class="pc bw bk pd pe pf"/><span class="pc bw bk pd pe pf"/><span class="pc bw bk pd pe"/></div><div class="ij ik il im in"><p id="b4a9" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="pg">更多内容看</em> <a class="ae kv" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="pg">说白了。报名参加我们的</em> <a class="ae kv" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="pg">免费周报</em> </strong> </a> <em class="pg">。关注我们关于</em> <a class="ae kv" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="pg">推特</em></strong></a><a class="ae kv" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="pg">LinkedIn</em></strong></a><em class="pg"/><a class="ae kv" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="pg">YouTube</em></strong></a><em class="pg"/><a class="ae kv" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="pg">不和</em> </strong> </a> <em class="pg">。</em></strong></a></p></div></div>    
</body>
</html>