<html>
<head>
<title>How to Improve the Performance of a React Native Application</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何提高React本机应用程序的性能</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-improve-performance-react-native-application-tips-and-examples-fa9a0b7d87ba?source=collection_archive---------7-----------------------#2022-02-28">https://javascript.plainenglish.io/how-to-improve-performance-react-native-application-tips-and-examples-fa9a0b7d87ba?source=collection_archive---------7-----------------------#2022-02-28</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="8c54" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">提高React本机应用程序性能的提示和示例。</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/9339bb8d7561c5914d3cd58eebc118ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*sYpJG2XTrUSYU8_qV2_4DQ.jpeg"/></div></div></figure><h1 id="9aeb" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">缓存图像</h1><p id="c24e" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">在React Native中，我们将“图像”作为核心组件。我们可以使用这个组件来显示图像，但是它有一些问题，比如:</p><ul class=""><li id="80b9" class="mf mg iq ll b lm mh lp mi ls mj lw mk ma ml me mm mn mo mp bi translated">忽明忽暗。</li><li id="18c5" class="mf mg iq ll b lm mq lp mr ls ms lw mt ma mu me mm mn mo mp bi translated">缓存未命中。</li><li id="9809" class="mf mg iq ll b lm mq lp mr ls ms lw mt ma mu me mm mn mo mp bi translated">从缓存进行低性能加载。</li><li id="ba83" class="mf mg iq ll b lm mq lp mr ls ms lw mt ma mu me mm mn mo mp bi translated">总体表现不佳。</li></ul><p id="d5ab" class="pw-post-body-paragraph lj lk iq ll b lm mh jr lo lp mi ju lr ls mv lu lv lw mw ly lz ma mx mc md me ij bi translated">所有这些都会损害用户体验。对于这些情况，我们可以从“react-native-fast-image”中得到帮助。这个库可以跨平台使用，它像魔术一样工作。</p><p id="488c" class="pw-post-body-paragraph lj lk iq ll b lm mh jr lo lp mi ju lr ls mv lu lv lw mw ly lz ma mx mc md me ij bi translated"><strong class="ll ir">注意:</strong>您必须使用React Native 0.60.0或更高版本才能使用react-native-fast-image的最新版本。</p><h2 id="ac4a" class="my ks iq bd kt mz na dn kx nb nc dp lb ls nd ne ld lw nf ng lf ma nh ni lh nj bi translated">例子</h2><p id="466b" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">步骤1:安装库。</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="78f2" class="my ks iq nl b gy np nq l nr ns">yarn add react-native-fast-image<br/>cd ios &amp;&amp; pod install</span></pre><p id="bb75" class="pw-post-body-paragraph lj lk iq ll b lm mh jr lo lp mi ju lr ls mv lu lv lw mw ly lz ma mx mc md me ij bi translated">步骤2:导入并使用库。</p><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="9516" class="my ks iq nl b gy np nq l nr ns">import FastImage from 'react-native-fast-image'</span><span id="5353" class="my ks iq nl b gy nt nq l nr ns">const YourImage = () =&gt; (<br/>    &lt;FastImage<br/>        style={{ width: 200, height: 200 }}<br/>        source={{<br/>            uri: 'https://unsplash.it/400/400?image=1',<br/>            headers: { Authorization: 'someAuthToken' },<br/>            priority: FastImage.priority.normal,<br/>        }}<br/>        resizeMode={FastImage.resizeMode.contain}<br/>    /&gt;<br/>)</span></pre><p id="d0fd" class="pw-post-body-paragraph lj lk iq ll b lm mh jr lo lp mi ju lr ls mv lu lv lw mw ly lz ma mx mc md me ij bi translated">更多例子可以在<a class="ae nu" href="https://github.com/DylanVann/react-native-fast-image" rel="noopener ugc nofollow" target="_blank"> <em class="nv">这里</em> </a>找到。</p><h1 id="8f28" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">记忆值</h1><p id="10b0" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">当屏幕频繁渲染时，使用<code class="fe nw nx ny nl b">useMemo</code>可以优化您的react原生应用程序。</p><p id="eee2" class="pw-post-body-paragraph lj lk iq ll b lm mh jr lo lp mi ju lr ls mv lu lv lw mw ly lz ma mx mc md me ij bi translated"><code class="fe nw nx ny nl b">useMemo</code>将记忆变量值，并且仅当其中一个依赖关系发生变化时才重新计算该值。因此，这种优化有助于避免每次渲染时进行昂贵的计算。<code class="fe nw nx ny nl b">useMemo</code>接受2个参数:</p><ul class=""><li id="e9ef" class="mf mg iq ll b lm mh lp mi ls mj lw mk ma ml me mm mn mo mp bi translated">memoized函数将返回值。</li><li id="3d63" class="mf mg iq ll b lm mq lp mr ls ms lw mt ma mu me mm mn mo mp bi translated">一组依赖关系。</li></ul><h2 id="3a20" class="my ks iq bd kt mz na dn kx nb nc dp lb ls nd ne ld lw nf ng lf ma nh ni lh nj bi translated">例子</h2><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="b471" class="my ks iq nl b gy np nq l nr ns">const computeExpensiveValue = (a, b)=&gt;{<br/>  let total = 0;<br/>  for(index=0; index&lt;10000000; index++){<br/>    total += index+a+b;<br/>  }<br/>  return total;<br/>}</span><span id="5050" class="my ks iq nl b gy nt nq l nr ns">const memoizedValue = useMemo(() =&gt; computeExpensiveValue(a, b), [a, b]);</span></pre><p id="f12e" class="pw-post-body-paragraph lj lk iq ll b lm mh jr lo lp mi ju lr ls mv lu lv lw mw ly lz ma mx mc md me ij bi translated">正如我们在上面的例子中看到的，我们将使用变量“a”和“b”计算索引10000000次。请注意，没有<code class="fe nw nx ny nl b">useMemo</code>优化的帮助，我们将为每个渲染计算相同的值，这可能会降低您的React本机应用程序的速度。使用<code class="fe nw nx ny nl b">useMemo</code>将确保我们不会为每个屏幕渲染一遍又一遍地计算相同的值，并且只有当影响最终结果的依赖关系之一被改变时。</p><h1 id="6c11" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">记忆式回调</h1><p id="0bc8" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">和<code class="fe nw nx ny nl b">useMemo</code>一样，<code class="fe nw nx ny nl b">useCallback</code>可以在屏幕频繁渲染的情况下优化你的react原生app。<code class="fe nw nx ny nl b">useCallback</code>将返回回调的记忆版本。<code class="fe nw nx ny nl b">useCallback</code>接受2个参数:</p><ul class=""><li id="8941" class="mf mg iq ll b lm mh lp mi ls mj lw mk ma ml me mm mn mo mp bi translated">要记忆的功能。</li><li id="f10b" class="mf mg iq ll b lm mq lp mr ls ms lw mt ma mu me mm mn mo mp bi translated">一组依赖关系。</li></ul><h2 id="a1aa" class="my ks iq bd kt mz na dn kx nb nc dp lb ls nd ne ld lw nf ng lf ma nh ni lh nj bi translated">例子</h2><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="0f3d" class="my ks iq nl b gy np nq l nr ns">const memoizedCallback = useCallback(<br/>  () =&gt; {<br/>    doSomething(a, b);<br/>  },<br/>  [a, b]<br/>);</span></pre><p id="a5d9" class="pw-post-body-paragraph lj lk iq ll b lm mh jr lo lp mi ju lr ls mv lu lv lw mw ly lz ma mx mc md me ij bi translated">正如我们在上面的例子中看到的，我们传递了一个接受两个参数“a”和“b”的内联函数<code class="fe nw nx ny nl b">doSomething</code>。这些参数意味着我们必须包含这些参数作为依赖项数组。通过在<code class="fe nw nx ny nl b">useCallback</code>中使用，我们确保如果“a”和“b”没有改变，我们不会为每个渲染创建相同的函数。</p><p id="4817" class="pw-post-body-paragraph lj lk iq ll b lm mh jr lo lp mi ju lr ls mv lu lv lw mw ly lz ma mx mc md me ij bi translated"><code class="fe nw nx ny nl b">useCallback</code>将返回回调的记忆化版本，该版本仅在其中一个依赖关系发生变化时才会发生变化。</p><h1 id="0cd8" class="kr ks iq bd kt ku kv kw kx ky kz la lb jw lc jx ld jz le ka lf kc lg kd lh li bi translated">避免箭头功能</h1><p id="6ba5" class="pw-post-body-paragraph lj lk iq ll b lm ln jr lo lp lq ju lr ls lt lu lv lw lx ly lz ma mb mc md me ij bi translated">箭头函数是无效重渲染的常见问题。避免在呈现屏幕的函数中使用箭头函数作为回调函数。</p><p id="fccc" class="pw-post-body-paragraph lj lk iq ll b lm mh jr lo lp mi ju lr ls mv lu lv lw mw ly lz ma mx mc md me ij bi translated">为什么？</p><p id="8c99" class="pw-post-body-paragraph lj lk iq ll b lm mh jr lo lp mi ju lr ls mv lu lv lw mw ly lz ma mx mc md me ij bi translated">因为每当父元素重新呈现一个新的引用时，函数就会被重新创建。使用箭头函数方法将导致每次渲染都生成该特定函数的新实例，因此，React Native将无法重用旧引用。</p><h2 id="f28a" class="my ks iq bd kt mz na dn kx nb nc dp lb ls nd ne ld lw nf ng lf ma nh ni lh nj bi translated">避免这种情况—例如</h2><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="78fc" class="my ks iq nl b gy np nq l nr ns">class AvoidCase extends React.Component {<br/>  // ...<br/>  addTodo() {<br/>    // ...<br/>  }<br/>  render() {<br/>    return (<br/>      &lt;View&gt;<br/>        &lt;TouchableHighlight onPress={() =&gt; this.addTodo()} /&gt;<br/>      &lt;/View&gt;<br/>    );<br/>  }<br/>}</span></pre><h2 id="ac81" class="my ks iq bd kt mz na dn kx nb nc dp lb ls nd ne ld lw nf ng lf ma nh ni lh nj bi translated">正确案例—示例</h2><pre class="kg kh ki kj gt nk nl nm nn aw no bi"><span id="1779" class="my ks iq nl b gy np nq l nr ns">class CorrectCase extends React.Component {<br/>  // ...<br/>  addTodo = () =&gt; {<br/>    // ...<br/>  }<br/>  render() {<br/>    return (<br/>      &lt;View&gt;<br/>        &lt;TouchableHighlight onPress={this.addTodo} /&gt;<br/>      &lt;/View&gt;<br/>    );<br/>  }</span></pre></div><div class="ab cl nz oa hu ob" role="separator"><span class="oc bw bk od oe of"/><span class="oc bw bk od oe of"/><span class="oc bw bk od oe"/></div><div class="ij ik il im in"><p id="90bc" class="pw-post-body-paragraph lj lk iq ll b lm mh jr lo lp mi ju lr ls mv lu lv lw mw ly lz ma mx mc md me ij bi translated"><strong class="ll ir">感谢</strong>到目前为止的阅读，如果你喜欢这样的内容，并且你想支持我作为一个程序员和作家写更多像这样的文章，<a class="ae nu" href="https://medium.com/membership/@nissimzarur" rel="noopener"> <strong class="ll ir"> <em class="nv">请用我的链接注册成为Medium的会员(5美元/月订阅)，你将可以无限制地访问Medium上的所有内容。</em> </strong> </a></p></div><div class="ab cl nz oa hu ob" role="separator"><span class="oc bw bk od oe of"/><span class="oc bw bk od oe of"/><span class="oc bw bk od oe"/></div><div class="ij ik il im in"><p id="de8b" class="pw-post-body-paragraph lj lk iq ll b lm mh jr lo lp mi ju lr ls mv lu lv lw mw ly lz ma mx mc md me ij bi translated">请继续关注更多React本机优化示例和技巧。</p><p id="294f" class="pw-post-body-paragraph lj lk iq ll b lm mh jr lo lp mi ju lr ls mv lu lv lw mw ly lz ma mx mc md me ij bi translated"><em class="nv">更多内容看</em> <a class="ae nu" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ll ir"> <em class="nv">说白了。报名参加我们的</em> <a class="ae nu" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ll ir"> <em class="nv">免费周报</em> </strong> </a> <em class="nv">。关注我们关于</em><a class="ae nu" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="ll ir"><em class="nv">Twitter</em></strong></a><em class="nv">和</em><a class="ae nu" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="ll ir"><em class="nv">LinkedIn</em></strong></a><em class="nv">。加入我们的</em> <a class="ae nu" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="ll ir"> <em class="nv">社区</em> </strong> </a> <em class="nv">。</em></strong></a></p></div></div>    
</body>
</html>