<html>
<head>
<title>How to Make a Treemap with JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用JavaScript制作树形图</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-make-a-treemap-with-javascript-1ea7349395c7?source=collection_archive---------16-----------------------#2022-06-08">https://javascript.plainenglish.io/how-to-make-a-treemap-with-javascript-1ea7349395c7?source=collection_archive---------16-----------------------#2022-06-08</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/9d2194e665e3eb423c61c2ceef37ff12.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*8RbPXsKE0lAQZYHF.png"/></div></div></figure><p id="7624" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">树形图可视化广泛用于分层数据分析。如果您需要构建一个，但以前从未做过，您可能会认为这个过程有些复杂。嗯，不一定。我决定制作一个循序渐进的教程，解释如何使用JavaScript轻松创建令人敬畏的交互式树形图。你会喜欢这些插图的！</p><p id="1fb8" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们在宇宙中是孤独的吗？一个我们每个人都曾问过自己的问题。当我们考虑地球是否是宇宙中唯一可居住的星球时，我们可能会考虑的一件事是宇宙有多大。让我们在树形图的帮助下来看看吧！在本教程中，我们将使用树形图技术可视化已知宇宙中10个最大星系的规模。</p><p id="72a2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">那么，你想知道如何快速构建一个基于JS的树形图吗？跟随我学习这个循序渐进的教程，以一种简单有趣的方式学习吧！</p><h1 id="dcfa" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">什么是树形图？</h1><p id="6ebb" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">在我们开始学习教程之前，让我们先来看看树形图的概念。<a class="ae lw" href="https://www.anychart.com/chartopedia/chart-type/treemap/" rel="noopener ugc nofollow" target="_blank">树形图</a>是一种用于可视化分层组织的树形结构数据的流行技术。旨在快速显示层次结构以及各个数据点的值，它使用嵌套的矩形，其大小与相应的数量成比例。</p><p id="fd52" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">树的每个分支是一个矩形，对于子分支，有更小的矩形嵌套在其中。通过颜色和接近度显示数据，树形图可以很容易地表示大量数据，同时有效地利用空间，非常适合比较层次结构中的比例。</p><p id="36d4" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">树状图是由<a class="ae lw" href="https://en.wikipedia.org/wiki/Ben_Shneiderman" rel="noopener ugc nofollow" target="_blank"> Ben Shneiderman </a>教授发明的，他在信息设计和人机交互领域做出了重大贡献。树状图用于许多数据可视化领域，可以在股票市场数据分析、人口普查系统和选举统计以及数据新闻、硬盘探索工具等方面找到应用。</p><h1 id="9011" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">一瞥我们的JS树形图</h1><p id="c1a6" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">所以现在，我们将使用JavaScript构建一个树形图来比较已知宇宙中前10个星系的大小。看看我们到底要创造什么。这是我们的JS树形图在教程结束时的样子。</p><figure class="ly lz ma mb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi lx"><img src="../Images/289b61d2d81042455974aec2f4d00885.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*bx9Zaek7gX9ggnHk.gif"/></div></div></figure><p id="43f5" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">让我们开始星际之旅吧！</p><h1 id="ca06" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">创建一个基本的JS树形图</h1><p id="0a19" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">创建基于JavaScript的树形图通常需要以下四个基本步骤:</p><ol class=""><li id="dd7c" class="mc md in jx b jy jz kc kd kg me kk mf ko mg ks mh mi mj mk bi translated">创建HTML页面</li><li id="325f" class="mc md in jx b jy ml kc mm kg mn kk mo ko mp ks mh mi mj mk bi translated">参考JavaScript文件</li><li id="2ba3" class="mc md in jx b jy ml kc mm kg mn kk mo ko mp ks mh mi mj mk bi translated">设置数据</li><li id="eea3" class="mc md in jx b jy ml kc mm kg mn kk mo ko mp ks mh mi mj mk bi translated">写一些JS树映射代码</li></ol><p id="7c14" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">如果你是HTML、CSS和JavaScript的新手，也不用担心。我们将详细介绍每一个步骤，在本教程结束时，您将已经准备好自己的JS树形图。</p><p id="6f19" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">那么，倒计时已经开始，让我们准备好我们的图表。</p><h2 id="8082" class="mq ku in bd kv mr ms dn kz mt mu dp ld kg mv mw lh kk mx my ll ko mz na lp nb bi translated">1.创建HTML页面</h2><p id="8c4d" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">我们在这里做的第一件事是创建一个基本的HTML页面。在这里，我们添加了一个HTML块元素(<code class="fe nc nd ne nf b">&lt;div&gt;</code>)——这是我们的树形图将要放置的地方——并为它分配了一个ID属性(例如，让它成为“container”)，以便在代码的后面引用它。</p><p id="027d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们还应该为<code class="fe nc nd ne nf b">&lt;div&gt;</code>设置一些样式。让我们将<code class="fe nc nd ne nf b">width</code>和<code class="fe nc nd ne nf b">height</code>属性定义为100%，边距和填充为0。你可以根据自己的喜好改变它。</p><pre class="ly lz ma mb gt ng nf nh ni aw nj bi"><span id="d99f" class="mq ku in nf b gy nk nl l nm nn">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>  &lt;head&gt;<br/>    &lt;meta charset="utf-8"&gt;<br/>    &lt;title&gt;JavaScript Treemap Chart&lt;/title&gt;<br/>    &lt;style type="text/css"&gt;   <br/>      html, body, #container {<br/>        width: 100%;<br/>        height: 100%;<br/>        margin: 0;<br/>        padding: 0;<br/>      }<br/>    &lt;/style&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;div id="container"&gt;&lt;/div&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><h2 id="3d76" class="mq ku in bd kv mr ms dn kz mt mu dp ld kg mv mw lh kk mx my ll ko mz na lp nb bi translated">2.参考JavaScript文件</h2><p id="76f8" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">接下来，我们需要引用创建树形图所需的所有脚本。</p><p id="4968" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">有<a class="ae lw" href="https://en.wikipedia.org/wiki/Comparison_of_JavaScript_charting_libraries" rel="noopener ugc nofollow" target="_blank">多个</a> JavaScript图表库可供选择。创建交互式数据可视化的基本步骤或多或少都是相同的。在这里，为了便于说明，我将使用<a class="ae lw" href="https://www.anychart.com" rel="noopener ugc nofollow" target="_blank">any chart</a>——它支持树形图并有一个免费版本，源代码在<a class="ae lw" href="https://github.com/AnyChart/AnyChart" rel="noopener ugc nofollow" target="_blank"> GitHub </a>上开放。</p><p id="4620" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">因此，要构建一个树形图，我们需要“核心”和“树形图”模块<a class="ae lw" href="https://docs.anychart.com/Quick_Start/Modules" rel="noopener ugc nofollow" target="_blank"/>。让我们在第一步中创建的HTML页面的head部分引用这两者。我们将从CDN获得它们(或者，可以下载脚本)。</p><pre class="ly lz ma mb gt ng nf nh ni aw nj bi"><span id="909c" class="mq ku in nf b gy nk nl l nm nn">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>  &lt;head&gt;<br/>    &lt;meta charset="utf-8"&gt;<br/>    &lt;title&gt;JavaScript Treemap Chart&lt;/title&gt;<br/>    &lt;script src="https://cdn.anychart.com/releases/8.11.0/js/anychart-core.min.js"&gt;&lt;/script&gt;<br/>    &lt;script src="https://cdn.anychart.com/releases/8.11.0/js/anychart-treemap.min.js"&gt;&lt;/script&gt;<br/>    &lt;style type="text/css"&gt;   <br/>      html, body, #container {<br/>        width: 100%;<br/>        height: 100%;<br/>        margin: 0;<br/>        padding: 0;<br/>      }<br/> &lt;/style&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;div id="container"&gt;&lt;/div&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><h2 id="b5b8" class="mq ku in bd kv mr ms dn kz mt mu dp ld kg mv mw lh kk mx my ll ko mz na lp nb bi translated">3.设置数据</h2><p id="c6da" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">数据来了。我们将想象出已知宇宙中最大的10个星系的规模。这些星系是如此的巨大，以至于可以用它们有多少光年来衡量。一光年是一束光在一个地球年中传播的距离，大约相当于6万亿英里。</p><p id="0373" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我已经从<a class="ae lw" href="https://largest.org/geography/galaxies/" rel="noopener ugc nofollow" target="_blank">Largest.org</a>那里得到了星系尺度的数据。</p><p id="3eec" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">对于我们的图表，树形结构数据如下所示。根级元素是“星系”，根据星系类型分为“椭圆”和“螺旋”作为其子元素，而这些子元素又有一系列单独的星系对象作为自己的子元素。</p><p id="9ec2" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">每个星系物体都有以光年为单位的名称和规模的键值属性。例如，<code class="fe nc nd ne nf b">{name: "IC 1101", value: 4000000}</code>表示IC 1101星系，其尺度为400万光年。老实说，很难理解它有多大。</p><pre class="ly lz ma mb gt ng nf nh ni aw nj bi"><span id="35df" class="mq ku in nf b gy nk nl l nm nn">var dataSet = [<br/>  {name: "Galaxies", children: [<br/>    {name: "Elliptical", children: [<br/>      {name: "IC 1101", value: 4000000},<br/>      {name: "Hercules A", value: 1500000},<br/>      {name: "A2261-BCG", value: 1000000},<br/>      {name: "ESO 306-17", value: 1000000},<br/>      {name: "ESO 444-46", value: 402200},<br/>    ]},<br/>    {name: "Spiral", children: [ <br/>      {name: "Rubin's Galaxy", value: 832000},<br/>      {name: "Comet Galaxy", value: 600000},<br/>      {name: "Condor Galaxy", value: 522000},<br/>      {name: "Tadpole Galaxy", value: 280000},<br/>      {name: "Andromeda Galaxy", value: 220000} <br/>    ]}<br/>  ]}<br/>];</span></pre><h2 id="ddd9" class="mq ku in bd kv mr ms dn kz mt mu dp ld kg mv mw lh kk mx my ll ko mz na lp nb bi translated">4.写一些JS树映射代码</h2><p id="7a2e" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">现在，只需几行JavaScript代码来为我们的树形图加油。</p><p id="ae4b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">首先，我们包含了<code class="fe nc nd ne nf b">anychart.onDocumentReady()</code>函数，它将封装树形图的所有JavaScript代码，确保它在网页完全加载并准备就绪时执行。</p><pre class="ly lz ma mb gt ng nf nh ni aw nj bi"><span id="ad9f" class="mq ku in nf b gy nk nl l nm nn">&lt;script&gt;<br/>  anychart.onDocumentReady(function () {<br/><strong class="nf io"><em class="no">    // The JS treemapping code will be written here.<br/></em></strong>  });<br/>&lt;/script&gt;</span></pre><p id="963d" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">第二步，我们在树形图中添加我们想要可视化的数据，从第三步开始。</p><pre class="ly lz ma mb gt ng nf nh ni aw nj bi"><span id="b06d" class="mq ku in nf b gy nk nl l nm nn">&lt;script&gt;<br/> <br/>  anychart.onDocumentReady(function () {<br/> <br/>    var dataSet = [<br/>      {name: "Galaxies", children: [<br/>        {name: "Elliptical", children: [<br/>          {name: "IC 1101", value: 4000000},<br/>          {name: "Hercules A", value: 1500000},<br/>          {name: "A2261-BCG", value: 1000000},<br/>          {name: "ESO 306-17", value: 1000000},<br/>          {name: "ESO 444-46", value: 402200},<br/>        ]},<br/>        {name: "Spiral", children: [ <br/>          {name: "Rubin's Galaxy", value: 832000},<br/>          {name: "Comet Galaxy", value: 600000},<br/>          {name: "Condor Galaxy", value: 522000},<br/>          {name: "Tadpole Galaxy", value: 280000},<br/>          {name: "Andromeda Galaxy", value: 220000} <br/>        ]}<br/>      ]}<br/>    ];<br/> <br/>  });<br/> <br/>&lt;/script&gt;</span></pre><p id="e4f9" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">第三，我们添加下面一行来从树数据创建一个树形图。</p><pre class="ly lz ma mb gt ng nf nh ni aw nj bi"><span id="a6e9" class="mq ku in nf b gy nk nl l nm nn">var chart = anychart.treeMap(dataSet, "as-tree");</span></pre><p id="5a80" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">最后，我们添加一个标题，将图表放入之前定义的<code class="fe nc nd ne nf b">&lt;div&gt;</code>容器中，并使用<code class="fe nc nd ne nf b">draw</code>命令显示它。</p><pre class="ly lz ma mb gt ng nf nh ni aw nj bi"><span id="9131" class="mq ku in nf b gy nk nl l nm nn">chart.title("The 10 Largest Galaxies in the Known Universe");<br/>chart.container("container");<br/>chart.draw();</span></pre><p id="4d1e" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在我们的JS树形图已经基本准备好了，如果我们就此打住，它看起来会像这样:</p><figure class="ly lz ma mb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi np"><img src="../Images/beeaf1c7980821c9e6235bcc8e5f706a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/0*ycAuVpC-70oDFPff.png"/></div></div></figure><p id="a0f4" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">加载树形图时，只能立即看到两个图块，“椭圆形”和“螺旋形”我们可以点击它们，它们会展开显示各自的子星系——这就是所谓的<a class="ae lw" href="https://docs.anychart.com/Drilldown" rel="noopener ugc nofollow" target="_blank">下钻</a>动作。</p><figure class="ly lz ma mb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nq"><img src="../Images/9ccdc272db16d00ddcb2623a3aec1d1e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*wtcdjW1CIrb1hXsQ.gif"/></div></div></figure><p id="d448" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">为什么会这样，就两块瓷砖？因为默认情况下，最大深度值设置为1。这意味着我们一次只能看到其父级的一个级别。较低的级别是隐藏的。在第一个层面上，我们将“星系”分为“椭圆”和“螺旋”，所以我们只能默认看到这种情况。</p><p id="245f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在，我们如何一次显示所有的银河方块呢？很简单。我们只需要使用<code class="fe nc nd ne nf b">maxDepth()</code>功能改变最大深度值。</p><pre class="ly lz ma mb gt ng nf nh ni aw nj bi"><span id="2fa3" class="mq ku in nf b gy nk nl l nm nn">chart.maxDepth(2);</span></pre><p id="92a9" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">倒计时结束了，我们的树形图已经是现在了！</p><figure class="ly lz ma mb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi np"><img src="../Images/75468548473ea12dc3d4894919d9642b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Cqs_QOzpueTVjAYp3omYyg.png"/></div></div></figure><p id="ebec" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在这张图表中，我们可以看到星系是如何根据层次进行分组的，我们还可以单击顶部的“椭圆形”或“螺旋形”标题来放大它们的子星系。</p><p id="98c9" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">在<a class="ae lw" href="https://jsfiddle.net/awanshrestha/zL6gbem5/" rel="noopener ugc nofollow" target="_blank"> JSFiddle </a>【或者<a class="ae lw" href="https://playground.anychart.com/zUBT93xw/" rel="noopener ugc nofollow" target="_blank"> AnyChart Playground </a>上看看这个基本JavaScript树形图的交互版本。你可以随意摆弄它。您也可以查看下面的完整代码。</p><pre class="ly lz ma mb gt ng nf nh ni aw nj bi"><span id="63e8" class="mq ku in nf b gy nk nl l nm nn">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>  &lt;head&gt;<br/>    &lt;meta charset="utf-8"&gt;<br/>    &lt;title&gt;JavaScript Treemap Chart&lt;/title&gt;<br/>    &lt;script data-fr-src="https://cdn.anychart.com/releases/8.11.0/js/anychart-core.min.js"&gt;&lt;/script&gt;<br/>    &lt;script data-fr-src="https://cdn.anychart.com/releases/8.11.0/js/anychart-treemap.min.js"&gt;&lt;/script&gt;<br/>    &lt;style type="text/css"&gt;   <br/>      html, body, #container {<br/>        width: 100%;<br/>        height: 100%;<br/>        margin: 0;<br/>        padding: 0;<br/>      }<br/>    &lt;/style&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;div id="container"&gt;&lt;/div&gt;<br/> <br/>    &lt;script&gt;<br/> <br/>      anychart.onDocumentReady(function () {<br/> <br/><strong class="nf io"><em class="no">        // create the data<br/></em></strong>        var dataSet = [<br/>          {name: "Galaxies", children: [<br/>            {name: "Elliptical", children: [<br/>              {name: "IC 1101", value: 4000000},<br/>              {name: "Hercules A", value: 1500000},<br/>              {name: "A2261-BCG", value: 1000000},<br/>              {name: "ESO 306-17", value: 1000000},<br/>              {name: "ESO 444-46", value: 402200},<br/>            ]},<br/>            {name: "Spiral", children: [ <br/>              {name: "Rubin's Galaxy", value: 832000},<br/>              {name: "Comet Galaxy", value: 600000},<br/>              {name: "Condor Galaxy", value: 522000},<br/>              {name: "Tadpole Galaxy", value: 280000},<br/>              {name: "Andromeda Galaxy", value: 220000} <br/>            ]}<br/>          ]}<br/>        ];<br/>        <br/><strong class="nf io"><em class="no">        //  create the treemap chart and set the data<br/></em></strong>        var chart = anychart.treeMap(dataSet, "as-tree");<br/> <br/><strong class="nf io"><em class="no">        // set the chart title<br/></em></strong>        chart.title("The 10 Largest Galaxies in the Known Universe");<br/> <br/><strong class="nf io"><em class="no">        // set the container id for the chart<br/></em></strong>        chart.container("container");<br/> <br/><strong class="nf io"><em class="no">        // initiate drawing the chart<br/></em></strong>        chart.draw();<br/> <br/>      });<br/> <br/>    &lt;/script&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><p id="e206" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">创建一个漂亮的JavaScript树形图很容易，不是吗？现在，你可以一目了然地看到10个最大星系的规模，并对它们进行比较。</p><p id="0734" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">最终的图表对我来说已经很不错了。但是，让我向您展示如何在需要时定制JavaScript树形图。</p><h1 id="7c9e" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">自定义JS树形图</h1><p id="a6fd" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">现在，让我们添加一些美学和功能上的变化，使我们的交互式树形图更好，更有洞察力。</p><h2 id="dbf7" class="mq ku in bd kv mr ms dn kz mt mu dp ld kg mv mw lh kk mx my ll ko mz na lp nb bi translated">A.改变颜色</h2><p id="f076" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">改变任何图表的外观和感觉的一个简单方法是改变颜色以匹配我们所表示的数据。这里我们展示了宇宙中的星系。当我想到宇宙时，我想象黑暗空间中深蓝色和紫色的恒星云。</p><p id="074b" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">所以，让我们改变瓷砖的颜色。让我们把它们涂成紫色。此外，让我们使他们深蓝色时，选择。</p><pre class="ly lz ma mb gt ng nf nh ni aw nj bi"><span id="bed6" class="mq ku in nf b gy nk nl l nm nn">chart.normal().fill('#B46FC2');<br/>chart.hovered().fill('#44008B', 0.8);<br/>chart.selected().fill('#0A0068', 0.8);<br/>chart.selected().hatchFill("forward-diagonal", '#282147', 2, 20);</span></pre><p id="7376" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这里，我们添加了<code class="fe nc nd ne nf b">fill()</code>和<code class="fe nc nd ne nf b">hatchFill()</code>方法来改变树形图的颜色。</p><figure class="ly lz ma mb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi np"><img src="../Images/9710efda6802eb24f7e26f1c97b5e163.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*pDrPbKMVhxQGm00vUMcRdA.png"/></div></div></figure><h2 id="7813" class="mq ku in bd kv mr ms dn kz mt mu dp ld kg mv mw lh kk mx my ll ko mz na lp nb bi translated">B.应用线性色标</h2><p id="00fd" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">在树形图中，不仅是尺寸，还有图块的颜色都有助于突出比例。让我们来看一个很酷的方法，在线性色标的帮助下，根据相应的数据维度自动给图块着色。</p><p id="4cf6" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们创建一个线性色标，为其提供两个值，一个是最低范围值，另一个是最高范围值，最后，启用颜色范围。</p><pre class="ly lz ma mb gt ng nf nh ni aw nj bi"><span id="ddc7" class="mq ku in nf b gy nk nl l nm nn">var customColorScale = anychart.scales.linearColor();<br/>customColorScale.colors(['#37B8F7', '#ffcc00']);<br/>chart.colorScale(customColorScale);<br/>chart.colorRange().enabled(true);<br/>chart.colorRange().length('90%');</span></pre><p id="28ee" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">为了实现这些功能，我们需要去掉前一节中编写的代码。</p><figure class="ly lz ma mb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi np"><img src="../Images/23aa15bde3398f2f438c23e790851e91.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*HSoO5dRsJ9Ors6i_FfJUcg.png"/></div></div></figure><p id="c2b7" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">这里我们有浅蓝色代表最低，黄色代表最高。和颜色一起玩。</p><h2 id="2d3c" class="mq ku in bd kv mr ms dn kz mt mu dp ld kg mv mw lh kk mx my ll ko mz na lp nb bi translated">C.格式化标签和工具提示</h2><p id="4fcd" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">我们可以使用HTML来格式化我们的标签。为此，我们需要为标签启用HTML。那么您可以无限制地使用HTML来设计它们的样式。</p><p id="446a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">为了简单起见，我们将把标签格式化为<code class="fe nc nd ne nf b">&lt;span&gt;</code> HTML元素，并设置它们的样式以增加字体大小和改变颜色。</p><pre class="ly lz ma mb gt ng nf nh ni aw nj bi"><span id="5997" class="mq ku in nf b gy nk nl l nm nn">chart.labels().useHtml(true);<br/>chart.labels().format(<br/>  "&lt;span style='font-size: 24px; color: #00076f'&gt;{%name}&lt;/span&gt;&lt;br&gt;{%value}"<br/>);</span></pre><p id="e108" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">正如你在上面的代码片段中看到的，我们还使用了<code class="fe nc nd ne nf b">{%name}</code>和<code class="fe nc nd ne nf b">{%value}</code>标记来改变树形图标签和工具提示的文本。这样，在创建可视化时，将输出每个星系的名称和比例值。</p><p id="b107" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">此外，让我们使用<code class="fe nc nd ne nf b">format()</code>方法定制工具提示的文本。信息丰富的工具提示有助于更好地理解数据。</p><pre class="ly lz ma mb gt ng nf nh ni aw nj bi"><span id="8ff1" class="mq ku in nf b gy nk nl l nm nn">chart.tooltip().format(<br/>  "Scale: {%value} light-years"<br/>);</span></pre><figure class="ly lz ma mb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi np"><img src="../Images/d36c5a434dd72a9b96ae6e27e877037a.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*0-sruPu6VsF8TMawAnxZtg.png"/></div></div></figure><p id="badb" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">我们基于JS的树形图在标签和工具提示格式上看起来有了很大的改进。</p><h2 id="35ce" class="mq ku in bd kv mr ms dn kz mt mu dp ld kg mv mw lh kk mx my ll ko mz na lp nb bi translated">D.按升序排列图块</h2><p id="43e6" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">默认情况下，树图平铺按降序排列。我们可以看到星系从最高到最低排序，规模最大的IC 1101星系是左起第一个。</p><p id="eb6a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">但情况不一定总是如此。有时，我们可能需要以升序显示数据。准备好惊讶地发现这有多简单吧！我们只用一行代码就做到了。</p><pre class="ly lz ma mb gt ng nf nh ni aw nj bi"><span id="d4a5" class="mq ku in nf b gy nk nl l nm nn">chart.sort("asc");</span></pre><figure class="ly lz ma mb gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi np"><img src="../Images/afb518d5c7b21aba7b5987a0d2564e45.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*fYPCE1Ty07a5E7a-opM28w.png"/></div></div></figure><p id="770c" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">查看下面这个最终的交互式JavaScript树形图的全部代码[也可以在<a class="ae lw" href="https://playground.anychart.com/5ZzVNs9c" rel="noopener ugc nofollow" target="_blank"> AnyChart游乐场</a>上查看]。请随意尝试一些实验。</p><pre class="ly lz ma mb gt ng nf nh ni aw nj bi"><span id="f87b" class="mq ku in nf b gy nk nl l nm nn">&lt;!DOCTYPE html&gt;<br/>&lt;html lang="en"&gt;<br/>  &lt;head&gt;<br/>    &lt;meta charset="utf-8"&gt;<br/>    &lt;title&gt;JavaScript Treemap Chart&lt;/title&gt;<br/>    &lt;script data-fr-src="https://cdn.anychart.com/releases/8.11.0/js/anychart-core.min.js"&gt;&lt;/script&gt;<br/>    &lt;script data-fr-src="https://cdn.anychart.com/releases/8.11.0/js/anychart-treemap.min.js"&gt;&lt;/script&gt;<br/>    &lt;style type="text/css"&gt;   <br/>      html, body, #container {<br/>        width: 100%;<br/>        height: 100%;<br/>        margin: 0;<br/>        padding: 0;<br/>      }<br/>    &lt;/style&gt;<br/>  &lt;/head&gt;<br/>  &lt;body&gt;<br/>    &lt;div id="container"&gt;&lt;/div&gt;<br/> <br/>    &lt;script&gt;<br/> <br/>      anychart.onDocumentReady(function () {<br/> <br/><strong class="nf io"><em class="no">        // create the data<br/></em></strong>        var dataSet = [<br/>          {name: "Galaxies", children: [<br/>            {name: "Elliptical", children: [<br/>              {name: "IC 1101", value: 4000000},<br/>              {name: "Hercules A", value: 1500000},<br/>              {name: "A2261-BCG", value: 1000000},<br/>              {name: "ESO 306-17", value: 1000000},<br/>              {name: "ESO 444-46", value: 402200},<br/>            ]},<br/>            {name: "Spiral", children: [ <br/>              {name: "Rubin's Galaxy", value: 832000},<br/>              {name: "Comet Galaxy", value: 600000},<br/>              {name: "Condor Galaxy", value: 522000},<br/>              {name: "Tadpole Galaxy", value: 280000},<br/>              {name: "Andromeda Galaxy", value: 220000} <br/>            ]}<br/>          ]}<br/>        ];</span><span id="4fc1" class="mq ku in nf b gy nr nl l nm nn"><strong class="nf io"><em class="no">        // create the treemap chart and set the data<br/></em></strong>        var chart = anychart.treeMap(dataSet, "as-tree");<br/> <br/><strong class="nf io"><em class="no">        // set the chart title<br/></em></strong>        chart.title("The 10 Largest Galaxies in the Known Universe");</span><span id="5764" class="mq ku in nf b gy nr nl l nm nn"><strong class="nf io"><em class="no">        // set a custom color scale<br/></em></strong>        var customColorScale = anychart.scales.linearColor();<br/>        customColorScale.colors(['#37B8F7', '#ffcc00']);<br/>        chart.colorScale(customColorScale);<br/>        chart.colorRange().enabled(true);<br/>        chart.colorRange().length('90%');</span><span id="b90b" class="mq ku in nf b gy nr nl l nm nn"><strong class="nf io"><em class="no">        // format the labels<br/></em></strong>        chart.labels().useHtml(true);<br/>        chart.labels().format(<br/>          "&lt;span style='font-size: 24px; color: #00076f'&gt;{%name}&lt;/span&gt;&lt;br&gt;{%value}"<br/>        );<br/>  <br/><strong class="nf io"><em class="no">        // format the tooltips<br/></em></strong>        chart.tooltip().format(<br/>          "Scale: {%value} light years"<br/>        );</span><span id="c18a" class="mq ku in nf b gy nr nl l nm nn"><strong class="nf io"><em class="no">        // sort in ascending order<br/></em></strong>        chart.sort("asc");<br/> <br/><strong class="nf io"><em class="no">        // set the container id for the chart<br/></em></strong>        chart.container("container");<br/> <br/><strong class="nf io"><em class="no">        // initiate drawing the chart<br/></em></strong>        chart.draw();<br/> <br/>      });<br/> <br/>    &lt;/script&gt;<br/>  &lt;/body&gt;<br/>&lt;/html&gt;</span></pre><h1 id="8c25" class="kt ku in bd kv kw kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq bi translated">结论</h1><p id="dadd" class="pw-post-body-paragraph jv jw in jx b jy lr ka kb kc ls ke kf kg lt ki kj kk lu km kn ko lv kq kr ks ig bi translated">你可能还没有找到“我们在宇宙中是孤独的吗？”问题。但是您已经学会了毫不费力地创建令人敬畏的交互式JavaScript树形图！</p><p id="0aa1" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">现在轮到您构建自己的基于JS的树形图可视化了。查看<a class="ae lw" href="https://docs.anychart.com/Basic_Charts/Treemap_Chart" rel="noopener ugc nofollow" target="_blank">树形图文档</a>以了解除了我们在本教程中讨论的内容之外还可以做什么，或者对不同的图表库应用相同的逻辑，如果您需要任何进一步的帮助，请不要犹豫联系我(我会尽力而为)。</p><p id="990a" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated">宇宙在不断扩张，让我们的学习、知识和创造力也是如此。</p></div><div class="ab cl ns nt hr nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="ig ih ii ij ik"><p id="7355" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"> <em class="no">经阿万·施雷斯塔许可出版。原载于2022年6月1日</em></strong><a class="ae lw" href="https://dzone.com/articles/treemap-chart-javascript" rel="noopener ugc nofollow" target="_blank"><strong class="jx io"><em class="no">DZone</em></strong></a><strong class="jx io"><em class="no">标题为《如何使用JavaScript构建树形图》。</em> </strong></p><p id="711f" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"> <em class="no">你可能也想看基本的JavaScript</em></strong><a class="ae lw" href="https://www.anychart.com/blog/2019/08/01/treemap-chart-create-javascript/" rel="noopener ugc nofollow" target="_blank"><strong class="jx io"><em class="no">Treemap图表教程</em> </strong> </a> <strong class="jx io"> <em class="no">最初发表在我们的博客上。</em> </strong></p><p id="7b92" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><strong class="jx io"> <em class="no">查看其他</em></strong><a class="ae lw" href="https://www.anychart.com/blog/category/javascript-chart-tutorials/" rel="noopener ugc nofollow" target="_blank"><strong class="jx io"><em class="no">JavaScript制图教程</em> </strong> </a> <strong class="jx io"> <em class="no">。</em>T45】</strong></p></div><div class="ab cl ns nt hr nu" role="separator"><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx ny"/><span class="nv bw bk nw nx"/></div><div class="ig ih ii ij ik"><p id="b787" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="no">最初发表于2022年6月8日</em><a class="ae lw" href="https://www.anychart.com/blog/2022/06/08/treemap-js/" rel="noopener ugc nofollow" target="_blank"><em class="no">https://www.anychart.com</em></a><em class="no">。</em></p><p id="58bd" class="pw-post-body-paragraph jv jw in jx b jy jz ka kb kc kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks ig bi translated"><em class="no">更多内容请看</em><a class="ae lw" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="jx io"><em class="no">plain English . io</em></strong></a><em class="no">。报名参加我们的</em> <a class="ae lw" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io"> <em class="no">免费周报</em> </strong> </a> <em class="no">。关注我们关于</em><a class="ae lw" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="jx io"><em class="no">Twitter</em></strong></a><em class="no">和</em><a class="ae lw" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="jx io"><em class="no">LinkedIn</em></strong></a><em class="no">。查看我们的</em> <a class="ae lw" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io"> <em class="no">社区不和谐</em> </strong> </a> <em class="no">加入我们的</em> <a class="ae lw" href="https://inplainenglish.pallet.com/talent/welcome" rel="noopener ugc nofollow" target="_blank"> <strong class="jx io"> <em class="no">人才集体</em> </strong> </a> <em class="no">。</em></p></div></div>    
</body>
</html>