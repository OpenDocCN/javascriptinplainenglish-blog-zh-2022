<html>
<head>
<title>How to Use Docker in Your Node.js and React Applications</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Node.js和React应用程序中使用Docker</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-use-docker-in-your-node-and-react-applications-8dd3cbd44853?source=collection_archive---------9-----------------------#2022-06-15">https://javascript.plainenglish.io/how-to-use-docker-in-your-node-and-react-applications-8dd3cbd44853?source=collection_archive---------9-----------------------#2022-06-15</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="f2f0" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">如何在Docker容器中创建和运行Node.js-Express后端和React前端。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/8664246960979bd531e1ef571cbebdfd.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*94UK6o7oc8qR6GjNWETW_A.png"/></div></div></figure><p id="7f12" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">Docker让开发人员能够将他们所有的应用程序打包到容器中。这些容器可以在任何安装了Docker的机器上运行，应用程序也是一样的。这是在多个系统上运行一个代码库克隆的好方法，并且你可以确定它们都是一样的。</p><p id="8194" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">当使用Docker时，CI/CD工作流和DevOps测试环境明显更好，Docker本质上是一组可以共享的软件工具。Kubernetes是另一个用于操作多个Docker容器的工具，但是规模要大得多。</p><p id="2efb" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在本教程中，我们将学习如何在Docker容器中创建和运行Node.js-Express后端和React前端。</p><h1 id="ad5f" class="lk ll in bd lm ln lo lp lq lr ls lt lu jt lv ju lw jw lx jx ly jz lz ka ma mb bi translated">在Docker中运行Node.js-Express后端</h1><p id="d9f0" class="pw-post-body-paragraph ko kp in kq b kr mc jo kt ku md jr kw kx me kz la lb mf ld le lf mg lh li lj ig bi translated">开始之前，请确保您的计算机上安装并运行了Docker。</p><p id="411a" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在使用命令行导航到一个目录，比如你的桌面，然后运行下面的命令。</p><pre class="kd ke kf kg gt mh mi mj mk aw ml bi"><span id="8bc3" class="mm ll in mi b gy mn mo l mp mq">mkdir my-app-docker<br/>cd my-app-docker<br/>touch docker-compose.yml<br/>mkdir api<br/>cd api<br/>npm init -y<br/>npm i express<br/>touch app.js Dockerfile .dockerignore<br/>cd ..</span></pre><p id="ef78" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我们设置了一个名为api的后端，并创建了一些Docker文件。现在，在代码编辑器中打开项目，并将下面的代码添加到相应的文件中。</p><p id="c967" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">将此放入<code class="fe mr ms mt mi b">docker-compose.yml</code>文件。小心YAML格式，否则，你会得到Docker错误，当你试图运行它。</p><pre class="kd ke kf kg gt mh mi mj mk aw ml bi"><span id="9905" class="mm ll in mi b gy mn mo l mp mq">version: '3.8'<br/>services:<br/>  api:<br/>    build: ./api<br/>    container_name: api_backend<br/>    ports:<br/>      - '4000:4000'<br/>    volumes:<br/>      - ./api:/app<br/>      - ./app/node_modules</span></pre><p id="5f83" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">将此添加到<code class="fe mr ms mt mi b">app.js</code>文件中:</p><pre class="kd ke kf kg gt mh mi mj mk aw ml bi"><span id="e220" class="mm ll in mi b gy mn mo l mp mq">const express = require('express');</span><span id="d62c" class="mm ll in mi b gy mu mo l mp mq">const app = express();</span><span id="9973" class="mm ll in mi b gy mu mo l mp mq">const port = process.env.PORT || 4000;</span><span id="1641" class="mm ll in mi b gy mu mo l mp mq">app.get('/', (req, res) =&gt; {<br/>  res.send('Home Route');<br/>});</span><span id="2cf7" class="mm ll in mi b gy mu mo l mp mq">app.listen(port, () =&gt;<br/>  console.log(`Server running on port ${port}, http://localhost:${port}`)<br/>);</span></pre><p id="58b0" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在将这一行添加到<code class="fe mr ms mt mi b">.dockerignore</code>文件中:</p><pre class="kd ke kf kg gt mh mi mj mk aw ml bi"><span id="29ed" class="mm ll in mi b gy mn mo l mp mq">node_modules</span></pre><p id="fdec" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">接下来，将这段代码添加到<code class="fe mr ms mt mi b">Dockerfile</code>文件中:</p><pre class="kd ke kf kg gt mh mi mj mk aw ml bi"><span id="c70a" class="mm ll in mi b gy mn mo l mp mq">FROM node:16-alpine</span><span id="394d" class="mm ll in mi b gy mu mo l mp mq">WORKDIR /app</span><span id="32b7" class="mm ll in mi b gy mu mo l mp mq">COPY package.json .</span><span id="9393" class="mm ll in mi b gy mu mo l mp mq">RUN npm install</span><span id="74be" class="mm ll in mi b gy mu mo l mp mq">COPY . .</span><span id="2f72" class="mm ll in mi b gy mu mo l mp mq">EXPOSE 4000</span><span id="1e2f" class="mm ll in mi b gy mu mo l mp mq">CMD ["node", "app.js"]</span></pre><p id="fa4b" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">最后，将这个运行脚本添加到<code class="fe mr ms mt mi b">package.json</code>文件中:</p><pre class="kd ke kf kg gt mh mi mj mk aw ml bi"><span id="644e" class="mm ll in mi b gy mn mo l mp mq">"scripts": {</span><span id="8bef" class="mm ll in mi b gy mu mo l mp mq">"start": "node app.js"</span><span id="2e11" class="mm ll in mi b gy mu mo l mp mq">},</span></pre><p id="07cc" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io">(可选)使用Nodemon让服务器在发生变化时自动重启</strong></p><p id="2fad" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">如果您想让服务器在每次更改后端文件时都重新启动，那么您可以将其配置为使用Nodemon。</p><p id="61dc" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">你所要做的就是更新<strong class="kq io"> api </strong>文件夹中的<code class="fe mr ms mt mi b">Dockerfile</code>和<code class="fe mr ms mt mi b">package.json</code>文件。</p><p id="0788" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">使用以下代码更新<code class="fe mr ms mt mi b">Dockerfile</code>中的代码。我们现在开始安装Nodemon，并使用<strong class="kq io"> dev </strong>作为运行命令。</p><pre class="kd ke kf kg gt mh mi mj mk aw ml bi"><span id="f262" class="mm ll in mi b gy mn mo l mp mq">FROM node:16-alpine</span><span id="4fdf" class="mm ll in mi b gy mu mo l mp mq">RUN npm install -g nodemon</span><span id="5cbf" class="mm ll in mi b gy mu mo l mp mq">WORKDIR /app</span><span id="825f" class="mm ll in mi b gy mu mo l mp mq">COPY package.json .</span><span id="4b5b" class="mm ll in mi b gy mu mo l mp mq">RUN npm install</span><span id="6dcf" class="mm ll in mi b gy mu mo l mp mq">COPY . .</span><span id="3ed7" class="mm ll in mi b gy mu mo l mp mq">EXPOSE 4000</span><span id="401e" class="mm ll in mi b gy mu mo l mp mq">CMD ["npm", "run", "dev"]</span></pre><p id="d233" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在用Nodemon的运行脚本更新<code class="fe mr ms mt mi b">package.json</code>文件。</p><pre class="kd ke kf kg gt mh mi mj mk aw ml bi"><span id="8817" class="mm ll in mi b gy mn mo l mp mq">"scripts": {</span><span id="7ce9" class="mm ll in mi b gy mu mo l mp mq">"start": "node app.js",</span><span id="1b57" class="mm ll in mi b gy mu mo l mp mq">"dev": "nodemon -L app.js"</span><span id="c61a" class="mm ll in mi b gy mu mo l mp mq">},</span></pre><p id="fe64" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我们刚刚创建了一个运行在端口4000上的基本Node.js-Express应用程序。该端口还映射到docker中的4000，这使我们可以在Docker容器中运行它。</p><h1 id="7142" class="lk ll in bd lm ln lo lp lq lr ls lt lu jt lv ju lw jw lx jx ly jz lz ka ma mb bi translated">启动服务器</h1><p id="eb5f" class="pw-post-body-paragraph ko kp in kq b kr mc jo kt ku md jr kw kx me kz la lb mf ld le lf mg lh li lj ig bi translated">要像normal一样使用Node在Docker容器之外运行服务器，只需在命令行中运行下面的代码。您需要确保您在api文件夹中。如果你去<a class="ae mv" href="http://localhost:4000/" rel="noopener ugc nofollow" target="_blank"> http://localhost:4000 </a>你应该会在你的浏览器窗口看到回家的路线。</p><pre class="kd ke kf kg gt mh mi mj mk aw ml bi"><span id="d946" class="mm ll in mi b gy mn mo l mp mq">npm run start</span></pre><p id="a726" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">让Node.js-Express应用程序在Docker中运行需要不同的命令。首先，您需要在根文件夹中找到<code class="fe mr ms mt mi b">docker-compose.yml</code>文件。现在运行下面的命令，它应该在Docker容器中运行。</p><p id="364a" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">不要忘记首先停止节点服务器的运行，因为在端口4000上只能运行一个服务器。</p><pre class="kd ke kf kg gt mh mi mj mk aw ml bi"><span id="3825" class="mm ll in mi b gy mn mo l mp mq">docker-compose up</span></pre><p id="6854" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">如果你访问http://localhost:4000 ，你应该会在你的浏览器窗口看到回家的路线。</p><p id="2f96" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">你可以用下面的命令停止服务器，或者你可以使用Docker应用程序停止容器的运行。</p><pre class="kd ke kf kg gt mh mi mj mk aw ml bi"><span id="4608" class="mm ll in mi b gy mn mo l mp mq">docker-compose down</span></pre><h1 id="376f" class="lk ll in bd lm ln lo lp lq lr ls lt lu jt lv ju lw jw lx jx ly jz lz ka ma mb bi translated">在Docker中运行React前端</h1><p id="4ad1" class="pw-post-body-paragraph ko kp in kq b kr mc jo kt ku md jr kw kx me kz la lb mf ld le lf mg lh li lj ig bi translated">现在让我们创建一个反应前端！使用命令行进入my-app-docker的根文件夹。运行下面的命令来设置项目。</p><pre class="kd ke kf kg gt mh mi mj mk aw ml bi"><span id="3645" class="mm ll in mi b gy mn mo l mp mq">npx create-react-app client<br/>cd client<br/>touch .dockerignore Dockerfile</span></pre><p id="a29a" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在将下面的代码添加到它们对应的文件中。</p><p id="c091" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">将这一行添加到<code class="fe mr ms mt mi b">.dockerignore</code>文件中。</p><pre class="kd ke kf kg gt mh mi mj mk aw ml bi"><span id="8ba1" class="mm ll in mi b gy mn mo l mp mq">node_modules</span></pre><p id="60c6" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">把这段代码放到<code class="fe mr ms mt mi b">Dockerfile</code>文件中。</p><pre class="kd ke kf kg gt mh mi mj mk aw ml bi"><span id="53c2" class="mm ll in mi b gy mn mo l mp mq">FROM node:17-alpine</span><span id="84a3" class="mm ll in mi b gy mu mo l mp mq">WORKDIR /app</span><span id="c439" class="mm ll in mi b gy mu mo l mp mq">COPY package.json .</span><span id="8040" class="mm ll in mi b gy mu mo l mp mq">RUN npm install</span><span id="b9f8" class="mm ll in mi b gy mu mo l mp mq">COPY . .</span><span id="2ba6" class="mm ll in mi b gy mu mo l mp mq">EXPOSE 3000</span><span id="e80d" class="mm ll in mi b gy mu mo l mp mq">CMD ["npm", "start"]</span></pre><p id="2d2d" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">最后，用下面的代码更新根文件夹中的<code class="fe mr ms mt mi b">docker-compose.yml</code>。我们在底部添加了一个客户端部分，用于设置React在Docker容器中的运行。小心YAML格式，否则，你会得到Docker错误，当你试图运行它。</p><pre class="kd ke kf kg gt mh mi mj mk aw ml bi"><span id="855f" class="mm ll in mi b gy mn mo l mp mq">version: '3.8'<br/>services:<br/>  api:<br/>    build: ./api<br/>    container_name: api_backend<br/>    ports:<br/>      - '4000:4000'<br/>    volumes:<br/>      - ./api:/app<br/>      - ./app/node_modules<br/>  client:<br/>    build: ./client<br/>    container_name: client_frontend<br/>    ports:<br/>      - '3000:3000'<br/>    volumes:<br/>      - ./client:/app<br/>      - ./app/node_modules<br/>    stdin_open: true<br/>    tty: true</span></pre><h1 id="accd" class="lk ll in bd lm ln lo lp lq lr ls lt lu jt lv ju lw jw lx jx ly jz lz ka ma mb bi translated">启动服务器</h1><p id="9b84" class="pw-post-body-paragraph ko kp in kq b kr mc jo kt ku md jr kw kx me kz la lb mf ld le lf mg lh li lj ig bi translated">要像normal一样使用Node在Docker容器之外运行服务器，只需在命令行中运行下面的代码。确保您在客户端文件夹中。如果你去<a class="ae mv" href="http://localhost:3000/" rel="noopener ugc nofollow" target="_blank"> http://localhost:3000 </a>你应该会在你的浏览器窗口看到回家的路线。</p><pre class="kd ke kf kg gt mh mi mj mk aw ml bi"><span id="e9b9" class="mm ll in mi b gy mn mo l mp mq">npm run start</span></pre><p id="66c2" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">让React应用程序在Docker中运行需要不同的命令。首先，你需要在根文件夹中找到<code class="fe mr ms mt mi b">docker-compose.yml</code>文件。现在运行下面的命令，它应该在Docker容器中运行。</p><p id="4e21" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">不要忘记首先停止React应用服务器的运行，因为在端口3000上只能运行一个服务器。</p><pre class="kd ke kf kg gt mh mi mj mk aw ml bi"><span id="98dd" class="mm ll in mi b gy mn mo l mp mq">docker-compose up</span></pre><p id="57c9" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">如果你去<a class="ae mv" href="http://localhost:3000/" rel="noopener ugc nofollow" target="_blank"> http://localhost:3000 </a>你应该会在你的浏览器窗口看到回家的路线。</p><p id="a424" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">你可以用下面的命令停止服务器，或者你可以使用Docker应用程序停止容器的运行。</p><pre class="kd ke kf kg gt mh mi mj mk aw ml bi"><span id="3f2e" class="mm ll in mi b gy mn mo l mp mq">docker-compose down</span></pre><p id="2e93" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">通过这种设置，您可以在Docker中同时运行Node.js后端和React前端！如果您遇到任何错误，那么您可能需要打开您的Docker桌面应用程序，并删除任何与此项目相关的图像。然后你可以试着再次运行<code class="fe mr ms mt mi b">docker-compose up</code>命令，希望这一次一切都像预期的那样工作。</p><p id="c9e4" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><em class="mw">更多内容尽在</em> <a class="ae mv" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io"> <em class="mw">说白了. io </em> </strong> </a> <em class="mw">。报名参加我们的</em> <a class="ae mv" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io"> <em class="mw">免费周报</em> </strong> </a> <em class="mw">。关注我们关于</em> <a class="ae mv" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io"> <em class="mw">推特</em> </strong> </a> <em class="mw">和</em><a class="ae mv" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kq io"><em class="mw">LinkedIn</em></strong></a><em class="mw">。查看我们的</em> <a class="ae mv" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io"> <em class="mw">社区不和谐</em> </strong> </a> <em class="mw">加入我们的</em> <a class="ae mv" href="https://inplainenglish.pallet.com/talent/welcome" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io"> <em class="mw">人才集体</em> </strong> </a> <em class="mw">。</em></p></div></div>    
</body>
</html>