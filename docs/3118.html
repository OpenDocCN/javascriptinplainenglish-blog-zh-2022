<html>
<head>
<title>How to Upload Files From a Webpage</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何从网页上传文件</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-upload-file-from-a-webpage-e3e9fa727d73?source=collection_archive---------4-----------------------#2022-08-02">https://javascript.plainenglish.io/how-to-upload-file-from-a-webpage-e3e9fa727d73?source=collection_archive---------4-----------------------#2022-08-02</a></blockquote><div><div class="fc ic id ie if ig"/><div class="ih ii ij ik il"><div class=""/><p id="f479" class="pw-post-body-paragraph jl jm io jn b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki ih bi translated">这里有3种从网页上传文件的方法:使用HTML表单、FormData和showOpenFilePicker API。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj kj"><img src="../Images/db27d9c2a68d70014d3568f97578247e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*im_6DEFgA1WGJbN3cU8Rqw.png"/></div></div></figure><h1 id="7c6c" class="kv kw io bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">前言</h1><p id="3efe" class="pw-post-body-paragraph jl jm io jn b jo lt jq jr js lu ju jv jw lv jy jz ka lw kc kd ke lx kg kh ki ih bi translated">上传文件是网页上很常见的功能，尤其是上传图片。大多数内容创作网站，如Medium、Twitter、StackOverflow等。支持上传图片，相比纯文本，图片会让写出来的内容通俗易懂。</p><p id="84bb" class="pw-post-body-paragraph jl jm io jn b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki ih bi translated">在这篇文章中，我们将学习3种在网页上上传文件的方法。我们将使用Node.js实现一个文件上传服务器，如本文所示:</p><div class="ly lz gq gs ma mb"><a rel="noopener  ugc nofollow" target="_blank" href="/how-to-implement-a-file-upload-server-with-node-js-83043bc180fc"><div class="mc ab fp"><div class="md ab me cl cj mf"><h2 class="bd ip gz z fq mg fs ft mh fv fx in bi translated">如何用Node.js实现文件上传服务器</h2><div class="mi l"><h3 class="bd b gz z fq mg fs ft mh fv fx dk translated">使用busboy模块解析表单数据。</h3></div><div class="mj l"><p class="bd b dl z fq mg fs ft mh fv fx dk translated">javascript.plainenglish.io</p></div></div><div class="mk l"><div class="ml l mm mn mo mk mp kt mb"/></div></div></a></div><h1 id="f19c" class="kv kw io bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">HTML表单</h1><p id="567b" class="pw-post-body-paragraph jl jm io jn b jo lt jq jr js lu ju jv jw lv jy jz ka lw kc kd ke lx kg kh ki ih bi translated">在网页上，我们可以使用<code class="fe mq mr ms mt b">&lt;form&gt;</code>元素提交用户输入的信息，比如允许用户在登录网站时填写用户名和密码。<code class="fe mq mr ms mt b">&lt;form&gt;</code>元素也支持上传文件。实现上传文件只需要几行HTML代码。当然，你需要注意正确设置<code class="fe mq mr ms mt b">&lt;form&gt;</code>元素的属性:</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="mu mv l"/></div></figure><p id="0bac" class="pw-post-body-paragraph jl jm io jn b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki ih bi translated">我们需要设置<code class="fe mq mr ms mt b">action</code>、<code class="fe mq mr ms mt b">enctype</code>、<code class="fe mq mr ms mt b">method</code>。<code class="fe mq mr ms mt b">action</code>将是处理表单提交的URL。<code class="fe mq mr ms mt b">method</code>的值必须是<code class="fe mq mr ms mt b">post</code>，否则表单数据将被追加到URL中。而<code class="fe mq mr ms mt b">enctype</code>的值在我们需要上传文件的时候必须是<code class="fe mq mr ms mt b">multipart/form-data</code>。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj mw"><img src="../Images/48cee76daca3a5e86692d3e9b878455b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*QC-W1HkSiAQvusynmRnViw.png"/></div></div></figure><p id="dba4" class="pw-post-body-paragraph jl jm io jn b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki ih bi translated">使用HTML <code class="fe mq mr ms mt b">&lt;form&gt;</code>元素上传文件非常简单，甚至不使用JavaScript。缺点也很明显。提交表单后，页面会跳转到新的地址，刷新页面时Safari中也会有警告。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div class="gi gj mx"><img src="../Images/0db26a440a19559d805085e43d7a79ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1040/format:webp/1*2bBE24f2bc7jtzLxkzZUmg.png"/></div><figcaption class="my mz gk gi gj na nb bd b be z dk">refresh the page after submit</figcaption></figure><h1 id="facd" class="kv kw io bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">使用JavaScript提交表单数据</h1><p id="63fa" class="pw-post-body-paragraph jl jm io jn b jo lt jq jr js lu ju jv jw lv jy jz ka lw kc kd ke lx kg kh ki ih bi translated">我们可以使用ajax实现表单提交，以避免HTML <code class="fe mq mr ms mt b">&lt;form&gt;</code>元素引起的页面跳转。</p><p id="4d7d" class="pw-post-body-paragraph jl jm io jn b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki ih bi translated">在使用JavaScript时，我们首先需要通过监听输入的change事件来获取可以访问的上传文件，然后构造表单数据，最后使用<code class="fe mq mr ms mt b">fetch</code>提交数据。</p><figure class="kk kl km kn gu ko"><div class="bz fq l di"><div class="mu mv l"/></div></figure><p id="78b4" class="pw-post-body-paragraph jl jm io jn b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki ih bi translated">选择文件后，该文件将自动上传到服务器:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nc"><img src="../Images/bef670475736f796e7d8e7f71eb09750.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*9Zewnn9sly67kiOjeNaUFw.png"/></div></div></figure><p id="8d32" class="pw-post-body-paragraph jl jm io jn b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki ih bi translated">在我的项目中，我使用这种方法上传文件。但是如果需要自定义样式，就不能直接通过CSS来实现。</p><h1 id="df3d" class="kv kw io bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">showOpenFilePicker API</h1><p id="623f" class="pw-post-body-paragraph jl jm io jn b jo lt jq jr js lu ju jv jw lv jy jz ka lw kc kd ke lx kg kh ki ih bi translated">随着现代网络技术的发展，浏览器支持<a class="ae nd" href="https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API" rel="noopener ugc nofollow" target="_blank">文件系统访问API </a>，它允许读、写和文件管理功能。</p><p id="4032" class="pw-post-body-paragraph jl jm io jn b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki ih bi translated"><a class="ae nd" href="https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API" rel="noopener ugc nofollow" target="_blank">文件系统访问API </a>有一个方法<code class="fe mq mr ms mt b"><a class="ae nd" href="https://developer.mozilla.org/en-US/docs/Web/API/window/showOpenFilePicker" rel="noopener ugc nofollow" target="_blank">showOpenFilePicker</a></code>，它显示了一个文件选择器，允许选择一个或多个文件。我们甚至可以在Chrome Devtools中使用它:</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj ne"><img src="../Images/3d521b957d9c3d6b30a20edaa3d54994.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ZG2Kb92SZiJ9OzvF4xBz9g.png"/></div></div></figure><p id="61e5" class="pw-post-body-paragraph jl jm io jn b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki ih bi translated"><code class="fe mq mr ms mt b">showOpenFilePicker</code>将返回一个承诺，其实现处理程序接收一组<code class="fe mq mr ms mt b"><a class="ae nd" href="https://developer.mozilla.org/en-US/docs/Web/API/FileSystemFileHandle" rel="noopener ugc nofollow" target="_blank">FileSystemFileHandle</a></code>对象。</p><p id="4e00" class="pw-post-body-paragraph jl jm io jn b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki ih bi translated">这种方法非常方便，但目前只有Chrome和Edge支持。</p><figure class="kk kl km kn gu ko gi gj paragraph-image"><div role="button" tabindex="0" class="kp kq di kr bf ks"><div class="gi gj nf"><img src="../Images/bdb2111c8fe63e35a9b095eafa5abcc4.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*K3Li9a0Z39CJ49N3gxeQog.png"/></div></div><figcaption class="my mz gk gi gj na nb bd b be z dk">Browser compatibility of showOpenFilePicker</figcaption></figure><h1 id="4fe8" class="kv kw io bd kx ky kz la lb lc ld le lf lg lh li lj lk ll lm ln lo lp lq lr ls bi translated">结论</h1><p id="076a" class="pw-post-body-paragraph jl jm io jn b jo lt jq jr js lu ju jv jw lv jy jz ka lw kc kd ke lx kg kh ki ih bi translated">在这篇文章中，我们学习了3种从网页上传文件的方法。通过使用HTML <code class="fe mq mr ms mt b">&lt;form&gt;</code>元素，我们可以在没有JavaScript的情况下上传文件，通过使用JavaScript，我们可以定制上传文件的交互，最令人期待的是<code class="fe mq mr ms mt b">showOpenFilePicker</code>使上传文件变得更容易和更具可扩展性。</p><p id="05dc" class="pw-post-body-paragraph jl jm io jn b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki ih bi translated">希望这篇文章能帮助你，我期待你跟随我学习更多实用的技巧，成为一名更好的开发者。</p></div><div class="ab cl ng nh hs ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ih ii ij ik il"><p id="38e6" class="pw-post-body-paragraph jl jm io jn b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki ih bi translated"><em class="nn">更多内容请看</em><a class="ae nd" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="jn ip"><em class="nn">plain English . io</em></strong></a><em class="nn">。报名参加我们的</em> <a class="ae nd" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="jn ip"> <em class="nn">免费周报</em> </strong> </a> <em class="nn">。关注我们关于</em><a class="ae nd" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="jn ip"><em class="nn">Twitter</em></strong></a><strong class="jn ip"><em class="nn"/></strong><em class="nn">和</em><a class="ae nd" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="jn ip"><em class="nn">LinkedIn</em></strong></a><em class="nn">。查看我们的</em> <a class="ae nd" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="jn ip"> <em class="nn">社区不和谐</em> </strong> </a> <em class="nn">加入我们的</em> <a class="ae nd" href="https://inplainenglish.pallet.com/talent/welcome" rel="noopener ugc nofollow" target="_blank"> <strong class="jn ip"> <em class="nn">人才集体</em> </strong> </a> <em class="nn">。</em></p></div></div>    
</body>
</html>