<html>
<head>
<title>Vue-i18n Key Fallback — Handle Missing Keys and Keep Options with a Function Decorator</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">Vue-i18n键回退——用函数装饰器处理丢失的键并保留选项</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/vue-i18n-key-fallback-handle-missing-keys-and-keep-options-with-a-function-decorator-2a67970248ee?source=collection_archive---------5-----------------------#2022-04-15">https://javascript.plainenglish.io/vue-i18n-key-fallback-handle-missing-keys-and-keep-options-with-a-function-decorator-2a67970248ee?source=collection_archive---------5-----------------------#2022-04-15</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="1ebe" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">使用function decorator模式添加一些额外的回退、错误处理程序或其他辅助操作。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/4016068051b58bd5c1a1a36ff697b181.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*XRMna2MMnW-rpV-y"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@arptrastogi?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Arpit Rastogi</a> on <a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="9225" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">Vue中广泛使用的国际化库— <code class="fe lp lq lr ls b">vue-i18n</code>有一些局限性。在<a class="ae ks" href="https://evionica.com/" rel="noopener ugc nofollow" target="_blank">evonica</a>中，我们遇到了对未识别的翻译键进行回退的需求。</p><h1 id="81b3" class="lt lu in bd lv lw lx ly lz ma mb mc md jt me ju mf jw mg jx mh jz mi ka mj mk bi translated">平移插值</h1><p id="b3f9" class="pw-post-body-paragraph kt ku in kv b kw ml jo ky kz mm jr lb lc mn le lf lg mo li lj lk mp lm ln lo ig bi translated">该库需要一个包含关键字和翻译字符串的本地化文件。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mq mr l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Example of localization file structure</figcaption></figure><p id="b769" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">基本用法非常简单——您必须传递翻译键，然后在结果中获得翻译文本。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mq mr l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Basic <code class="fe lp lq lr ls b">vue-i18n</code> translation example</figcaption></figure><p id="d7c5" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">您可以插入翻译，在翻译文本中添加<code class="fe lp lq lr ls b">{variable}</code>,并传递选项对象，将<code class="fe lp lq lr ls b">{variable: 'someValue'}</code>作为翻译调用的第二个参数。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mq mr l"/></div></figure><h1 id="9dd7" class="lt lu in bd lv lw lx ly lz ma mb mc md jt me ju mf jw mg jx mh jz mi ka mj mk bi translated">缺少翻译</h1><p id="8244" class="pw-post-body-paragraph kt ku in kv b kw ml jo ky kz mm jr lb lc mn le lf lg mo li lj lk mp lm ln lo ig bi translated">当<code class="fe lp lq lr ls b">vue-i18n</code>翻译功能无法识别翻译密钥时，则返回密钥本身。这个库提供了一个地方来声明在初始化器中的<code class="fe lp lq lr ls b">missing</code>方法，这个方法在这种情况下被触发。<code class="fe lp lq lr ls b">missing</code>方法有一个类型<code class="fe lp lq lr ls b">MissingHandler</code>。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mq mr l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Vue-i18n missing handler type declaration</figcaption></figure><h2 id="1390" class="ms lu in bd lv mt mu dn lz mv mw dp md lc mx my mf lg mz na mh lk nb nc mj nd bi translated">基本回退</h2><p id="dcad" class="pw-post-body-paragraph kt ku in kv b kw ml jo ky kz mm jr lb lc mn le lf lg mo li lj lk mp lm ln lo ig bi translated">您可以创建一些后备翻译。您可以在初始化器中访问<code class="fe lp lq lr ls b">i18n</code>实例。在下面的情况中，当缺少翻译密钥时，返回回退密钥的翻译。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mq mr l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Missing handler with fallback for missing translations</figcaption></figure><h2 id="dab7" class="ms lu in bd lv mt mu dn lz mv mw dp md lc mx my mf lg mz na mh lk nb nc mj nd bi translated">缺少选项</h2><p id="5ff3" class="pw-post-body-paragraph kt ku in kv b kw ml jo ky kz mm jr lb lc mn le lf lg mo li lj lk mp lm ln lo ig bi translated">不幸的是，<code class="fe lp lq lr ls b">missing</code>函数不包含传递参数的信息。如果您想访问它们，您必须后退一步，在函数调用之前收集它们。</p><p id="858c" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">为此，您可以创建一个自定义函数装饰器。函数装饰器获取原始函数，执行一些辅助操作，然后执行原始函数。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mq mr l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Examples of basic function decorators with or without arguments</figcaption></figure><p id="01bf" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">正如你在第二个例子中看到的，有对参数的访问。翻译键总是所有<code class="fe lp lq lr ls b">i18n.global.t</code>重载中的第一个参数。</p><p id="ed5a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">你可以析构参数，得到你想要保留的<code class="fe lp lq lr ls b">key</code>和<code class="fe lp lq lr ls b">rest</code>。当转换函数返回键时，让我们调用回退键的转换，传递所有其他原始参数。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mq mr l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Missing translation decorator</figcaption></figure><p id="7c1e" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如果要添加类型脚本类型:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mq mr l"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Typed missing translation decorator</figcaption></figure><h1 id="cfdd" class="lt lu in bd lv lw lx ly lz ma mb mc md jt me ju mf jw mg jx mh jz mi ka mj mk bi translated">摘要</h1><p id="715a" class="pw-post-body-paragraph kt ku in kv b kw ml jo ky kz mm jr lb lc mn le lf lg mo li lj lk mp lm ln lo ig bi translated">使用function decorator模式，您可以对函数结果进行预处理或后处理，添加一些额外的回退、错误处理程序或其他辅助操作。我们使用它们来允许在配置文件中声明未知的键。我们不必担心丢失翻译输出，因为有一个后备方案。</p><p id="44ae" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated"><em class="ne">更多内容请看</em><a class="ae ks" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="ne">plain English . io</em></strong></a><em class="ne">。报名参加我们的</em> <a class="ae ks" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="ne">免费周报</em> </strong> </a> <em class="ne">。关注我们关于</em><a class="ae ks" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="ne">Twitter</em></strong></a><em class="ne">和</em><a class="ae ks" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="ne">LinkedIn</em></strong></a><em class="ne">。加入我们的</em> <a class="ae ks" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="ne">社区不和谐</em> </strong> </a> <em class="ne">。</em></p></div></div>    
</body>
</html>