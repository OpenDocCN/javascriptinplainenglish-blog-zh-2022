<html>
<head>
<title>Goodbye HTML. Hello Canvas!</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">再见HTML。你好画布！</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/goodbye-html-hello-canvas-d9e62e2e0cfe?source=collection_archive---------1-----------------------#2022-03-13">https://javascript.plainenglish.io/goodbye-html-hello-canvas-d9e62e2e0cfe?source=collection_archive---------1-----------------------#2022-03-13</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="2c9a" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">第2部分:在画布上打印字符</h2></div><p id="73f0" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">可以在这里阅读本系列<a class="ae ky" rel="noopener ugc nofollow" target="_blank" href="/goodbye-html-hello-canvas-part-1-92f750961666">的上一篇文章。</a></p><figure class="la lb lc ld gt le gh gi paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="gh gi kz"><img src="../Images/815aabd1dd272e7071225a7e08b59b27.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*46etXI6P9T6jK42M"/></div></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk">Photo by <a class="ae ky" href="https://unsplash.com/@mitchel3uo?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Mitchell Luo</a> on <a class="ae ky" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="2460" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">重要编辑:</h1><p id="22c0" class="pw-post-body-paragraph kc kd in ke b kf mh jo kh ki mi jr kk kl mj kn ko kp mk kr ks kt ml kv kw kx ig bi translated">读者<a class="ae ky" href="https://medium.com/@mikebender_deephaven" rel="noopener">迈克·本德</a>，写了这样的回复:</p><blockquote class="mm mn mo"><p id="bda2" class="kc kd mp ke b kf kg jo kh ki kj jr kk mq km kn ko mr kq kr ks ms ku kv kw kx ig bi translated">这篇文章的前提“画布函数fillText…质量差”是不正确的。您完全可以使用fillText在画布上绘制文本，并使用子像素着色获得清晰的文本。您所需要做的就是在创建上下文画布时设置选项{ alpha: false }，然后浏览器将优化呈现。</p></blockquote><p id="a819" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我做了初步试验，证明他是对的。但是将alpha设置为false会禁用半透明颜色的打印。如果您需要这两个特性，解决方案将涉及两个重叠的画布:一个标准画布，另一个仅用于fillText函数。无论如何，它<strong class="ke io">会比关于当前文章文本的提议</strong>更简单。</p><h1 id="fa83" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">澄清！</h1><p id="b132" class="pw-post-body-paragraph kc kd in ke b kf mh jo kh ki mi jr kk kl mj kn ko kp mk kr ks kt ml kv kw kx ig bi translated">本系列的第一篇文章有一些强有力的回复；基本上，有着同样的担忧。所以，我意识到我应该在继续之前为大家澄清一下:</p><ol class=""><li id="f7f1" class="mt mu in ke b kf kg ki kj kl mv kp mw kt mx kx my mz na nb bi translated">尽管这个文章系列的标题是，在<strong class="ke io"> <em class="mp">没办法</em> </strong> <em class="mp">我是在告诉人们离开HTML和CSS </em>。HTML和CSS是99.9%的情况下的必经之路(并不是说我喜欢它们)。</li><li id="d668" class="mt mu in ke b kf nc ki nd kl ne kp nf kt ng kx my mz na nb bi translated">当要呈现一个保持<strong class="ke io">相同布局</strong> <strong class="ke io">和各处观感</strong>的表格(表格数据)时，我知道我可以依靠图像。我的意思是在标准HTML和CSS中使用图像，只在必要的时候使用。也许我将需要不同版本的表格(图片)用于不同的屏幕和可访问性问题。</li><li id="f438" class="mt mu in ke b kf nc ki nd kl ne kp nf kt ng kx my mz na nb bi translated">和其他软件一样，浏览器也不是没有漏洞的。即使是Chrome在处理它不习惯的东西时也可能表现得很糟糕；比如翻译用JavaScript编写的HTML元素的复杂结构的页面。</li><li id="8bd6" class="mt mu in ke b kf nc ki nd kl ne kp nf kt ng kx my mz na nb bi translated">浏览器是为你自动调整的。但是你不能完全控制每个设备和浏览器的最终外观。你可以实现完全的控制，在任何地方保持精确的外观，但是有一个<strong class="ke io">代价要付出</strong>。在99.9%的情况下这是不值得的。</li><li id="e6f6" class="mt mu in ke b kf nc ki nd kl ne kp nf kt ng kx my mz na nb bi translated">我写这些文章是为了0.1%的案例。</li><li id="a463" class="mt mu in ke b kf nc ki nd kl ne kp nf kt ng kx my mz na nb bi translated">使用画布非常有效。</li><li id="5624" class="mt mu in ke b kf nc ki nd kl ne kp nf kt ng kx my mz na nb bi translated">JavaScript代码并不难，可以重用，而且“很短”——在压缩成(不太简单的)绘图工具之前只有412 kB。</li></ol><h2 id="da5b" class="nh lq in bd lr ni nj dn lv nk nl dp lz kl nm nn mb kp no np md kt nq nr mf ns bi translated">更多说明</h2><p id="cc71" class="pw-post-body-paragraph kc kd in ke b kf mh jo kh ki mi jr kk kl mj kn ko kp mk kr ks kt ml kv kw kx ig bi translated">我认为我创造了一个如此大胆的标题(我的错)，以至于有些人在开始回复之前几乎没有阅读整篇文章。</p><p id="26ef" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">总的来说，读者开始回答基于画布的应用程序<em class="mp">不能工作</em>；他们写了“<em class="mp">求求你，不要这样做</em>”、“<em class="mp">这是某种精心的讽刺</em>”、“<em class="mp">只要没见天日</em>”(我很喜欢这个；)…</p><p id="4bed" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我回答了他们，解释(再次)我的意思，并(再次)指向像素艺术绘图工具的链接(<a class="ae ky" href="https://www.bobsprite.com/" rel="noopener ugc nofollow" target="_blank">这是主页，不是app </a>)。然后他们开始表现出更准确的担忧。但是一些<em class="mp">把这个特定应用程序的当前版本的细节作为技术的固有缺陷</em>:</p><ol class=""><li id="68ad" class="mt mu in ke b kf kg ki kj kl mv kp mw kt mx kx my mz na nb bi translated">"<em class="mp">缩放画布(缩放整个应用程序)会使打印在画布上的文本有点模糊。</em>“—你缩放过Gimp、Inkscape、MS Paint或者PhotoShop吗？仅仅因为浏览器允许缩放整个应用程序并不意味着你应该这样做。</li><li id="0db1" class="mt mu in ke b kf nc ki nd kl ne kp nf kt ng kx my mz na nb bi translated">我有高分辨率的大屏幕。因此缩放应用程序将是一件好事。”—好的。在这种情况下，我们必须改进代码来很好地处理这种屏幕。这意味着有更多的工作要做？当然可以。我之前说过，这是要付出代价的(但结果是完美的)。</li><li id="4737" class="mt mu in ke b kf nc ki nd kl ne kp nf kt ng kx my mz na nb bi translated">"<em class="mp">此应用程序不适用于智能手机。</em>”—真相。但是这和是否基于画布没有关系。每个版本的绘图工具(无论是否基于浏览器)都可以在智能手机或电脑上运行，但不能同时在两者上运行。</li><li id="dbe2" class="mt mu in ke b kf nc ki nd kl ne kp nf kt ng kx my mz na nb bi translated">"<em class="mp">你忘了</em> <strong class="ke io"> <em class="mp">无障碍</em> </strong> <em class="mp">(通过不允许更大的字体)。</em>“—不一定！没有任何东西禁止你创建一个按钮，使应用程序适合有辅助功能问题的人。不仅仅是字体大小的问题，还有颜色、简化/特定版本等等。那就太好了！</li><li id="b3e8" class="mt mu in ke b kf nc ki nd kl ne kp nf kt ng kx my mz na nb bi translated">"<em class="mp">当我打开控制台时，它覆盖了应用程序的一部分。</em> " —它不应该与开放的控制台一起使用。</li></ol><p id="d628" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">你可以通过一个基于画布的应用程序获得完全的控制权。你可以让它适合不同的屏幕，适合有无障碍问题的人。这只是更多的工作。很多时候是不值得的。有几次真的很有必要。</p><p id="ce0e" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><strong class="ke io">重要编辑</strong>:我写这篇文章的时候，并没有意识到无障碍也包括盲人；这意味着与屏幕阅读器兼容。这个问题将在下一篇文章中讨论。非常感谢善良的读者，他们与我战斗，直到我明白。</p></div><div class="ab cl nt nu hr nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="ig ih ii ij ik"><h2 id="36e5" class="nh lq in bd lr ni nj dn lv nk nl dp lz kl nm nn mb kp no np md kt nq nr mf ns bi translated">TrueType字体</h2><p id="ebc5" class="pw-post-body-paragraph kc kd in ke b kf mh jo kh ki mi jr kk kl mj kn ko kp mk kr ks kt ml kv kw kx ig bi translated"><a class="ae ky" href="https://docs.microsoft.com/en-us/typography/truetype/" rel="noopener ugc nofollow" target="_blank">来自微软文档</a>:TrueType字体技术由两部分组成:字体本身的描述(TrueType字体文件)，以及读取字体描述并生成位图的程序(TrueType光栅化器)。</p><figure class="la lb lc ld gt le gh gi paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="gh gi oa"><img src="../Images/1b8d16d876ffee95ea321169bf936a3f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1228/format:webp/1*rRhCPR4K3zzGloO3ZobiIQ.png"/></div></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk">Letter C “inside” .ttf File — A Bezier Curve</figcaption></figure><p id="526c" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="mp"> ttf </em>字符被记录为数学公式(贝塞尔二次曲线)。因此，它们可以很容易地以高质量进行缩放，并转换为图像(位图——像素/字节的数组)。</p><p id="d34e" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">对我们来说重要的是，当浏览器显示带有文本的标签时，它只是在屏幕上打印字符(位图图像)。它的工作原理类似于画布函数<em class="mp"> drawImage </em>。</p></div><div class="ab cl nt nu hr nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="ig ih ii ij ik"><h2 id="33d1" class="nh lq in bd lr ni nj dn lv nk nl dp lz kl nm nn mb kp no np md kt nq nr mf ns bi translated">字体的画布策略</h2><p id="daa0" class="pw-post-body-paragraph kc kd in ke b kf mh jo kh ki mi jr kk kl mj kn ko kp mk kr ks kt ml kv kw kx ig bi translated">不幸的是，正如我们在第一篇文章中看到的，画布函数<em class="mp"> fillText，</em>虽然容易使用，但质量很差。这就是为什么我们将使用函数<em class="mp"> drawImage </em>作为我们自己的打印文本函数的基础。轻松点。</p><p id="b999" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">而不是直接用一个高度精密，非常令人佩服的<em class="mp">。ttf </em>文件，我们将创建<strong class="ke io">不起眼的</strong>但非常有效的字体表。</p><p id="54ea" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">为了打印出与HTML相同质量的文本，我们将需要一个<strong class="ke io">专用的字体表</strong> <strong class="ke io">，用于字体系列、字体大小、字体粗细、字体颜色、背景颜色和字体样式(斜体)的每种组合</strong>。</p><p id="4146" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">看起来我们需要几十个字体表，但是实际上，几个字体表就足够了。</p><p id="6a34" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">如果我们希望应用程序在更高分辨率的屏幕上看起来更好，或者我们正在解决<strong class="ke io">可访问性</strong>问题，我们需要创建具有更大字体大小的字体表。</p></div><div class="ab cl nt nu hr nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="ig ih ii ij ik"><h1 id="eab4" class="lp lq in bd lr ls ob lu lv lw oc ly lz jt od ju mb jw oe jx md jz of ka mf mg bi translated">创建字体表</h1><figure class="la lb lc ld gt le gh gi paragraph-image"><div role="button" tabindex="0" class="lf lg di lh bf li"><div class="gh gi og"><img src="../Images/697285df2df9f76203da481964cca9b8.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*Fmf5FjOFk4oN0pmDA12q8Q.png"/></div></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk">“Pangolin” Font Sheet</figcaption></figure><blockquote class="mm mn mo"><p id="241a" class="kc kd mp ke b kf kg jo kh ki kj jr kk mq km kn ko mr kq kr ks ms ku kv kw kx ig bi translated">那么，如何实现同样质量的HTML文本呢？HTML文本将是我们的来源！</p></blockquote><p id="5bf5" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">我们使用他的在线工具来创建字体表。我们可以选择:</p><ol class=""><li id="5c0e" class="mt mu in ke b kf kg ki kj kl mv kp mw kt mx kx my mz na nb bi translated">字体大小</li><li id="9912" class="mt mu in ke b kf nc ki nd kl ne kp nf kt ng kx my mz na nb bi translated">字体粗细</li><li id="8ec6" class="mt mu in ke b kf nc ki nd kl ne kp nf kt ng kx my mz na nb bi translated">行高</li><li id="9752" class="mt mu in ke b kf nc ki nd kl ne kp nf kt ng kx my mz na nb bi translated">斜体与否</li><li id="f42c" class="mt mu in ke b kf nc ki nd kl ne kp nf kt ng kx my mz na nb bi translated">字体颜色</li><li id="672a" class="mt mu in ke b kf nc ki nd kl ne kp nf kt ng kx my mz na nb bi translated">背景颜色</li></ol><p id="2e4a" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">对于字体家族，我们必须编辑工具(网页)的CSS代码。</p><p id="5232" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">然后我们截取一个截图，并使用一些图像编辑器，从截图中剪切出字体表，保存为一个<em class="mp"> png </em>文件。正如我之前说过的，这是一个不起眼的工作，这里的目的是用每个人都可以使用的方法来证明一个概念。</p><h1 id="8c04" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">测试字体表</h1><figure class="la lb lc ld gt le gh gi paragraph-image"><div class="gh gi oh"><img src="../Images/33e6f28f6ae29df84c19a40ac83600fc.png" data-original-src="https://miro.medium.com/v2/resize:fit:994/format:webp/1*MJSPbmsVEsqL7T8bKYpSyg.png"/></div><figcaption class="ll lm gj gh gi ln lo bd b be z dk">Testing The Font Sheet</figcaption></figure><p id="a992" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在我们使用另一个在线工具<a class="ae ky" href="https://storage.googleapis.com/jblate/medium/test-font-sheet.html" rel="noopener ugc nofollow" target="_blank">来测试字体表</a>。我们需要做的就是加载字体表(<em class="mp"> png </em> image)并开始在键盘上打字。</p><p id="b2ca" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">你不需要创建一个字体表来使用这个工具。把上一节的图片(穿山甲字体表)保存在电脑上就行了。</p><p id="abae" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">当您运行这个工具时，您会意识到在画布上高质量地打印文本是多么容易。</p><h2 id="5bb6" class="nh lq in bd lr ni nj dn lv nk nl dp lz kl nm nn mb kp no np md kt nq nr mf ns bi translated">它是如何工作的</h2><p id="96f7" class="pw-post-body-paragraph kc kd in ke b kf mh jo kh ki mi jr kk kl mj kn ko kp mk kr ks kt ml kv kw kx ig bi translated">基于先前建立的符号序列(“ABCDE……”)，该工具逐行扫描字体页(图像)的像素，搜索符号之间存在的空白列，以便识别该行中每个符号的开始和结束；为每个符号创建一个小画布，并将其放入字体字典中。简单快捷！</p><p id="1d62" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">字体(字典)完成后，我们可以非常容易地在画布上打印文本:</p><pre class="la lb lc ld gt oi oj ok ol aw om bi"><span id="b6b5" class="nh lq in oj b gy on oo l op oq">function writeTextOnCanvas(context, font, txt, left, top) {<br/>    //<br/>    for (const c of txt) {<br/>        if (c == " ") { left += font["."].width; continue }<br/>        //<br/>        const cnv = font[c]<br/>        context.drawImage(cnv, left, top)<br/>        left += cnv.width<br/>    }<br/>}</span></pre></div><div class="ab cl nt nu hr nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="ig ih ii ij ik"><h2 id="b24a" class="nh lq in bd lr ni nj dn lv nk nl dp lz kl nm nn mb kp no np md kt nq nr mf ns bi translated">只有几行清晰的代码</h2><p id="7dfe" class="pw-post-body-paragraph kc kd in ke b kf mh jo kh ki mi jr kk kl mj kn ko kp mk kr ks kt ml kv kw kx ig bi translated">阅读工具的代码(JavaScript ),我们意识到这是多么简单。扫描图像和创建字体字典的部分只有4个函数，占用了80个短而稀疏的行！</p></div><div class="ab cl nt nu hr nv" role="separator"><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny nz"/><span class="nw bw bk nx ny"/></div><div class="ig ih ii ij ik"><p id="cc73" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在<a class="ae ky" href="https://joanaborgeslate.medium.com/goodbye-html-hello-canvas-b44ae0ba85b8" rel="noopener">的下一篇文章</a>中将讨论整体战略和基本架构。</p><p id="c55a" class="pw-post-body-paragraph kc kd in ke b kf kg jo kh ki kj jr kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="mp">更多内容看</em> <a class="ae ky" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io"> <em class="mp">说白了就是</em> </strong> </a> <em class="mp">。报名参加我们的</em> <a class="ae ky" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io"> <em class="mp">免费周报</em> </strong> </a> <em class="mp">。关注我们关于</em><a class="ae ky" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="ke io"><em class="mp">Twitter</em></strong></a><em class="mp">和</em><a class="ae ky" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="ke io"><em class="mp">LinkedIn</em></strong></a><em class="mp">。加入我们的</em> <a class="ae ky" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="ke io"> <em class="mp">社区</em> </strong> </a> <em class="mp">。</em></p></div></div>    
</body>
</html>