<html>
<head>
<title>Build a REST API with Koa</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Koa构建REST API</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/koa-js-and-rest-api-cd0770fbe916?source=collection_archive---------2-----------------------#2022-05-13">https://javascript.plainenglish.io/koa-js-and-rest-api-cd0770fbe916?source=collection_archive---------2-----------------------#2022-05-13</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="54b3" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">关于如何使用Koa构建REST API的教程。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/0feaf08d797c1a575100f24dadfee477.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*hhxfMQlaZ50pkSQfXPQIbQ.png"/></div></div></figure><p id="767b" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">通过阅读本文，您可以获得一些关于Koa和REST API的知识。此外，您可以了解如何使用Koa构建REST API。</p><h1 id="51d3" class="lk ll in bd lm ln lo lp lq lr ls lt lu jt lv ju lw jw lx jx ly jz lz ka ma mb bi translated">Koa简介</h1><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi mc"><img src="../Images/4cd33a40e6b8fbd71688e5c9ef9e398c.png" data-original-src="https://miro.medium.com/v2/resize:fit:1000/format:webp/1*suXzT3k1lYrtR91XRDN7gA.png"/></div></figure><p id="b88f" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">Koa是一个开源的Node.js web应用框架。它由设计Express的同一个团队设计。它是为开发web应用程序和web APIs而设计的。该框架旨在为web应用程序和API提供一个更小、更具表现力和更可靠的基础。</p><h2 id="7b02" class="md ll in bd lm me mf dn lq mg mh dp lu kx mi mj lw lb mk ml ly lf mm mn ma mo bi translated">构建Koa应用程序</h2><p id="8f5b" class="pw-post-body-paragraph ko kp in kq b kr mp jo kt ku mq jr kw kx mr kz la lb ms ld le lf mt lh li lj ig bi translated">让我们用Koa构建一个小的web应用程序。要构建它，首先你必须在你的设备上安装Node.js。然后创建一个文件夹，其中将存储所有与项目相关的文件。</p><p id="7d90" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">那么我们应该将其初始化为Node.js项目。为此，请在终端上输入以下命令:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="f79f" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><code class="fe mw mx my mz b">npm init</code>用于设置<code class="fe mw mx my mz b"> package.json </code>文件。<code class="fe mw mx my mz b">-y</code>标志用于简单地生成一个空的<code class="fe mw mx my mz b">npm</code>项目，而无需通过问卷调查。然后你会得到一个类似于下面的<code class="fe mw mx my mz b">package.json</code>文件:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="5c9c" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">然后你应该添加<code class="fe mw mx my mz b">koa js</code>依赖项。为此，请在终端上输入以下命令:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="1844" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">之后，创建一个名为app.js的文件，并插入以下代码:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="bb7e" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">最后，在终端上输入以下命令并运行应用程序:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="7f89" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在转到浏览器窗口中的<code class="fe mw mx my mz b">http://localhost:3000</code>。您应该会在浏览器窗口中看到以下内容:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi na"><img src="../Images/28dfbd7922e6a73a4daaa182a49ddff9.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*TZEZbd7t5MQVsVl_L8fYNQ.png"/></div></div></figure><p id="3a1c" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">恭喜你！现在您已经构建了您的第一个Koa应用程序。</p></div><div class="ab cl nb nc hr nd" role="separator"><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng nh"/><span class="ne bw bk nf ng"/></div><div class="ig ih ii ij ik"><h1 id="291c" class="lk ll in bd lm ln ni lp lq lr nj lt lu jt nk ju lw jw nl jx ly jz nm ka ma mb bi translated">REST API简介</h1><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi nn"><img src="../Images/f09dc1596aedf161593f7397dfb86153.png" data-original-src="https://miro.medium.com/v2/resize:fit:746/format:webp/1*3gUGUk7yEHORgeXcOiexkg.png"/></div></figure><p id="0e1d" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">REST是一种架构风格，代表具象状态转移。它是由罗伊·菲尔丁在2000年首次提出的。REST是基于资源的，这意味着它是围绕事物或资源构建的。这些资源是由URIs确定的。多个URIs可以引用同一个资源。JSON或XML用于传递数据。它是轻量级的、可伸缩的和可维护的。</p><h2 id="6bf1" class="md ll in bd lm me mf dn lq mg mh dp lu kx mi mj lw lb mk ml ly lf mm mn ma mo bi translated">REST API方法</h2><p id="2385" class="pw-post-body-paragraph ko kp in kq b kr mp jo kt ku mq jr kw kx mr kz la lb ms ld le lf mt lh li lj ig bi translated">标准HTTP方法请求可用于创建、查看、编辑和删除资源，如下表所示:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi no"><img src="../Images/4a23938baa491331f87b1664720b30d1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*mV4Dt-grmk_R23uoOaJz_A.png"/></div></div></figure><h2 id="9c52" class="md ll in bd lm me mf dn lq mg mh dp lu kx mi mj lw lb mk ml ly lf mm mn ma mo bi translated">HTTP代码</h2><p id="3ac4" class="pw-post-body-paragraph ko kp in kq b kr mp jo kt ku mq jr kw kx mr kz la lb ms ld le lf mt lh li lj ig bi translated">服务器对浏览器请求的响应是一个HTTP状态代码。当您访问一个网站时，您的浏览器向服务器发出请求，服务器用一个称为HTTP状态码的三位数代码来响应。</p><ul class=""><li id="64b3" class="np nq in kq b kr ks ku kv kx nr lb ns lf nt lj nu nv nw nx bi translated">200 —好的</li><li id="ec6f" class="np nq in kq b kr ny ku nz kx oa lb ob lf oc lj nu nv nw nx bi translated">201 —已创建</li><li id="43b2" class="np nq in kq b kr ny ku nz kx oa lb ob lf oc lj nu nv nw nx bi translated">202-已接受</li><li id="1af2" class="np nq in kq b kr ny ku nz kx oa lb ob lf oc lj nu nv nw nx bi translated">204 —无内容</li><li id="dd99" class="np nq in kq b kr ny ku nz kx oa lb ob lf oc lj nu nv nw nx bi translated">301 —永久移动</li><li id="e936" class="np nq in kq b kr ny ku nz kx oa lb ob lf oc lj nu nv nw nx bi translated">302 —发现</li><li id="8cbf" class="np nq in kq b kr ny ku nz kx oa lb ob lf oc lj nu nv nw nx bi translated">304 —未修改</li><li id="8b88" class="np nq in kq b kr ny ku nz kx oa lb ob lf oc lj nu nv nw nx bi translated">400 —错误的请求</li><li id="3d2e" class="np nq in kq b kr ny ku nz kx oa lb ob lf oc lj nu nv nw nx bi translated">401-未经授权</li><li id="5ab1" class="np nq in kq b kr ny ku nz kx oa lb ob lf oc lj nu nv nw nx bi translated">403 —禁止</li><li id="2b71" class="np nq in kq b kr ny ku nz kx oa lb ob lf oc lj nu nv nw nx bi translated">404 —未找到</li><li id="f798" class="np nq in kq b kr ny ku nz kx oa lb ob lf oc lj nu nv nw nx bi translated">405-不允许的方法</li><li id="152c" class="np nq in kq b kr ny ku nz kx oa lb ob lf oc lj nu nv nw nx bi translated">409 —冲突</li><li id="106c" class="np nq in kq b kr ny ku nz kx oa lb ob lf oc lj nu nv nw nx bi translated">412-前提条件失败</li><li id="fb69" class="np nq in kq b kr ny ku nz kx oa lb ob lf oc lj nu nv nw nx bi translated">500 —内部服务器错误</li><li id="a773" class="np nq in kq b kr ny ku nz kx oa lb ob lf oc lj nu nv nw nx bi translated">502 —错误的网关</li><li id="267b" class="np nq in kq b kr ny ku nz kx oa lb ob lf oc lj nu nv nw nx bi translated">503-服务不可用</li></ul><h1 id="a0d5" class="lk ll in bd lm ln lo lp lq lr ls lt lu jt lv ju lw jw lx jx ly jz lz ka ma mb bi translated">用Koa构建REST API</h1><p id="30a1" class="pw-post-body-paragraph ko kp in kq b kr mp jo kt ku mq jr kw kx mr kz la lb ms ld le lf mt lh li lj ig bi translated">我希望现在你对Koa和REST API有了一个基本的了解。让我们开始用Koa构建一个REST API。首先，遵循上述第一个koa应用程序中的说明，直到您到达install Koa依赖项。</p><p id="28ae" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">然后在终端上输入以下命令。Nodemon是一个帮助开发Node.js应用程序的工具，当检测到目录中的文件更改时，它会自动重新启动这些应用程序。从安装nodemon开始，你不需要在修改的时候一次又一次的运行你的应用程序。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="df95" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">安装nodemon后，将以下内容添加到package.json文件的“脚本”部分:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="e44f" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">然后还安装以下依赖项:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="0409" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在创建一个名为app.js的文件，并将以下代码插入其中:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="083b" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">然后创建另一个名为items.js的文件，并插入以下代码:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mu mv l"/></div></figure><h2 id="e818" class="md ll in bd lm me mf dn lq mg mh dp lu kx mi mj lw lb mk ml ly lf mm mn ma mo bi translated">获取方法</h2><p id="c869" class="pw-post-body-paragraph ko kp in kq b kr mp jo kt ku mq jr kw kx mr kz la lb ms ld le lf mt lh li lj ig bi translated">下面是在Koa中处理一个<code class="fe mw mx my mz b">GET</code>请求的代码。将以下代码添加到<code class="fe mw mx my mz b">items.js</code>:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="92c9" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">要运行这个，您必须首先在<code class="fe mw mx my mz b">app.js</code>中插入routes文件并调用它们:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="0ef8" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在您已经创建了GET方法。在终端上输入以下命令运行应用程序:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="0bc2" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">访问网址<code class="fe mw mx my mz b"><a class="ae od" href="http://localhost:3000/books" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/items</a></code>。如果您可以在浏览器上看到以下内容，则您已经成功创建了GET方法:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi oe"><img src="../Images/12066c64b9466785e636895f65a7ef6d.png" data-original-src="https://miro.medium.com/v2/resize:fit:1122/format:webp/1*y-6rNIAbLccdNzhAtybHVw.png"/></div></figure><p id="d904" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在上面的例子中，我们创建了一个获取所有项目的路径。现在我们将创建一条通过<code class="fe mw mx my mz b">id</code>获取物品的路线。为此，请将以下代码插入items.js文件:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="f452" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在，我们可以获得特定项目的详细信息。在您的浏览器窗口中输入<code class="fe mw mx my mz b">http:localhost:3000/items/101</code>，您将得到以下结果:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi of"><img src="../Images/1cab3273f6b4ae2cf46304a4df632732.png" data-original-src="https://miro.medium.com/v2/resize:fit:952/format:webp/1*nvkx0qaxWpFss31CyrshMQ.png"/></div></figure><p id="7835" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">如果id不存在或不正确，您必须发送一条HTTP代码为404的错误消息:<code class="fe mw mx my mz b">http:localhost:3000/items/108</code></p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi og"><img src="../Images/d40c531a13d6d2ed53bffff0baca9ad7.png" data-original-src="https://miro.medium.com/v2/resize:fit:316/format:webp/1*IHmUWrPp5DTdi72NWlPjrg.png"/></div></figure><h2 id="3ec1" class="md ll in bd lm me mf dn lq mg mh dp lu kx mi mj lw lb mk ml ly lf mm mn ma mo bi translated">过帐方法</h2><p id="737e" class="pw-post-body-paragraph ko kp in kq b kr mp jo kt ku mq jr kw kx mr kz la lb ms ld le lf mt lh li lj ig bi translated">最后，我们将建立一个路由来处理POST方法。要构建POST路由，请将以下代码添加到<code class="fe mw mx my mz b">items.js</code>。</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="mu mv l"/></div></figure><p id="8839" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">要测试这个POST方法是否成功，可以使用Postman API平台。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oh"><img src="../Images/ba05d8d9d220a98bb445ead425e690b3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*xfhwqajecGj2wVVbaDph1w.png"/></div></div></figure><p id="85f1" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">然后访问网址<code class="fe mw mx my mz b"><a class="ae od" href="http://localhost:3000/books" rel="noopener ugc nofollow" target="_blank">http://localhost:3000/items</a></code>。您可以看到这些项目以及新添加的项目。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi oi"><img src="../Images/b3c5645d6a6f3033519a67d0da628b15.png" data-original-src="https://miro.medium.com/v2/resize:fit:1116/format:webp/1*uXVR4u5-3Gj7kFaHHGoxbw.png"/></div></figure><p id="9176" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在您已经用Koa创建了一个REST API。我希望你通过这篇文章获得了一些关于Koa和REST API的基础知识。</p><p id="eab0" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">本文的完整代码可以在下面的Github资源库中找到:</p><div class="oj ok gp gr ol om"><a href="https://github.com/ShonaliRomeshika/KoaJS-REST/tree/main" rel="noopener  ugc nofollow" target="_blank"><div class="on ab fo"><div class="oo ab op cl cj oq"><h2 class="bd io gy z fp or fr fs os fu fw im bi translated">GitHub-shonalimeshika/KOA js-REST</h2></div><div class="ot l"><div class="ou l ov ow ox ot oy km om"/></div></div></a></div><p id="2a2d" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><em class="oz">更多内容请看</em><a class="ae od" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kq io"><em class="oz">plain English . io</em></strong></a><em class="oz">。报名参加我们的</em> <a class="ae od" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io"> <em class="oz">免费周报</em> </strong> </a> <em class="oz">。关注我们关于</em><a class="ae od" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="kq io"><em class="oz">Twitter</em></strong></a><em class="oz">和</em><a class="ae od" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kq io"><em class="oz">LinkedIn</em></strong></a><em class="oz">。查看我们的</em> <a class="ae od" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io"> <em class="oz">社区不和谐</em> </strong> </a> <em class="oz">加入我们的</em> <a class="ae od" href="https://inplainenglish.pallet.com/talent/welcome" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io"> <em class="oz">人才集体</em> </strong> </a> <em class="oz">。</em></p></div></div>    
</body>
</html>