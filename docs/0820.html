<html>
<head>
<title>How to Protect Your App from Malicious Dependencies</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何保护你的应用免受恶意依赖</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-protect-your-app-from-malicious-dependencies-da640f8c8143?source=collection_archive---------20-----------------------#2022-02-15">https://javascript.plainenglish.io/how-to-protect-your-app-from-malicious-dependencies-da640f8c8143?source=collection_archive---------20-----------------------#2022-02-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><figure class="gl gn jo jp jq jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi jn"><img src="../Images/9e2c9f1a7f85acd0bef83327e35f7f3b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*j5fweS0etYczZY9J"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@markusspiske?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Markus Spiske</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="adb0" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">早在一月份，两个流行的开源库(faker.js和colors.js)的维护者发布了这两个库的新版本，删除了所有功能，并包含了一些记录消息的代码，这些消息将在导入模块时显示。</p><p id="4b34" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">本文并不关注这一事件的哲学层面，而是关注由此引发的安全问题。</p><div class="lb lc gp gr ld le"><a href="https://www.bleepingcomputer.com/news/security/dev-corrupts-npm-libs-colors-and-faker-breaking-thousands-of-apps/" rel="noopener  ugc nofollow" target="_blank"><div class="lf ab fo"><div class="lg ab lh cl cj li"><h2 class="bd ir gy z fp lj fr fs lk fu fw ip bi translated">开发腐败NPM图书馆的“颜色”和“骗子”打破数以千计的应用程序</h2><div class="ll l"><h3 class="bd b gy z fp lj fr fs lk fu fw dk translated">流行的开源库“colors”和“faker”的用户在看到他们的应用程序后感到震惊，使用…</h3></div><div class="lm l"><p class="bd b dl z fp lj fr fs lk fu fw dk translated">www.bleepingcomputer.com</p></div></div><div class="ln l"><div class="lo l lp lq lr ln ls jw le"/></div></div></a></div><p id="cd83" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">这以一种非常清晰有力的方式表明，依赖关系容易受到恶意更改的攻击。这总是正确的，但是当这样的事件发生时，它提出了许多关于当前工作流安全性的问题。这是一个相当温和的情况，这可能会更糟。想象一下，一个维护者，或者一个可以访问维护者账户的黑客决定发布一个新版本，用恶意软件替换这个库。如果您的项目工作流不安全，您可能会将恶意软件下载到您的开发甚至生产机器上。</p><h1 id="8882" class="lt lu iq bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated"><strong class="ak">我们当前的工作流程</strong></h1><figure class="ms mt mu mv gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mr"><img src="../Images/3930ecffc8af766740bafef672b8eaa1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gQWxIpAXNQKeiC1U"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@creativeaxe?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Axel Vazquez</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="0771" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">本文主要讨论NPM和JavaScript项目。但是可以从任何依赖程度高的栈的角度来研究这些概念。</p><p id="f276" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">我们的大多数项目使用NPM作为我们下载依赖项的包存储库。我们的依赖通常来自受信任和受欢迎的项目，但也可能来自任何人。这些依赖项可能有它们自己的依赖项，这些依赖项也可能有它们自己的依赖项，等等。</p><p id="c826" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">您是否检查了上次安装和新安装之间有什么变化？当审查对项目的依赖拉取请求时，是否验证库更新？大多数人不会。虽然这在大多数情况下没什么大不了的，但是如果依赖关系受到损害，您的开发甚至生产环境可能会很脆弱。</p><h1 id="09aa" class="lt lu iq bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated"><strong class="ak">缓解问题</strong></h1><figure class="ms mt mu mv gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi mw"><img src="../Images/005ad7868baa7ea514af67f244882a30.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*_EkYzuLO6thZrSZ4"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@brazofuerte?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Collin Armstrong</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="c5df" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">那么，我们如何减轻这种安全风险呢？考虑到这种情况并不常见，这并不一定是一个高风险的问题，但是它很容易执行。您所需要的只是访问一个流行依赖项的发布权限。如果您只是发布一个补丁更新，它不会被大多数配置停止，因为补丁更新被视为“不间断更改”，通常包含错误修复或性能改进。</p><p id="1d38" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">缓解这个问题的第一个方法是利用像<code class="fe mx my mz na b">package-lock.json</code>这样的东西。这个文件包含了你的依赖树和每个包的锁定版本。这与在生产环境中运行全新安装的<code class="fe mx my mz na b">npm ci</code>命令(带有锁定的依赖关系树)一起，有助于保持生产环境的一致性和安全性。</p><div class="lb lc gp gr ld le"><a href="https://docs.npmjs.com/cli/v7/configuring-npm/package-lock-json" rel="noopener  ugc nofollow" target="_blank"><div class="lf ab fo"><div class="lg ab lh cl cj li"><h2 class="bd ir gy z fp lj fr fs lk fu fw ip bi translated">package-lock.json | npm文档</h2><div class="ll l"><h3 class="bd b gy z fp lj fr fs lk fu fw dk translated">对于npm修改node_modules树或……的任何操作，都会自动生成package-lock.json</h3></div><div class="lm l"><p class="bd b dl z fp lj fr fs lk fu fw dk translated">docs.npmjs.com</p></div></div><div class="ln l"><div class="nb l lp lq lr ln ls jw le"/></div></div></a></div><p id="a004" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">除了在安装/更新依赖项时检查新版本之外，您对本地部署没有太多可做的。这不仅会揭示任何新的特性或突破性的变化，还会确保项目没有受到损害。如果你不需要更新任何包，你也可以运行一个<code class="fe mx my mz na b">npm ci</code>安装，但是如果你是维护者，这并不意味着你不能停止检查更新。请记住，修补程序更新可能包含漏洞修补程序，因此请确保经常审核您的依赖关系。</p><h1 id="d479" class="lt lu iq bd lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn mo mp mq bi translated"><strong class="ak">最坏的情况</strong></h1><figure class="ms mt mu mv gt jr gh gi paragraph-image"><div role="button" tabindex="0" class="js jt di ju bf jv"><div class="gh gi nc"><img src="../Images/06e3c12d2ff6e79933e7fa03601addfe.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*D0iX4AGUnQAJgVoT"/></div></div><figcaption class="jy jz gj gh gi ka kb bd b be z dk">Photo by <a class="ae kc" href="https://unsplash.com/@stilltane4ka?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Tanya Grypachevskaya</a> on <a class="ae kc" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="6ad1" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated">还有最后一件事可能会危及您对依赖项的使用，那就是对NPM的攻击。虽然这是极不可能的，如果NPM被入侵，你可能在技术上下载你认为是已知的好版本，但实际上收到的是恶意软件。这不太可能，而且是最糟糕的情况，但是最好了解攻击面是什么，以及哪里容易受到攻击。</p></div><div class="ab cl nd ne hu nf" role="separator"><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni nj"/><span class="ng bw bk nh ni"/></div><div class="ij ik il im in"><h1 id="8dfc" class="lt lu iq bd lv lw nk ly lz ma nl mc md me nm mg mh mi nn mk ml mm no mo mp mq bi translated"><strong class="ak">结论</strong></h1><p id="a36b" class="pw-post-body-paragraph kd ke iq kf b kg np ki kj kk nq km kn ko nr kq kr ks ns ku kv kw nt ky kz la ij bi translated">虽然这些事件非常罕见，而且最近的例子也很温和，但是对于所有使用某种集中依赖库的项目来说，这些都是真正的威胁。即使安装依赖项的时间稍微长一点，在下载之前或之后，但在运行之前检查一下软件包也是值得的。虽然我希望这些事件不再发生，但我们至少要做好准备，保持警惕。</p><p id="caea" class="pw-post-body-paragraph kd ke iq kf b kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la ij bi translated"><em class="nu">更多内容看</em> <a class="ae kc" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir"> <em class="nu">说白了。报名参加我们的</em> <a class="ae kc" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir"> <em class="nu">免费周报</em> </strong> </a> <em class="nu">。在我们的</em> <a class="ae kc" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kf ir"> <em class="nu">社区不和谐</em> </strong> </a> <em class="nu">获得独家获取写作机会和建议。</em></strong></a></p></div></div>    
</body>
</html>