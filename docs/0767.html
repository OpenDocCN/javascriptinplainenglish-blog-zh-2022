<html>
<head>
<title>Use zx.js instead of Shell</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用zx.js代替Shell</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/use-zx-js-instead-of-shell-c42ce7ce6b62?source=collection_archive---------0-----------------------#2022-02-13">https://javascript.plainenglish.io/use-zx-js-instead-of-shell-c42ce7ce6b62?source=collection_archive---------0-----------------------#2022-02-13</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><p id="d8af" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">让我们体验一下<a class="ae kl" href="https://github.com/google/zx" rel="noopener ugc nofollow" target="_blank"> zx.js </a>的快感吧。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi km"><img src="../Images/ea7f8f6347744c83d005567dce04f3ce.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*4fTP0l2fI_uuQoYw"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">Photo by <a class="ae kl" href="https://unsplash.com/@dancristianp?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Dan-Cristian Pădureț</a> on <a class="ae kl" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><blockquote class="lc ld le"><p id="b15e" class="jn jo lf jp b jq jr js jt ju jv jw jx lg jz ka kb lh kd ke kf li kh ki kj kk ij bi translated">在本文中，我们将了解zx.js是什么，他提供了哪些功能，以及我们如何使用它来编写脚本，然后<strong class="jp ir">我们将通过构建命令行工具<br/> <br/> </strong>来学习如何使用zx的特性。命令行工具的代码可在我的github中找到:<a class="ae kl" href="https://github.com/iseekTo/zx.js-Command-tool" rel="noopener ugc nofollow" target="_blank">https://github.com/iseekTo/zx.js-Command-tool</a></p></blockquote></div><div class="ab cl lj lk hu ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="ij ik il im in"><h1 id="42b4" class="lq lr iq bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">什么和为什么用zx.js？</h1><p id="52bf" class="pw-post-body-paragraph jn jo iq jp b jq mo js jt ju mp jw jx jy mq ka kb kc mr ke kf kg ms ki kj kk ij bi translated">Bash shell不错，但是在编写脚本时，人们往往会选择更方便的编程语言，JavaScript是一个完美的选择。但是标准的Node.js库在使用之前需要很多额外的操作，比如安装和引入库。<strong class="jp ir"> zx提供了一个包装器child_process </strong>，它转义参数并提供合并的默认值。</p><p id="4930" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先看一个官方的例子:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="mt mu l"/></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">Official example</figcaption></figure><p id="a95c" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">上面例子中的JavaScript语法可能看起来有点奇怪。它使用了一种叫做<a class="ae kl" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals" rel="noopener ugc nofollow" target="_blank">标记模板文字</a>的语言特性。<br/>但是很酷，对吧？所以让我们开始吧！</p></div><div class="ab cl lj lk hu ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="ij ik il im in"><h1 id="ab97" class="lq lr iq bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">安装</h1><pre class="kn ko kp kq gt mv mw mx my aw mz bi"><span id="9d71" class="na lr iq mw b gy nb nc l nd ne">// Global installation.<br/>// Also you can also install it separately in your project.<br/>npm i zx -g</span></pre><p id="b7c6" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">要求:<br/>确保您的节点版本&gt; = 16.00.0</p><h1 id="6a14" class="lq lr iq bd ls lt nf lv lw lx ng lz ma mb nh md me mf ni mh mi mj nj ml mm mn bi translated">zx.js原理</h1><p id="c2d4" class="pw-post-body-paragraph jn jo iq jp b jq mo js jt ju mp jw jx jy mq ka kb kc mr ke kf kg ms ki kj kk ij bi translated">它提供了一些函数来完成子进程的创建，以及对这些进程中的<code class="fe nk nl nm mw b">stdout</code>和<code class="fe nk nl nm mw b">stderr</code>的处理</p><h1 id="2916" class="lq lr iq bd ls lt nf lv lw lx ng lz ma mb nh md me mf ni mh mi mj nj ml mm mn bi translated">使用</h1><ul class=""><li id="1390" class="nn no iq jp b jq mo ju mp jy np kc nq kg nr kk ns nt nu nv bi translated">捷径是使用管道字符来快速测试脚本</li></ul><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="mt mu l"/></div></figure><ul class=""><li id="fbe6" class="nn no iq jp b jq jr ju jv jy nw kc nx kg ny kk ns nt nu nv bi translated">另一种方法是像我们经常做的那样在项目中开发脚本</li></ul><p id="5dde" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先初始化项目，</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="f301" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">主文件需要包含以下文件头:<br/> <code class="fe nk nl nm mw b">#!/usr/bin/env zx</code></p><p id="5f52" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">您需要首先添加执行权限，然后运行脚本:</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="b225" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">它现在可以显示一些内容，zx.js提供了很多黑魔法，它内置了<a class="ae kl" href="https://github.com/google/zx#fetch" rel="noopener ugc nofollow" target="_blank"> fetch </a>、<a class="ae kl" href="https://github.com/google/zx#question" rel="noopener ugc nofollow" target="_blank"> question </a>、<a class="ae kl" href="https://github.com/google/zx#sleep" rel="noopener ugc nofollow" target="_blank">异步操作</a> (cool)，理论上可以执行shell等脚本像tree等自己安装的命令，非常强大。</p><p id="e223" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">接下来让我们实现一个命令行工具，它是构建组件库的常用工具！</p></div><div class="ab cl lj lk hu ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="ij ik il im in"><h1 id="1a8a" class="lq lr iq bd ls lt lu lv lw lx ly lz ma mb mc md me mf mg mh mi mj mk ml mm mn bi translated">命令行工具</h1><p id="995b" class="pw-post-body-paragraph jn jo iq jp b jq mo js jt ju mp jw jx jy mq ka kb kc mr ke kf kg ms ki kj kk ij bi translated">这个项目会帮助我们生成常用的组件目录和文件，并且可以自动填充<code class="fe nk nl nm mw b">components.ts</code>，大大减少了新文件的重复操作。</p><p id="e8b7" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">首先根据上面的部分创建一个节点项目，然后如图所示创建相应的目录/文件。操作完成后，您的目录结构应该如下所示。不要忘记在组件目录中创建一个新的<code class="fe nk nl nm mw b">index.ts</code>文件(忽略协议文件和。vscode目录)</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div class="gh gi nz"><img src="../Images/70df49431c42bc4e4f4f7c33c105c0d8.png" data-original-src="https://miro.medium.com/v2/resize:fit:740/format:webp/1*WGr1XFRo3m7ufumxSCqE1A.png"/></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">Init projct</figcaption></figure><ol class=""><li id="43f8" class="nn no iq jp b jq jr ju jv jy nw kc nx kg ny kk oa nt nu nv bi translated">第一步，我们需要创建第一个模板文件，这是一个React组件，默认导出一个Props类型，最后生成目录和文件的内容。</li></ol><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="2431" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">2.导出模板文件</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="208b" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">3.我们需要一个主文件，导出所有组件(如按钮，选择，卡片)，这是一个很好的编程实践。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="e3a2" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">4.在<code class="fe nk nl nm mw b">index.mjs</code>文件中编写主要的逻辑代码，负责接收用户输入的命令行参数信息，检测目录是否存在，创建目录，最后更新每个文件。</p><figure class="kn ko kp kq gt kr"><div class="bz fp l di"><div class="mt mu l"/></div></figure><p id="8111" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">5.让我们开始创建您的组件，打开终端，例如我们要创建一个按钮组件。</p><figure class="kn ko kp kq gt kr gh gi paragraph-image"><div role="button" tabindex="0" class="ks kt di ku bf kv"><div class="gh gi ob"><img src="../Images/440392c26535b9db8be06aed40dc47c0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*-ykBmGuwXnyyck3CK6jzGQ.png"/></div></div><figcaption class="ky kz gj gh gi la lb bd b be z dk">Done</figcaption></figure><p id="4327" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated">It成功，我们创建了按钮组件，导出的相关代码自动填充到components/index.ts中，完美！</p></div><div class="ab cl lj lk hu ll" role="separator"><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo lp"/><span class="lm bw bk ln lo"/></div><div class="ij ik il im in"><p id="0649" class="pw-post-body-paragraph jn jo iq jp b jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf kg kh ki kj kk ij bi translated"><em class="lf">更多内容尽在</em> <a class="ae kl" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> <em class="lf">说白了. io </em> </strong> </a> <em class="lf">。报名参加我们的</em> <a class="ae kl" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> <em class="lf">免费周报</em> </strong> </a> <em class="lf">。在我们的</em> <a class="ae kl" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="jp ir"> <em class="lf">社区获得独家访问写作机会和建议</em> </strong> </a> <em class="lf">。</em></p></div></div>    
</body>
</html>