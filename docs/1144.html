<html>
<head>
<title>How to Scrape Glassdoor Data with Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何用Node.js抓取Glassdoor数据</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/scrape-glassdoor-data-with-nodejs-a16daa6fa3e9?source=collection_archive---------8-----------------------#2022-03-05">https://javascript.plainenglish.io/scrape-glassdoor-data-with-nodejs-a16daa6fa3e9?source=collection_archive---------8-----------------------#2022-03-05</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/33faecdde2fb6afccf94b3ba8fa29ee0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*mhYgpswJwNZ38oK9"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/@markusspiske?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Markus Spiske</a> on <a class="ae jz" href="https://unsplash.com/s/photos/database?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="7961" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">有多种方法可以从网页上抓取数据。本文解释了一种使用NodeJS脚本从Glassdoor获取加德满都市工资数据的更智能的方法。首先，让我们看看我们将使用的工具。</p><p id="aed2" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><a class="ae jz" href="https://github.com/jsdom/jsdom" rel="noopener ugc nofollow" target="_blank"> JSDOM </a></p><ul class=""><li id="db6d" class="ky kz in kc b kd ke kh ki kl la kp lb kt lc kx ld le lf lg bi translated">它是web标准的JavaScript实现，用于NodeJS。特别使用这个工具的原因是:同样的逻辑在浏览器的控制台和NodeJS上工作。没有必要学习额外的东西刮。就我个人而言，我尝试先从浏览器的控制台抓取数据，然后在scraper脚本中使用相同的代码。其他工具如<a class="ae jz" href="https://cheerio.js.org/" rel="noopener ugc nofollow" target="_blank"> cheer.io </a>也可以作为替代。</li></ul><p id="5d05" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><a class="ae jz" href="https://github.com/axios/axios" rel="noopener ugc nofollow" target="_blank"> Axios </a></p><ul class=""><li id="487b" class="ky kz in kc b kd ke kh ki kl la kp lb kt lc kx ld le lf lg bi translated">它是NodeJS的HTTP客户端；用于获取网页的源(HTML)。</li></ul><h1 id="dcf3" class="lh li in bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">聪明的方法</h1><p id="e875" class="pw-post-body-paragraph ka kb in kc b kd mf kf kg kh mg kj kk kl mh kn ko kp mi kr ks kt mj kv kw kx ig bi translated">在运行任何抓取任务之前，有必要分析页面的源代码；寻找让你的工作更容易的模式。抓取分页数据比抓取常规数据更麻烦。</p><p id="16b0" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">在我们的例子中，我将使用这个(<a class="ae jz" href="https://www.glassdoor.com/Salaries/kathmandu-salary-SRCH_IL.0,9_IM1598.htm" rel="noopener ugc nofollow" target="_blank">https://www . glass door . com/Salaries/Kathmandu-salary-SRCH _ il . 0，9_IM1598.htm </a> ) URL来收集加德满都市的工资数据。</p><h2 id="eae2" class="mk li in bd lj ml mm dn ln mn mo dp lr kl mp mq lv kp mr ms lz kt mt mu md mv bi translated">我们开始吧</h2><p id="940a" class="pw-post-body-paragraph ka kb in kc b kd mf kf kg kh mg kj kk kl mh kn ko kp mi kr ks kt mj kv kw kx ig bi translated">浏览网址，你得到的第一件事是一个愚蠢的“注册”对话框覆盖所有数据。快速旋转开发者工具，转到inspector，识别元素(<code class="fe mw mx my mz b">div#HardsellOverlay</code>)并将其移除。</p><figure class="nb nc nd ne gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi na"><img src="../Images/2ba4d700e08e092eda9cce6f6c2a7749.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*xA14sEWqfmfxa8Km"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Sign-up dialog covering data</figcaption></figure><p id="99a5" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">现在数据是可见的，寻找有助于识别工资数据列表的模式。幸运的是我们有一个。所有数据都有属性<code class="fe mw mx my mz b">data-test=”salaries-list-item-XXX”</code>。</p><figure class="nb nc nd ne gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nf"><img src="../Images/601d87b1940ac7a5177c3d7b92a0956e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*N5j7qCuW3zVLaP1D"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Pattern for salary data</figcaption></figure><p id="9a14" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">进一步探索，我们可以看到每个数据项都有一个相似的模式，我们可以从浏览器控制台使用查询选择器简单地抓取它。将给定的代码复制粘贴到浏览器的控制台中。稍后在构建脚本时，我们将使用相同的代码。</p><pre class="nb nc nd ne gt ng mz nh ni aw nj bi"><span id="b121" class="mk li in mz b gy nk nl l nm nn">// A page has 20 data<br/>for (let i = 0; i &lt;= 19; i++) {<br/>	// all salary data are prefixed with <br/>	let attrPrefix = `salaries-list-item-${i}`;</span><span id="1a16" class="mk li in mz b gy no nl l nm nn">	console.log("company name", document.querySelector(`[data-test='${attrPrefix}-employer-name'] a`).textContent);</span><span id="a22a" class="mk li in mz b gy no nl l nm nn">	console.log("company logo", document.querySelector(`[data-test='${attrPrefix}-employer-url'] img`).src);</span><span id="d4ee" class="mk li in mz b gy no nl l nm nn">	console.log("job title", document.querySelector(`[data-test='${attrPrefix}-job-title']`).textContent);</span><span id="a3d9" class="mk li in mz b gy no nl l nm nn">	console.log("salary", document.querySelector(`[data-test='${attrPrefix}-salary-info'] h3`).textContent);<br/>}</span></pre><p id="b015" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">好了，现在我们有了数据，我们知道如何从HTML中抓取数据。我们接下来需要的是更多的数据。</p><p id="b8a7" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">当我们滚动到底部，我们看到一个分页。接下来要做的事情是:分页，然后从每个页面抓取数据。您可能已经注意到，每页有20个数据项。</p><figure class="nb nc nd ne gt jo gh gi paragraph-image"><div class="gh gi np"><img src="../Images/9ad66fe6b56720063a6001ebc387a508.png" data-original-src="https://miro.medium.com/v2/resize:fit:1100/0*PADK6M7dOmafyeA1"/></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Pagination. Also, note the total no. of items.</figcaption></figure><p id="3fd1" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">等等！也许有另一种模式可以让我们的任务更容易。随着我们深入研究，分页也有了一种模式。</p><p id="9722" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">从第二页开始，URL的页码中混合了一些奇怪的值。此外，正如我们前面看到的，总共有1632个数据，每页20个。总共是1632/20 = 82页。</p><figure class="nb nc nd ne gt jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi nq"><img src="../Images/f427e99d1c5e2415086905dabc1d32fb.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*SX0YL1D5tNQQma-o"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">pattern in pagination</figcaption></figure><h1 id="593d" class="lh li in bd lj lk ll lm ln lo lp lq lr ls lt lu lv lw lx ly lz ma mb mc md me bi translated">NodeJS脚本</h1><p id="df94" class="pw-post-body-paragraph ka kb in kc b kd mf kf kg kh mg kj kk kl mh kn ko kp mi kr ks kt mj kv kw kx ig bi translated">既然我们已经找到了收集所有这些数据的方法，那么是时候编写一个NodeJS脚本来收集Glassdoor工资数据并将其保存到一个JSON文件中了。我们将在每页抓取完成后将数据写入文件<code class="fe mw mx my mz b">data.json</code>。原因:您可以在任何页面暂停和继续+您可以使用不同的页码范围并行运行脚本多次。</p><p id="54ae" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">为了简单起见，我将脚本直接粘贴在这里，并附上解释性注释。</p><figure class="nb nc nd ne gt jo"><div class="bz fp l di"><div class="nr ns l"/></div></figure><p id="a108" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">运行该脚本后，您将得到一个data.json文件，其中包含Glassdoor的加德满都市工资数据。类似地，你可以抓取任何其他城市的数据或工作列表上的数据。</p><blockquote class="nt nu nv"><p id="6eec" class="ka kb nw kc b kd ke kf kg kh ki kj kk nx km kn ko ny kq kr ks nz ku kv kw kx ig bi translated">重要信息:刮不一定是蛮力，总有聪明的方法来最小化工作量。</p></blockquote><p id="8484" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated">希望你喜欢这些内容。如果有任何问题，请随时指出。</p><p id="0a2d" class="pw-post-body-paragraph ka kb in kc b kd ke kf kg kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ig bi translated"><em class="nw">更多内容尽在</em> <a class="ae jz" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kc io"> <em class="nw">说白了. io </em> </strong> </a> <em class="nw">。报名参加我们的</em> <a class="ae jz" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kc io"> <em class="nw">免费周报</em> </strong> </a> <em class="nw">。关注我们关于</em> <a class="ae jz" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"> <strong class="kc io"> <em class="nw">推特</em> </strong> </a> <em class="nw">和</em><a class="ae jz" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kc io"><em class="nw">LinkedIn</em></strong></a><em class="nw">。加入我们的</em> <a class="ae jz" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kc io"> <em class="nw">社区不和谐</em> </strong> </a> <em class="nw">。</em></p></div></div>    
</body>
</html>