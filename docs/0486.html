<html>
<head>
<title>Not-Recommended Way to Communicate Between Distant Angular Components</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">不推荐在远距离角度组件之间进行通信的方式</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/not-recommended-way-to-communicate-between-distant-angular-components-40d0d08b6b6e?source=collection_archive---------20-----------------------#2022-01-27">https://javascript.plainenglish.io/not-recommended-way-to-communicate-between-distant-angular-components-40d0d08b6b6e?source=collection_archive---------20-----------------------#2022-01-27</a></blockquote><div><div class="fc if ig ih ii ij"/><div class="ik il im in io"><div class=""/><div class=""><h2 id="ace0" class="pw-subtitle-paragraph jo iq ir bd b jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke kf dk translated">在Angular应用程序中，当您需要时，实现一个快速而懒惰的解决方案来传递数据。</h2></div><figure class="kh ki kj kk gu kl gi gj paragraph-image"><div role="button" tabindex="0" class="km kn di ko bf kp"><div class="gi gj kg"><img src="../Images/07a6c11d965dda69bdf5a695339a70d7.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*qgOjIM8nkPyOEoT-"/></div></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">Photo by <a class="ae kw" href="https://unsplash.com/@picsbyjameslee?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">James Lee</a> on <a class="ae kw" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="1c69" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">官方Angular文档列出了<a class="ae kw" href="https://angular.io/guide/component-interaction" rel="noopener ugc nofollow" target="_blank">组件间通信的几种方式</a>。但是生活并不总是理想的。在一个晴朗的早晨，您仍然需要另一种交互方式，尤其是当组件松散地连接在一起，而您又懒得仅仅为了在它们之间交流而编写专用服务时。</p><p id="e93d" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">在这些情况下，您可以使用EventBus模式。当心，不推荐，所以“<em class="lt">蜡烛带毛</em>”:)</p><h1 id="7ac5" class="lu lv ir bd lw lx ly lz ma mb mc md me jx mf jy mg ka mh kb mi kd mj ke mk ml bi translated">EventBusService</h1><p id="4b24" class="pw-post-body-paragraph kx ky ir kz b la mm js lc ld mn jv lf lg mo li lj lk mp lm ln lo mq lq lr ls ik bi translated">创建一个名为<code class="fe mr ms mt mu b">EventBusService</code>的角度服务。该服务非常简单，有一个RxJS主题作为中介。</p><figure class="kh ki kj kk gu kl"><div class="bz fq l di"><div class="mv mw l"/></div><figcaption class="ks kt gk gi gj ku kv bd b be z dk">Event Bus Service</figcaption></figure><h1 id="9e53" class="lu lv ir bd lw lx ly lz ma mb mc md me jx mf jy mg ka mh kb mi kd mj ke mk ml bi translated">使用</h1><p id="eda5" class="pw-post-body-paragraph kx ky ir kz b la mm js lc ld mn jv lf lg mo li lj lk mp lm ln lo mq lq lr ls ik bi translated">从一个组件通过EventBusService引发事件:</p><pre class="kh ki kj kk gu mx mu my mz aw na bi"><span id="aacc" class="nb lv ir mu b gz nc nd l ne nf">export class FooterComponent {<br/>  constructor(private ebs: EventBusService){}</span><span id="d52c" class="nb lv ir mu b gz ng nd l ne nf">  onClickAcceptCookie(): void {<br/>    const event: CustomEvent = {<br/>      key: 'USER_COOKIE_CONSENT',<br/>      payload: {<br/>        userId: "123", <br/>        acceptedOn: "2022-01-25T13:30:30Z"<br/>      }<br/>    }</span><span id="463b" class="nb lv ir mu b gz ng nd l ne nf">    this.ebs.emit(event)<br/>  }<br/>}</span></pre><p id="6dde" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated">在另一个组件中，拦截事件并采取行动:</p><pre class="kh ki kj kk gu mx mu my mz aw na bi"><span id="826f" class="nb lv ir mu b gz nc nd l ne nf">public AdsComponent implements OnInit {<br/>  constructor(private ebs: EventBusService){}</span><span id="61f8" class="nb lv ir mu b gz ng nd l ne nf">ngOnInit(): void {<br/>  this.ebs<br/>      .on$('USER_COOKIE_CONSENT')<br/>      .subscribe((payload) =&gt; bombardWithAds(payload));<br/>  }<br/>}</span></pre><h1 id="2e13" class="lu lv ir bd lw lx ly lz ma mb mc md me jx mf jy mg ka mh kb mi kd mj ke mk ml bi translated">结论</h1><p id="6b0c" class="pw-post-body-paragraph kx ky ir kz b la mm js lc ld mn jv lf lg mo li lj lk mp lm ln lo mq lq lr ls ik bi translated">事件监听从您订阅的那一刻起就开始了。所以要时刻关注小溪流了多久。当不再需要监听事件时，使用<code class="fe mr ms mt mu b">take</code>、<code class="fe mr ms mt mu b">takeUntil</code>操作符到流或<code class="fe mr ms mt mu b">ngOnDestroy</code>钩子来终止订阅可能是个好主意。编码快乐！</p><p id="3be4" class="pw-post-body-paragraph kx ky ir kz b la lb js lc ld le jv lf lg lh li lj lk ll lm ln lo lp lq lr ls ik bi translated"><em class="lt">更多内容看</em> <a class="ae kw" href="http://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kz is"> <em class="lt">说白了。报名参加我们的</em> <a class="ae kw" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kz is"> <em class="lt">免费周报</em> </strong> </a> <em class="lt">。在我们的</em> <a class="ae kw" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kz is"> <em class="lt">社区不和谐</em> </strong> </a> <em class="lt">获得独家获取写作机会和建议。</em></strong></a></p></div></div>    
</body>
</html>