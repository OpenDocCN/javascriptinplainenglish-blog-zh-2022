<html>
<head>
<title>How to Test Your React Hooks Like a Pro</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何像专业人士一样测试你的反应钩</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/testing-your-hooks-like-a-pro-e1e0d7106670?source=collection_archive---------4-----------------------#2022-04-25">https://javascript.plainenglish.io/testing-your-hooks-like-a-pro-e1e0d7106670?source=collection_archive---------4-----------------------#2022-04-25</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="5042" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">一开始看起来可能很复杂，但是测试React钩子实际上非常简单！</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/f1cbb40bd4547948176c54a954b41f17.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*x1WceHi5cZmHjfNeP0dhYw.jpeg"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by Karolina Grabowska: <a class="ae kv" href="https://www.pexels.com/photo/orange-and-black-fish-bait-on-white-surface-6478090/" rel="noopener ugc nofollow" target="_blank">https://www.pexels.com/photo/orange-and-black-fish-bait-on-white-surface-6478090/</a></figcaption></figure><p id="db8d" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我已经用React每天工作了4年多了。我一直在浏览类组件，不得不习惯新的钩子系统。尽管他们的到来更多的是一种祝福而不是诅咒，但是对他们的测试是一条新的学习曲线。</p><p id="cdd0" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">谢天谢地，测试库团队发布了一个专门测试钩子的库，让我们的生活更简单！这就是我们今天要学习的内容！</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="e3fa" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">对于本文，我将假设您正在运行一个react环境(CRA或任何类似webpack的bundler)并设置(如果需要)Jest。</p><p id="0b8e" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">测试库团队正在将他们的库分成不同的包，以使测试更加模块化。因此，为了测试我们的钩子，我们必须安装<code class="fe ma mb mc md b">@testing-library/react-hooks</code>包:</p><div class="me mf gp gr mg mh"><a href="https://www.npmjs.com/package/@testing-library/react-hooks" rel="noopener  ugc nofollow" target="_blank"><div class="mi ab fo"><div class="mj ab mk cl cj ml"><h2 class="bd ir gy z fp mm fr fs mn fu fw ip bi translated">@测试库/反应钩</h2><div class="mo l"><h3 class="bd b gy z fp mm fr fs mn fu fw dk translated">简单完整的React hooks测试工具鼓励良好的测试实践..最新版本:8.0.0，最新…</h3></div><div class="mp l"><p class="bd b dl z fp mm fr fs mn fu fw dk translated">www.npmjs.com</p></div></div><div class="mq l"><div class="mr l ms mt mu mq mv kp mh"/></div></div></a></div></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><h1 id="80f6" class="mw mx iq bd my mz na nb nc nd ne nf ng jw nh jx ni jz nj ka nk kc nl kd nm nn bi translated">要测试的钩子</h1><p id="7753" class="pw-post-body-paragraph kw kx iq ky b kz no jr lb lc np ju le lf nq lh li lj nr ll lm ln ns lp lq lr ij bi translated">当我们学习如何测试一个钩子时，我们当然需要一个钩子来测试！</p><p id="120b" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">为了保持简单但足够详细，我们将创建一个简单的钩子来存储一个计数器，接受一个默认值，并允许增加或减少它:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi nt"><img src="../Images/a3b4d3d91ee52e3c05c45b77858038e1.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*_KOIzJcJn1jlS96xZXvyiQ.png"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Our useCounter hook</figcaption></figure><h1 id="3ac4" class="mw mx iq bd my mz nu nb nc nd nv nf ng jw nw jx ni jz nx ka nk kc ny kd nm nn bi translated">获取默认值</h1><p id="7c78" class="pw-post-body-paragraph kw kx iq ky b kz no jr lb lc np ju le lf nq lh li lj nr ll lm ln ns lp lq lr ij bi translated">正如您所看到，这个钩子用一个默认值初始化我们的计数器。那么我们的两个函数要么递增要么递减计数器。</p><p id="ca40" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将从确保默认值成功返回开始。</p><p id="f679" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">测试钩子时，<code class="fe ma mb mc md b">renderHook</code>将返回一个具有如下结构的对象:</p><pre class="kg kh ki kj gt nz md oa ob aw oc bi"><span id="2d7c" class="od mx iq md b gy oe of l og oh">{<br/>  all: Array&lt;any&gt;<br/>  current: any,<br/>  error: Error<br/>}</span></pre><p id="83a5" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">根据文档，<code class="fe ma mb mc md b">all</code>代表<strong class="ky ir">钩子</strong>返回的所有结果(包括错误)，<code class="fe ma mb mc md b">current</code>是<strong class="ky ir">当前状态</strong>，如果<strong class="ky ir">当前状态</strong>中有任何抛出的错误，则定义错误。</p><p id="2c16" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们的最终测试将如下所示:</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oi"><img src="../Images/8343d53adaa3306c344b0d09c92fca80.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*cYUGnWyfW_nRB5Llsw9EgA.png"/></div></div></figure><p id="8b00" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">在这个测试中，我们只是渲染我们的钩子，并从中获得初始结果。因为我们在调用它的时候给出了两个，所以我们希望它也是两个！</p><h1 id="7b0d" class="mw mx iq bd my mz nu nb nc nd nv nf ng jw nw jx ni jz nx ka nk kc ny kd nm nn bi translated">与挂钩互动</h1><p id="bad3" class="pw-post-body-paragraph kw kx iq ky b kz no jr lb lc np ju le lf nq lh li lj nr ll lm ln ns lp lq lr ij bi translated">既然我们可以测试我们的钩子正在返回它的默认值，我们需要确保交互函数也正常工作。</p><p id="c903" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">我们将测试<code class="fe ma mb mc md b">add</code>函数，并期望我们的新值为3。</p><p id="4159" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">当与钩子交互时，我们需要将任何改变状态的交互封装在测试库提供的一个名为<code class="fe ma mb mc md b">act</code> <br/>的函数中，这个函数是为了确保钩子的行为更接近react在浏览器中的工作方式。</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi oj"><img src="../Images/1cd23396b68edde431f3f14c3ae09ca3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*gXSidkovFkV4UkVHwKA5dA.png"/></div></div></figure><p id="d26c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">就这么简单！像第一个测试一样，我们使用默认值2来呈现钩子。但是这一次，我们调用了<code class="fe ma mb mc md b">act</code>中的<code class="fe ma mb mc md b">add</code>函数来触发状态的改变。那么我们期望我们的结果是3！</p></div><div class="ab cl ls lt hu lu" role="separator"><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx ly"/><span class="lv bw bk lw lx"/></div><div class="ij ik il im in"><p id="4c3c" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">测试一个钩子非常简单，可以很快给你的代码带来信心。此外，将大部分逻辑封装到钩子中可以让您专注于React组件中的UI测试，并在测试钩子时更加关注数据！</p><p id="a635" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">感谢您的阅读，如果您喜欢这篇文章，请留下关注或鼓掌，因为这将对我有很大帮助！</p><p id="94c2" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated">祝你有美好的一天！</p><p id="2182" class="pw-post-body-paragraph kw kx iq ky b kz la jr lb lc ld ju le lf lg lh li lj lk ll lm ln lo lp lq lr ij bi translated"><em class="lz">更多内容看</em><strong class="ky ir"><em class="lz"/></strong><a class="ae kv" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="lz">说白了. io </em> </strong> </a> <em class="lz">。报名参加我们的</em> <a class="ae kv" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="lz">免费周报</em> </strong> </a> <em class="lz">。关注我们关于</em><a class="ae kv" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="lz">Twitter</em></strong></a><em class="lz">和</em><a class="ae kv" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="ky ir"><em class="lz">LinkedIn</em></strong></a><em class="lz">。加入我们的</em> <a class="ae kv" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="ky ir"> <em class="lz">社区</em> </strong> </a> <em class="lz">。</em></p></div></div>    
</body>
</html>