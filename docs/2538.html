<html>
<head>
<title>4 Custom React Hooks Every Developer Should Know</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">每个开发人员都应该知道的4个自定义React挂钩</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/4-custom-react-hooks-every-developer-should-know-bf27af5b2dc?source=collection_archive---------1-----------------------#2022-06-15">https://javascript.plainenglish.io/4-custom-react-hooks-every-developer-should-know-bf27af5b2dc?source=collection_archive---------1-----------------------#2022-06-15</a></blockquote><div><div class="fc ie if ig ih ii"/><div class="ij ik il im in"><div class=""/><div class=""><h2 id="74a0" class="pw-subtitle-paragraph jn ip iq bd b jo jp jq jr js jt ju jv jw jx jy jz ka kb kc kd ke dk translated">4个自定义反应挂钩，提高您的效率</h2></div><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi kf"><img src="../Images/1e52ad28a2cdde14e166b327392c9ad2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*1xkvjkiOMCwv_I82"/></div></div><figcaption class="kr ks gj gh gi kt ku bd b be z dk">Photo by <a class="ae kv" href="https://unsplash.com/@lautaroandreani?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Lautaro Andreani</a> on <a class="ae kv" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h1 id="e5db" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">前言</h1><p id="66d3" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">朋友们，如果我早点学会这4个React钩子，也许我能写出更漂亮的代码。</p><p id="1e67" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">它们极大地提高了我的工作效率和代码的可伸缩性和可读性。你一定也想学吧？</p><h1 id="29cb" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">1.使用数量</h1><p id="d0b8" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">以前我经常写这种风格的代码，组件刚渲染的时候，需要发送一个请求或者做一些其他的逻辑，大概是这样的。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="9f21" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">这很简单，不是吗？但是它有一个很大的缺点:<em class="mr">语义不够清晰，即使我们传入一个空数组。</em></p><p id="9f94" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">所以我们可以定制一个名为<code class="fe ms mt mu mv b">useMount</code>的钩子，只在组件第一次呈现的时候执行回调函数。</p><p id="374d" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir">源代码</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="b2ef" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir">示例</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="4300" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">组件重新渲染时，<code class="fe ms mt mu mv b">useMount</code>不再执行，太好了！</p><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mw"><img src="../Images/ee095b6a30bfd1d9d959850bacef1a7e.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*bnwA_ZyNEtTGZpLt0c_Xyg.gif"/></div></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx mq l"/></div></figure><h1 id="c44d" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">2.使用卸载</h1><p id="854b" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">当组件被卸载时，我们想要触发一些逻辑，比如清除计时器，我们将编写如下代码:</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="a025" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">显然，我们不能直接看到它是在组件卸载时执行的。</p><p id="ef21" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">所以我们需要设计一个钩子，<code class="fe ms mt mu mv b">useUnmount</code>来指示当组件被卸载时回调函数被执行。</p><p id="ceab" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir">源代码</strong></p><p id="6960" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">真的这么简单吗？让我们看看如何使用它。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="2d9d" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir">例子</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx mq l"/></div></figure><p id="aa43" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">当“子”组件被销毁时，确实执行了“useUnmount”回调函数，但是我们发现<code class="fe ms mt mu mv b">count</code>的值是初始值0，而不是10，<strong class="lq ir">是什么原因导致这样错误的结果？</strong></p><p id="c8cc" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">是由<code class="fe ms mt mu mv b">useEffect</code>中的关闭机制造成的，因为第一次渲染卸载组件时传入的函数，为了得到实时状态，我们需要用<code class="fe ms mt mu mv b">useRef</code>来实现。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mw"><img src="../Images/f28566dda68f008a9e52f6895d60b2ad.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*S-by-qxpu8yNEY8EF7fPCw.gif"/></div></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx mq l"/></div></figure><p id="85c0" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">太好了，我们还可以在组件被破坏时正确获取<code class="fe ms mt mu mv b">count</code>的值。</p><h1 id="b820" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">3.useUpdateEffect</h1><p id="1d79" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">有时，我们希望只在依赖关系改变后才执行逻辑代码。这样写能达到目的吗？</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mw"><img src="../Images/aa53754593de167532521a8e55596f89.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*eB5VHSFHOS77OqJ9HccwnA.gif"/></div></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx mq l"/></div></figure><p id="39d5" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">不幸的是，一旦组件被安装，“计数”将打印出“0”。“计数”改变后如何执行回调函数？</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mw"><img src="../Images/f217eb63646cc128cbb0a7339b3a8285.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*TgD4btOM7CrJ6fu8IdLFRw.gif"/></div></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx mq l"/></div></figure><p id="8abf" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">太好了，这是一个超级实用的挂钩。</p><h1 id="8d36" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">4.使用设置状态</h1><p id="0bac" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated">当我们编写一个<code class="fe ms mt mu mv b">class</code>组件时，我们使用<code class="fe ms mt mu mv b">this.setState</code>来操作组件的数据，而<code class="fe ms mt mu mv b">setState</code>在操作对象类型数据时往往更方便。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="d3f8" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated">能否实现一个<code class="fe ms mt mu mv b">useSetState</code>钩子来简化<code class="fe ms mt mu mv b">setPerson</code>的操作？这很简单，只要围绕<code class="fe ms mt mu mv b">useState</code>做一个简单的包装就可以了。</p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><p id="002a" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><strong class="lq ir">例子</strong></p><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mp mq l"/></div></figure><figure class="kg kh ki kj gt kk gh gi paragraph-image"><div role="button" tabindex="0" class="kl km di kn bf ko"><div class="gh gi mw"><img src="../Images/5c5eb07e63575381f53561732a986f0b.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/1*ohXLRMzWWrp1WbKcqv0_lg.gif"/></div></div></figure><figure class="kg kh ki kj gt kk"><div class="bz fp l di"><div class="mx mq l"/></div></figure><h1 id="c893" class="kw kx iq bd ky kz la lb lc ld le lf lg jw lh jx li jz lj ka lk kc ll kd lm ln bi translated">最后</h1><p id="ca8f" class="pw-post-body-paragraph lo lp iq lq b lr ls jr lt lu lv ju lw lx ly lz ma mb mc md me mf mg mh mi mj ij bi translated"><strong class="lq ir">感谢阅读。</strong>我期待<strong class="lq ir"> </strong>期待您的关注和阅读更多高质量的文章。</p><div class="my mz gp gr na nb"><a rel="noopener  ugc nofollow" target="_blank" href="/interviewer-what-happened-to-npm-run-xxx-cdcb37dbaf44"><div class="nc ab fo"><div class="nd ab ne cl cj nf"><h2 class="bd ir gy z fp ng fr fs nh fu fw ip bi translated">采访者:“npm跑xxx”怎么了？</h2><div class="ni l"><h3 class="bd b gy z fp ng fr fs nh fu fw dk translated">一个大多数人都不知道的秘密。</h3></div><div class="nj l"><p class="bd b dl z fp ng fr fs nh fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="nk l"><div class="nl l nm nn no nk np kp nb"/></div></div></a></div><div class="my mz gp gr na nb"><a rel="noopener  ugc nofollow" target="_blank" href="/my-boss-you-dont-know-react-at-all-f493970f1807"><div class="nc ab fo"><div class="nd ab ne cl cj nf"><h2 class="bd ir gy z fp ng fr fs nh fu fw ip bi translated">我老板:你根本不知道反应！😠</h2><div class="ni l"><h3 class="bd b gy z fp ng fr fs nh fu fw dk translated">你必须知道的React的3种错误用法。</h3></div><div class="nj l"><p class="bd b dl z fp ng fr fs nh fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="nk l"><div class="nq l nm nn no nk np kp nb"/></div></div></a></div><div class="my mz gp gr na nb"><a rel="noopener  ugc nofollow" target="_blank" href="/8-cool-github-tricks-to-make-you-look-like-a-senior-developer-ab8fe9ae9b14"><div class="nc ab fo"><div class="nd ab ne cl cj nf"><h2 class="bd ir gy z fp ng fr fs nh fu fw ip bi translated">让你看起来像高级开发人员的8个很酷的GitHub技巧</h2><div class="ni l"><h3 class="bd b gy z fp ng fr fs nh fu fw dk translated">使用GitHub可以做的8件很酷的事情</h3></div><div class="nj l"><p class="bd b dl z fp ng fr fs nh fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="nk l"><div class="nr l nm nn no nk np kp nb"/></div></div></a></div><div class="my mz gp gr na nb"><a rel="noopener  ugc nofollow" target="_blank" href="/interviewer-can-x-x-return-true-in-javascript-7e1d1fa7b5cd"><div class="nc ab fo"><div class="nd ab ne cl cj nf"><h2 class="bd ir gy z fp ng fr fs nh fu fw ip bi translated">面试官:可以“x！== x "在JavaScript中返回True？</h2><div class="ni l"><h3 class="bd b gy z fp ng fr fs nh fu fw dk translated">你可能不知道的五个神奇的JavaScript知识点！</h3></div><div class="nj l"><p class="bd b dl z fp ng fr fs nh fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="nk l"><div class="ns l nm nn no nk np kp nb"/></div></div></a></div><div class="my mz gp gr na nb"><a rel="noopener  ugc nofollow" target="_blank" href="/what-does-123-tostring-length-123-print-out-in-javascript-2c804a414325"><div class="nc ab fo"><div class="nd ab ne cl cj nf"><h2 class="bd ir gy z fp ng fr fs nh fu fw ip bi translated">123['toString']。length + 123)用JavaScript打印出来？</h2><div class="ni l"><h3 class="bd b gy z fp ng fr fs nh fu fw dk translated">95%的前端开发者回答错误的问题。</h3></div><div class="nj l"><p class="bd b dl z fp ng fr fs nh fu fw dk translated">javascript.plainenglish.io</p></div></div><div class="nk l"><div class="nt l nm nn no nk np kp nb"/></div></div></a></div><p id="74b5" class="pw-post-body-paragraph lo lp iq lq b lr mk jr lt lu ml ju lw lx mm lz ma mb mn md me mf mo mh mi mj ij bi translated"><em class="mr">更多内容看</em> <a class="ae kv" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="lq ir"> <em class="mr">说白了。报名参加我们的</em> <a class="ae kv" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="lq ir"> <em class="mr">免费周报</em> </strong> </a> <em class="mr">。关注我们</em> <a class="ae kv" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"> <strong class="lq ir"> <em class="mr">推特</em> </strong> </a> <em class="mr">和</em><a class="ae kv" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="lq ir"><em class="mr">LinkedIn</em></strong></a><em class="mr">。查看我们的</em> <a class="ae kv" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="lq ir"> <em class="mr">社区不和谐</em> </strong> </a> <em class="mr">加入我们的</em> <a class="ae kv" href="https://inplainenglish.pallet.com/talent/welcome" rel="noopener ugc nofollow" target="_blank"> <strong class="lq ir"> <em class="mr">人才集体</em> </strong> </a> <em class="mr">。</em></strong></a></p></div></div>    
</body>
</html>