<html>
<head>
<title>How to copy files and folders in Node.js?</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何复制Node.js中的文件和文件夹？</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-copy-files-and-folders-in-node-js-e37394fdf4c0?source=collection_archive---------3-----------------------#2022-12-27">https://javascript.plainenglish.io/how-to-copy-files-and-folders-in-node-js-e37394fdf4c0?source=collection_archive---------3-----------------------#2022-12-27</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="a412" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">在Node.js中复制文件的多种方法</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/e4b2357091b082efb68403f90a3644f2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*7n_qZ-WwSo5EogMXnRc97g.jpeg"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://www.pexels.com/photo/focused-man-writing-in-account-book-at-table-7063776/" rel="noopener ugc nofollow" target="_blank">Dziana Hasanbekava</a></figcaption></figure><p id="66cb" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">在Node.js中，复制文件有多种方式。，让我们来看看可能的方法，并分析每一种方法。这是我第44篇中型文章。</p><h1 id="76d4" class="lp lq in bd lr ls lt lu lv lw lx ly lz jt ma ju mb jw mc jx md jz me ka mf mg bi translated">1 .拷贝文件</h1><p id="75da" class="pw-post-body-paragraph kt ku in kv b kw mh jo ky kz mi jr lb lc mj le lf lg mk li lj lk ml lm ln lo ig bi translated"><code class="fe mm mn mo mp b">copyFile()</code>函数可以将文件直接复制到目标目录，它执行最简单的操作。</p><pre class="kd ke kf kg gt mq mp mr ms aw mt bi"><span id="89b9" class="mu lq in mp b gy mv mw l mx my">fs.copyFile('./data.txt', './dest/info.txt');</span></pre><blockquote class="mz na nb"><p id="19f0" class="kt ku nc kv b kw kx jo ky kz la jr lb nd ld le lf ne lh li lj nf ll lm ln lo ig bi translated">上述方法将文件从src异步复制到dest。如果目的地已经存在，则默认情况下会被覆盖。除了任何可能的异常之外，没有任何参数传递给回调函数。Node.js不能确保复制操作是原子的。如果在打开目标文件进行写入后发生错误，Node.js将尝试删除目标文件。</p></blockquote><p id="895a" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">当我们使用上述方法时，有一个缺点。如果目标目录不存在，则会引发异常，因为目标目录必须存在(该方法不会自动创建目标目录)。因此，在使用上述方法之前，用户必须验证目标目录是否确实存在？如果目标目录不存在，用户可以使用<code class="fe mm mn mo mp b">fs.mkdir()</code>或<code class="fe mm mn mo mp b">fs.mkdirSync()</code>创建目标目录。<code class="fe mm mn mo mp b">copyFile()</code>方法不能复制目录。</p></div><div class="ab cl ng nh hr ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ig ih ii ij ik"><h1 id="f5bf" class="lp lq in bd lr ls nn lu lv lw no ly lz jt np ju mb jw nq jx md jz nr ka mf mg bi translated">2.readFile和writeFile</h1><p id="1473" class="pw-post-body-paragraph kt ku in kv b kw mh jo ky kz mi jr lb lc mj le lf lg mk li lj lk ml lm ln lo ig bi translated">这样，读取源文件的内容，然后写入目标文件。如果在复制过程中必须修改源文件的内容，这种方法是合适的</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="bae0" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">这种方法的缺点与上面的<code class="fe mm mn mo mp b">copyFile()</code>方法相同。<code class="fe mm mn mo mp b">readFile()</code>方法用于读取源文件的内容，而<code class="fe mm mn mo mp b">writeFile()</code>方法只能在现有目录中写入文件。通过使用这种方法，我们不能复制目录。使用这种方法的优点是可以在复制的同时修改内容。</p></div><div class="ab cl ng nh hr ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ig ih ii ij ik"><h1 id="dfe3" class="lp lq in bd lr ls nn lu lv lw no ly lz jt np ju mb jw nq jx md jz nr ka mf mg bi translated">3.createReadStream和createWriteStream</h1><p id="c15b" class="pw-post-body-paragraph kt ku in kv b kw mh jo ky kz mi jr lb lc mj le lf lg mk li lj lk ml lm ln lo ig bi translated"><code class="fe mm mn mo mp b">readFile()</code>方法和<code class="fe mm mn mo mp b">writeFile()</code>方法是整块运算数据。如果文件很大，上述方法会增加系统资源的压力。<code class="fe mm mn mo mp b">createReadStream()</code>和<code class="fe mm mn mo mp b">createWriteStream()</code>是用流的方式来操纵数据。</p><pre class="kd ke kf kg gt mq mp mr ms aw mt bi"><span id="329b" class="mu lq in mp b gy mv mw l mx my">fs.createReadStream('./data.txt').pipe(fs.createWriteStream(`./info.txt`));</span></pre></div><div class="ab cl ng nh hr ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ig ih ii ij ik"><h1 id="5691" class="lp lq in bd lr ls nn lu lv lw no ly lz jt np ju mb jw nq jx md jz nr ka mf mg bi translated">4.丙酸纤维素</h1><p id="06b4" class="pw-post-body-paragraph kt ku in kv b kw mh jo ky kz mi jr lb lc mj le lf lg mk li lj lk ml lm ln lo ig bi translated">Node.js的16.7.0版本增加了新的<code class="fe mm mn mo mp b"><a class="ae ks" href="https://nodejs.dev/en/api/v18/fs/#fscpsrc-dest-options-callback" rel="noopener ugc nofollow" target="_blank">fs.cp()</a></code>方法，通过使用该方法，可以将包括子目录和文件在内的整个目录结构从src异步复制到dest。方法可以复制一个文件或者一个目录。如果需要目录副本，需要将配置的<code class="fe mm mn mo mp b">recursive</code>属性设置为true。</p><h2 id="7c93" class="mu lq in bd lr nu nv dn lv nw nx dp lz lc ny nz mb lg oa ob md lk oc od mf oe bi translated">复制文件</h2><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ns nt l"/></div></figure><h2 id="3fed" class="mu lq in bd lr nu nv dn lv nw nx dp lz lc ny nz mb lg oa ob md lk oc od mf oe bi translated">复制目录，包括子目录和文件。</h2><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="f0a5" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如你所见，这个<code class="fe mm mn mo mp b">fs.cp()</code>方法比上面3个方法好很多。</p><ol class=""><li id="add1" class="of og in kv b kw kx kz la lc oh lg oi lk oj lo ok ol om on bi translated">不需要dest目录存在。如果目标目录不存在，将自动创建该目录(不考虑目录的级别)</li><li id="16ac" class="of og in kv b kw oo kz op lc oq lg or lk os lo ok ol om on bi translated">您可以完全复制整个文件夹(包括子目录)中的文件，而无需分别递归复制。</li></ol><blockquote class="mz na nb"><p id="0dcb" class="kt ku nc kv b kw kx jo ky kz la jr lb nd ld le lf ne lh li lj nf ll lm ln lo ig bi translated">当您打算首先使用这种方法时，首先需要确认Node.js版本！</p></blockquote><p id="4669" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如果你想复制文件夹中的每个文件，但是你只有一个较低版本的Node.js怎么办？除了用于Linux的本机cp命令之外，我们还可以递归地复制一些文件，这将在下一节中介绍:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ns nt l"/></div></figure><p id="999f" class="pw-post-body-paragraph kt ku in kv b kw kx jo ky kz la jr lb lc ld le lf lg lh li lj lk ll lm ln lo ig bi translated">如何使用:</p><pre class="kd ke kf kg gt mq mp mr ms aw mt bi"><span id="b3fc" class="mu lq in mp b gy mv mw l mx my">copyDir('./component', './page/home');</span></pre></div><div class="ab cl ng nh hr ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ig ih ii ij ik"><h1 id="b985" class="lp lq in bd lr ls nn lu lv lw no ly lz jt np ju mb jw nq jx md jz nr ka mf mg bi translated">5.Linux中的cp命令</h1><p id="d149" class="pw-post-body-paragraph kt ku in kv b kw mh jo ky kz mi jr lb lc mj le lf lg mk li lj lk ml lm ln lo ig bi translated">为了执行Linux本地命令，我们可以使用<code class="fe mm mn mo mp b">child_process</code>中的<code class="fe mm mn mo mp b">exec</code>或<code class="fe mm mn mo mp b">spawn</code>命令。要复制文件或目录，使用Linux 中的<a class="ae ks" href="https://www.rapidtables.com/code/linux/cp.html" rel="noopener ugc nofollow" target="_blank"> cp命令。</a></p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="ns nt l"/></div></figure></div><div class="ab cl ng nh hr ni" role="separator"><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl nm"/><span class="nj bw bk nk nl"/></div><div class="ig ih ii ij ik"><h1 id="67ad" class="lp lq in bd lr ls nn lu lv lw no ly lz jt np ju mb jw nq jx md jz nr ka mf mg bi translated">结论</h1><p id="ef83" class="pw-post-body-paragraph kt ku in kv b kw mh jo ky kz mi jr lb lc mj le lf lg mk li lj lk ml lm ln lo ig bi translated">如果您使用的是最新的节点版本，您可以使用以上5种方法。使用节点中的fs模块，我已经分享了复制文件/目录的最快方法。我们彻底研究了通过Node.js的fs模块访问的异步方法。</p><h2 id="2073" class="mu lq in bd lr nu nv dn lv nw nx dp lz lc ny nz mb lg oa ob md lk oc od mf oe bi translated">更多内容请访问<a class="ae ks" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> PlainEnglish.io </a>。</h2><p id="e8a0" class="pw-post-body-paragraph kt ku in kv b kw mh jo ky kz mi jr lb lc mj le lf lg mk li lj lk ml lm ln lo ig bi translated"><em class="nc">报名参加我们的</em> <a class="ae ks" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="nc">免费周报</em> </strong> </a> <em class="nc">。关注我们上</em> <a class="ae ks" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="nc">推特</em> </strong> </a>，<a class="ae ks" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"> <strong class="kv io"> <em class="nc">领英</em> </strong> </a> <strong class="kv io"> <em class="nc">，</em></strong><a class="ae ks" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="nc">YouTube</em></strong></a><strong class="kv io"><em class="nc">，以及</em></strong><em class="nc"/><a class="ae ks" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"><strong class="kv io"><em class="nc">不和</em> </strong> </a>T47】</p><h2 id="9278" class="mu lq in bd lr nu nv dn lv nw nx dp lz lc ny nz mb lg oa ob md lk oc od mf oe bi translated">想扩大你的软件创业规模吗？检查<a class="ae ks" href="https://circuit.ooo/?utm=publication-post-cta" rel="noopener ugc nofollow" target="_blank">电路</a>。</h2></div></div>    
</body>
</html>