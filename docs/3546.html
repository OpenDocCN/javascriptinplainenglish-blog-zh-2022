<html>
<head>
<title>How to Solve the replaceAll Error in Jest</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何解决Jest中的replaceAll错误</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/how-to-solve-the-replaceall-error-in-jest-815dc296c34b?source=collection_archive---------9-----------------------#2022-09-06">https://javascript.plainenglish.io/how-to-solve-the-replaceall-error-in-jest-815dc296c34b?source=collection_archive---------9-----------------------#2022-09-06</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><figure class="gl gn jl jm jn jo gh gi paragraph-image"><div role="button" tabindex="0" class="jp jq di jr bf js"><div class="gh gi jk"><img src="../Images/066d70ebac512035fcbbcd3857678f90.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*TnLAiqL8pKTzEoMD"/></div></div><figcaption class="jv jw gj gh gi jx jy bd b be z dk">Photo by <a class="ae jz" href="https://unsplash.com/@dav420?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">David Pupaza</a> on <a class="ae jz" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><blockquote class="ka kb kc"><p id="bb97" class="kd ke kf kg b kh ki kj kk kl km kn ko kp kq kr ks kt ku kv kw kx ky kz la lb ig bi translated">不要忘记保持所有项目配置的同步。</p></blockquote><p id="6218" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">有一次我在一个遗留的React项目上工作，我运行了一个最近添加的单元测试，我得到了这个错误:</p><p id="4d11" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated"><strong class="kg io">问题</strong></p><p id="8818" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated"><em class="kf"> Jest: TypeError: replaceAll不是函数</em></p><p id="94ff" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">一开始我很困惑，因为在浏览器中，该组件使用<a class="ae jz" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/replaceAll" rel="noopener ugc nofollow" target="_blank"> replaceAll </a>方法工作得非常好，但结果是<em class="kf"> replaceAll是一个新功能，并不是在所有浏览器或旧版本的Node.js中都实现了。</em></p><p id="a26f" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated"><strong class="kg io">解决方案</strong></p><p id="c5de" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">安装replaceAll polyfill并将其添加到jest设置配置文件中。</p><ol class=""><li id="c8d9" class="lf lg in kg b kh ki kl km lc lh ld li le lj lb lk ll lm ln bi translated">安装replaceAll</li></ol><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="746f" class="lx ly in lt b gy lz ma l mb mc">npm i string.prototype.replaceall</span></pre><p id="f240" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">2.修改您的Jest配置，添加一个<em class="kf"> setupFilesAfterEnv </em>属性，如下所示:</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="86db" class="lx ly in lt b gy lz ma l mb mc">{</span><span id="c716" class="lx ly in lt b gy md ma l mb mc">    "jest": {</span><span id="c428" class="lx ly in lt b gy md ma l mb mc">        "setupFilesAfterEnv": ["&lt;rootDir&gt;/jestSetup.js"]</span><span id="9bb0" class="lx ly in lt b gy md ma l mb mc">    }</span><span id="0f05" class="lx ly in lt b gy md ma l mb mc">}</span></pre><p id="4eca" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">3.将以下代码添加到您的<em class="kf"> jestSetup </em>文件中</p><pre class="lo lp lq lr gt ls lt lu lv aw lw bi"><span id="e6ed" class="lx ly in lt b gy lz ma l mb mc">import replaceAllInserter from 'string.prototype.replaceall';<br/></span><span id="e0ab" class="lx ly in lt b gy md ma l mb mc">replaceAllInserter.shim();</span></pre><p id="fca8" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">编码快乐！</p><p id="8779" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated"><a class="ae jz" href="https://stackoverflow.com/questions/65295584/jest-typeerror-replaceall-is-not-a-function/67877325#67877325" rel="noopener ugc nofollow" target="_blank">来源</a></p></div><div class="ab cl me mf hr mg" role="separator"><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj mk"/><span class="mh bw bk mi mj"/></div><div class="ig ih ii ij ik"><p id="93a4" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated">嗨，<a class="ae jz" href="https://davidjsmoreno.dev/" rel="noopener ugc nofollow" target="_blank">在这里</a>我们谈论软件开发、JavaScript、自学教育和其他东西。</p><p id="1eba" class="pw-post-body-paragraph kd ke in kg b kh ki kj kk kl km kn ko lc kq kr ks ld ku kv kw le ky kz la lb ig bi translated"><em class="kf">更多内容看</em> <a class="ae jz" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kg io"> <em class="kf">说白了。报名参加我们的</em> <a class="ae jz" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kg io"> <em class="kf">免费每周简讯</em> </strong> </a> <em class="kf">。关注我们关于</em> <a class="ae jz" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"> <strong class="kg io"> <em class="kf">推特</em> </strong> </a>，<a class="ae jz" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kg io"><em class="kf">LinkedIn</em></strong></a><em class="kf">，</em><a class="ae jz" href="https://www.youtube.com/channel/UCtipWUghju290NWcn8jhyAw" rel="noopener ugc nofollow" target="_blank"><strong class="kg io"><em class="kf">YouTube</em></strong></a><em class="kf">，</em> <a class="ae jz" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kg io"> <em class="kf">不和</em> </strong> </a> <em class="kf">。</em></strong></a></p></div></div>    
</body>
</html>