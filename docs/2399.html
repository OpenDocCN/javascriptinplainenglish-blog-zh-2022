<html>
<head>
<title>Schema Creation Design Pattern in JavaScript</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">JavaScript中的模式创建设计模式</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/schema-creation-design-pattern-in-javascript-a1493e0fb5b?source=collection_archive---------2-----------------------#2022-06-04">https://javascript.plainenglish.io/schema-creation-design-pattern-in-javascript-a1493e0fb5b?source=collection_archive---------2-----------------------#2022-06-04</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="6a20" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">使用模式创建设计模式，通过JavaScript中的抽象方法创建一个类实例</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/db5d3e813af5a71b11425b0fa85122ae.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*y6Z2Am7PELoIkBrr"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Photo by <a class="ae ks" href="https://unsplash.com/@wrongtog?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">WrongTog</a> on <a class="ae ks" href="https://unsplash.com?utm_source=medium&amp;utm_medium=referral" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><h2 id="5c22" class="kt ku in bd kv kw kx dn ky kz la dp lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">用例</h2><p id="20ea" class="pw-post-body-paragraph lp lq in lr b ls lt jo lu lv lw jr lx lc ly lz ma lg mb mc md lk me mf mg mh ig bi translated">当你谈论设计模式时，用例是一个重要的约束。这里的基本用例是sequel ize——一个非常流行的基于Node.js的ORM。另一个例子是任何需要为不同类型的属性更新和获取一组逻辑的应用程序。</p><p id="fa67" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">今天，我将谈论设计模式，并具体到Sequelize使用什么设计模式。</p><h2 id="8d3a" class="kt ku in bd kv kw kx dn ky kz la dp lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">为什么要序列化？</h2><p id="04f9" class="pw-post-body-paragraph lp lq in lr b ls lt jo lu lv lw jr lx lc ly lz ma lg mb mc md lk me mf mg mh ig bi translated">不，在阅读这篇文章的时候，没有必要在头脑中有一个顺序，但是它的概念和它如何实例化模型。我想谈谈它的结构是如何设计的</p><p id="13bd" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">此外，这也是我们在这里要做的一个很好的例子。</p><p id="834c" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">举个例子，</p><pre class="kd ke kf kg gt mn mo mp mq aw mr bi"><span id="0e65" class="kt ku in mo b gy ms mt l mu mv">Sequelize.model('name', {</span><span id="085f" class="kt ku in mo b gy mw mt l mu mv">  company: {</span><span id="2a1d" class="kt ku in mo b gy mw mt l mu mv">   type: string,</span><span id="6d08" class="kt ku in mo b gy mw mt l mu mv">   readOnly: false</span><span id="b21c" class="kt ku in mo b gy mw mt l mu mv">  },</span><span id="fed2" class="kt ku in mo b gy mw mt l mu mv">  user: {</span><span id="b491" class="kt ku in mo b gy mw mt l mu mv">   type: string,</span><span id="b702" class="kt ku in mo b gy mw mt l mu mv">   readOnly: true</span><span id="434f" class="kt ku in mo b gy mw mt l mu mv">  },</span><span id="457d" class="kt ku in mo b gy mw mt l mu mv">  email: {</span><span id="1b75" class="kt ku in mo b gy mw mt l mu mv">   type: string,</span><span id="31f0" class="kt ku in mo b gy mw mt l mu mv">   readOnly: true</span><span id="3122" class="kt ku in mo b gy mw mt l mu mv">  }</span><span id="4a10" class="kt ku in mo b gy mw mt l mu mv">})</span></pre><p id="dbf3" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">这是一个伪代码，而不是一个实际的Sequelize模型，所以不要对语法感到恼火，但我想展示的是基于字段，并包括一个将创建其属性和方法的模型</p><blockquote class="mx my mz"><p id="0789" class="lp lq na lr b ls mi jo lu lv mj jr lx nb mk lz ma nc ml mc md nd mm mf mg mh ig bi translated">在严格模式下使用时抛出只读错误，否则值不会在不抛出错误的情况下得到更新</p></blockquote><p id="d633" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">当暴露时，序列化项目将具有许多动态创建的属性</p><h2 id="b9df" class="kt ku in bd kv kw kx dn ky kz la dp lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">介绍</h2><p id="255b" class="pw-post-body-paragraph lp lq in lr b ls lt jo lu lv lw jr lx lc ly lz ma lg mb mc md lk me mf mg mh ig bi translated">现在，我们为这篇文章准备了基本的思想体系，所以让我们来讨论一下输出会是什么样子</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/78ce33c0484d95630f107122790b1e2d.png" data-original-src="https://miro.medium.com/v2/resize:fit:894/format:webp/1*vTR2idJ2Pc_wwfPtg05fiQ.png"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">output</figcaption></figure><p id="9252" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">完成本文后，我们将拥有一个包含一组新变量和方法的类来操作其中的数据，并公开一些输出，就像这里一样</p><h2 id="9b94" class="kt ku in bd kv kw kx dn ky kz la dp lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">抽象类</h2><p id="52cb" class="pw-post-body-paragraph lp lq in lr b ls lt jo lu lv lw jr lx lc ly lz ma lg mb mc md lk me mf mg mh ig bi translated">在继续之前，我们需要理解抽象类。你可能想知道“为什么我们这里需要这个？”但是我们需要这样做，因为我们不希望我们的核心逻辑暴露在外部世界，也不希望我们把整个逻辑放在一起</p><blockquote class="mx my mz"><p id="4b73" class="lp lq na lr b ls mi jo lu lv mj jr lx nb mk lz ma nc ml mc md nd mm mf mg mh ig bi translated">一个类可以模拟功能，但永远不能创建自己的实例，而是继承给子类，这就是所谓的抽象类</p></blockquote><h2 id="889f" class="kt ku in bd kv kw kx dn ky kz la dp lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">开始</h2><p id="0a47" class="pw-post-body-paragraph lp lq in lr b ls lt jo lu lv lw jr lx lc ly lz ma lg mb mc md lk me mf mg mh ig bi translated">让我们开始，首先，我们将创建一个基本的布局结构是必要的。我创建了一个抽象类，它检查实例是否有相同的构造函数，如果有，它会抛出一个错误，说“抽象类不能被实例化”</p><p id="44c5" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">剩下的代码继承了输出的父文件和样板文件。好消息是我们现在根本不会更新子类，它会告诉用户他/她想更新什么</p><p id="c4c3" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated"><strong class="lr io">错别字</strong>:LN:11上的语法应该是<code class="fe nf ng nh mo b">class Child extends Parent{</code></p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi ni"><img src="../Images/2e76967d774c55313480b33ba81283e3.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*jW8ocpLU-pzMSIbwTR8s0w.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">boilerplate</figcaption></figure><h2 id="2a50" class="kt ku in bd kv kw kx dn ky kz la dp lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">向抽象类添加属性</h2><p id="b972" class="pw-post-body-paragraph lp lq in lr b ls lt jo lu lv lw jr lx lc ly lz ma lg mb mc md lk me mf mg mh ig bi translated">下一步是根据我们获取的fields对象向类中动态添加属性。如果你仔细观察字段模式，你会发现我们只需要两个字段值，readOnly你可以编辑或添加更多的值。记住要修改这个方法，因为它在这里保存了模式的关键部分</p><p id="8f3a" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">在私有方法<code class="fe nf ng nh mo b">fromFields</code>的第一条语句中，我们寻找传递的Object字段的条目，并在<code class="fe nf ng nh mo b">this</code>上创建一个null属性。当使用JavaScript时，这一步是最关键和最必要的，因为它是一种基于原型的语言，不能添加只读和只写属性</p><p id="8e97" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">如果我们想在这里检查类型或其他验证，我们将单独访问<code class="fe nf ng nh mo b">Object.defineProperty</code>，否则我们可以使用<code class="fe nf ng nh mo b">Object.defineProperties</code>将它们全部添加到一起。这里还有一个我们称之为<code class="fe nf ng nh mo b">addMethods</code>的方法，将在后面的讨论中添加。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nj"><img src="../Images/e7c312b85790dc8db680ea2d3cb794d0.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*iIlc7QSeAGM-kIfFAKkqwA.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">add properties to the class</figcaption></figure><p id="7b71" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">现在，如果我们看到输出，它看起来会像这样:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi nk"><img src="../Images/ff22da61415adb4e1f3dd95cb1bc450f.png" data-original-src="https://miro.medium.com/v2/resize:fit:860/format:webp/1*lcoKLcYzu0wHghropkgL-A.png"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">output for adding properties</figcaption></figure><h2 id="f4cc" class="kt ku in bd kv kw kx dn ky kz la dp lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">向抽象类添加方法</h2><p id="1a97" class="pw-post-body-paragraph lp lq in lr b ls lt jo lu lv lw jr lx lc ly lz ma lg mb mc md lk me mf mg mh ig bi translated">在类中添加自定义方法之前，我们需要更好的内部方法，比如prototype。</p><ul class=""><li id="91cf" class="nl nm in lr b ls mi lv mj lc nn lg no lk np mh nq nr ns nt bi translated">检查属性是否存在—查看属性是否存在，并根据键返回值</li><li id="dc6b" class="nl nm in lr b ls nu lv nv lc nw lg nx lk ny mh nq nr ns nt bi translated">验证-查看输入值是否与之前提供的模式兼容</li><li id="16e8" class="nl nm in lr b ls nu lv nv lc nw lg nx lk ny mh nq nr ns nt bi translated">原型方法——我们希望所有的类都有一些通用的CRUD功能。也将回拨作为输入，但如果需要，更新为承诺</li></ul><p id="93e2" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">更新你喜欢的逻辑，为了这篇文章，我只添加了基本的东西。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nz"><img src="../Images/d2f5f783a9a66b7d6abfa9902de510c2.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*ucPyuxEWfE_N5i67CqyPLg.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">prototype methods</figcaption></figure><p id="09b5" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">现在让我们添加addMethods函数的实现，我们将为方法类创建新的属性，并恢复其布局。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi oa"><img src="../Images/268266a5407fc5bf0a5116584842ed7f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*tv9f4vJSGcHmKfQz2N62lg.png"/></div></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">Add custom methods</figcaption></figure><p id="8659" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">在这个方法中，我们首先使用标题case函数创建固定的CRUD键，然后为每个函数定义空属性，然后为它分配原型方法，但在内部传递键名并返回一个新方法。下面是我使用的<code class="fe nf ng nh mo b">toTitleCase</code>方法:</p><pre class="kd ke kf kg gt mn mo mp mq aw mr bi"><span id="7d84" class="kt ku in mo b gy ms mt l mu mv">function toTitleCase(str) {</span><span id="31d4" class="kt ku in mo b gy mw mt l mu mv">   return str.replace(</span><span id="e1a1" class="kt ku in mo b gy mw mt l mu mv">   /\w\S*/g,</span><span id="753b" class="kt ku in mo b gy mw mt l mu mv">    function (txt) { </span><span id="044d" class="kt ku in mo b gy mw mt l mu mv">      return txt.charAt(0).toUpperCase() +       txt.substr(1).toLowerCase();</span><span id="61b4" class="kt ku in mo b gy mw mt l mu mv">    }</span><span id="2352" class="kt ku in mo b gy mw mt l mu mv">  );</span><span id="9290" class="kt ku in mo b gy mw mt l mu mv">}</span></pre><h2 id="7de7" class="kt ku in bd kv kw kx dn ky kz la dp lb lc ld le lf lg lh li lj lk ll lm ln lo bi translated">结果</h2><p id="ce7b" class="pw-post-body-paragraph lp lq in lr b ls lt jo lu lv lw jr lx lc ly lz ma lg mb mc md lk me mf mg mh ig bi translated">让我们看看我们是否能实现输出。如果我们现在运行这个程序，并检查我们的实例具有的属性，它应该是这样的:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi ob"><img src="../Images/f2f9c9eadad33fc7f04f5ad9d52454ab.png" data-original-src="https://miro.medium.com/v2/resize:fit:1280/format:webp/1*dlk0_Uc_-F_565F-9-VysQ.png"/></div><figcaption class="ko kp gj gh gi kq kr bd b be z dk">output</figcaption></figure><p id="d648" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">这里，我们将所有方法都附加到它的这个实例上。您可以尝试这种创建实例的方法，并创建自己独特的处理属性的方式。</p><p id="d8b6" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">我希望你喜欢这篇文章。完整的源代码在这个<a class="ae ks" href="https://github.com/Piyush-Use-Personal/schema-pattern/blob/main/practice.js" rel="noopener ugc nofollow" target="_blank"> Github页面</a>上。</p><p id="f235" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated">谢了。</p><p id="72cb" class="pw-post-body-paragraph lp lq in lr b ls mi jo lu lv mj jr lx lc mk lz ma lg ml mc md lk mm mf mg mh ig bi translated"><em class="na">更多内容请看</em><a class="ae ks" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="lr io"><em class="na">plain English . io</em></strong></a><em class="na">。报名参加我们的</em> <a class="ae ks" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="lr io"> <em class="na">免费周报</em> </strong> </a> <em class="na">。关注我们关于</em><a class="ae ks" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="lr io"><em class="na">Twitter</em></strong></a><em class="na">和</em><a class="ae ks" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="lr io"><em class="na">LinkedIn</em></strong></a><em class="na">。查看我们的</em> <a class="ae ks" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="lr io"> <em class="na">社区不和谐</em> </strong> </a> <em class="na">加入我们的</em> <a class="ae ks" href="https://inplainenglish.pallet.com/talent/welcome" rel="noopener ugc nofollow" target="_blank"> <strong class="lr io"> <em class="na">人才集体</em> </strong> </a> <em class="na">。</em></p></div></div>    
</body>
</html>