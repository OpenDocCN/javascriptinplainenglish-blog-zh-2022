# å¯¹ React åº”ç”¨ç¨‹åºä½¿ç”¨ Viteï¼Œè€Œä¸æ˜¯ CRA

> åŸæ–‡ï¼š<https://javascript.plainenglish.io/use-vite-for-react-apps-instead-of-cra-7ad4885e0c73?source=collection_archive---------3----------------------->

## å°†æ‚¨çš„ CRA åº”ç”¨ç¨‹åºè¿ç§»åˆ° Viteï¼Œä»¥åŠ å¿«å¼€å‘å’Œç”Ÿäº§æ„å»ºã€‚

![](img/9b84baab47e2e58b591a549fe62bbf47.png)

Photo by [Chris Liverani](https://unsplash.com/@chrisliverani?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText) on [Unsplash](https://unsplash.com/s/photos/speed?utm_source=unsplash&utm_medium=referral&utm_content=creditCopyText)

æˆ‘ä»¬å¤§å¤šæ•°äººä¼šä½¿ç”¨ [Create React App](https://create-react-app.dev/) æ¥åˆ›å»º [React](https://reactjs.org/) Appã€‚å®ƒæ”¯æŒå¼€ç®±å³ç”¨çš„æ‰€æœ‰é…ç½®ã€‚ä½†æ˜¯ï¼Œå½“æ‚¨çš„é¡¹ç›®ä»£ç å¢é•¿æ—¶ï¼Œæ‚¨å¯èƒ½ä¼šé¢ä¸´æ›´é•¿çš„æ„å»ºæ—¶é—´ã€å¼€å‘æœåŠ¡å™¨ä¸­æ›´æ…¢çš„å¯åŠ¨ï¼Œä»¥åŠç­‰å¾… 2 åˆ° 5 ç§’æ¥åæ˜ æ‚¨åœ¨ä»£ç ä¸­æ‰€åšçš„æ›´æ”¹ï¼Œå½“åº”ç”¨ç¨‹åºè§„æ¨¡æ›´å¤§æ—¶ï¼Œè¿™å¯èƒ½ä¼šè¿…é€Ÿå¢åŠ ã€‚

è¿™å¢åŠ äº†:

1.  å¼€å‘æ—¶é—´ï¼Œå› ä¸ºæˆ‘ä»¬éœ€è¦ä¸ºæ¯ä¸ªå˜åŒ–ç­‰å¾… 2 åˆ° 6 ç§’ã€‚
2.  ç”Ÿäº§æ„å»ºæ—¶é—´ï¼Œéƒ¨ç½²å¿«é€Ÿä¿®å¤å¯èƒ½éœ€è¦ 10 åˆ° 20 åˆ†é’Ÿã€‚
3.  æ—¶é—´ï¼Œæ—¶é—´å°±æ˜¯é‡‘é’±ğŸ™‚ã€‚

# ä¸ºä»€ä¹ˆ CRA å¼€å‘æœåŠ¡å™¨å¾ˆæ…¢ï¼Ÿ

CRA ä½¿ç”¨ [Webpack](https://webpack.js.org/) æ¥æ†ç»‘ä»£ç ã€‚Webpack æ†ç»‘äº†æ•´ä¸ªä»£ç ï¼Œæ‰€ä»¥å¦‚æœæ‚¨çš„ä»£ç åº“éå¸¸å¤§(è¶…è¿‡ 10k è¡Œ),æ‚¨å¯èƒ½ä¼šçœ‹åˆ°å¼€å‘æœåŠ¡å™¨å¯åŠ¨è¾ƒæ…¢ï¼Œå¹¶ä¸”éœ€è¦å¾ˆé•¿æ—¶é—´æ‰èƒ½çœ‹åˆ°æ‰€åšçš„æ›´æ”¹ã€‚

![](img/6d03367bbbf79352a15b1373ec436550.png)

æ­£å¦‚æ‚¨åœ¨ä¸Šé¢çš„å›¾åƒä¸­æ‰€çœ‹åˆ°çš„ï¼Œæ•´ä¸ªä»£ç è¢«æ†ç»‘åœ¨ä¸€èµ·ï¼Œä»¥ä½¿æœåŠ¡å™¨ä¸ºå¼€å‘åšå¥½å‡†å¤‡ã€‚

# æ€ä¹ˆè®©å®ƒæ›´å¿«ï¼Ÿ

æˆ‘ä»¬å¯ä»¥è¿ç§»åˆ° [Vite](https://vitejs.dev/) ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ CRA æ¥åˆ›å»ºä¸€ä¸ª React åº”ç”¨ã€‚Vite æ˜¯ä¸‹ä¸€ä»£å‰ç«¯å·¥å…·ï¼Œå¯ä»¥æ›´å¿«åœ°æ„å»ºåº”ç”¨ç¨‹åºã€‚

## Vite çš„äº®ç‚¹

1.  é€šè¿‡æœ¬æœº ESM æŒ‰éœ€æä¾›æ–‡ä»¶æœåŠ¡ï¼Œæ— éœ€æ†ç»‘ï¼
2.  çƒ­æ¨¡å—æ›´æ¢(HMR ),æ— è®ºåº”ç”¨ç¨‹åºå¤§å°å¦‚ä½•éƒ½ä¿æŒå¿«é€Ÿã€‚
3.  å¯¹ TypeScriptã€JSXã€CSS ç­‰çš„ç°æˆæ”¯æŒã€‚
4.  æ”¯æŒå¤šé¡µå’Œåº“æ¨¡å¼çš„é¢„é…ç½®æ±‡æ€»æ„ä»¶ã€‚
5.  å¼€å‘äººå‘˜å’Œæ„å»ºäººå‘˜å…±äº«çš„ roll up-è¶…é›†æ’ä»¶æ¥å£ã€‚
6.  å…·æœ‰å®Œæ•´ç±»å‹è„šæœ¬ç±»å‹çš„çµæ´»ç¼–ç¨‹ APIã€‚
7.  æ”¯æ¶åä½œç”¨ï¼Œ [Vue.js](https://vite.new/vue) ï¼Œ[é¢„ä½œç”¨](https://vite.new/preact)ï¼Œå’Œ[ç»†é•¿](https://vite.new/svelte)ã€‚

# ç»´ç‰¹æ¯” CRA å¿«å¤šå°‘ï¼Ÿ

**Vite** ä½¿ç”¨çš„ [esbuild](https://esbuild.github.io/) æ˜¯ç”¨ Go ç¼–å†™çš„ï¼Œé¢„æ†ç»‘ä¾èµ–**æ¯”åŸºäº JavaScript çš„æ†ç»‘å™¨å¿« 10-100 å€**ã€‚

Vite é€šè¿‡å°†åº”ç”¨ç¨‹åºçš„æ¨¡å—åˆ†æˆä¸¤ç±»æ¥æ”¹è¿›å¼€å‘æœåŠ¡å™¨çš„å¯åŠ¨æ—¶é—´:**ä¾èµ–é¡¹**å’Œ**æºä»£ç **ã€‚

*   **ä¾èµ–å…³ç³»**å¤§å¤šæ˜¯æ™®é€šçš„ JavaScriptï¼Œåœ¨å¼€å‘è¿‡ç¨‹ä¸­ä¸ä¼šç»å¸¸æ”¹å˜ã€‚ä¸€äº›å¤§å‹ä¾èµ–é¡¹(ä¾‹å¦‚[å’Œ](https://ant.design/))çš„å¤„ç†æˆæœ¬ä¹Ÿå¾ˆé«˜ã€‚
*   **æºä»£ç **ç»å¸¸åŒ…å«éœ€è¦è½¬æ¢çš„éæ™®é€š JavaScript(å¦‚ JSXã€CSS æˆ– etc ç»„ä»¶)ï¼Œå¹¶ä¸”ä¼šè¢«é¢‘ç¹ç¼–è¾‘ã€‚æ­¤å¤–ï¼Œå¹¶éæ‰€æœ‰æºä»£ç éƒ½éœ€è¦åŒæ—¶åŠ è½½(ä¾‹å¦‚ï¼ŒåŸºäºè·¯ç”±çš„ä»£ç åˆ†å‰²)ã€‚

![](img/9fb2e255610da8e69ed563b2e659d963.png)

Vite Approach

å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå½“æµè§ˆå™¨è¯·æ±‚æ—¶ï¼ŒVite åªéœ€è¦æŒ‰éœ€è½¬æ¢å’Œæä¾›æºä»£ç ã€‚ä»£ç éšè—æ¡ä»¶åŠ¨æ€å¯¼å…¥åªæœ‰åœ¨å½“å‰å±å¹•ä¸Šå®é™…ä½¿ç”¨æ—¶æ‰ä¼šè¢«å¤„ç†ã€‚

æˆ‘å·²ç»å°†ç°æœ‰çš„ react åº”ç”¨ç¨‹åºè¿ç§»åˆ°äº† Viteã€‚æˆ‘ä»¬æ¥æ¯”è¾ƒä¸€ä¸‹åŒºåˆ«ã€‚

# CRA å¼€å‘æœåŠ¡å™¨å¯åŠ¨æŒç»­æ—¶é—´

![](img/7c16522c026f879bed2fbdd3f6bb5787.png)

**CRA** å¸¦ç€ **12s** å¯åŠ¨å¼€å‘æœåŠ¡å™¨ã€‚ç¤ºä¾‹åº”ç”¨ç¨‹åºåªåŒ…å« 2 æ¡è·¯çº¿å’Œ 6 ä¸ªç»„ä»¶ã€‚è®©æˆ‘ä»¬ç”¨ Vite çœ‹çœ‹åŒæ ·çš„æƒ…å†µã€‚

# Vite å¼€å‘æœåŠ¡å™¨å¯åŠ¨æŒç»­æ—¶é—´

![](img/0c982e0425f55242bf2ea4a9ac736bb6.png)

**Vite** åªç”¨äº†**298 æ¯«ç§’**å°±å¯åŠ¨äº†å¼€å‘æœåŠ¡å™¨ï¼Œä¸ CRA ç›¸æ¯”ï¼Œè¿™å·²ç»æ˜¯éå¸¸å¿«çš„é€Ÿåº¦äº†ã€‚æ‚¨å¯ä»¥çœ‹åˆ°è¿™ä¸¤ç§å·¥å…·ä¹‹é—´çš„å·¨å¤§å·®å¼‚ã€‚è®©æˆ‘ä»¬ä¹Ÿæ¯”è¾ƒä¸€ä¸‹ä¸¤è€…çš„ç”Ÿäº§æ„å»ºæ—¶é—´ã€‚

# CRA æ„å»ºæŒç»­æ—¶é—´

![](img/23527874d6980fdebcb88198762b2bcc.png)

CRA èŠ±äº†**16.66 ç§’**æ¥åˆ¶ä½œè¿™ä¸ªåº”ç”¨ç¨‹åºã€‚æ¥çœ‹çœ‹ Vite çš„è¡¨ç°å§ã€‚

# Vite æ„å»ºæŒç»­æ—¶é—´

Vite ä½¿ç”¨ä¸ [**Rollup**](https://rollupjs.org/guide/en/) ç›¸åŒçš„**æ†ç»‘åŒ…æ–¹æ³•**è¿›è¡Œç”Ÿäº§æ„å»ºï¼Œå› ä¸ºåœ¨ç”Ÿäº§ä¸­ä½¿ç”¨æœªæ†ç»‘çš„æœ¬æœº ESM ä¼šå¯¼è‡´é¢å¤–çš„ HTTP è¯·æ±‚ã€‚

![](img/6f9fdb955674c81a10ed481ddc978f77.png)

Vite with rollup åªç”¨äº†**9.11 ç§’**å°±å®Œæˆäº†æ•´ä¸ªåº”ç”¨ï¼Œä¼¼ä¹æ¯” CRA æ›´å¥½ã€‚å› ä¸ºå®ƒå‡å°‘äº†ä½¿ç”¨ Vite æ—¶ 40%åˆ° 50%çš„æ„å»ºæ—¶é—´ã€‚è¿™æ ·æ›´æœ‰æ•ˆã€‚ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨å½“å‰çš„æ„å»ºæ—¶é—´æ˜¯ 20 åˆ†é’Ÿï¼Œé‚£ä¹ˆå½“ä½¿ç”¨ Vite æ—¶ï¼Œå®ƒå°†å‡å°‘åˆ° 10 åˆ° 12 åˆ†é’ŸğŸš€ã€‚

> *ä¸æ»¡æ„å¯¹æ¯”æ£€æŸ¥æœ¬* [*æ¨æ–‡*](https://twitter.com/amasad/status/1355379680275128321) *ã€‚*

å¸Œæœ›æ‚¨æ­£åœ¨è€ƒè™‘å¦‚ä½•**å°†æ‚¨å½“å‰çš„ React CRA åº”ç”¨ç¨‹åºè¿ç§»åˆ° Vite** ï¼Ÿ

æ²¡ä»€ä¹ˆå¤§ä¸äº†çš„ï¼è®©æˆ‘ä»¬é‡æ–°å¼€å§‹ã€‚

# ä» CRA åˆ°ç»´ç‰¹çš„è¿ç§»

1.  ä» **package.json** ä¾èµ–å…³ç³»ä¸­ç§»é™¤ **react-scripts** ã€‚
2.  å¦‚æœä½ ä½¿ç”¨ CSS æˆ– SCSSï¼Œåœ¨ **package.json** ä¸­æ·»åŠ  **sass** ã€‚
3.  å°†ä»¥ä¸‹ä¾èµ–é¡¹æ·»åŠ ä¸ºå¼€å‘ä¾èµ–é¡¹:

```
"devDependencies": {
  "@vitejs/plugin-react": "1.1.1",
  "vite": "2.7.0"
},
```

4.å°†ä»¥ä¸‹å‘½ä»¤æ·»åŠ åˆ°è„šæœ¬ä¸­:

```
"scripts": {
  "start": "vite",
  "build": "vite build"
},
```

5.åœ¨æ ¹æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ **vite.config.js** ï¼Œæ·»åŠ ä¸‹é¢çš„ä»£ç :

**react()** ç”¨äºé¿å…åœ¨`.jsx`å’Œ`.tsx`æ¨¡å—ä¸­æ‰‹å·¥å¯¼å…¥`React`ã€‚

6.å°†`index.html`æ–‡ä»¶ç§»åˆ°`public`æ–‡ä»¶å¤¹å¤–ã€‚

7.ä»`index.html`ä¸Šæ‹†ä¸‹æ‰€æœ‰çš„`%PUBLIC_URL%`:

```
//From
<link *rel*="icon" *href*="%PUBLIC_URL%/favicon.ico" />//To
<link *rel*="icon" *href*="/favicon.ico" />
```

8.åœ¨**index.html**çš„ä¸»ä½“ä¸­æ·»åŠ ä»¥ä¸‹è„šæœ¬æ ‡ç­¾:

```
<div *id*="root"></div>
<script *type*="module" *src*="/src/index.jsx"></script> // Need to add
```

9.å°†æ‚¨çš„ env ä» **REACT_APP** æ›´æ–°ä¸º **VITE** ï¼Œå¦‚ä¸‹æ‰€ç¤º:

```
// From
REACT_APP_ENV = local
REACT_APP_HOST_UR = [https://reqres.in/api/](https://reqres.in/api/)// To
*VITE_ENV* = local
*VITE_HOST_URL* = [https://reqres.in/api/](https://reqres.in/api/)
```

10.ç°åœ¨åªéœ€è¿è¡Œ`**npm install**`æˆ–`**yarn**`æˆ–**ã€‚**

11.ç°åœ¨è¿è¡Œ`yarn start`æˆ–`npm start`ã€‚æå®šäº†ã€‚ç°åœ¨ï¼Œæˆ‘ä»¬çš„ CRA åº”ç”¨ç¨‹åºè¿ç§»åˆ°äº† Viteã€‚

## æ³¨æ„äº‹é¡¹:

å¦‚æœæ‚¨åœ¨å¯¼å…¥ç»„ä»¶æ—¶é‡åˆ°ä»»ä½•é—®é¢˜ï¼Œè¯·ä½¿ç”¨[è§£å†³åˆ«å](https://vitejs.dev/config/#resolve-alias)ã€‚

# ä½¿ç”¨ Vite çš„æ–° React åº”ç”¨ç¨‹åº

ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤åˆ›å»ºä¸€ä¸ªæ–°çš„ React åº”ç”¨ç¨‹åº:

```
**yarn create vite my-react-app --template react**
```

# å‚è€ƒ

1.  [ç»´ç‰¹](https://vitejs.dev/)
2.  [esbuild](https://esbuild.github.io/)
3.  [æ±‡æ€»](https://rollupjs.org/guide/en/)
4.  [Vite é¢„ç½®æ¨¡æ¿](https://github.com/vitejs/vite/tree/main/packages/create-vite)

# ç»“è®º

ä¸ CRA ç›¸æ¯”ï¼ŒVite ä¼¼ä¹å¾ˆæœ‰æ•ˆç‡ï¼Œé€Ÿåº¦æ›´å¿«ï¼ŒèŠ‚çœæ›´å¤šçš„æ—¶é—´ã€‚è¯•è¯• **Vite** ï¼Œå°±èƒ½çœ‹å‡ºåŒºåˆ«ã€‚

æ„Ÿè°¢æ‚¨çš„é˜…è¯»ã€‚

*æ›´å¤šå†…å®¹è¯·çœ‹*[***plain English . io***](https://plainenglish.io/)*ã€‚æŠ¥åå‚åŠ æˆ‘ä»¬çš„* [***å…è´¹å‘¨æŠ¥***](http://newsletter.plainenglish.io/) *ã€‚å…³æ³¨æˆ‘ä»¬å…³äº*[***Twitter***](https://twitter.com/inPlainEngHQ)*å’Œ*[***LinkedIn***](https://www.linkedin.com/company/inplainenglish/)*ã€‚æŸ¥çœ‹æˆ‘ä»¬çš„* [***ç¤¾åŒºä¸å’Œè°***](https://discord.gg/GtDtUAvyhW) *åŠ å…¥æˆ‘ä»¬çš„* [***äººæ‰é›†ä½“***](https://inplainenglish.pallet.com/talent/welcome) *ã€‚*