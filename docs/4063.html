<html>
<head>
<title>How to Convert JSON to XML in Node.js</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何在Node.js中将JSON转换成XML</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/node-js-convert-json-to-xml-137e41b2acbb?source=collection_archive---------8-----------------------#2022-10-21">https://javascript.plainenglish.io/node-js-convert-json-to-xml-137e41b2acbb?source=collection_archive---------8-----------------------#2022-10-21</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="5dd3" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">了解如何在Node.js中将JSON轻松转换为XML。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/70d0a7b5b513265bd8beee46cb131474.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*6HTtvgFQr13GqVfarsoCQg.png"/></div></div></figure><p id="e728" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我们可以在Node.js中使用<code class="fe lk ll lm ln b">xml-js</code>库轻松地将JSON字符串转换成XML字符串。</p><pre class="kd ke kf kg gt lo ln lp lq aw lr bi"><span id="09f0" class="ls lt in ln b gy lu lv l lw lx">import { json2xml } from 'xml-js';</span><span id="d734" class="ls lt in ln b gy ly lv l lw lx">const jsonObj = {<br/>  name: 'Garage',<br/>  cars: [<br/>    { color: 'red', maxSpeed: 120, age: 2 },<br/>    { color: 'blue', maxSpeed: 100, age: 3 },<br/>    { color: 'green', maxSpeed: 130, age: 2 },<br/>  ],<br/>};</span><span id="ba22" class="ls lt in ln b gy ly lv l lw lx">const json = JSON.stringify(jsonObj);</span><span id="a7e8" class="ls lt in ln b gy ly lv l lw lx">const xml = json2xml(json, { compact: true, spaces: 4 });</span><span id="1801" class="ls lt in ln b gy ly lv l lw lx">console.log(xml);</span></pre><p id="9fea" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">该代码将有以下输出:</p><pre class="kd ke kf kg gt lo ln lp lq aw lr bi"><span id="31a1" class="ls lt in ln b gy lu lv l lw lx">&lt;name&gt;Garage&lt;/name&gt;<br/>&lt;cars&gt;<br/>    &lt;color&gt;red&lt;/color&gt;<br/>    &lt;maxSpeed&gt;120&lt;/maxSpeed&gt;<br/>    &lt;age&gt;2&lt;/age&gt;<br/>&lt;/cars&gt;<br/>&lt;cars&gt;<br/>    &lt;color&gt;blue&lt;/color&gt;<br/>    &lt;maxSpeed&gt;100&lt;/maxSpeed&gt;<br/>    &lt;age&gt;3&lt;/age&gt;<br/>&lt;/cars&gt;<br/>&lt;cars&gt;<br/>    &lt;color&gt;green&lt;/color&gt;<br/>    &lt;maxSpeed&gt;130&lt;/maxSpeed&gt;<br/>    &lt;age&gt;2&lt;/age&gt;<br/>&lt;/cars&gt;</span></pre><h1 id="d41f" class="lz lt in bd ma mb mc md me mf mg mh mi jt mj ju mk jw ml jx mm jz mn ka mo mp bi translated">安装xml-js</h1><p id="5e24" class="pw-post-body-paragraph ko kp in kq b kr mq jo kt ku mr jr kw kx ms kz la lb mt ld le lf mu lh li lj ig bi translated">在使用<code class="fe lk ll lm ln b">xml-js</code>之前，我们需要将它安装到我们的项目中。我们可以使用NPM命令行界面来实现这一点。</p><pre class="kd ke kf kg gt lo ln lp lq aw lr bi"><span id="6673" class="ls lt in ln b gy lu lv l lw lx">npm i xml-js</span></pre><p id="4982" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">或使用纱线CLI:</p><pre class="kd ke kf kg gt lo ln lp lq aw lr bi"><span id="4115" class="ls lt in ln b gy lu lv l lw lx">yarn add xml-js</span></pre><p id="7353" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">安装完成后，我们可以将其导入JavaScript模块，如下所示:</p><pre class="kd ke kf kg gt lo ln lp lq aw lr bi"><span id="0767" class="ls lt in ln b gy lu lv l lw lx">import { json2xml } from 'xml-js';</span></pre><p id="8478" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我们使用导入析构直接从库中访问<code class="fe lk ll lm ln b">json2xml()</code>方法。</p><p id="42cd" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">对于CommonJS模块，我们将改为这样导入它:</p><pre class="kd ke kf kg gt lo ln lp lq aw lr bi"><span id="83bd" class="ls lt in ln b gy lu lv l lw lx">const { json2xml } = require('xml-js');</span></pre><h1 id="af68" class="lz lt in bd ma mb mc md me mf mg mh mi jt mj ju mk jw ml jx mm jz mn ka mo mp bi translated"><code class="fe lk ll lm ln b">json2xml()</code>功能</h1><p id="50d6" class="pw-post-body-paragraph ko kp in kq b kr mq jo kt ku mr jr kw kx ms kz la lb mt ld le lf mu lh li lj ig bi translated">库中的<code class="fe lk ll lm ln b">json2xml()</code>函数有两个参数。第一个是要转换成XML的JSON字符串，第二个是对象。</p><pre class="kd ke kf kg gt lo ln lp lq aw lr bi"><span id="10e7" class="ls lt in ln b gy lu lv l lw lx">const xml = json2xml(json, { compact: true, spaces: 4 });</span></pre><h1 id="73b4" class="lz lt in bd ma mb mc md me mf mg mh mi jt mj ju mk jw ml jx mm jz mn ka mo mp bi translated">在Node.js中自定义JSON到XML的转换</h1><p id="b6de" class="pw-post-body-paragraph ko kp in kq b kr mq jo kt ku mr jr kw kx ms kz la lb mt ld le lf mu lh li lj ig bi translated">此对象用于指定自定义转换过程的各种选项。</p><p id="4919" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在我们的示例中，我们将<code class="fe lk ll lm ln b">compact</code>属性设置为<code class="fe lk ll lm ln b">true</code>，以表明JSON字符串输入是紧凑形式的。</p><p id="4f52" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我们将<code class="fe lk ll lm ln b">spaces</code>属性设置为<code class="fe lk ll lm ln b">4</code>，将嵌套的XML节点缩进4个空格。因此，我们可以通过将<code class="fe lk ll lm ln b">spaces</code>设置为<code class="fe lk ll lm ln b">1</code>来减少缩进:</p><pre class="kd ke kf kg gt lo ln lp lq aw lr bi"><span id="529c" class="ls lt in ln b gy lu lv l lw lx">import { json2xml } from 'xml-js';</span><span id="3da6" class="ls lt in ln b gy ly lv l lw lx">const jsonObj = {<br/>  name: 'Garage',<br/>  cars: [<br/>    { color: 'red', maxSpeed: 120, age: 2 },<br/>    { color: 'blue', maxSpeed: 100, age: 3 },<br/>    { color: 'green', maxSpeed: 130, age: 2 },<br/>  ],<br/>};</span><span id="dc43" class="ls lt in ln b gy ly lv l lw lx">const json = JSON.stringify(jsonObj);</span><span id="22fc" class="ls lt in ln b gy ly lv l lw lx">const xml = json2xml(json, { compact: true, spaces: 1 });</span><span id="dfc1" class="ls lt in ln b gy ly lv l lw lx">console.log(xml);</span></pre><p id="76df" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在，我们将得到以下XML输出:</p><pre class="kd ke kf kg gt lo ln lp lq aw lr bi"><span id="e1dc" class="ls lt in ln b gy lu lv l lw lx">&lt;name&gt;Garage&lt;/name&gt;<br/>&lt;cars&gt;<br/> &lt;color&gt;red&lt;/color&gt;<br/> &lt;maxSpeed&gt;120&lt;/maxSpeed&gt;<br/> &lt;age&gt;2&lt;/age&gt;<br/>&lt;/cars&gt;<br/>&lt;cars&gt;<br/> &lt;color&gt;blue&lt;/color&gt;<br/> &lt;maxSpeed&gt;100&lt;/maxSpeed&gt;<br/> &lt;age&gt;3&lt;/age&gt;<br/>&lt;/cars&gt;<br/>&lt;cars&gt;<br/> &lt;color&gt;green&lt;/color&gt;<br/> &lt;maxSpeed&gt;130&lt;/maxSpeed&gt;<br/> &lt;age&gt;2&lt;/age&gt;<br/>&lt;/cars&gt;</span></pre><h1 id="bbf9" class="lz lt in bd ma mb mc md me mf mg mh mi jt mj ju mk jw ml jx mm jz mn ka mo mp bi translated">Node.js中JSON到XML的本机转换</h1><p id="48a3" class="pw-post-body-paragraph ko kp in kq b kr mq jo kt ku mr jr kw kx ms kz la lb mt ld le lf mu lh li lj ig bi translated">如果不想使用任何第三方库，那么可以在Node.js中使用这个递归函数将JSON转换成XML。</p><pre class="kd ke kf kg gt lo ln lp lq aw lr bi"><span id="90ec" class="ls lt in ln b gy lu lv l lw lx">function JSONtoXML(obj) {<br/>  let xml = '';<br/>  for (let prop in obj) {<br/>    xml += obj[prop] instanceof Array ? '' : '&lt;' + prop + '&gt;';<br/>    if (obj[prop] instanceof Array) {<br/>      for (let array in obj[prop]) {<br/>        xml += '\n&lt;' + prop + '&gt;\n';<br/>        xml += JSONtoXML(new Object(obj[prop][array]));<br/>        xml += '&lt;/' + prop + '&gt;';<br/>      }<br/>    } else if (typeof obj[prop] == 'object') {<br/>      xml += JSONtoXML(new Object(obj[prop]));<br/>    } else {<br/>      xml += obj[prop];<br/>    }<br/>    xml += obj[prop] instanceof Array ? '' : '&lt;/' + prop + '&gt;\n';<br/>  }<br/>  xml = xml.replace(/&lt;\/?[0-9]{1,}&gt;/g, '');<br/>  return xml;<br/>}</span><span id="7019" class="ls lt in ln b gy ly lv l lw lx">const jsonObj = {<br/>  name: 'Garage',<br/>  cars: [<br/>    { color: 'red', maxSpeed: 120, age: 2 },<br/>    { color: 'blue', maxSpeed: 100, age: 3 },<br/>    { color: 'green', maxSpeed: 130, age: 2 },<br/>  ],<br/>};</span><span id="ae7b" class="ls lt in ln b gy ly lv l lw lx">const xml = JSONtoXML(jsonObj);</span><span id="9b11" class="ls lt in ln b gy ly lv l lw lx">console.log(xml);</span></pre><p id="5401" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">该代码将产生以下输出:</p><pre class="kd ke kf kg gt lo ln lp lq aw lr bi"><span id="9fce" class="ls lt in ln b gy lu lv l lw lx">&lt;name&gt;Garage&lt;/name&gt;</span><span id="3fdd" class="ls lt in ln b gy ly lv l lw lx">&lt;cars&gt;<br/>&lt;color&gt;red&lt;/color&gt;<br/>&lt;maxSpeed&gt;120&lt;/maxSpeed&gt;<br/>&lt;age&gt;2&lt;/age&gt;<br/>&lt;/cars&gt;<br/>&lt;cars&gt;<br/>&lt;color&gt;blue&lt;/color&gt;<br/>&lt;maxSpeed&gt;100&lt;/maxSpeed&gt;<br/>&lt;age&gt;3&lt;/age&gt;<br/>&lt;/cars&gt;<br/>&lt;cars&gt;<br/>&lt;color&gt;green&lt;/color&gt;<br/>&lt;maxSpeed&gt;130&lt;/maxSpeed&gt;<br/>&lt;age&gt;2&lt;/age&gt;<br/>&lt;/cars&gt;</span></pre></div><div class="ab cl mv mw hr mx" role="separator"><span class="my bw bk mz na nb"/><span class="my bw bk mz na nb"/><span class="my bw bk mz na"/></div><div class="ig ih ii ij ik"><p id="1a7d" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><em class="nc">原载于</em><a class="ae nd" href="https://cbdev.link/fe37fc" rel="noopener ugc nofollow" target="_blank"><em class="nc">codingbeautydev.com</em></a></p><h1 id="b721" class="lz lt in bd ma mb mc md me mf mg mh mi jt mj ju mk jw ml jx mm jz mn ka mo mp bi translated">JavaScript做的每一件疯狂的事情</h1><p id="e18c" class="pw-post-body-paragraph ko kp in kq b kr mq jo kt ku mr jr kw kx ms kz la lb mt ld le lf mu lh li lj ig bi translated">一本关于JavaScript微妙的警告和鲜为人知的部分的迷人指南。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi ne"><img src="../Images/143ee152ba78025ea8643ba5b9726a20.png" data-original-src="https://miro.medium.com/v2/resize:fit:700/format:webp/1*YS5Oub8REWy8vnOEqBnsyQ.png"/></div></figure><p id="7d6e" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><a class="ae nd" href="https://cbdev.link/d3c4eb" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io">报名</strong> </a>立即免费领取一份。</p></div></div>    
</body>
</html>