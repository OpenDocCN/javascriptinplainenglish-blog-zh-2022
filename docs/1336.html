<html>
<head>
<title>Build the Simplest RESTful API with Node.js and MySQL</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">用Node.js和MySQL构建最简单的RESTful API</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/the-simplest-restful-api-with-nodejs-and-mysql-3d513493ef0e?source=collection_archive---------1-----------------------#2022-03-17">https://javascript.plainenglish.io/the-simplest-restful-api-with-nodejs-and-mysql-3d513493ef0e?source=collection_archive---------1-----------------------#2022-03-17</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="ab24" class="pw-subtitle-paragraph jk im in bd b jl jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb dk translated">构建连接到MySQL数据库以查询和操作数据的Express RESTful API的基础。</h2></div><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi kc"><img src="../Images/008920d92d54d6139ebc7bde0c6cb557.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*4C94DErmzDU4fSEusyU3wQ.jpeg"/></div></div></figure><p id="b3ed" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">我仍然喜欢写一些文章来帮助初学者入门。这些年来，我在不同的领域积累了大量的经验，但是如果没有这些基础知识，我不可能取得现在的成就。</p><h1 id="28c4" class="lk ll in bd lm ln lo lp lq lr ls lt lu jt lv ju lw jw lx jx ly jz lz ka ma mb bi translated">我们开始吧</h1><h2 id="652c" class="mc ll in bd lm md me dn lq mf mg dp lu kx mh mi lw lb mj mk ly lf ml mm ma mn bi translated"><strong class="ak"> 1。创建我们的数据库和必要的表。</strong></h2><p id="5a73" class="pw-post-body-paragraph ko kp in kq b kr mo jo kt ku mp jr kw kx mq kz la lb mr ld le lf ms lh li lj ig bi translated">创建数据库有很多方法，你可以使用一个GUI工具，比如PHPMyAdmin，HeidiSQL等等。，或者通过终端创建一个，如下所示。</p><p id="32d1" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io"> a .打开你的终端应用，输入</strong></p><pre class="kd ke kf kg gt mt mu mv mw aw mx bi"><span id="a2bd" class="mc ll in mu b gy my mz l na nb">mysql -u [username] -p</span></pre><ul class=""><li id="92d4" class="nc nd in kq b kr ks ku kv kx ne lb nf lf ng lj nh ni nj nk bi translated"><em class="nl">将[用户名]替换为您的数据库用户，然后按回车键。系统会提示您输入密码来访问MySQL shell。</em></li><li id="17ab" class="nc nd in kq b kr nm ku nn kx no lb np lf nq lj nh ni nj nk bi translated"><code class="fe nr ns nt mu b"><strong class="kq io">mysql&gt;</strong></code>提示符表示您已经登录到MySQL shell。</li></ul><p id="519f" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io"> b .通过数据库认证后，创建一个数据库。</strong></p><p id="212d" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在同一终端中，键入:</p><pre class="kd ke kf kg gt mt mu mv mw aw mx bi"><span id="7bf5" class="mc ll in mu b gy my mz l na nb">CREATE DATABASE restful_api;</span><span id="e9d4" class="mc ll in mu b gy nu mz l na nb">USE restful_api;</span></pre><p id="4d25" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">创建存储我们数据的表格。</p><pre class="kd ke kf kg gt mt mu mv mw aw mx bi"><span id="1d29" class="mc ll in mu b gy my mz l na nb">CREATE TABLE employees(<br/>id INT AUTO_INCREMENT PRIMARY KEY, <br/>firstname VARCHAR(50) NOT NULL, <br/>lastname VARCHAR(50) NOT NULL,<br/>phone VARCHAR(50) NOT NULL,<br/>email VARCHAR(50) NOT NULL,<br/>);</span></pre><p id="f442" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><strong class="kq io"> d .简单地退出MySQL，因为我们现在已经完成了。</strong></p><pre class="kd ke kf kg gt mt mu mv mw aw mx bi"><span id="250e" class="mc ll in mu b gy my mz l na nb">exit;</span></pre><h2 id="cd90" class="mc ll in bd lm md me dn lq mf mg dp lu kx mh mi lw lb mj mk ly lf ml mm ma mn bi translated"><strong class="ak"> 2。引导我们的应用程序并创建必要的文件。</strong></h2><p id="b123" class="pw-post-body-paragraph ko kp in kq b kr mo jo kt ku mp jr kw kx mq kz la lb mr ld le lf ms lh li lj ig bi translated">打开终端，导航到restful_api目录(如果您不在那里),然后运行下面的命令</p><p id="ab98" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">a.初始化npm并安装必要的模块。为了这个项目。</p><pre class="kd ke kf kg gt mt mu mv mw aw mx bi"><span id="dac4" class="mc ll in mu b gy my mz l na nb">touch index.js .env</span><span id="1ab9" class="mc ll in mu b gy nu mz l na nb">npm init -y</span><span id="b233" class="mc ll in mu b gy nu mz l na nb">npm i express mysql dotenv --save</span><span id="b85b" class="mc ll in mu b gy nu mz l na nb">npm i nodemon --save-dev</span></pre><p id="7f0c" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">b.现在我们写一些代码。</p><p id="79b9" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在VSCode中打开项目，然后打开我们的。env文件并添加下面的代码</p><pre class="kd ke kf kg gt mt mu mv mw aw mx bi"><span id="c067" class="mc ll in mu b gy my mz l na nb">DB_DATABASE=restful_api<br/>DB_USERNAME=root<br/>DB_PASSWORD=12345678<br/>DB_HOST=localhost<br/>PORT=3000</span></pre><p id="d062" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">打开我们的index.js文件，创建一个基本的Express服务器(暂时)。</p><p id="9af6" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">在下面的代码中，我们创建了一个基本的restful API，它运行在。env文件，设置我们用来发送和接收数据的API路由，没什么重要的。😎😎😎</p><pre class="kd ke kf kg gt mt mu mv mw aw mx bi"><span id="133a" class="mc ll in mu b gy my mz l na nb">require('dotenv').config();<br/>const express = require('express');<br/>const app = express();</span><span id="a8dd" class="mc ll in mu b gy nu mz l na nb">const PORT = process.env.PORT;</span><span id="79a6" class="mc ll in mu b gy nu mz l na nb">//Our Database Config<br/>const DB_HOST = process.env.DB_HOST;<br/>const DB_DATABASE = process.env.DB_DATABASE;<br/>const DB_USERNAME = process.env.DB_USERNAME;<br/>const DB_PASSWORD = process.env.DB_PASSWORD;</span><span id="799b" class="mc ll in mu b gy nu mz l na nb">//Get all employees from the database<br/>app.get('employees', function (req, res) {});</span><span id="94cf" class="mc ll in mu b gy nu mz l na nb">//Add new empoyee to the database<br/>app.post('employees', function (req, res) {});</span><span id="7726" class="mc ll in mu b gy nu mz l na nb">//Get single employee by id from the database<br/>app.get('employees/details/:id', function (req, res) {});</span><span id="9f8d" class="mc ll in mu b gy nu mz l na nb">//Update single employee by id from the database<br/>app.put('employees/update/:id', function (req, res) {});</span><span id="2070" class="mc ll in mu b gy nu mz l na nb">//Delete single employee by id from the database<br/>app.delete('employees/delete/:id', function (req, res) {});</span><span id="f339" class="mc ll in mu b gy nu mz l na nb">app.listen(PORT, function() {<br/> console.log('Restful API is running on PORT 3000');<br/>});</span></pre><p id="1f7d" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">输入所有这些内容后，😩😩😩保存index.js文件。</p><p id="0d3d" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在让我们运行它，以确保我们没有犯任何错误。👌</p><p id="64cd" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">打开项目根目录中的package.json，并对start scripts部分进行如下修改。</p><pre class="kd ke kf kg gt mt mu mv mw aw mx bi"><span id="7de8" class="mc ll in mu b gy my mz l na nb">"scripts": {<br/>    "start": "node server",<br/>    "start:dev": "nodemon server"<br/> },</span></pre><p id="ed27" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">保存您的更改，打开终端并运行:</p><pre class="kd ke kf kg gt mt mu mv mw aw mx bi"><span id="c070" class="mc ll in mu b gy my mz l na nb">npm run start:dev</span></pre><p id="a6d2" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">这个命令将使用nodemon启动我们的express服务器，并在我们对文件进行更改时自动重启它。很方便，对吧？😎</p><p id="25fe" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">您的Express服务器现在应该已经启动并正在运行。</p><h2 id="2b2d" class="mc ll in bd lm md me dn lq mf mg dp lu kx mh mi lw lb mj mk ly lf ml mm ma mn bi translated"><strong class="ak"> 3。现在让我们连接到数据库，查询一些数据。</strong></h2><p id="e28c" class="pw-post-body-paragraph ko kp in kq b kr mo jo kt ku mp jr kw kx mq kz la lb mr ld le lf ms lh li lj ig bi translated">a.我们需要使用require MySQL，如下所示:</p><pre class="kd ke kf kg gt mt mu mv mw aw mx bi"><span id="f867" class="mc ll in mu b gy my mz l na nb">const mysql = require('mysql');</span></pre><p id="d2cb" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">b.在我们代码的数据库配置部分之后，我们需要创建一个到数据库的连接，如下所示:</p><pre class="kd ke kf kg gt mt mu mv mw aw mx bi"><span id="97f0" class="mc ll in mu b gy my mz l na nb">//Connection to MySQL database<br/>const db = mysql.createConnection({<br/>  user: DB_USERNAME,<br/>  password: DB_PASSWORD,<br/>  host: DB_HOST,<br/>  database: DB_DATABASE,<br/>});</span></pre><p id="496f" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">c.我们现在有了使用🥳🥳🥳.的连接让我们修改我们的root，向数据库中添加一名新员工:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="5552" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">d.很好，现在很快，让我们打开Postman测试一下。输入如下所示的数据并点击发送按钮:</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nx"><img src="../Images/9117eb9702232b421f0317892421e685.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*uLLXruB3eBYPGs6xonoMRw.png"/></div></div></figure><p id="d430" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">检查数据是否出现在你的数据库中。如果到目前为止所有的指令都被执行了，那么您应该可以在数据库中看到您的数据。</p><p id="c58f" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">只需在终端中通过MySQL shell连接到您的数据库，然后键入</p><pre class="kd ke kf kg gt mt mu mv mw aw mx bi"><span id="05f6" class="mc ll in mu b gy my mz l na nb">SELECT * FROM employees;</span></pre><p id="4ceb" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">这应该会返回类似于👇👇👇👇</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div class="gh gi ny"><img src="../Images/5b9b6a94a3ab080d071344ef0bf5333f.png" data-original-src="https://miro.medium.com/v2/resize:fit:1344/format:webp/1*HRoVMkclbUGJEEkf9sW0QQ.png"/></div></figure><p id="a772" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">e.现在我们召集所有员工。只需修改获取员工路线，如下所示:</p><figure class="kd ke kf kg gt kh"><div class="bz fp l di"><div class="nv nw l"/></div></figure><p id="846f" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">再次打开Postman并进行测试，确保一切正常。</p><figure class="kd ke kf kg gt kh gh gi paragraph-image"><div role="button" tabindex="0" class="ki kj di kk bf kl"><div class="gh gi nx"><img src="../Images/c55adde0f9d8042cac4099a8bcf18836.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/format:webp/1*yzFDN5t-9wjZi6tiGriSMw.png"/></div></div><figcaption class="nz oa gj gh gi ob oc bd b be z dk">Get all employee records from the database</figcaption></figure><p id="c79b" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">如果你已经走了这么远。好哇🎉🎈🥳!现在，您已经知道如何使用Node.js Restful服务在MySQL中查询和执行插入操作。</p><p id="42a1" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">为了简洁起见，我就讲到这里，但是还有很多要讨论的。</p><ol class=""><li id="f2fe" class="nc nd in kq b kr ks ku kv kx ne lb nf lf ng lj od ni nj nk bi translated"><strong class="kq io"> <em class="nl">获取单条记录</em> </strong></li><li id="bf09" class="nc nd in kq b kr nm ku nn kx no lb np lf nq lj od ni nj nk bi translated"><strong class="kq io"> <em class="nl">更新单条记录</em> </strong></li><li id="106e" class="nc nd in kq b kr nm ku nn kx no lb np lf nq lj od ni nj nk bi translated"><strong class="kq io"> <em class="nl">执行批量更新</em> </strong></li><li id="c74e" class="nc nd in kq b kr nm ku nn kx no lb np lf nq lj od ni nj nk bi translated"><strong class="kq io"> <em class="nl">返回分页的数据列表。</em>T15】</strong></li><li id="9dee" class="nc nd in kq b kr nm ku nn kx no lb np lf nq lj od ni nj nk bi translated"><strong class="kq io"> <em class="nl">用Redis添加缓存</em> </strong></li><li id="9698" class="nc nd in kq b kr nm ku nn kx no lb np lf nq lj od ni nj nk bi translated"><strong class="kq io"> <em class="nl">将API部署到服务器上。</em> </strong></li><li id="3c1f" class="nc nd in kq b kr nm ku nn kx no lb np lf nq lj od ni nj nk bi translated"><strong class="kq io"> <em class="nl">搜索功能同弹性搜索。</em> </strong></li></ol><p id="104e" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">如果你觉得这个非常有用，请在评论中告诉我，关注，评论，分享改进，如果你遇到任何问题，请告诉我。我很乐意指导你。</p><p id="f105" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated">现在再见👋🏽👋🏽👋🏽👋🏽</p><p id="51a1" class="pw-post-body-paragraph ko kp in kq b kr ks jo kt ku kv jr kw kx ky kz la lb lc ld le lf lg lh li lj ig bi translated"><em class="nl">更多内容请看</em><a class="ae oe" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kq io"><em class="nl">plain English . io</em></strong></a><em class="nl">。报名参加我们的</em> <a class="ae oe" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io"> <em class="nl">免费每周简讯</em> </strong> </a> <em class="nl">。关注我们</em><a class="ae oe" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="kq io"><em class="nl">Twitter</em></strong></a><em class="nl">和</em><strong class="kq io"><em class="nl"/></strong><a class="ae oe" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kq io"><em class="nl">LinkedIn</em></strong></a><em class="nl">。加入我们的</em> <a class="ae oe" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kq io"> <em class="nl">社区不和谐</em> </strong> </a> <em class="nl">。</em></p></div></div>    
</body>
</html>