<html>
<head>
<title>How to Call Alpine.js Methods from Third-Party Scripts</title>
<link href="../Styles/Style.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<h1 class="translated">如何从第三方脚本中调用Alpine.js方法</h1>
<blockquote>原文：<a href="https://javascript.plainenglish.io/calling-alpine-js-methods-from-third-party-scripts-70068815659f?source=collection_archive---------14-----------------------#2022-03-08">https://javascript.plainenglish.io/calling-alpine-js-methods-from-third-party-scripts-70068815659f?source=collection_archive---------14-----------------------#2022-03-08</a></blockquote><div><div class="fc ib ic id ie if"/><div class="ig ih ii ij ik"><div class=""/><div class=""><h2 id="1cf0" class="pw-subtitle-paragraph jl im in bd b jm jn jo jp jq jr js jt ju jv jw jx jy jz ka kb kc dk translated"><em class="jk">我们如何让阿尔卑斯山的网页理解谷歌地图事件。</em></h2></div><figure class="ke kf kg kh gt ki gh gi paragraph-image"><div role="button" tabindex="0" class="kj kk di kl bf km"><div class="gh gi kd"><img src="../Images/18891c38b0a3f350487050133ae53571.png" data-original-src="https://miro.medium.com/v2/resize:fit:1400/0*gOQ4k9VvWUbHU9ZI"/></div></div><figcaption class="kp kq gj gh gi kr ks bd b be z dk">Photo by <a class="ae kt" href="https://unsplash.com/@dead____artist?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Z</a> on <a class="ae kt" href="https://unsplash.com/@dead____artist?utm_source=unsplash&amp;utm_medium=referral&amp;utm_content=creditCopyText" rel="noopener ugc nofollow" target="_blank">Unsplash</a></figcaption></figure><p id="2342" class="pw-post-body-paragraph ku kv in kw b kx ky jp kz la lb js lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">最近，当在Alpine.js支持的页面上实现谷歌地图时，我们遇到了一个小挑战。要点:</p><ul class=""><li id="1adb" class="lq lr in kw b kx ky la lb ld ls lh lt ll lu lp lv lw lx ly bi translated">地图标记数据加载在Alpine.js存储中</li><li id="19c7" class="lq lr in kw b kx lz la ma ld mb lh mc ll md lp lv lw lx ly bi translated">谷歌地图不在Alpine.js的范围内，所以<strong class="kw io">在加载后不能直接调用Alpine方法</strong></li></ul><p id="8def" class="pw-post-body-paragraph ku kv in kw b kx ky jp kz la lb js lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">我们不可能在谷歌地图上显示这些地图标记。</p><p id="5cdf" class="pw-post-body-paragraph ku kv in kw b kx ky jp kz la lb js lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">冲浪后，<a class="ae kt" href="https://github.com/alpinejs/alpine/discussions/517" rel="noopener ugc nofollow" target="_blank">这条线</a>给出了一个提示。让我们通过实际的代码来建立基础。</p><p id="c0a4" class="pw-post-body-paragraph ku kv in kw b kx ky jp kz la lb js lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated"><em class="me">谷歌地图相关代码:</em></p><pre class="ke kf kg kh gt mf mg mh mi aw mj bi"><span id="536f" class="mk ml in mg b gy mm mn l mo mp">&lt;div class="container"&gt;<br/> &lt;div id="google-map" style="height: 600px;"&gt;&lt;/div&gt;<br/>&lt;/div&gt;</span><span id="a5be" class="mk ml in mg b gy mq mn l mo mp">...</span><span id="6969" class="mk ml in mg b gy mq mn l mo mp">&lt;script async src="<a class="ae kt" href="https://maps.googleapis.com/maps/api/js?key=APIKEY&amp;callback=renderMap" rel="noopener ugc nofollow" target="_blank">https://maps.googleapis.com/maps/api/js?key=APIKEY&amp;callback=renderMap</a>"&gt;&lt;/script&gt;</span><span id="b191" class="mk ml in mg b gy mq mn l mo mp">&lt;script&gt;<br/> var googleMapObject;</span><span id="77c1" class="mk ml in mg b gy mq mn l mo mp">function renderMap() {<br/>  googleMapObject = new google.maps.Map(document.getElementById("google-map"), {<br/>   // Map config<br/>  });<br/> }<br/>&lt;/script&gt;</span></pre><p id="cb2f" class="pw-post-body-paragraph ku kv in kw b kx ky jp kz la lb js lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated"><em class="me">这是Alpine.js的设置代码:</em></p><pre class="ke kf kg kh gt mf mg mh mi aw mj bi"><span id="c0f0" class="mk ml in mg b gy mm mn l mo mp">&lt;script defer src="<a class="ae kt" href="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" rel="noopener ugc nofollow" target="_blank">https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js</a>"&gt;&lt;/script&gt;</span><span id="d615" class="mk ml in mg b gy mq mn l mo mp">&lt;script&gt;<br/> document.addEventListener('alpine:init', () =&gt; {<br/>  Alpine.store('app', {<br/>   mapMarkers: [<br/>    // Pre-loaded markers data<br/>   ]<br/>  });<br/> });<br/>&lt;/script&gt;</span></pre><h1 id="e7c4" class="mr ml in bd ms mt mu mv mw mx my mz na ju nb jv nc jx nd jy ne ka nf kb ng nh bi translated">解决办法</h1><p id="efc2" class="pw-post-body-paragraph ku kv in kw b kx ni jp kz la nj js lc ld nk lf lg lh nl lj lk ll nm ln lo lp ig bi translated"><em class="me">事件</em>前来救援。您可以从谷歌地图对象中激发一个自定义的Javascript窗口事件，并让Alpine听它。让我们看看代码:</p><pre class="ke kf kg kh gt mf mg mh mi aw mj bi"><span id="9416" class="mk ml in mg b gy mm mn l mo mp">&lt;script&gt;<br/> function renderMap() {<br/>  // initialize map code</span><span id="2a6e" class="mk ml in mg b gy mq mn l mo mp">var mapLoadedEvent = new Event('map-loaded');<br/>  window.dispatchEvent(mapLoadedEvent);<br/> }<br/>&lt;/script&gt;</span></pre><p id="0f00" class="pw-post-body-paragraph ku kv in kw b kx ky jp kz la lb js lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">首先，一旦谷歌地图被加载，我们就启动名为<code class="fe nn no np mg b">map-loaded</code>的定制JS事件。</p><pre class="ke kf kg kh gt mf mg mh mi aw mj bi"><span id="3c0f" class="mk ml in mg b gy mm mn l mo mp">&lt;div class="container" x-data <a class="ae kt" href="http://twitter.com/map" rel="noopener ugc nofollow" target="_blank">@map</a>-loaded.window="$store.app.addAllMarkers()"&gt;<br/> &lt;div id="google-map" style="height: 600px;"&gt;&lt;/div&gt;<br/>&lt;/div&gt;</span></pre><p id="3800" class="pw-post-body-paragraph ku kv in kw b kx ky jp kz la lb js lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">该HTML代码监听该事件，并调用<em class="me"> addAllMarkers </em> Alpine方法。这样，我们的谷歌地图就可以调用Alpine.js方法来显示地图标记。</p><p id="29fb" class="pw-post-body-paragraph ku kv in kw b kx ky jp kz la lb js lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">最后，我们的高山方法可以完成其余的工作。</p><pre class="ke kf kg kh gt mf mg mh mi aw mj bi"><span id="8540" class="mk ml in mg b gy mm mn l mo mp">&lt;script&gt;<br/> var googleMapObject;</span><span id="ce30" class="mk ml in mg b gy mq mn l mo mp">document.addEventListener('alpine:init', () =&gt; {<br/>  Alpine.store('app', {<br/>   mapMarkers: [<br/>    // Pre-loaded markers data<br/>   ],</span><span id="a01f" class="mk ml in mg b gy mq mn l mo mp">addAllMarkers() {<br/>    this.mapMarkers.forEach(function (mapMarker) {<br/>     new google.maps.Marker({<br/>      // Map marker config<br/>     });<br/>    });<br/>   },<br/>  });<br/> });<br/>&lt;/script&gt;</span></pre><p id="4c30" class="pw-post-body-paragraph ku kv in kw b kx ky jp kz la lb js lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">我们这样做是为了谷歌地图，但是您也可以使用自定义Javascript窗口事件对任何其他第三方JS库进行同样的操作。</p><blockquote class="nq nr ns"><p id="3db9" class="ku kv me kw b kx ky jp kz la lb js lc nt le lf lg nu li lj lk nv lm ln lo lp ig bi translated"><em class="in">需要注意的是</em> <code class="fe nn no np mg b"><em class="in">CustomEvent</em></code> <em class="in">不同于<code class="fe nn no np mg b"><em class="in">Event</em></code> <em class="in">的普通JS。查看</em> <a class="ae kt" href="https://stackoverflow.com/a/40795249/3113599" rel="noopener ugc nofollow" target="_blank"> <em class="in">本</em> </a> <em class="in"> Stackoverflow答案获取详细信息。</em></em></p></blockquote><p id="c552" class="pw-post-body-paragraph ku kv in kw b kx ky jp kz la lb js lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated">干杯！</p></div><div class="ab cl nw nx hr ny" role="separator"><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob oc"/><span class="nz bw bk oa ob"/></div><div class="ig ih ii ij ik"><p id="39d8" class="pw-post-body-paragraph ku kv in kw b kx ky jp kz la lb js lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated"><em class="me">原为发表于</em><a class="ae kt" href="https://blog.freshbits.in/calling-alpinejs-methods-from-third-party-scripts" rel="noopener ugc nofollow" target="_blank"><em class="me">https://blog . freshbits . in</em></a><em class="me">。</em></p><p id="d09b" class="pw-post-body-paragraph ku kv in kw b kx ky jp kz la lb js lc ld le lf lg lh li lj lk ll lm ln lo lp ig bi translated"><em class="me">更多内容请看</em><a class="ae kt" href="https://plainenglish.io/" rel="noopener ugc nofollow" target="_blank"><strong class="kw io"><em class="me">plain English . io</em></strong></a><em class="me">。报名参加我们的</em> <a class="ae kt" href="http://newsletter.plainenglish.io/" rel="noopener ugc nofollow" target="_blank"> <strong class="kw io"> <em class="me">免费周报</em> </strong> </a> <em class="me">。关注我们关于</em><a class="ae kt" href="https://twitter.com/inPlainEngHQ" rel="noopener ugc nofollow" target="_blank"><strong class="kw io"><em class="me">Twitter</em></strong></a><em class="me">和</em><a class="ae kt" href="https://www.linkedin.com/company/inplainenglish/" rel="noopener ugc nofollow" target="_blank"><strong class="kw io"><em class="me">LinkedIn</em></strong></a><em class="me">。加入我们的</em> <a class="ae kt" href="https://discord.gg/GtDtUAvyhW" rel="noopener ugc nofollow" target="_blank"> <strong class="kw io"> <em class="me">社区不和谐</em> </strong> </a> <em class="me">。</em></p></div></div>    
</body>
</html>